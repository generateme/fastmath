<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistics – Fastmath documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./polynomials.html" rel="next">
<link href="./random.html" rel="prev">
<link href="./clay/resources/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-494121dfa8658343c03537e94414993d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5080318e4e0fa5434adc66c5e0128d3e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stats.html">Statistics</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fastmath documentation</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector_matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vectors and matrices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./polynomials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polynomials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./special.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Special functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calculus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interpolation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpolation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine Learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complex_quaternions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Complex numbers and quaternions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./easings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Easings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fields.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vector fields</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./efloat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EFloat</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#datasets" id="toc-datasets" class="nav-link active" data-scroll-target="#datasets">Datasets</a>
  <ul>
  <li><a href="#mtcars" id="toc-mtcars" class="nav-link" data-scroll-target="#mtcars"><code>mtcars</code></a></li>
  <li><a href="#iris" id="toc-iris" class="nav-link" data-scroll-target="#iris"><code>iris</code></a></li>
  <li><a href="#winequality" id="toc-winequality" class="nav-link" data-scroll-target="#winequality"><code>winequality</code></a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul>
  <li><a href="#mtcars-1" id="toc-mtcars-1" class="nav-link" data-scroll-target="#mtcars-1"><code>mtcars</code></a></li>
  <li><a href="#iris-1" id="toc-iris-1" class="nav-link" data-scroll-target="#iris-1"><code>iris</code></a></li>
  <li><a href="#winequality-1" id="toc-winequality-1" class="nav-link" data-scroll-target="#winequality-1"><code>winequality</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#basic-descriptive-statistics" id="toc-basic-descriptive-statistics" class="nav-link" data-scroll-target="#basic-descriptive-statistics">Basic Descriptive Statistics</a>
  <ul>
  <li><a href="#basic" id="toc-basic" class="nav-link" data-scroll-target="#basic">Basic</a></li>
  <li><a href="#mean" id="toc-mean" class="nav-link" data-scroll-target="#mean">Mean</a>
  <ul>
  <li><a href="#weighted" id="toc-weighted" class="nav-link" data-scroll-target="#weighted">Weighted</a></li>
  <li><a href="#expectile" id="toc-expectile" class="nav-link" data-scroll-target="#expectile">Expectile</a></li>
  </ul></li>
  <li><a href="#mode" id="toc-mode" class="nav-link" data-scroll-target="#mode">Mode</a></li>
  <li><a href="#stats" id="toc-stats" class="nav-link" data-scroll-target="#stats">Stats</a></li>
  </ul></li>
  <li><a href="#quantiles-and-percentiles" id="toc-quantiles-and-percentiles" class="nav-link" data-scroll-target="#quantiles-and-percentiles">Quantiles and Percentiles</a>
  <ul>
  <li><a href="#weighted-1" id="toc-weighted-1" class="nav-link" data-scroll-target="#weighted-1">Weighted</a></li>
  </ul></li>
  <li><a href="#measures-of-dispersiondeviation" id="toc-measures-of-dispersiondeviation" class="nav-link" data-scroll-target="#measures-of-dispersiondeviation">Measures of Dispersion/Deviation</a>
  <ul>
  <li><a href="#variance-and-standard-deviation" id="toc-variance-and-standard-deviation" class="nav-link" data-scroll-target="#variance-and-standard-deviation">Variance and standard deviation</a></li>
  <li><a href="#mad" id="toc-mad" class="nav-link" data-scroll-target="#mad">MAD</a></li>
  </ul></li>
  <li><a href="#moments-and-shape" id="toc-moments-and-shape" class="nav-link" data-scroll-target="#moments-and-shape">Moments and Shape</a>
  <ul>
  <li><a href="#conventional-moments-moment" id="toc-conventional-moments-moment" class="nav-link" data-scroll-target="#conventional-moments-moment">Conventional Moments (<code>moment</code>)</a></li>
  <li><a href="#skewness" id="toc-skewness" class="nav-link" data-scroll-target="#skewness">Skewness</a></li>
  <li><a href="#kurtosis" id="toc-kurtosis" class="nav-link" data-scroll-target="#kurtosis">Kurtosis</a></li>
  <li><a href="#l-moment" id="toc-l-moment" class="nav-link" data-scroll-target="#l-moment">L-moment</a></li>
  </ul></li>
  <li><a href="#intervals-and-extents" id="toc-intervals-and-extents" class="nav-link" data-scroll-target="#intervals-and-extents">Intervals and Extents</a></li>
  <li><a href="#outlier-detection" id="toc-outlier-detection" class="nav-link" data-scroll-target="#outlier-detection">Outlier Detection</a></li>
  <li><a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation">Data Transformation</a></li>
  <li><a href="#correlation-and-covariance" id="toc-correlation-and-covariance" class="nav-link" data-scroll-target="#correlation-and-covariance">Correlation and Covariance</a></li>
  <li><a href="#distance-and-similarity-metrics" id="toc-distance-and-similarity-metrics" class="nav-link" data-scroll-target="#distance-and-similarity-metrics">Distance and Similarity Metrics</a>
  <ul>
  <li><a href="#error-metrics" id="toc-error-metrics" class="nav-link" data-scroll-target="#error-metrics">Error Metrics</a></li>
  <li><a href="#distance-metrics-l-p-norms-and-others" id="toc-distance-metrics-l-p-norms-and-others" class="nav-link" data-scroll-target="#distance-metrics-l-p-norms-and-others">Distance Metrics (L-p Norms and others)</a></li>
  <li><a href="#dissimilarity-and-similarity" id="toc-dissimilarity-and-similarity" class="nav-link" data-scroll-target="#dissimilarity-and-similarity">Dissimilarity and Similarity</a>
  <ul>
  <li><a href="#dissimilarity-methods" id="toc-dissimilarity-methods" class="nav-link" data-scroll-target="#dissimilarity-methods">Dissimilarity Methods</a></li>
  <li><a href="#similarity-methods" id="toc-similarity-methods" class="nav-link" data-scroll-target="#similarity-methods">Similarity Methods</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#contingency-tables" id="toc-contingency-tables" class="nav-link" data-scroll-target="#contingency-tables">Contingency Tables</a>
  <ul>
  <li><a href="#binary-classification-metrics" id="toc-binary-classification-metrics" class="nav-link" data-scroll-target="#binary-classification-metrics">Binary Classification Metrics</a></li>
  </ul></li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size">Effect Size</a>
  <ul>
  <li><a href="#difference-family" id="toc-difference-family" class="nav-link" data-scroll-target="#difference-family">Difference Family</a></li>
  <li><a href="#ratio-family" id="toc-ratio-family" class="nav-link" data-scroll-target="#ratio-family">Ratio Family</a></li>
  <li><a href="#ordinal-non-parametric-family" id="toc-ordinal-non-parametric-family" class="nav-link" data-scroll-target="#ordinal-non-parametric-family">Ordinal / Non-parametric Family</a></li>
  <li><a href="#overlap-family" id="toc-overlap-family" class="nav-link" data-scroll-target="#overlap-family">Overlap Family</a></li>
  <li><a href="#correlation-association-family" id="toc-correlation-association-family" class="nav-link" data-scroll-target="#correlation-association-family">Correlation / Association Family</a></li>
  </ul></li>
  <li><a href="#statistical-tests" id="toc-statistical-tests" class="nav-link" data-scroll-target="#statistical-tests">Statistical Tests</a>
  <ul>
  <li><a href="#normality-and-shape-tests" id="toc-normality-and-shape-tests" class="nav-link" data-scroll-target="#normality-and-shape-tests">Normality and Shape Tests</a></li>
  <li><a href="#binomial-tests" id="toc-binomial-tests" class="nav-link" data-scroll-target="#binomial-tests">Binomial Tests</a>
  <ul>
  <li><a href="#binomial-confidence-intervals" id="toc-binomial-confidence-intervals" class="nav-link" data-scroll-target="#binomial-confidence-intervals">Binomial Confidence Intervals</a></li>
  </ul></li>
  <li><a href="#location-tests-tz-tests" id="toc-location-tests-tz-tests" class="nav-link" data-scroll-target="#location-tests-tz-tests">Location Tests (T/Z Tests)</a></li>
  <li><a href="#variance-tests" id="toc-variance-tests" class="nav-link" data-scroll-target="#variance-tests">Variance Tests</a></li>
  <li><a href="#goodness-of-fit-and-independence-tests" id="toc-goodness-of-fit-and-independence-tests" class="nav-link" data-scroll-target="#goodness-of-fit-and-independence-tests">Goodness-of-Fit and Independence Tests</a></li>
  <li><a href="#anova-and-rank-sum-tests" id="toc-anova-and-rank-sum-tests" class="nav-link" data-scroll-target="#anova-and-rank-sum-tests">ANOVA and Rank Sum Tests</a></li>
  <li><a href="#autocorrelation-tests" id="toc-autocorrelation-tests" class="nav-link" data-scroll-target="#autocorrelation-tests">Autocorrelation Tests</a></li>
  </ul></li>
  <li><a href="#time-series-analysis" id="toc-time-series-analysis" class="nav-link" data-scroll-target="#time-series-analysis">Time Series Analysis</a></li>
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms">Histograms</a></li>
  <li><a href="#bootstrap" id="toc-bootstrap" class="nav-link" data-scroll-target="#bootstrap">Bootstrap</a>
  <ul>
  <li><a href="#statistics" id="toc-statistics" class="nav-link" data-scroll-target="#statistics">Statistics</a></li>
  <li><a href="#ci" id="toc-ci" class="nav-link" data-scroll-target="#ci">CI</a></li>
  </ul></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a>
  <ul>
  <li><a href="#fastmath.stats" id="toc-fastmath.stats" class="nav-link" data-scroll-target="#fastmath.stats">fastmath.stats</a>
  <ul>
  <li><a href="#confusion-matrix-deprecated" id="toc-confusion-matrix-deprecated" class="nav-link" data-scroll-target="#confusion-matrix-deprecated">-&gt;confusion-matrix <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#l0" id="toc-l0" class="nav-link" data-scroll-target="#l0">L0</a></li>
  <li><a href="#l1" id="toc-l1" class="nav-link" data-scroll-target="#l1">L1</a></li>
  <li><a href="#l2" id="toc-l2" class="nav-link" data-scroll-target="#l2">L2</a></li>
  <li><a href="#l2sq" id="toc-l2sq" class="nav-link" data-scroll-target="#l2sq">L2sq</a></li>
  <li><a href="#linf" id="toc-linf" class="nav-link" data-scroll-target="#linf">LInf</a></li>
  <li><a href="#acf" id="toc-acf" class="nav-link" data-scroll-target="#acf">acf</a></li>
  <li><a href="#acf-ci" id="toc-acf-ci" class="nav-link" data-scroll-target="#acf-ci">acf-ci</a></li>
  <li><a href="#ad-test-one-sample" id="toc-ad-test-one-sample" class="nav-link" data-scroll-target="#ad-test-one-sample">ad-test-one-sample</a></li>
  <li><a href="#adjacent-values" id="toc-adjacent-values" class="nav-link" data-scroll-target="#adjacent-values">adjacent-values</a></li>
  <li><a href="#ameasure" id="toc-ameasure" class="nav-link" data-scroll-target="#ameasure">ameasure</a></li>
  <li><a href="#binary-measures" id="toc-binary-measures" class="nav-link" data-scroll-target="#binary-measures">binary-measures</a></li>
  <li><a href="#binary-measures-all" id="toc-binary-measures-all" class="nav-link" data-scroll-target="#binary-measures-all">binary-measures-all</a></li>
  <li><a href="#binomial-ci" id="toc-binomial-ci" class="nav-link" data-scroll-target="#binomial-ci">binomial-ci</a></li>
  <li><a href="#binomial-ci-methods" id="toc-binomial-ci-methods" class="nav-link" data-scroll-target="#binomial-ci-methods">binomial-ci-methods</a></li>
  <li><a href="#binomial-test" id="toc-binomial-test" class="nav-link" data-scroll-target="#binomial-test">binomial-test</a></li>
  <li><a href="#bonett-seier-test" id="toc-bonett-seier-test" class="nav-link" data-scroll-target="#bonett-seier-test">bonett-seier-test</a></li>
  <li><a href="#bootstrap-deprecated" id="toc-bootstrap-deprecated" class="nav-link" data-scroll-target="#bootstrap-deprecated">bootstrap <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#bootstrap-ci-deprecated" id="toc-bootstrap-ci-deprecated" class="nav-link" data-scroll-target="#bootstrap-ci-deprecated">bootstrap-ci <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#box-cox-infer-lambda" id="toc-box-cox-infer-lambda" class="nav-link" data-scroll-target="#box-cox-infer-lambda">box-cox-infer-lambda</a></li>
  <li><a href="#box-cox-transformation" id="toc-box-cox-transformation" class="nav-link" data-scroll-target="#box-cox-transformation">box-cox-transformation</a></li>
  <li><a href="#brown-forsythe-test" id="toc-brown-forsythe-test" class="nav-link" data-scroll-target="#brown-forsythe-test">brown-forsythe-test</a></li>
  <li><a href="#chisq-test" id="toc-chisq-test" class="nav-link" data-scroll-target="#chisq-test">chisq-test</a></li>
  <li><a href="#ci-1" id="toc-ci-1" class="nav-link" data-scroll-target="#ci-1">ci</a></li>
  <li><a href="#cliffs-delta" id="toc-cliffs-delta" class="nav-link" data-scroll-target="#cliffs-delta">cliffs-delta</a></li>
  <li><a href="#coefficient-matrix" id="toc-coefficient-matrix" class="nav-link" data-scroll-target="#coefficient-matrix">coefficient-matrix</a></li>
  <li><a href="#cohens-d" id="toc-cohens-d" class="nav-link" data-scroll-target="#cohens-d">cohens-d</a></li>
  <li><a href="#cohens-d-corrected" id="toc-cohens-d-corrected" class="nav-link" data-scroll-target="#cohens-d-corrected">cohens-d-corrected</a></li>
  <li><a href="#cohens-f" id="toc-cohens-f" class="nav-link" data-scroll-target="#cohens-f">cohens-f</a></li>
  <li><a href="#cohens-f2" id="toc-cohens-f2" class="nav-link" data-scroll-target="#cohens-f2">cohens-f2</a></li>
  <li><a href="#cohens-kappa" id="toc-cohens-kappa" class="nav-link" data-scroll-target="#cohens-kappa">cohens-kappa</a></li>
  <li><a href="#cohens-q" id="toc-cohens-q" class="nav-link" data-scroll-target="#cohens-q">cohens-q</a></li>
  <li><a href="#cohens-u1" id="toc-cohens-u1" class="nav-link" data-scroll-target="#cohens-u1">cohens-u1</a></li>
  <li><a href="#cohens-u1-normal" id="toc-cohens-u1-normal" class="nav-link" data-scroll-target="#cohens-u1-normal">cohens-u1-normal</a></li>
  <li><a href="#cohens-u2" id="toc-cohens-u2" class="nav-link" data-scroll-target="#cohens-u2">cohens-u2</a></li>
  <li><a href="#cohens-u2-normal" id="toc-cohens-u2-normal" class="nav-link" data-scroll-target="#cohens-u2-normal">cohens-u2-normal</a></li>
  <li><a href="#cohens-u3" id="toc-cohens-u3" class="nav-link" data-scroll-target="#cohens-u3">cohens-u3</a></li>
  <li><a href="#cohens-u3-normal" id="toc-cohens-u3-normal" class="nav-link" data-scroll-target="#cohens-u3-normal">cohens-u3-normal</a></li>
  <li><a href="#cohens-w" id="toc-cohens-w" class="nav-link" data-scroll-target="#cohens-w">cohens-w</a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">confusion-matrix</a></li>
  <li><a href="#contingency-2x2-measures" id="toc-contingency-2x2-measures" class="nav-link" data-scroll-target="#contingency-2x2-measures">contingency-2x2-measures</a></li>
  <li><a href="#contingency-2x2-measures-all" id="toc-contingency-2x2-measures-all" class="nav-link" data-scroll-target="#contingency-2x2-measures-all">contingency-2x2-measures-all</a></li>
  <li><a href="#contingency-table" id="toc-contingency-table" class="nav-link" data-scroll-target="#contingency-table">contingency-table</a></li>
  <li><a href="#contingency-table-marginals" id="toc-contingency-table-marginals" class="nav-link" data-scroll-target="#contingency-table-marginals">contingency-table-&gt;marginals</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">correlation</a></li>
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix">correlation-matrix</a></li>
  <li><a href="#count" id="toc-count" class="nav-link" data-scroll-target="#count">count=</a></li>
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance">covariance</a></li>
  <li><a href="#covariance-matrix" id="toc-covariance-matrix" class="nav-link" data-scroll-target="#covariance-matrix">covariance-matrix</a></li>
  <li><a href="#cramers-c" id="toc-cramers-c" class="nav-link" data-scroll-target="#cramers-c">cramers-c</a></li>
  <li><a href="#cramers-v" id="toc-cramers-v" class="nav-link" data-scroll-target="#cramers-v">cramers-v</a></li>
  <li><a href="#cramers-v-corrected" id="toc-cramers-v-corrected" class="nav-link" data-scroll-target="#cramers-v-corrected">cramers-v-corrected</a></li>
  <li><a href="#cressie-read-test" id="toc-cressie-read-test" class="nav-link" data-scroll-target="#cressie-read-test">cressie-read-test</a></li>
  <li><a href="#demean" id="toc-demean" class="nav-link" data-scroll-target="#demean">demean</a></li>
  <li><a href="#dissimilarity" id="toc-dissimilarity" class="nav-link" data-scroll-target="#dissimilarity">dissimilarity</a></li>
  <li><a href="#durbin-watson" id="toc-durbin-watson" class="nav-link" data-scroll-target="#durbin-watson">durbin-watson</a></li>
  <li><a href="#epsilon-sq" id="toc-epsilon-sq" class="nav-link" data-scroll-target="#epsilon-sq">epsilon-sq</a></li>
  <li><a href="#estimate-bins" id="toc-estimate-bins" class="nav-link" data-scroll-target="#estimate-bins">estimate-bins</a></li>
  <li><a href="#estimation-strategies-list" id="toc-estimation-strategies-list" class="nav-link" data-scroll-target="#estimation-strategies-list">estimation-strategies-list</a></li>
  <li><a href="#eta-sq" id="toc-eta-sq" class="nav-link" data-scroll-target="#eta-sq">eta-sq</a></li>
  <li><a href="#expectile-1" id="toc-expectile-1" class="nav-link" data-scroll-target="#expectile-1">expectile</a></li>
  <li><a href="#extent" id="toc-extent" class="nav-link" data-scroll-target="#extent">extent</a></li>
  <li><a href="#f-test" id="toc-f-test" class="nav-link" data-scroll-target="#f-test">f-test</a></li>
  <li><a href="#fligner-killeen-test" id="toc-fligner-killeen-test" class="nav-link" data-scroll-target="#fligner-killeen-test">fligner-killeen-test</a></li>
  <li><a href="#freeman-tukey-test" id="toc-freeman-tukey-test" class="nav-link" data-scroll-target="#freeman-tukey-test">freeman-tukey-test</a></li>
  <li><a href="#geomean" id="toc-geomean" class="nav-link" data-scroll-target="#geomean">geomean</a></li>
  <li><a href="#glass-delta" id="toc-glass-delta" class="nav-link" data-scroll-target="#glass-delta">glass-delta</a></li>
  <li><a href="#harmean" id="toc-harmean" class="nav-link" data-scroll-target="#harmean">harmean</a></li>
  <li><a href="#hedges-g" id="toc-hedges-g" class="nav-link" data-scroll-target="#hedges-g">hedges-g</a></li>
  <li><a href="#hedges-g-1" id="toc-hedges-g-1" class="nav-link" data-scroll-target="#hedges-g-1">hedges-g*</a></li>
  <li><a href="#hedges-g-corrected" id="toc-hedges-g-corrected" class="nav-link" data-scroll-target="#hedges-g-corrected">hedges-g-corrected</a></li>
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram">histogram</a></li>
  <li><a href="#hpdi-extent" id="toc-hpdi-extent" class="nav-link" data-scroll-target="#hpdi-extent">hpdi-extent</a></li>
  <li><a href="#inner-fence-extent" id="toc-inner-fence-extent" class="nav-link" data-scroll-target="#inner-fence-extent">inner-fence-extent</a></li>
  <li><a href="#iqr" id="toc-iqr" class="nav-link" data-scroll-target="#iqr">iqr</a></li>
  <li><a href="#jarque-bera-test" id="toc-jarque-bera-test" class="nav-link" data-scroll-target="#jarque-bera-test">jarque-bera-test</a></li>
  <li><a href="#jensen-shannon-divergence-deprecated" id="toc-jensen-shannon-divergence-deprecated" class="nav-link" data-scroll-target="#jensen-shannon-divergence-deprecated">jensen-shannon-divergence <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#kendall-correlation" id="toc-kendall-correlation" class="nav-link" data-scroll-target="#kendall-correlation">kendall-correlation</a></li>
  <li><a href="#kruskal-test" id="toc-kruskal-test" class="nav-link" data-scroll-target="#kruskal-test">kruskal-test</a></li>
  <li><a href="#ks-test-one-sample" id="toc-ks-test-one-sample" class="nav-link" data-scroll-target="#ks-test-one-sample">ks-test-one-sample</a></li>
  <li><a href="#ks-test-two-samples" id="toc-ks-test-two-samples" class="nav-link" data-scroll-target="#ks-test-two-samples">ks-test-two-samples</a></li>
  <li><a href="#kullback-leibler-divergence-deprecated" id="toc-kullback-leibler-divergence-deprecated" class="nav-link" data-scroll-target="#kullback-leibler-divergence-deprecated">kullback-leibler-divergence <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#kurtosis-1" id="toc-kurtosis-1" class="nav-link" data-scroll-target="#kurtosis-1">kurtosis</a></li>
  <li><a href="#kurtosis-test" id="toc-kurtosis-test" class="nav-link" data-scroll-target="#kurtosis-test">kurtosis-test</a></li>
  <li><a href="#l-moment-1" id="toc-l-moment-1" class="nav-link" data-scroll-target="#l-moment-1">l-moment</a></li>
  <li><a href="#l-variation" id="toc-l-variation" class="nav-link" data-scroll-target="#l-variation">l-variation</a></li>
  <li><a href="#levene-test" id="toc-levene-test" class="nav-link" data-scroll-target="#levene-test">levene-test</a></li>
  <li><a href="#mad-1" id="toc-mad-1" class="nav-link" data-scroll-target="#mad-1">mad</a></li>
  <li><a href="#mad-extent" id="toc-mad-extent" class="nav-link" data-scroll-target="#mad-extent">mad-extent</a></li>
  <li><a href="#mae" id="toc-mae" class="nav-link" data-scroll-target="#mae">mae</a></li>
  <li><a href="#mape" id="toc-mape" class="nav-link" data-scroll-target="#mape">mape</a></li>
  <li><a href="#maximum" id="toc-maximum" class="nav-link" data-scroll-target="#maximum">maximum</a></li>
  <li><a href="#mcc" id="toc-mcc" class="nav-link" data-scroll-target="#mcc">mcc</a></li>
  <li><a href="#me" id="toc-me" class="nav-link" data-scroll-target="#me">me</a></li>
  <li><a href="#mean-1" id="toc-mean-1" class="nav-link" data-scroll-target="#mean-1">mean</a></li>
  <li><a href="#mean-absolute-deviation" id="toc-mean-absolute-deviation" class="nav-link" data-scroll-target="#mean-absolute-deviation">mean-absolute-deviation</a></li>
  <li><a href="#means-ratio" id="toc-means-ratio" class="nav-link" data-scroll-target="#means-ratio">means-ratio</a></li>
  <li><a href="#means-ratio-corrected" id="toc-means-ratio-corrected" class="nav-link" data-scroll-target="#means-ratio-corrected">means-ratio-corrected</a></li>
  <li><a href="#median" id="toc-median" class="nav-link" data-scroll-target="#median">median</a></li>
  <li><a href="#median-3" id="toc-median-3" class="nav-link" data-scroll-target="#median-3">median-3</a></li>
  <li><a href="#median-absolute-deviation" id="toc-median-absolute-deviation" class="nav-link" data-scroll-target="#median-absolute-deviation">median-absolute-deviation</a></li>
  <li><a href="#minimum" id="toc-minimum" class="nav-link" data-scroll-target="#minimum">minimum</a></li>
  <li><a href="#minimum-discrimination-information-test" id="toc-minimum-discrimination-information-test" class="nav-link" data-scroll-target="#minimum-discrimination-information-test">minimum-discrimination-information-test</a></li>
  <li><a href="#mode-1" id="toc-mode-1" class="nav-link" data-scroll-target="#mode-1">mode</a></li>
  <li><a href="#modes" id="toc-modes" class="nav-link" data-scroll-target="#modes">modes</a></li>
  <li><a href="#modified-power-transformation-deprecated" id="toc-modified-power-transformation-deprecated" class="nav-link" data-scroll-target="#modified-power-transformation-deprecated">modified-power-transformation <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#moment" id="toc-moment" class="nav-link" data-scroll-target="#moment">moment</a></li>
  <li><a href="#mse" id="toc-mse" class="nav-link" data-scroll-target="#mse">mse</a></li>
  <li><a href="#multinomial-likelihood-ratio-test" id="toc-multinomial-likelihood-ratio-test" class="nav-link" data-scroll-target="#multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</a></li>
  <li><a href="#neyman-modified-chisq-test" id="toc-neyman-modified-chisq-test" class="nav-link" data-scroll-target="#neyman-modified-chisq-test">neyman-modified-chisq-test</a></li>
  <li><a href="#normality-test" id="toc-normality-test" class="nav-link" data-scroll-target="#normality-test">normality-test</a></li>
  <li><a href="#omega-sq" id="toc-omega-sq" class="nav-link" data-scroll-target="#omega-sq">omega-sq</a></li>
  <li><a href="#one-way-anova-test" id="toc-one-way-anova-test" class="nav-link" data-scroll-target="#one-way-anova-test">one-way-anova-test</a></li>
  <li><a href="#outer-fence-extent" id="toc-outer-fence-extent" class="nav-link" data-scroll-target="#outer-fence-extent">outer-fence-extent</a></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers">outliers</a></li>
  <li><a href="#p-overlap" id="toc-p-overlap" class="nav-link" data-scroll-target="#p-overlap">p-overlap</a></li>
  <li><a href="#p-value" id="toc-p-value" class="nav-link" data-scroll-target="#p-value">p-value</a></li>
  <li><a href="#pacf" id="toc-pacf" class="nav-link" data-scroll-target="#pacf">pacf</a></li>
  <li><a href="#pacf-ci" id="toc-pacf-ci" class="nav-link" data-scroll-target="#pacf-ci">pacf-ci</a></li>
  <li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">pearson-correlation</a></li>
  <li><a href="#pearson-r" id="toc-pearson-r" class="nav-link" data-scroll-target="#pearson-r">pearson-r</a></li>
  <li><a href="#percentile" id="toc-percentile" class="nav-link" data-scroll-target="#percentile">percentile</a></li>
  <li><a href="#percentile-bc-extent" id="toc-percentile-bc-extent" class="nav-link" data-scroll-target="#percentile-bc-extent">percentile-bc-extent</a></li>
  <li><a href="#percentile-bca-extent" id="toc-percentile-bca-extent" class="nav-link" data-scroll-target="#percentile-bca-extent">percentile-bca-extent</a></li>
  <li><a href="#percentile-extent" id="toc-percentile-extent" class="nav-link" data-scroll-target="#percentile-extent">percentile-extent</a></li>
  <li><a href="#percentiles" id="toc-percentiles" class="nav-link" data-scroll-target="#percentiles">percentiles</a></li>
  <li><a href="#pi" id="toc-pi" class="nav-link" data-scroll-target="#pi">pi</a></li>
  <li><a href="#pi-extent" id="toc-pi-extent" class="nav-link" data-scroll-target="#pi-extent">pi-extent</a></li>
  <li><a href="#pooled-mad" id="toc-pooled-mad" class="nav-link" data-scroll-target="#pooled-mad">pooled-mad</a></li>
  <li><a href="#pooled-stddev" id="toc-pooled-stddev" class="nav-link" data-scroll-target="#pooled-stddev">pooled-stddev</a></li>
  <li><a href="#pooled-variance" id="toc-pooled-variance" class="nav-link" data-scroll-target="#pooled-variance">pooled-variance</a></li>
  <li><a href="#population-stddev" id="toc-population-stddev" class="nav-link" data-scroll-target="#population-stddev">population-stddev</a></li>
  <li><a href="#population-variance" id="toc-population-variance" class="nav-link" data-scroll-target="#population-variance">population-variance</a></li>
  <li><a href="#population-wstddev" id="toc-population-wstddev" class="nav-link" data-scroll-target="#population-wstddev">population-wstddev</a></li>
  <li><a href="#population-wvariance" id="toc-population-wvariance" class="nav-link" data-scroll-target="#population-wvariance">population-wvariance</a></li>
  <li><a href="#power-divergence-test" id="toc-power-divergence-test" class="nav-link" data-scroll-target="#power-divergence-test">power-divergence-test</a></li>
  <li><a href="#power-transformation-deprecated" id="toc-power-transformation-deprecated" class="nav-link" data-scroll-target="#power-transformation-deprecated">power-transformation <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#powmean" id="toc-powmean" class="nav-link" data-scroll-target="#powmean">powmean</a></li>
  <li><a href="#psnr" id="toc-psnr" class="nav-link" data-scroll-target="#psnr">psnr</a></li>
  <li><a href="#quantile" id="toc-quantile" class="nav-link" data-scroll-target="#quantile">quantile</a></li>
  <li><a href="#quantile-extent" id="toc-quantile-extent" class="nav-link" data-scroll-target="#quantile-extent">quantile-extent</a></li>
  <li><a href="#quantiles" id="toc-quantiles" class="nav-link" data-scroll-target="#quantiles">quantiles</a></li>
  <li><a href="#r2" id="toc-r2" class="nav-link" data-scroll-target="#r2">r2</a></li>
  <li><a href="#r2-determination" id="toc-r2-determination" class="nav-link" data-scroll-target="#r2-determination">r2-determination</a></li>
  <li><a href="#rank-epsilon-sq" id="toc-rank-epsilon-sq" class="nav-link" data-scroll-target="#rank-epsilon-sq">rank-epsilon-sq</a></li>
  <li><a href="#rank-eta-sq" id="toc-rank-eta-sq" class="nav-link" data-scroll-target="#rank-eta-sq">rank-eta-sq</a></li>
  <li><a href="#remove-outliers" id="toc-remove-outliers" class="nav-link" data-scroll-target="#remove-outliers">remove-outliers</a></li>
  <li><a href="#rescale" id="toc-rescale" class="nav-link" data-scroll-target="#rescale">rescale</a></li>
  <li><a href="#rmse" id="toc-rmse" class="nav-link" data-scroll-target="#rmse">rmse</a></li>
  <li><a href="#robust-standardize" id="toc-robust-standardize" class="nav-link" data-scroll-target="#robust-standardize">robust-standardize</a></li>
  <li><a href="#rows-contingency-table" id="toc-rows-contingency-table" class="nav-link" data-scroll-target="#rows-contingency-table">rows-&gt;contingency-table</a></li>
  <li><a href="#rss" id="toc-rss" class="nav-link" data-scroll-target="#rss">rss</a></li>
  <li><a href="#second-moment-deprecated" id="toc-second-moment-deprecated" class="nav-link" data-scroll-target="#second-moment-deprecated">second-moment <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#sem" id="toc-sem" class="nav-link" data-scroll-target="#sem">sem</a></li>
  <li><a href="#sem-extent" id="toc-sem-extent" class="nav-link" data-scroll-target="#sem-extent">sem-extent</a></li>
  <li><a href="#similarity" id="toc-similarity" class="nav-link" data-scroll-target="#similarity">similarity</a></li>
  <li><a href="#skewness-1" id="toc-skewness-1" class="nav-link" data-scroll-target="#skewness-1">skewness</a></li>
  <li><a href="#skewness-test" id="toc-skewness-test" class="nav-link" data-scroll-target="#skewness-test">skewness-test</a></li>
  <li><a href="#span" id="toc-span" class="nav-link" data-scroll-target="#span">span</a></li>
  <li><a href="#spearman-correlation" id="toc-spearman-correlation" class="nav-link" data-scroll-target="#spearman-correlation">spearman-correlation</a></li>
  <li><a href="#standardize" id="toc-standardize" class="nav-link" data-scroll-target="#standardize">standardize</a></li>
  <li><a href="#stats-map" id="toc-stats-map" class="nav-link" data-scroll-target="#stats-map">stats-map</a></li>
  <li><a href="#stddev" id="toc-stddev" class="nav-link" data-scroll-target="#stddev">stddev</a></li>
  <li><a href="#stddev-extent" id="toc-stddev-extent" class="nav-link" data-scroll-target="#stddev-extent">stddev-extent</a></li>
  <li><a href="#sum" id="toc-sum" class="nav-link" data-scroll-target="#sum">sum</a></li>
  <li><a href="#t-test-one-sample" id="toc-t-test-one-sample" class="nav-link" data-scroll-target="#t-test-one-sample">t-test-one-sample</a></li>
  <li><a href="#t-test-two-samples" id="toc-t-test-two-samples" class="nav-link" data-scroll-target="#t-test-two-samples">t-test-two-samples</a></li>
  <li><a href="#trim" id="toc-trim" class="nav-link" data-scroll-target="#trim">trim</a></li>
  <li><a href="#trim-lower" id="toc-trim-lower" class="nav-link" data-scroll-target="#trim-lower">trim-lower</a></li>
  <li><a href="#trim-upper" id="toc-trim-upper" class="nav-link" data-scroll-target="#trim-upper">trim-upper</a></li>
  <li><a href="#tschuprows-t" id="toc-tschuprows-t" class="nav-link" data-scroll-target="#tschuprows-t">tschuprows-t</a></li>
  <li><a href="#ttest-one-sample-deprecated" id="toc-ttest-one-sample-deprecated" class="nav-link" data-scroll-target="#ttest-one-sample-deprecated">ttest-one-sample <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#ttest-two-samples-deprecated" id="toc-ttest-two-samples-deprecated" class="nav-link" data-scroll-target="#ttest-two-samples-deprecated">ttest-two-samples <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance">variance</a></li>
  <li><a href="#variation" id="toc-variation" class="nav-link" data-scroll-target="#variation">variation</a></li>
  <li><a href="#weighted-kappa" id="toc-weighted-kappa" class="nav-link" data-scroll-target="#weighted-kappa">weighted-kappa</a></li>
  <li><a href="#winsor" id="toc-winsor" class="nav-link" data-scroll-target="#winsor">winsor</a></li>
  <li><a href="#wmean-deprecated" id="toc-wmean-deprecated" class="nav-link" data-scroll-target="#wmean-deprecated">wmean <sup><sub>DEPRECATED</sub></sup></a></li>
  <li><a href="#wmedian" id="toc-wmedian" class="nav-link" data-scroll-target="#wmedian">wmedian</a></li>
  <li><a href="#wmode" id="toc-wmode" class="nav-link" data-scroll-target="#wmode">wmode</a></li>
  <li><a href="#wmodes" id="toc-wmodes" class="nav-link" data-scroll-target="#wmodes">wmodes</a></li>
  <li><a href="#wmw-odds" id="toc-wmw-odds" class="nav-link" data-scroll-target="#wmw-odds">wmw-odds</a></li>
  <li><a href="#wquantile" id="toc-wquantile" class="nav-link" data-scroll-target="#wquantile">wquantile</a></li>
  <li><a href="#wquantiles" id="toc-wquantiles" class="nav-link" data-scroll-target="#wquantiles">wquantiles</a></li>
  <li><a href="#wstddev" id="toc-wstddev" class="nav-link" data-scroll-target="#wstddev">wstddev</a></li>
  <li><a href="#wvariance" id="toc-wvariance" class="nav-link" data-scroll-target="#wvariance">wvariance</a></li>
  <li><a href="#yeo-johnson-infer-lambda" id="toc-yeo-johnson-infer-lambda" class="nav-link" data-scroll-target="#yeo-johnson-infer-lambda">yeo-johnson-infer-lambda</a></li>
  <li><a href="#yeo-johnson-transformation" id="toc-yeo-johnson-transformation" class="nav-link" data-scroll-target="#yeo-johnson-transformation">yeo-johnson-transformation</a></li>
  <li><a href="#z-test-one-sample" id="toc-z-test-one-sample" class="nav-link" data-scroll-target="#z-test-one-sample">z-test-one-sample</a></li>
  <li><a href="#z-test-two-samples" id="toc-z-test-two-samples" class="nav-link" data-scroll-target="#z-test-two-samples">z-test-two-samples</a></li>
  </ul></li>
  <li><a href="#fastmath.stats.bootstrap" id="toc-fastmath.stats.bootstrap" class="nav-link" data-scroll-target="#fastmath.stats.bootstrap">fastmath.stats.bootstrap</a>
  <ul>
  <li><a href="#bootstrap-1" id="toc-bootstrap-1" class="nav-link" data-scroll-target="#bootstrap-1">bootstrap</a></li>
  <li><a href="#bootstrap-stats" id="toc-bootstrap-stats" class="nav-link" data-scroll-target="#bootstrap-stats">bootstrap-stats</a></li>
  <li><a href="#ci-basic" id="toc-ci-basic" class="nav-link" data-scroll-target="#ci-basic">ci-basic</a></li>
  <li><a href="#ci-bc" id="toc-ci-bc" class="nav-link" data-scroll-target="#ci-bc">ci-bc</a></li>
  <li><a href="#ci-bca" id="toc-ci-bca" class="nav-link" data-scroll-target="#ci-bca">ci-bca</a></li>
  <li><a href="#ci-normal" id="toc-ci-normal" class="nav-link" data-scroll-target="#ci-normal">ci-normal</a></li>
  <li><a href="#ci-percentile" id="toc-ci-percentile" class="nav-link" data-scroll-target="#ci-percentile">ci-percentile</a></li>
  <li><a href="#ci-studentized" id="toc-ci-studentized" class="nav-link" data-scroll-target="#ci-studentized">ci-studentized</a></li>
  <li><a href="#ci-t" id="toc-ci-t" class="nav-link" data-scroll-target="#ci-t">ci-t</a></li>
  <li><a href="#jackknife" id="toc-jackknife" class="nav-link" data-scroll-target="#jackknife">jackknife</a></li>
  <li><a href="#jackknife-1" id="toc-jackknife-1" class="nav-link" data-scroll-target="#jackknife-1">jackknife+</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style></style>
<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>
<style>.clay-limit-image-width .clay-image {max-width: 100%}
.clay-side-by-side .sourceCode {margin: 0}
.clay-side-by-side {margin: 1em 0}
</style>
<script src="stats_files/md-default79.js" type="text/javascript"></script>
<script src="stats_files/md-default80.js" type="text/javascript"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js" type="text/javascript"></script>
<p><link href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css"></p>
<p>This notebook provides a comprehensive overview and examples of the statistical functions available in the <code>fastmath.stats</code> namespace. It covers a wide array of descriptive statistics, measures of spread, quantiles, moments, correlation, distance metrics, contingency table analysis, binary classification metrics, effect sizes, various statistical tests (normality, binomial, t/z, variance, goodness-of-fit, ANOVA, autocorrelation), time series analysis tools (ACF, PACF), data transformations, and histogram generation. Each section introduces the relevant concepts and demonstrates the use of <code>fastmath.stats</code> functions with illustrative datasets (<code>mtcars</code>, <code>iris</code>, <code>winequality</code>).</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This notebook is written with the support of Gemini LLM models:</p>
<ul>
<li><code>gemini-2.5-pro-exp-03-25</code></li>
<li><code>gemini-2.5-flash-preview-04-17</code></li>
</ul>
<p>I did my best to verify the output of LLMs however I don’t guarantee absence of the model hallucinations or incorrectnesses.</p>
</div>
</div>
<section id="datasets" class="level2">
<h2 class="anchored" data-anchor-id="datasets">Datasets</h2>
<p>To illustrate statistical functions three dataset will be used:</p>
<ul>
<li><code>mtcars</code></li>
<li><code>iris</code></li>
<li><code>winequality</code></li>
</ul>
<p>A <code>fastmath.dev.dataset</code> as <code>ds</code> will be used to access data.</p>
<p>Select the <code>:mpg</code> column from <code>mtcars</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb1"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(ds/mtcars <span class="at">:mpg</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb2"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">33.9</span> <span class="fl">21.5</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span> <span class="fl">27.3</span> <span class="dv">26</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="dv">15</span> <span class="fl">21.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Select the <code>:mpg</code> column with a row predicate</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb3"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(ds/mtcars <span class="at">:mpg</span> (<span class="kw">fn</span> [row] (<span class="kw">and</span> (<span class="kw">&lt;</span> (row <span class="at">:mpg</span>) <span class="fl">20.0</span>) (<span class="kw">zero?</span> (row <span class="at">:am</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb4"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Group by the <code>:am</code> column and select <code>:mpg</code></p>
<div class="sourceClojure">
<div class="sourceCode" id="cb5"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(ds/by ds/mtcars <span class="at">:am</span> <span class="at">:mpg</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb6"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>{<span class="dv">1</span> (<span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">33.9</span> <span class="fl">27.3</span> <span class="dv">26</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="dv">15</span> <span class="fl">21.4</span>), <span class="dv">0</span> (<span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">21.5</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="mtcars" class="level3">
<h3 class="anchored" data-anchor-id="mtcars"><code>mtcars</code></h3>
<p>11 attributes of 32 different cars comparison</p>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive clay-table"><thead><tr><th>name</th><th>qsec</th><th>cyl</th><th>am</th><th>gear</th><th>disp</th><th>wt</th><th>drat</th><th>hp</th><th>mpg</th><th>vs</th><th>carb</th></tr></thead><tbody><tr><td>Mazda RX4</td><td>16.46</td><td>6</td><td>1</td><td>4</td><td>160</td><td>2.62</td><td>3.9</td><td>110</td><td>21</td><td>0</td><td>4</td></tr><tr><td>Mazda RX4 Wag</td><td>17.02</td><td>6</td><td>1</td><td>4</td><td>160</td><td>2.875</td><td>3.9</td><td>110</td><td>21</td><td>0</td><td>4</td></tr><tr><td>Datsun 710</td><td>18.61</td><td>4</td><td>1</td><td>4</td><td>108</td><td>2.32</td><td>3.85</td><td>93</td><td>22.8</td><td>1</td><td>1</td></tr><tr><td>Hornet 4 Drive</td><td>19.44</td><td>6</td><td>0</td><td>3</td><td>258</td><td>3.215</td><td>3.08</td><td>110</td><td>21.4</td><td>1</td><td>1</td></tr><tr><td>Hornet Sportabout</td><td>17.02</td><td>8</td><td>0</td><td>3</td><td>360</td><td>3.44</td><td>3.15</td><td>175</td><td>18.7</td><td>0</td><td>2</td></tr><tr><td>Valiant</td><td>20.22</td><td>6</td><td>0</td><td>3</td><td>225</td><td>3.46</td><td>2.76</td><td>105</td><td>18.1</td><td>1</td><td>1</td></tr><tr><td>Duster 360</td><td>15.84</td><td>8</td><td>0</td><td>3</td><td>360</td><td>3.57</td><td>3.21</td><td>245</td><td>14.3</td><td>0</td><td>4</td></tr><tr><td>Merc 240D</td><td>20</td><td>4</td><td>0</td><td>4</td><td>146.7</td><td>3.19</td><td>3.69</td><td>62</td><td>24.4</td><td>1</td><td>2</td></tr><tr><td>Merc 230</td><td>22.9</td><td>4</td><td>0</td><td>4</td><td>140.8</td><td>3.15</td><td>3.92</td><td>95</td><td>22.8</td><td>1</td><td>2</td></tr><tr><td>Merc 280</td><td>18.3</td><td>6</td><td>0</td><td>4</td><td>167.6</td><td>3.44</td><td>3.92</td><td>123</td><td>19.2</td><td>1</td><td>4</td></tr><tr><td>Merc 280C</td><td>18.9</td><td>6</td><td>0</td><td>4</td><td>167.6</td><td>3.44</td><td>3.92</td><td>123</td><td>17.8</td><td>1</td><td>4</td></tr><tr><td>Merc 450SE</td><td>17.4</td><td>8</td><td>0</td><td>3</td><td>275.8</td><td>4.07</td><td>3.07</td><td>180</td><td>16.4</td><td>0</td><td>3</td></tr><tr><td>Merc 450SL</td><td>17.6</td><td>8</td><td>0</td><td>3</td><td>275.8</td><td>3.73</td><td>3.07</td><td>180</td><td>17.3</td><td>0</td><td>3</td></tr><tr><td>Merc 450SLC</td><td>18</td><td>8</td><td>0</td><td>3</td><td>275.8</td><td>3.78</td><td>3.07</td><td>180</td><td>15.2</td><td>0</td><td>3</td></tr><tr><td>Cadillac Fleetwood</td><td>17.98</td><td>8</td><td>0</td><td>3</td><td>472</td><td>5.25</td><td>2.93</td><td>205</td><td>10.4</td><td>0</td><td>4</td></tr><tr><td>Lincoln Continental</td><td>17.82</td><td>8</td><td>0</td><td>3</td><td>460</td><td>5.424</td><td>3</td><td>215</td><td>10.4</td><td>0</td><td>4</td></tr><tr><td>Chrysler Imperial</td><td>17.42</td><td>8</td><td>0</td><td>3</td><td>440</td><td>5.345</td><td>3.23</td><td>230</td><td>14.7</td><td>0</td><td>4</td></tr><tr><td>Fiat 128</td><td>19.47</td><td>4</td><td>1</td><td>4</td><td>78.7</td><td>2.2</td><td>4.08</td><td>66</td><td>32.4</td><td>1</td><td>1</td></tr><tr><td>Honda Civic</td><td>18.52</td><td>4</td><td>1</td><td>4</td><td>75.7</td><td>1.615</td><td>4.93</td><td>52</td><td>30.4</td><td>1</td><td>2</td></tr><tr><td>Toyota Corolla</td><td>19.9</td><td>4</td><td>1</td><td>4</td><td>71.1</td><td>1.835</td><td>4.22</td><td>65</td><td>33.9</td><td>1</td><td>1</td></tr><tr><td>Toyota Corona</td><td>20.01</td><td>4</td><td>0</td><td>3</td><td>120.1</td><td>2.465</td><td>3.7</td><td>97</td><td>21.5</td><td>1</td><td>1</td></tr><tr><td>Dodge Challenger</td><td>16.87</td><td>8</td><td>0</td><td>3</td><td>318</td><td>3.52</td><td>2.76</td><td>150</td><td>15.5</td><td>0</td><td>2</td></tr><tr><td>AMC Javelin</td><td>17.3</td><td>8</td><td>0</td><td>3</td><td>304</td><td>3.435</td><td>3.15</td><td>150</td><td>15.2</td><td>0</td><td>2</td></tr><tr><td>Camaro Z28</td><td>15.41</td><td>8</td><td>0</td><td>3</td><td>350</td><td>3.84</td><td>3.73</td><td>245</td><td>13.3</td><td>0</td><td>4</td></tr><tr><td>Pontiac Firebird</td><td>17.05</td><td>8</td><td>0</td><td>3</td><td>400</td><td>3.845</td><td>3.08</td><td>175</td><td>19.2</td><td>0</td><td>2</td></tr><tr><td>Fiat X1-9</td><td>18.9</td><td>4</td><td>1</td><td>4</td><td>79</td><td>1.935</td><td>4.08</td><td>66</td><td>27.3</td><td>1</td><td>1</td></tr><tr><td>Porsche 914-2</td><td>16.7</td><td>4</td><td>1</td><td>5</td><td>120.3</td><td>2.14</td><td>4.43</td><td>91</td><td>26</td><td>0</td><td>2</td></tr><tr><td>Lotus Europa</td><td>16.9</td><td>4</td><td>1</td><td>5</td><td>95.1</td><td>1.513</td><td>3.77</td><td>113</td><td>30.4</td><td>1</td><td>2</td></tr><tr><td>Ford Pantera L</td><td>14.5</td><td>8</td><td>1</td><td>5</td><td>351</td><td>3.17</td><td>4.22</td><td>264</td><td>15.8</td><td>0</td><td>4</td></tr><tr><td>Ferrari Dino</td><td>15.5</td><td>6</td><td>1</td><td>5</td><td>145</td><td>2.77</td><td>3.62</td><td>175</td><td>19.7</td><td>0</td><td>6</td></tr><tr><td>Maserati Bora</td><td>14.6</td><td>8</td><td>1</td><td>5</td><td>301</td><td>3.57</td><td>3.54</td><td>335</td><td>15</td><td>0</td><td>8</td></tr><tr><td>Volvo 142E</td><td>18.6</td><td>4</td><td>1</td><td>4</td><td>121</td><td>2.78</td><td>4.11</td><td>109</td><td>21.4</td><td>1</td><td>2</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":400,"sPaginationType":"full_numbers","order":[]});</script></table>
</div>
</div>
</section>
<section id="iris" class="level3">
<h3 class="anchored" data-anchor-id="iris"><code>iris</code></h3>
<p>Sepal and Petal iris species comparison</p>
<div class="clay-table">
<div class="clay-table">
<table class="table table-hover table-responsive clay-table"><thead><tr><th>sepal-length</th><th>sepal-width</th><th>petal-length</th><th>petal-width</th><th>species</th></tr></thead><tbody><tr><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td></tr><tr><td>4.9</td><td>3</td><td>1.4</td><td>0.2</td><td>setosa</td></tr><tr><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td></tr><tr><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td></tr><tr><td>5</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td></tr><tr><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td></tr><tr><td>4.6</td><td>3.4</td><td>1.4</td><td>0.3</td><td>setosa</td></tr><tr><td>5</td><td>3.4</td><td>1.5</td><td>0.2</td><td>setosa</td></tr><tr><td>4.4</td><td>2.9</td><td>1.4</td><td>0.2</td><td>setosa</td></tr><tr><td>4.9</td><td>3.1</td><td>1.5</td><td>0.1</td><td>setosa</td></tr><tr><td>5.4</td><td>3.7</td><td>1.5</td><td>0.2</td><td>setosa</td></tr><tr><td>4.8</td><td>3.4</td><td>1.6</td><td>0.2</td><td>setosa</td></tr><tr><td>4.8</td><td>3</td><td>1.4</td><td>0.1</td><td>setosa</td></tr><tr><td>4.3</td><td>3</td><td>1.1</td><td>0.1</td><td>setosa</td></tr><tr><td>5.8</td><td>4</td><td>1.2</td><td>0.2</td><td>setosa</td></tr><tr><td>5.7</td><td>4.4</td><td>1.5</td><td>0.4</td><td>setosa</td></tr><tr><td>5.4</td><td>3.9</td><td>1.3</td><td>0.4</td><td>setosa</td></tr><tr><td>5.1</td><td>3.5</td><td>1.4</td><td>0.3</td><td>setosa</td></tr><tr><td>5.7</td><td>3.8</td><td>1.7</td><td>0.3</td><td>setosa</td></tr><tr><td>5.1</td><td>3.8</td><td>1.5</td><td>0.3</td><td>setosa</td></tr><tr><td>5.4</td><td>3.4</td><td>1.7</td><td>0.2</td><td>setosa</td></tr><tr><td>5.1</td><td>3.7</td><td>1.5</td><td>0.4</td><td>setosa</td></tr><tr><td>4.6</td><td>3.6</td><td>1</td><td>0.2</td><td>setosa</td></tr><tr><td>5.1</td><td>3.3</td><td>1.7</td><td>0.5</td><td>setosa</td></tr><tr><td>4.8</td><td>3.4</td><td>1.9</td><td>0.2</td><td>setosa</td></tr><tr><td>5</td><td>3</td><td>1.6</td><td>0.2</td><td>setosa</td></tr><tr><td>5</td><td>3.4</td><td>1.6</td><td>0.4</td><td>setosa</td></tr><tr><td>5.2</td><td>3.5</td><td>1.5</td><td>0.2</td><td>setosa</td></tr><tr><td>5.2</td><td>3.4</td><td>1.4</td><td>0.2</td><td>setosa</td></tr><tr><td>4.7</td><td>3.2</td><td>1.6</td><td>0.2</td><td>setosa</td></tr><tr><td>4.8</td><td>3.1</td><td>1.6</td><td>0.2</td><td>setosa</td></tr><tr><td>5.4</td><td>3.4</td><td>1.5</td><td>0.4</td><td>setosa</td></tr><tr><td>5.2</td><td>4.1</td><td>1.5</td><td>0.1</td><td>setosa</td></tr><tr><td>5.5</td><td>4.2</td><td>1.4</td><td>0.2</td><td>setosa</td></tr><tr><td>4.9</td><td>3.1</td><td>1.5</td><td>0.1</td><td>setosa</td></tr><tr><td>5</td><td>3.2</td><td>1.2</td><td>0.2</td><td>setosa</td></tr><tr><td>5.5</td><td>3.5</td><td>1.3</td><td>0.2</td><td>setosa</td></tr><tr><td>4.9</td><td>3.1</td><td>1.5</td><td>0.1</td><td>setosa</td></tr><tr><td>4.4</td><td>3</td><td>1.3</td><td>0.2</td><td>setosa</td></tr><tr><td>5.1</td><td>3.4</td><td>1.5</td><td>0.2</td><td>setosa</td></tr><tr><td>5</td><td>3.5</td><td>1.3</td><td>0.3</td><td>setosa</td></tr><tr><td>4.5</td><td>2.3</td><td>1.3</td><td>0.3</td><td>setosa</td></tr><tr><td>4.4</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td></tr><tr><td>5</td><td>3.5</td><td>1.6</td><td>0.6</td><td>setosa</td></tr><tr><td>5.1</td><td>3.8</td><td>1.9</td><td>0.4</td><td>setosa</td></tr><tr><td>4.8</td><td>3</td><td>1.4</td><td>0.3</td><td>setosa</td></tr><tr><td>5.1</td><td>3.8</td><td>1.6</td><td>0.2</td><td>setosa</td></tr><tr><td>4.6</td><td>3.2</td><td>1.4</td><td>0.2</td><td>setosa</td></tr><tr><td>5.3</td><td>3.7</td><td>1.5</td><td>0.2</td><td>setosa</td></tr><tr><td>5</td><td>3.3</td><td>1.4</td><td>0.2</td><td>setosa</td></tr><tr><td>7</td><td>3.2</td><td>4.7</td><td>1.4</td><td>versicolor</td></tr><tr><td>6.4</td><td>3.2</td><td>4.5</td><td>1.5</td><td>versicolor</td></tr><tr><td>6.9</td><td>3.1</td><td>4.9</td><td>1.5</td><td>versicolor</td></tr><tr><td>5.5</td><td>2.3</td><td>4</td><td>1.3</td><td>versicolor</td></tr><tr><td>6.5</td><td>2.8</td><td>4.6</td><td>1.5</td><td>versicolor</td></tr><tr><td>5.7</td><td>2.8</td><td>4.5</td><td>1.3</td><td>versicolor</td></tr><tr><td>6.3</td><td>3.3</td><td>4.7</td><td>1.6</td><td>versicolor</td></tr><tr><td>4.9</td><td>2.4</td><td>3.3</td><td>1</td><td>versicolor</td></tr><tr><td>6.6</td><td>2.9</td><td>4.6</td><td>1.3</td><td>versicolor</td></tr><tr><td>5.2</td><td>2.7</td><td>3.9</td><td>1.4</td><td>versicolor</td></tr><tr><td>5</td><td>2</td><td>3.5</td><td>1</td><td>versicolor</td></tr><tr><td>5.9</td><td>3</td><td>4.2</td><td>1.5</td><td>versicolor</td></tr><tr><td>6</td><td>2.2</td><td>4</td><td>1</td><td>versicolor</td></tr><tr><td>6.1</td><td>2.9</td><td>4.7</td><td>1.4</td><td>versicolor</td></tr><tr><td>5.6</td><td>2.9</td><td>3.6</td><td>1.3</td><td>versicolor</td></tr><tr><td>6.7</td><td>3.1</td><td>4.4</td><td>1.4</td><td>versicolor</td></tr><tr><td>5.6</td><td>3</td><td>4.5</td><td>1.5</td><td>versicolor</td></tr><tr><td>5.8</td><td>2.7</td><td>4.1</td><td>1</td><td>versicolor</td></tr><tr><td>6.2</td><td>2.2</td><td>4.5</td><td>1.5</td><td>versicolor</td></tr><tr><td>5.6</td><td>2.5</td><td>3.9</td><td>1.1</td><td>versicolor</td></tr><tr><td>5.9</td><td>3.2</td><td>4.8</td><td>1.8</td><td>versicolor</td></tr><tr><td>6.1</td><td>2.8</td><td>4</td><td>1.3</td><td>versicolor</td></tr><tr><td>6.3</td><td>2.5</td><td>4.9</td><td>1.5</td><td>versicolor</td></tr><tr><td>6.1</td><td>2.8</td><td>4.7</td><td>1.2</td><td>versicolor</td></tr><tr><td>6.4</td><td>2.9</td><td>4.3</td><td>1.3</td><td>versicolor</td></tr><tr><td>6.6</td><td>3</td><td>4.4</td><td>1.4</td><td>versicolor</td></tr><tr><td>6.8</td><td>2.8</td><td>4.8</td><td>1.4</td><td>versicolor</td></tr><tr><td>6.7</td><td>3</td><td>5</td><td>1.7</td><td>versicolor</td></tr><tr><td>6</td><td>2.9</td><td>4.5</td><td>1.5</td><td>versicolor</td></tr><tr><td>5.7</td><td>2.6</td><td>3.5</td><td>1</td><td>versicolor</td></tr><tr><td>5.5</td><td>2.4</td><td>3.8</td><td>1.1</td><td>versicolor</td></tr><tr><td>5.5</td><td>2.4</td><td>3.7</td><td>1</td><td>versicolor</td></tr><tr><td>5.8</td><td>2.7</td><td>3.9</td><td>1.2</td><td>versicolor</td></tr><tr><td>6</td><td>2.7</td><td>5.1</td><td>1.6</td><td>versicolor</td></tr><tr><td>5.4</td><td>3</td><td>4.5</td><td>1.5</td><td>versicolor</td></tr><tr><td>6</td><td>3.4</td><td>4.5</td><td>1.6</td><td>versicolor</td></tr><tr><td>6.7</td><td>3.1</td><td>4.7</td><td>1.5</td><td>versicolor</td></tr><tr><td>6.3</td><td>2.3</td><td>4.4</td><td>1.3</td><td>versicolor</td></tr><tr><td>5.6</td><td>3</td><td>4.1</td><td>1.3</td><td>versicolor</td></tr><tr><td>5.5</td><td>2.5</td><td>4</td><td>1.3</td><td>versicolor</td></tr><tr><td>5.5</td><td>2.6</td><td>4.4</td><td>1.2</td><td>versicolor</td></tr><tr><td>6.1</td><td>3</td><td>4.6</td><td>1.4</td><td>versicolor</td></tr><tr><td>5.8</td><td>2.6</td><td>4</td><td>1.2</td><td>versicolor</td></tr><tr><td>5</td><td>2.3</td><td>3.3</td><td>1</td><td>versicolor</td></tr><tr><td>5.6</td><td>2.7</td><td>4.2</td><td>1.3</td><td>versicolor</td></tr><tr><td>5.7</td><td>3</td><td>4.2</td><td>1.2</td><td>versicolor</td></tr><tr><td>5.7</td><td>2.9</td><td>4.2</td><td>1.3</td><td>versicolor</td></tr><tr><td>6.2</td><td>2.9</td><td>4.3</td><td>1.3</td><td>versicolor</td></tr><tr><td>5.1</td><td>2.5</td><td>3</td><td>1.1</td><td>versicolor</td></tr><tr><td>5.7</td><td>2.8</td><td>4.1</td><td>1.3</td><td>versicolor</td></tr><tr><td>6.3</td><td>3.3</td><td>6</td><td>2.5</td><td>virginica</td></tr><tr><td>5.8</td><td>2.7</td><td>5.1</td><td>1.9</td><td>virginica</td></tr><tr><td>7.1</td><td>3</td><td>5.9</td><td>2.1</td><td>virginica</td></tr><tr><td>6.3</td><td>2.9</td><td>5.6</td><td>1.8</td><td>virginica</td></tr><tr><td>6.5</td><td>3</td><td>5.8</td><td>2.2</td><td>virginica</td></tr><tr><td>7.6</td><td>3</td><td>6.6</td><td>2.1</td><td>virginica</td></tr><tr><td>4.9</td><td>2.5</td><td>4.5</td><td>1.7</td><td>virginica</td></tr><tr><td>7.3</td><td>2.9</td><td>6.3</td><td>1.8</td><td>virginica</td></tr><tr><td>6.7</td><td>2.5</td><td>5.8</td><td>1.8</td><td>virginica</td></tr><tr><td>7.2</td><td>3.6</td><td>6.1</td><td>2.5</td><td>virginica</td></tr><tr><td>6.5</td><td>3.2</td><td>5.1</td><td>2</td><td>virginica</td></tr><tr><td>6.4</td><td>2.7</td><td>5.3</td><td>1.9</td><td>virginica</td></tr><tr><td>6.8</td><td>3</td><td>5.5</td><td>2.1</td><td>virginica</td></tr><tr><td>5.7</td><td>2.5</td><td>5</td><td>2</td><td>virginica</td></tr><tr><td>5.8</td><td>2.8</td><td>5.1</td><td>2.4</td><td>virginica</td></tr><tr><td>6.4</td><td>3.2</td><td>5.3</td><td>2.3</td><td>virginica</td></tr><tr><td>6.5</td><td>3</td><td>5.5</td><td>1.8</td><td>virginica</td></tr><tr><td>7.7</td><td>3.8</td><td>6.7</td><td>2.2</td><td>virginica</td></tr><tr><td>7.7</td><td>2.6</td><td>6.9</td><td>2.3</td><td>virginica</td></tr><tr><td>6</td><td>2.2</td><td>5</td><td>1.5</td><td>virginica</td></tr><tr><td>6.9</td><td>3.2</td><td>5.7</td><td>2.3</td><td>virginica</td></tr><tr><td>5.6</td><td>2.8</td><td>4.9</td><td>2</td><td>virginica</td></tr><tr><td>7.7</td><td>2.8</td><td>6.7</td><td>2</td><td>virginica</td></tr><tr><td>6.3</td><td>2.7</td><td>4.9</td><td>1.8</td><td>virginica</td></tr><tr><td>6.7</td><td>3.3</td><td>5.7</td><td>2.1</td><td>virginica</td></tr><tr><td>7.2</td><td>3.2</td><td>6</td><td>1.8</td><td>virginica</td></tr><tr><td>6.2</td><td>2.8</td><td>4.8</td><td>1.8</td><td>virginica</td></tr><tr><td>6.1</td><td>3</td><td>4.9</td><td>1.8</td><td>virginica</td></tr><tr><td>6.4</td><td>2.8</td><td>5.6</td><td>2.1</td><td>virginica</td></tr><tr><td>7.2</td><td>3</td><td>5.8</td><td>1.6</td><td>virginica</td></tr><tr><td>7.4</td><td>2.8</td><td>6.1</td><td>1.9</td><td>virginica</td></tr><tr><td>7.9</td><td>3.8</td><td>6.4</td><td>2</td><td>virginica</td></tr><tr><td>6.4</td><td>2.8</td><td>5.6</td><td>2.2</td><td>virginica</td></tr><tr><td>6.3</td><td>2.8</td><td>5.1</td><td>1.5</td><td>virginica</td></tr><tr><td>6.1</td><td>2.6</td><td>5.6</td><td>1.4</td><td>virginica</td></tr><tr><td>7.7</td><td>3</td><td>6.1</td><td>2.3</td><td>virginica</td></tr><tr><td>6.3</td><td>3.4</td><td>5.6</td><td>2.4</td><td>virginica</td></tr><tr><td>6.4</td><td>3.1</td><td>5.5</td><td>1.8</td><td>virginica</td></tr><tr><td>6</td><td>3</td><td>4.8</td><td>1.8</td><td>virginica</td></tr><tr><td>6.9</td><td>3.1</td><td>5.4</td><td>2.1</td><td>virginica</td></tr><tr><td>6.7</td><td>3.1</td><td>5.6</td><td>2.4</td><td>virginica</td></tr><tr><td>6.9</td><td>3.1</td><td>5.1</td><td>2.3</td><td>virginica</td></tr><tr><td>5.8</td><td>2.7</td><td>5.1</td><td>1.9</td><td>virginica</td></tr><tr><td>6.8</td><td>3.2</td><td>5.9</td><td>2.3</td><td>virginica</td></tr><tr><td>6.7</td><td>3.3</td><td>5.7</td><td>2.5</td><td>virginica</td></tr><tr><td>6.7</td><td>3</td><td>5.2</td><td>2.3</td><td>virginica</td></tr><tr><td>6.3</td><td>2.5</td><td>5</td><td>1.9</td><td>virginica</td></tr><tr><td>6.5</td><td>3</td><td>5.2</td><td>2</td><td>virginica</td></tr><tr><td>6.2</td><td>3.4</td><td>5.4</td><td>2.3</td><td>virginica</td></tr><tr><td>5.9</td><td>3</td><td>5.1</td><td>1.8</td><td>virginica</td></tr></tbody><script>new DataTable(document.currentScript.parentElement, {"paging":false,"scrollY":400,"sPaginationType":"full_numbers","order":[]});</script></table>
</div>
</div>
</section>
<section id="winequality" class="level3">
<h3 class="anchored" data-anchor-id="winequality"><code>winequality</code></h3>
<p>White <a href="https://archive.ics.uci.edu/dataset/186/wine+quality">Portugese Vinho Verde</a> wine consisting set of quality parameters (physicochemical and sensory).</p>
</section>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>Let’s bind some common columns to a global vars</p>
<section id="mtcars-1" class="level4">
<h4 class="anchored" data-anchor-id="mtcars-1"><code>mtcars</code></h4>
<p>Miles per US gallon</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb7"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> mpg </span>(ds/mtcars <span class="at">:mpg</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Horsepower</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb8"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> hp </span>(ds/mtcars <span class="at">:hp</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Weight of the car</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb9"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> wt </span>(ds/mtcars <span class="at">:wt</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/0.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/1.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/2.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="iris-1" class="level4">
<h4 class="anchored" data-anchor-id="iris-1"><code>iris</code></h4>
<p>Sepal lengths</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb10"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> sepal-lengths </span>(ds/by ds/iris <span class="at">:species</span> <span class="at">:sepal-length</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb11"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> setosa-sepal-length </span>(sepal-lengths <span class="at">:setosa</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb12"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> virginica-sepal-length </span>(sepal-lengths <span class="at">:virginica</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/3.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/4.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Sepal widths</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb13"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> sepal-widths </span>(ds/by ds/iris <span class="at">:species</span> <span class="at">:sepal-width</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb14"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> setosa-sepal-width </span>(sepal-widths <span class="at">:setosa</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb15"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> virginica-sepal-width </span>(sepal-widths <span class="at">:virginica</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/5.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/6.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="winequality-1" class="level4">
<h4 class="anchored" data-anchor-id="winequality-1"><code>winequality</code></h4>
<div class="sourceClojure">
<div class="sourceCode" id="cb16"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar </span>(ds/winequality <span class="st">"residual sugar"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb17"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> alcohol </span>(ds/winequality <span class="st">"alcohol"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/7.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/8.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="basic-descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="basic-descriptive-statistics">Basic Descriptive Statistics</h2>
<p>General summary statistics for describing the center and range of data.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>minimum</code>, <code>maximum</code></li>
<li><code>sum</code></li>
<li><code>mean</code></li>
<li><code>geomean</code>, <code>harmean</code>, <code>powmean</code></li>
<li><code>mode</code>, <code>modes</code></li>
<li><code>wmode</code>, <code>wmodes</code></li>
<li><code>stats-map</code></li>
</ul>
</div>
</div>
<section id="basic" class="level3">
<h3 class="anchored" data-anchor-id="basic">Basic</h3>
<p>This section covers fundamental descriptive statistics including finding the smallest (<code>minimum</code>) and largest (<code>maximum</code>) values, and calculating the total (<code>sum</code>).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb18"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(stats/minimum mpg) <span class="co">;; =&gt; 10.4</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>(stats/maximum mpg) <span class="co">;; =&gt; 33.9</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>(stats/sum mpg) <span class="co">;; =&gt; 642.8999999999999</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Compensated summation can be used to reduce numerical error. There are three algorithms implemented:</p>
<ul>
<li><code>:kahan</code>: The classic algorithm using a single correction variable to reduce numerical error.</li>
<li><code>:neumayer</code>: An improvement on Kahan, also using one correction variable but often providing better accuracy.</li>
<li><code>:klein</code>: A higher-order method using two correction variables, typically offering the highest accuracy at a slight computational cost.</li>
</ul>
<p>As you can see below, all compensated summation give accurate result for <code>mpg</code> data.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb19"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(stats/sum mpg) <span class="co">;; =&gt; 642.8999999999999</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>(stats/sum mpg <span class="at">:kahan</span>) <span class="co">;; =&gt; 642.9</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>(stats/sum mpg <span class="at">:neumayer</span>) <span class="co">;; =&gt; 642.9</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>(stats/sum mpg <span class="at">:klein</span>) <span class="co">;; =&gt; 642.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>But here is the example in which normal summation and <code>:kahan</code> fails.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb20"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(stats/sum [<span class="fl">1.0</span> <span class="fl">1.0E100</span> <span class="fl">1.0</span> -<span class="fl">1.0E100</span>]) <span class="co">;; =&gt; 0.0</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>(stats/sum [<span class="fl">1.0</span> <span class="fl">1.0E100</span> <span class="fl">1.0</span> -<span class="fl">1.0E100</span>] <span class="at">:kahan</span>) <span class="co">;; =&gt; 0.0</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>(stats/sum [<span class="fl">1.0</span> <span class="fl">1.0E100</span> <span class="fl">1.0</span> -<span class="fl">1.0E100</span>] <span class="at">:neumayer</span>) <span class="co">;; =&gt; 2.0</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>(stats/sum [<span class="fl">1.0</span> <span class="fl">1.0E100</span> <span class="fl">1.0</span> -<span class="fl">1.0E100</span>] <span class="at">:klein</span>) <span class="co">;; =&gt; 2.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="mean" class="level3">
<h3 class="anchored" data-anchor-id="mean">Mean</h3>
<p>The mean is a measure of central tendency. <code>fastmath.stats</code> provides several types of means:</p>
<ul>
<li><strong>Arithmetic Mean</strong> (<code>mean</code>): The sum of values divided by their count. It’s the most common type of average.</li>
</ul>
<p><span class="math display">\[\mu = \frac{1}{n} \sum_{i=1}^{n} x_i\]</span></p>
<ul>
<li><strong>Geometric Mean</strong> (<code>geomean</code>): The n-th root of the product of n numbers. Suitable for averaging ratios, growth rates, or values that are multiplicative in nature. Requires all values to be positive. It’s less affected by extreme large values than the arithmetic mean, but more affected by extreme small values.</li>
</ul>
<p><span class="math display">\[G = \left(\prod_{i=1}^{n} x_i\right)^{1/n} = \exp\left(\frac{1}{n}\sum_{i=1}^{n} \ln(x_i)\right)\]</span></p>
<ul>
<li><strong>Harmonic Mean</strong> (<code>harmean</code>): The reciprocal of the arithmetic mean of the reciprocals of the observations. Appropriate for averaging rates (e.g., speeds). It is sensitive to small values and requires all values to be positive and non-zero.</li>
</ul>
<p><span class="math display">\[H = \frac{n}{\sum_{i=1}^{n} \frac{1}{x_i}}\]</span></p>
<ul>
<li><strong>Power Mean</strong> (<code>powmean</code>): Also known as the generalized mean or Hölder mean. It generalizes the arithmetic, geometric, and harmonic means. Defined by a power parameter <span class="math inline">\(p\)</span>.</li>
</ul>
<p><span class="math display">\[M_p = \left(\frac{1}{n} \sum_{i=1}^{n} x_i^p\right)^{1/p} \text{ for } (p \neq 0)\]</span></p>
<p>Special cases:</p>
<ul>
<li><span class="math inline">\(p \to 0\)</span>: Geometric Mean</li>
<li><span class="math inline">\(p = 1\)</span>: Arithmetic Mean</li>
<li><span class="math inline">\(p = -1\)</span>: Harmonic Mean</li>
<li><span class="math inline">\(p = 2\)</span>: Root Mean Square (RMS)</li>
<li><span class="math inline">\(p \to \infty\)</span>: Maximum value</li>
<li><span class="math inline">\(p \to -\infty\)</span>: Minimum value</li>
</ul>
<p>The behavior depends on <span class="math inline">\(p\)</span>: higher <span class="math inline">\(p\)</span> gives more weight to larger values, lower <span class="math inline">\(p\)</span> gives more weight to smaller values.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb21"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar) <span class="co">;; =&gt; 6.391414863209474</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>(stats/geomean residual-sugar) <span class="co">;; =&gt; 4.397022390150047</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>(stats/harmean residual-sugar) <span class="co">;; =&gt; 2.9295723194226815</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>(stats/powmean residual-sugar <span class="at">##</span>-Inf) <span class="co">;; =&gt; 0.6</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>(stats/powmean residual-sugar -<span class="fl">4.5</span>) <span class="co">;; =&gt; 1.5790401256763393</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>(stats/powmean residual-sugar -<span class="fl">1.0</span>) <span class="co">;; =&gt; 2.9295723194226815</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>(stats/powmean residual-sugar <span class="fl">0.0</span>) <span class="co">;; =&gt; 4.397022390150047</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>(stats/powmean residual-sugar <span class="fl">1.0</span>) <span class="co">;; =&gt; 6.391414863209474</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>(stats/powmean residual-sugar <span class="fl">4.5</span>) <span class="co">;; =&gt; 12.228524559326921</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>(stats/powmean residual-sugar <span class="at">##</span>Inf) <span class="co">;; =&gt; 65.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>All values of power mean for <code>residual-sugar</code> data and range of the power from <code>-5</code> to <code>5</code>.</p>
<div class="clay-image">
<img class="clay-image" src="stats_files/9.png">
</div>
<section id="weighted" class="level4">
<h4 class="anchored" data-anchor-id="weighted">Weighted</h4>
<p>Every mean function accepts optional weights vector. Formulas for weighted means are as follows.</p>
<ul>
<li><strong>Arithmetic Mean</strong> (<code>mean</code>):</li>
</ul>
<p><span class="math display">\[\mu_w = \frac{\sum_{i=1}^{n} w_i x_i}{\sum_{i=1}^{n} w_i}\]</span></p>
<ul>
<li><strong>Geometric Mean</strong> (<code>geomean</code>):</li>
</ul>
<p><span class="math display">\[G_w = \left(\prod_{i=1}^{n} x_i^{w_i}\right)^{1/\sum w_i} = \exp\left(\frac{\sum_{i=1}^{n} w_i \ln(x_i)}{\sum_{i=1}^{n} w_i}\right)\]</span></p>
<ul>
<li><strong>Harmonic Mean</strong> (<code>harmean</code>):</li>
</ul>
<p><span class="math display">\[H_w = \frac{\sum_{i=1}^{n} w_i}{\sum_{i=1}^{n} \frac{w_i}{x_i}}\]</span></p>
<ul>
<li><strong>Power Mean</strong> (<code>powmean</code>):</li>
</ul>
<p><span class="math display">\[M_{w,p} = \left(\frac{\sum_{i=1}^{n} w_i x_i^p}{\sum_{i=1}^{n} w_i}\right)^{1/p} \text{ for } (p \neq 0)\]</span></p>
<p>Let’s calculate mean of <code>hp</code> (horsepower) weighted by <code>wt</code> (car weight).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb22"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(stats/mean hp) <span class="co">;; =&gt; 146.6875</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>(stats/mean hp wt) <span class="co">;; =&gt; 159.99440515968607</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>(stats/geomean hp) <span class="co">;; =&gt; 131.88367883954564</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>(stats/geomean hp wt) <span class="co">;; =&gt; 145.7870847521906</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>(stats/harmean hp) <span class="co">;; =&gt; 118.2288915187372</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>(stats/harmean hp wt) <span class="co">;; =&gt; 131.56286792601395</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>(stats/powmean hp -<span class="fl">4.5</span>) <span class="co">;; =&gt; 87.4433284945516</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>(stats/powmean hp wt -<span class="fl">4.5</span>) <span class="co">;; =&gt; 95.2308358812506</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>(stats/powmean hp <span class="fl">4.5</span>) <span class="co">;; =&gt; 193.97486455878905</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>(stats/powmean hp wt <span class="fl">4.5</span>) <span class="co">;; =&gt; 201.37510347727357</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="expectile" class="level4">
<h4 class="anchored" data-anchor-id="expectile">Expectile</h4>
<p>The <code>expectile</code> is a measure of location, related to both the [<a href="#mean">mean</a>] and [<a href="#quantile">quantile</a>]. For a given level <code>τ</code> (tau, a value between 0 and 1), the <code>τ</code>-th expectile is the value <code>t</code> that minimizes an asymmetrically weighted sum of <em>squared</em> differences from <code>t</code>. This is distinct from quantiles, which minimize an asymmetrically weighted sum of <em>absolute</em> differences.</p>
<p>A key property of expectiles is that the 0.5-expectile is identical to the arithmetic [<a href="#mean">mean</a>]. As <code>τ</code> varies from 0 to 1, expectiles span a range of values, typically from the minimum (<code>τ=0</code>) to the maximum (<code>τ=1</code>) of the dataset. Like the mean, expectiles are influenced by the magnitude of all data points, making them generally more sensitive to outliers than corresponding quantiles (e.g., the median).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb23"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(stats/expectile residual-sugar <span class="fl">0.1</span>) <span class="co">;; =&gt; 2.794600951101003</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>(stats/expectile residual-sugar <span class="fl">0.5</span>) <span class="co">;; =&gt; 6.391414863209474</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar) <span class="co">;; =&gt; 6.391414863209474</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>(stats/expectile residual-sugar <span class="fl">0.9</span>) <span class="co">;; =&gt; 11.368419035291927</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>(stats/expectile hp wt <span class="fl">0.25</span>) <span class="co">;; =&gt; 130.66198036981677</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Plotting expectiles for <code>residual-sugar</code> data across the range of <code>τ</code> from 0.0 to 1.0.</p>
<div class="clay-image">
<img class="clay-image" src="stats_files/10.png">
</div>
</section>
</section>
<section id="mode" class="level3">
<h3 class="anchored" data-anchor-id="mode">Mode</h3>
<p>The mode is the value that appears most frequently in a dataset.</p>
<p>For numeric data, <code>mode</code> returns the first mode encountered, while <code>modes</code> returns a sequence of all modes (in increasing order for the default method).</p>
<p>Let’s see that mode returns elements with the highest frequency of <code>hp</code> (showing only first 10 values)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb24"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>^<span class="at">:kind/hidden</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">-&gt;&gt;</span> (<span class="kw">frequencies</span> hp)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">sort-by</span> <span class="kw">second</span> <span class="kw">&gt;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">take</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>110</td>
<td>3</td>
</tr>
<tr class="even">
<td>175</td>
<td>3</td>
</tr>
<tr class="odd">
<td>180</td>
<td>3</td>
</tr>
<tr class="even">
<td>150</td>
<td>2</td>
</tr>
<tr class="odd">
<td>66</td>
<td>2</td>
</tr>
<tr class="even">
<td>245</td>
<td>2</td>
</tr>
<tr class="odd">
<td>123</td>
<td>2</td>
</tr>
<tr class="even">
<td>65</td>
<td>1</td>
</tr>
<tr class="odd">
<td>62</td>
<td>1</td>
</tr>
<tr class="even">
<td>205</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb25"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(stats/mode hp) <span class="co">;; =&gt; 110.0</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>(stats/modes hp) <span class="co">;; =&gt; (110.0 175.0 180.0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>When dealing with data potentially from a continuous distribution, these functions can estimate the mode using different methods:</p>
<ul>
<li><code>:histogram</code>: Mode(s) based on the peak(s) of a histogram.</li>
<li><code>:pearson</code>: Mode estimated using Pearson’s second skewness coefficient (<code>mode ≈ 3 * median - 2 * mean</code>).</li>
<li><code>:kde</code>: Mode(s) based on Kernel Density Estimation, finding original data points with the highest estimated density.</li>
<li>The default method finds the exact most frequent value(s), suitable for discrete data.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb26"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(stats/mode residual-sugar) <span class="co">;; =&gt; 1.2</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>(stats/mode residual-sugar <span class="at">:histogram</span>) <span class="co">;; =&gt; 1.700695134061569</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>(stats/mode residual-sugar <span class="at">:pearson</span>) <span class="co">;; =&gt; 2.8171702735810538</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>(stats/mode residual-sugar <span class="at">:kde</span>) <span class="co">;; =&gt; 1.65</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>For weighted data, or data of any type (not just numeric), use <code>wmode</code> and <code>wmodes</code>. <code>wmode</code> returns the first weighted mode (the one with the highest total weight encountered first), and <code>wmodes</code> returns all values that share the highest total weight. If weights are omitted, they default to 1.0 for each value, effectively calculating unweighted modes for any data type.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb27"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(stats/wmode [<span class="at">:a</span> <span class="at">:b</span> <span class="at">:c</span> <span class="at">:d</span>] [<span class="dv">1</span> <span class="fl">2.5</span> <span class="dv">1</span> <span class="fl">2.5</span>]) <span class="co">;; =&gt; :b</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>(stats/wmodes [<span class="at">:a</span> <span class="at">:b</span> <span class="at">:c</span> <span class="at">:d</span>] [<span class="dv">1</span> <span class="fl">2.5</span> <span class="dv">1</span> <span class="fl">2.5</span>]) <span class="co">;; =&gt; (:b :d)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="stats" class="level3">
<h3 class="anchored" data-anchor-id="stats">Stats</h3>
<p>The <code>stats-map</code> function provides a comprehensive summary of descriptive statistics for a given dataset. It returns a map where keys are statistic names (as keywords) and values are their calculated measures. This function is a convenient way to get a quick overview of the data’s characteristics.</p>
<p>The resulting map contains the following key-value pairs:</p>
<ul>
<li><code>:Size</code> - The number of data points in the sequence.</li>
<li><code>:Min</code> - The smallest value in the sequence (see [<a href="#minimum">minimum</a>]).</li>
<li><code>:Max</code> - The largest value in the sequence (see [<a href="#maximum">maximum</a>]).</li>
<li><code>:Range</code> - The difference between the maximum and minimum values.</li>
<li><code>:Mean</code> - The arithmetic average of the values (see [<a href="#mean">mean</a>]).</li>
<li><code>:Median</code> - The middle value of the sorted sequence (see [<a href="#median">median</a>]).</li>
<li><code>:Mode</code> - The most frequently occurring value(s) (see [<a href="#mode">mode</a>]).</li>
<li><code>:Q1</code> - The first quartile (25th percentile) of the data (see [<a href="#percentile">percentile</a>]).</li>
<li><code>:Q3</code> - The third quartile (75th percentile) of the data (see [<a href="#percentile">percentile</a>]).</li>
<li><code>:Total</code> - The sum of all values in the sequence (see [<a href="#sum">sum</a>]).</li>
<li><code>:SD</code> - The sample standard deviation, a measure of data dispersion around the mean.</li>
<li><code>:Variance</code> - The sample variance, the square of the standard deviation.</li>
<li><code>:MAD</code> - The Median Absolute Deviation, a robust measure of variability (see [<a href="#median-absolute-deviation">median-absolute-deviation</a>]).</li>
<li><code>:SEM</code> - The Standard Error of the Mean, an estimate of the standard deviation of the sample mean.</li>
<li><code>:LAV</code> - The Lower Adjacent Value, the smallest observation that is not an outlier (see [<a href="#adjacent-values">adjacent-values</a>]).</li>
<li><code>:UAV</code> - The Upper Adjacent Value, the largest observation that is not an outlier (see [<a href="#adjacent-values">adjacent-values</a>]).</li>
<li><code>:IQR</code> - The Interquartile Range, the difference between Q3 and Q1.</li>
<li><code>:LOF</code> - The Lower Outer Fence, a threshold for identifying extreme low outliers (<code>Q1 - 3.0 * IQR</code>).</li>
<li><code>:UOF</code> - The Upper Outer Fence, a threshold for identifying extreme high outliers (<code>Q3 + 3.0 * IQR</code>).</li>
<li><code>:LIF</code> - The Lower Inner Fence, a threshold for identifying mild low outliers (<code>Q1 - 1.5 * IQR</code>).</li>
<li><code>:UIF</code> - The Upper Inner Fence, a threshold for identifying mild high outliers (<code>Q3 + 1.5 * IQR</code>).</li>
<li><code>:Outliers</code> - A list of data points considered outliers (values outside the inner fences, see [<a href="#outliers">outliers</a>]).</li>
<li><code>:Kurtosis</code> - A measure of the “tailedness” or “peakedness” of the distribution (see [<a href="#kurtosis">kurtosis</a>]).</li>
<li><code>:Skewness</code> - A measure of the asymmetry of the distribution (see [<a href="#skewness">skewness</a>]).</li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb28"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(stats/stats-map residual-sugar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb29"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:IQR</span> <span class="fl">8.200000000000001</span>,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:Kurtosis</span> <span class="fl">3.4698201025634363</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:LAV</span> <span class="fl">0.6</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:LIF</span> -<span class="fl">10.600000000000001</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:LOF</span> -<span class="fl">22.900000000000002</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:MAD</span> <span class="fl">3.6</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:Max</span> <span class="fl">65.8</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:Mean</span> <span class="fl">6.391414863209486</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:Median</span> <span class="fl">5.2</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:Min</span> <span class="fl">0.6</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:Mode</span> <span class="fl">1.2</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:Outliers</span> (<span class="fl">22.6</span> <span class="fl">23.5</span> <span class="fl">26.05</span> <span class="fl">26.05</span> <span class="fl">31.6</span> <span class="fl">31.6</span> <span class="fl">65.8</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:Q1</span> <span class="fl">1.7</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:Q3</span> <span class="fl">9.9</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:Range</span> <span class="fl">65.2</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:SD</span> <span class="fl">5.072057784014863</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:SEM</span> <span class="fl">0.07247276021182479</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:Size</span> <span class="dv">4898</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:Skewness</span> <span class="fl">1.0770937564241123</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a> <span class="at">:Total</span> <span class="fl">31305.150000000063</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a> <span class="at">:UAV</span> <span class="fl">22.0</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a> <span class="at">:UIF</span> <span class="fl">22.200000000000003</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a> <span class="at">:UOF</span> <span class="fl">34.5</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a> <span class="at">:Variance</span> <span class="fl">25.72577016438576</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="quantiles-and-percentiles" class="level2">
<h2 class="anchored" data-anchor-id="quantiles-and-percentiles">Quantiles and Percentiles</h2>
<p>Statistics related to points dividing the distribution of data.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>percentile</code>, <code>percentiles</code></li>
<li><code>quantile</code>, <code>quantiles</code></li>
<li><code>wquantile</code>, <code>wquantiles</code></li>
<li><code>median</code>, <code>median-3</code></li>
<li><code>wmedian</code></li>
</ul>
</div>
</div>
<p>Quantiles and percentiles are statistics that divide the range of a probability distribution into continuous intervals with equal probabilities, or divide the observations in a sample in the same way.</p>
<p><code>fastmath.stats</code> provides several functions to calculate these measures:</p>
<ul>
<li><code>percentile</code>: Calculates the p-th percentile (a value from 0 to 100) of a sequence.</li>
<li><code>percentiles</code>: Calculates multiple percentiles for a sequence.</li>
<li><code>quantile</code>: Calculates the q-th quantile (a value from 0.0 to 1.0) of a sequence. This is equivalent to <code>(percentile vs (* q 100.0))</code>.</li>
<li><code>quantiles</code>: Calculates multiple quantiles for a sequence.</li>
<li><code>median</code>: Calculates the median (0.5 quantile or 50th percentile) of a sequence.</li>
<li><code>median-3</code>: A specialized function that calculates the median of exactly three numbers.</li>
</ul>
<p>All <code>percentile</code>, <code>quantiles</code>, <code>quantile</code>, <code>quantiles</code>, and <code>median</code> functions accept an optional <code>estimation-strategy</code> keyword. This parameter determines how the quantile is estimated, particularly how interpolation is handled when the desired quantile falls between data points in the sorted sequence.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb30"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(stats/quantile mpg <span class="fl">0.25</span>) <span class="co">;; =&gt; 15.274999999999999</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>(stats/quantiles mpg [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>]) <span class="co">;; =&gt; [13.600000000000001 15.274999999999999 19.2 22.8 30.4]</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>(stats/percentile mpg <span class="fl">50.0</span>) <span class="co">;; =&gt; 19.2</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>(stats/percentiles residual-sugar [<span class="dv">10</span> <span class="dv">25</span> <span class="dv">50</span> <span class="dv">75</span> <span class="dv">90</span>]) <span class="co">;; =&gt; [1.2 1.7 5.2 9.9 14.0]</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>(stats/median mpg) <span class="co">;; =&gt; 19.2</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>(stats/median<span class="dv">-3</span> <span class="dv">15</span> <span class="dv">5</span> <span class="dv">10</span>) <span class="co">;; =&gt; 10.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The available <code>estimation-strategy</code> values are <code>:legacy</code> (default), <code>:r1</code>, <code>:r2</code>, <code>:r3</code>, <code>:r4</code>, <code>:r5</code>, <code>:r6</code>, <code>:r7</code>, <code>:r8</code> and <code>:r9</code>. Formulas for all of them can be found on this <a href="https://en.wikipedia.org/wiki/Quantile#Estimating_quantiles_from_a_sample">Wikipedia article</a>. <code>:legacy</code> uses estimate of the form: <span class="math inline">\(Q_p = x_{\lceil p(N+1) - 1/2 \rceil}\)</span></p>
<p>The plot below illustrates the differences between these estimation strategies for the sample <code>vs = [1 10 10 30]</code>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb31"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> vs </span>[<span class="dv">1</span> <span class="dv">10</span> <span class="dv">10</span> <span class="dv">30</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/11.png">
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb32"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:legacy</span>) <span class="co">;; =&gt; [1.0 3.25 10.0 25.0 30.0]</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r1</span>) <span class="co">;; =&gt; [1.0 1.0 10.0 10.0 30.0]</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r2</span>) <span class="co">;; =&gt; [1.0 5.5 10.0 20.0 30.0]</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r3</span>) <span class="co">;; =&gt; [1.0 1.0 10.0 10.0 30.0]</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r4</span>) <span class="co">;; =&gt; [1.0 1.0 10.0 10.0 22.0]</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r5</span>) <span class="co">;; =&gt; [1.0 5.5 10.0 20.0 30.0]</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r6</span>) <span class="co">;; =&gt; [1.0 3.25 10.0 25.0 30.0]</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r7</span>) <span class="co">;; =&gt; [3.7 7.75 10.0 15.0 24.000000000000004]</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r8</span>) <span class="co">;; =&gt; [1.0 4.749999999999998 10.0 21.66666666666667 30.0]</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>(stats/quantiles vs [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r9</span>) <span class="co">;; =&gt; [1.0 4.9375 10.0 21.25 30.0]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="weighted-1" class="level3">
<h3 class="anchored" data-anchor-id="weighted-1">Weighted</h3>
<p>There are also functions to calculate weighted quantiles and medians. These are useful when individual data points have different levels of importance or contribution.</p>
<ul>
<li><code>wquantile</code>: Calculates the q-th weighted quantile for a sequence <code>vs</code> with corresponding <code>weights</code>.</li>
<li><code>wquantiles</code>: Calculates multiple weighted quantiles for a sequence <code>vs</code> with <code>weights</code>.</li>
<li><code>wmedian</code>: Calculates the weighted median (0.5 weighted quantile) for <code>vs</code> with <code>weights</code>.</li>
</ul>
<p>All these functions accept an optional <code>method</code> keyword argument that specifies the interpolation strategy when a quantile falls between points in the weighted empirical cumulative distribution function (ECDF). The available methods are:</p>
<ul>
<li><code>:linear</code> (Default): Performs linear interpolation between the data values corresponding to the cumulative weights surrounding the target quantile.</li>
<li><code>:step</code>: Uses a step function (specifically, step-before interpolation) based on the weighted ECDF. The result is the data value whose cumulative weight range includes the target quantile.</li>
<li><code>:average</code>: Computes the average of the step-before and step-after interpolation methods. This can be useful when a quantile corresponds exactly to a cumulative weight boundary.</li>
</ul>
<p>Let’s define a sample dataset and weights:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb33"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> sample-data </span>[<span class="dv">10</span> <span class="dv">15</span> <span class="dv">30</span> <span class="dv">50</span> <span class="dv">100</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb34"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> sample-weights </span>[<span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb35"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(stats/wquantile sample-data sample-weights <span class="fl">0.25</span>) <span class="co">;; =&gt; 13.75</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>(stats/wquantile sample-data sample-weights <span class="fl">0.5</span>) <span class="co">;; =&gt; 21.0</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>(stats/wmedian sample-data sample-weights) <span class="co">;; =&gt; 21.0</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>(stats/wquantile sample-data sample-weights <span class="fl">0.75</span>) <span class="co">;; =&gt; 28.5</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>(stats/wmedian sample-data sample-weights <span class="at">:linear</span>) <span class="co">;; =&gt; 21.0</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>(stats/wmedian sample-data sample-weights <span class="at">:step</span>) <span class="co">;; =&gt; 30.0</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>(stats/wmedian sample-data sample-weights <span class="at">:average</span>) <span class="co">;; =&gt; 22.5</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>(stats/wquantiles sample-data sample-weights [<span class="fl">0.2</span> <span class="fl">0.5</span> <span class="fl">0.8</span>]) <span class="co">;; =&gt; [12.5 21.0 30.0]</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>(stats/wquantiles sample-data sample-weights [<span class="fl">0.2</span> <span class="fl">0.5</span> <span class="fl">0.8</span>] <span class="at">:step</span>) <span class="co">;; =&gt; [15.0 30.0 30.0]</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>(stats/wquantiles sample-data sample-weights [<span class="fl">0.2</span> <span class="fl">0.5</span> <span class="fl">0.8</span>] <span class="at">:average</span>) <span class="co">;; =&gt; [12.5 22.5 30.0]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Using <code>mpg</code> data and <code>wt</code> (car weight) as weights:</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb36"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(stats/wmedian mpg wt) <span class="co">;; =&gt; 17.702906976744185</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>(stats/wquantile mpg wt <span class="fl">0.25</span>) <span class="co">;; =&gt; 14.894033613445378</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>(stats/wquantiles mpg wt [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:average</span>) <span class="co">;; =&gt; [10.4 14.85 17.55 21.2 25.2]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>When weights are equal to 1.0, then:</p>
<ul>
<li><code>:linear</code> method is the same as <code>:r4</code> estimation strategy in <code>quantiles</code></li>
<li><code>:step</code> is the same as <code>:r1</code></li>
<li><code>:average</code> has no corresponding strategy</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb37"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(stats/quantiles mpg [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r4</span>) <span class="co">;; =&gt; [13.5 15.2 19.2 22.8 29.78]</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>(stats/wquantiles mpg (<span class="kw">repeat</span> (<span class="kw">count</span> mpg) <span class="fl">1.0</span>) [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>]) <span class="co">;; =&gt; [13.5 15.2 19.2 22.8 29.78]</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>(stats/quantiles mpg [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:r1</span>) <span class="co">;; =&gt; [14.3 15.2 19.2 22.8 30.4]</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>(stats/wquantiles mpg (<span class="kw">repeat</span> (<span class="kw">count</span> mpg) <span class="fl">1.0</span>) [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:step</span>) <span class="co">;; =&gt; [14.3 15.2 19.2 22.8 30.4]</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>(stats/wquantiles mpg (<span class="kw">repeat</span> (<span class="kw">count</span> mpg) <span class="fl">1.0</span>) [<span class="fl">0.1</span> <span class="fl">0.25</span> <span class="fl">0.5</span> <span class="fl">0.75</span> <span class="fl">0.9</span>] <span class="at">:average</span>) <span class="co">;; =&gt; [13.8 15.2 19.2 22.8 28.85]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="measures-of-dispersiondeviation" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-dispersiondeviation">Measures of Dispersion/Deviation</h2>
<p>Statistics describing the spread or variability of data.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>variance</code>, <code>population-variance</code></li>
<li><code>stddev</code>, <code>population-stddev</code></li>
<li><code>wvariance</code>, <code>population-wvariance</code></li>
<li><code>wstddev</code>, <code>population-wstddev</code></li>
<li><code>pooled-variance</code>, <code>pooled-stddev</code></li>
<li><code>variation</code>, <code>l-variation</code></li>
<li><code>mean-absolute-deviation</code></li>
<li><code>median-absolute-deviation</code>, <code>mad</code></li>
<li><code>pooled-mad</code></li>
<li><code>sem</code></li>
</ul>
</div>
</div>
<section id="variance-and-standard-deviation" class="level3">
<h3 class="anchored" data-anchor-id="variance-and-standard-deviation">Variance and standard deviation</h3>
<p>Variance and standard deviation are fundamental measures of the dispersion or spread of a dataset around its mean.</p>
<ul>
<li><p><strong>Variance</strong> quantifies the average squared difference of each data point from the mean. A higher variance indicates that the data points are more spread out, while a lower variance indicates they are clustered closer to the mean.</p></li>
<li><p><strong>Standard Deviation</strong> is the square root of the variance. It is expressed in the same units as the data, making it more interpretable than variance as a measure of spread.</p></li>
<li><p><strong>Sample Variance</strong> (<code>variance</code>) and <strong>Sample Standard Deviation</strong> (<code>stddev</code>): These are estimates of the population variance and standard deviation, calculated from a sample of data. They use a denominator of <span class="math inline">\(N-1\)</span> (Bessel’s correction) to provide an unbiased estimate of the population variance.</p></li>
</ul>
<p><span class="math display">\[s^2 = \frac{\sum_{i=1}^{n} (x_i - \bar{x})^2}{n-1}\]</span></p>
<p><span class="math display">\[s = \sqrt{s^2}\]</span></p>
<p>Both functions can optionally accept a pre-calculated mean (<code>mu</code>) as a second argument.</p>
<ul>
<li><strong>Population Variance</strong> (<code>population-variance</code>) and <strong>Population Standard Deviation</strong> (<code>population-stddev</code>): These are used when the data represents the entire population of interest, or when a biased estimate (maximum likelihood estimate) from a sample is desired. They use a denominator of <span class="math inline">\(N\)</span>.</li>
</ul>
<p><span class="math display">\[\sigma^2 = \frac{\sum_{i=1}^{N} (x_i - \mu)^2}{N}\]</span></p>
<p><span class="math display">\[\sigma = \sqrt{\sigma^2}\]</span></p>
<p>These also accept an optional pre-calculated population mean (<code>mu</code>).</p>
<ul>
<li><strong>Weighted Variance</strong> (<code>wvariance</code>, <code>population-wvariance</code>) and <strong>Weighted Standard Deviation</strong> (<code>wstddev</code>, <code>population-wstddev</code>): These calculate variance and standard deviation when each data point has an associated weight. For weighted sample variance (unbiased form, where <span class="math inline">\(w_i\)</span> are weights):</li>
</ul>
<p><span class="math display">\[\bar{x}_w = \frac{\sum w_i x_i}{\sum w_i}\]</span></p>
<p><span class="math display">\[s_w^2 = \frac{\sum w_i (x_i - \bar{x}_w)^2}{(\sum w_i) - 1}\]</span></p>
<p>For weighted population variance:</p>
<p><span class="math display">\[\sigma_w^2 = \frac{\sum w_i (x_i - \bar{x}_w)^2}{\sum w_i}\]</span></p>
<p>Weighted standard deviations are the square roots of their respective variances.</p>
<ul>
<li><strong>Pooled Variance</strong> (<code>pooled-variance</code>) and <strong>Pooled Standard Deviation</strong> (<code>pooled-stddev</code>): These are used to estimate a common variance when data comes from several groups that are assumed to have the same population variance. Following methods can be used (where <span class="math inline">\(k\)</span> is the number of groups, each with <span class="math inline">\(n_i\)</span> number of observations and sample variance <span class="math inline">\(s_i^2\)</span>)
<ul>
<li><code>:unbiased</code> (default) <span class="math display">\[s_p^2 = \frac{\sum_{i=1}^{k} (n_i-1)s_i^2}{\sum_{i=1}^{k} n_i - k}\]</span></li>
<li><code>:biased</code> <span class="math display">\[s_p^2 = \frac{\sum_{i=1}^{k} (n_i-1)s_i^2}{\sum_{i=1}^{k} n_i}\]</span></li>
<li><code>:avg</code> - simple average of group variances. <span class="math display">\[s_p^2 = \frac{\sum_{i=1}^{k} s_i^2}{k}\]</span></li>
</ul></li>
</ul>
<p>Pooled standard deviation is <span class="math inline">\(\sqrt{s_p^2}\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb38"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(stats/variance mpg) <span class="co">;; =&gt; 36.32410282258065</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>(stats/stddev mpg) <span class="co">;; =&gt; 6.026948052089105</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>(stats/population-variance mpg) <span class="co">;; =&gt; 35.188974609375</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>(stats/population-stddev mpg) <span class="co">;; =&gt; 5.932029552301219</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>(stats/variance mpg (stats/mean mpg)) <span class="co">;; =&gt; 36.32410282258065</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>(stats/population-variance mpg (stats/mean mpg)) <span class="co">;; =&gt; 35.188974609375</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Weighted variance and standard deviation</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb39"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>(stats/wvariance hp wt) <span class="co">;; =&gt; 4477.350800154701</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>(stats/wstddev hp wt) <span class="co">;; =&gt; 66.91300919966685</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>(stats/population-wvariance hp wt) <span class="co">;; =&gt; 4433.861107869416</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>(stats/population-wstddev hp wt) <span class="co">;; =&gt; 66.58724433305088</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Pooled variance and standard deviation</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb40"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>(stats/pooled-variance [setosa-sepal-length virginica-sepal-length]) <span class="co">;; =&gt; 0.264295918367347</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>(stats/pooled-stddev [setosa-sepal-length virginica-sepal-length]) <span class="co">;; =&gt; 0.5140971876672221</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>(stats/pooled-variance [setosa-sepal-length virginica-sepal-length] <span class="at">:biased</span>) <span class="co">;; =&gt; 0.2590100000000001</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>(stats/pooled-variance [setosa-sepal-length virginica-sepal-length] <span class="at">:avg</span>) <span class="co">;; =&gt; 0.264295918367347</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Beyond variance and standard deviation, we have three additional functions:</p>
<ul>
<li><strong>Coefficient of Variation</strong> (<code>variation</code>): This is a standardized measure of dispersion, calculated as the ratio of the standard deviation <span class="math inline">\(s\)</span> to the mean <span class="math inline">\(\bar{x}\)</span>.</li>
</ul>
<p><span class="math display">\[CV = \frac{s}{\bar{x}}\]</span></p>
<p>The CV is unitless, making it useful for comparing the variability of datasets with different means or units. It’s most meaningful for data measured on a ratio scale (i.e., with a true zero point) and where all values are positive.</p>
<ul>
<li><strong>Standard Error of the Mean</strong> (<code>sem</code>): The SEM estimates the standard deviation of the sample mean if you were to draw multiple samples from the same population. It indicates how precisely the sample mean estimates the true population mean.</li>
</ul>
<p><span class="math display">\[SEM = \frac{s}{\sqrt{n}}\]</span></p>
<p>where <span class="math inline">\(s\)</span> is the sample standard deviation and <span class="math inline">\(n\)</span> is the sample size. A smaller SEM suggests a more precise estimate of the population mean.</p>
<ul>
<li><strong>L-variation</strong> (<code>l-variation</code>): Calculates the coefficient of L-variation. This is a dimensionless measure of dispersion, analogous to the coefficient of variation.</li>
</ul>
<p><span class="math display">\[\tau_2 = \lambda_2 / \lambda_1\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb41"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(stats/variation mpg) <span class="co">;; =&gt; 0.29998808160966145</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>(stats/variation residual-sugar) <span class="co">;; =&gt; 0.7935735502339006</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>(stats/l-variation mpg) <span class="co">;; =&gt; 0.1691378280874466</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>(stats/l-variation residual-sugar) <span class="co">;; =&gt; 0.43403938821477966</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>(stats/sem mpg) <span class="co">;; =&gt; 1.0654239593728148</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>(stats/sem residual-sugar) <span class="co">;; =&gt; 0.07247276021182479</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="mad" class="level3">
<h3 class="anchored" data-anchor-id="mad">MAD</h3>
<p>MAD typically refers to Median Absolute Deviation, a robust measure of statistical dispersion. <code>fastmath.stats</code> also provides the Mean Absolute Deviation.</p>
<ul>
<li><strong>Median Absolute Deviation</strong> (<code>median-absolute-deviation</code> or <code>mad</code>): This is a robust measure of the variability of a univariate sample. It is defined as the median of the absolute deviations from the data’s median.</li>
</ul>
<p><span class="math display">\[MAD = \text{median}(|X_i - \text{median}(X)|)\]</span></p>
<p>If a specific center <span class="math inline">\(c\)</span> is provided, it’s <span class="math inline">\(MAD_c = \text{median}(|X_i - c|)\)</span>. Also, different estimation strategies can be used, see [<a href="#median">median</a>] MAD is less sensitive to outliers than the standard deviation.</p>
<ul>
<li><strong>Mean Absolute Deviation</strong> (<code>mean-absolute-deviation</code>): This measures variability as the average of the absolute deviations from a central point, typically the data’s mean.</li>
</ul>
<p><span class="math display">\[MeanAD = \frac{1}{n} \sum_{i=1}^{n} |X_i - \text{mean}(X)|\]</span></p>
<p>If a specific center <span class="math inline">\(c\)</span> is provided, it’s <span class="math inline">\(MeanAD_c = \frac{1}{n} \sum_{i=1}^{n} |X_i - c|\)</span>. MeanAD is more sensitive to outliers than MAD but less sensitive than the standard deviation.</p>
<ul>
<li><strong>Pooled MAD</strong> (<code>pooled-mad</code>): This function calculates a pooled estimate of the Median Absolute Deviation when data comes from several groups. For each group <span class="math inline">\(i\)</span>, absolute deviations from its median <span class="math inline">\(M_i\)</span> are calculated: <span class="math inline">\(Y_{ij} = |X_{ij} - M_i|\)</span>. The pooled MAD is then the median of all such <span class="math inline">\(Y_{ij}\)</span> values, scaled by a constant <code>const</code> (which defaults to approximately 1.4826, to make it comparable to the standard deviation for normal data).</li>
</ul>
<p><span class="math display">\[PooledMAD = \text{const} \cdot \text{median}(\{Y_{ij} \mid \text{for all groups } i \text{ and observations } j \text{ in group } i\})\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb42"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>(stats/mad mpg) <span class="co">;; =&gt; 3.6500000000000004</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>(stats/median-absolute-deviation mpg) <span class="co">;; =&gt; 3.6500000000000004</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>(stats/median-absolute-deviation mpg (stats/median mpg) <span class="at">:r3</span>) <span class="co">;; =&gt; 3.6000000000000014</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>(stats/median-absolute-deviation mpg (stats/mean mpg)) <span class="co">;; =&gt; 4.299999999999999</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>(stats/mean-absolute-deviation mpg) <span class="co">;; =&gt; 4.714453125</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>(stats/mean-absolute-deviation mpg (stats/median mpg)) <span class="co">;; =&gt; 4.634375</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>(stats/pooled-mad [setosa-sepal-length virginica-sepal-length]) <span class="co">;; =&gt; 0.4447806655516804</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>(stats/pooled-mad [setosa-sepal-length virginica-sepal-length] <span class="fl">1.0</span>) <span class="co">;; =&gt; 0.2999999999999998</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="moments-and-shape" class="level2">
<h2 class="anchored" data-anchor-id="moments-and-shape">Moments and Shape</h2>
<p>Moments and shape statistics describe the form of a dataset’s distribution, particularly its symmetry and peakedness.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>moment</code></li>
<li><code>skewness</code></li>
<li><code>kurtosis</code></li>
<li><code>l-moment</code></li>
</ul>
</div>
</div>
<section id="conventional-moments-moment" class="level3">
<h3 class="anchored" data-anchor-id="conventional-moments-moment">Conventional Moments (<code>moment</code>)</h3>
<p>The <code>moment</code> function calculates statistical moments of a dataset. Moments can be central (around the mean), raw (around zero), or around a specified center. They can also be absolute and/or normalized.</p>
<ul>
<li><p><strong>k-th Central Moment</strong>: <span class="math inline">\(\mu_k = E[(X - \mu)^k] \approx \frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x})^k\)</span>. Calculated when <code>center</code> is <code>nil</code> (default) and <code>:mean?</code> is <code>true</code> (default).</p></li>
<li><p><strong>k-th Raw Moment</strong> (about origin): <span class="math inline">\(\mu'_k = E[X^k] \approx \frac{1}{n} \sum_{i=1}^{n} x_i^k\)</span>. Calculated if <code>center</code> is <code>0.0</code>.</p></li>
<li><p><strong>k-th Absolute Central Moment</strong>: <span class="math inline">\(E[|X - \mu|^k] \approx \frac{1}{n} \sum_{i=1}^{n} |x_i - \bar{x}|^k\)</span>. Calculated if <code>:absolute?</code> is <code>true</code>.</p></li>
<li><p><strong>Normalization</strong>: If <code>:normalize?</code> is <code>true</code>, the moment is divided by <span class="math inline">\(\sigma^k\)</span> (where <span class="math inline">\(\sigma\)</span> is the standard deviation), yielding a scale-invariant measure. For example, the 3rd normalized central moment is related to skewness, and the 4th to kurtosis.</p></li>
<li><p><strong>Power of sum of differences</strong>: If <code>:mean?</code> is <code>false</code>, the function returns the sum <span class="math inline">\(\sum (x_i - c)^k\)</span> (or sum of absolute values) instead of the mean.</p></li>
</ul>
<p>The <code>order</code> parameter specifies <span class="math inline">\(k\)</span>. For example, the 2nd central moment for <span class="math inline">\(k=2\)</span> is the variance.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb43"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(stats/moment mpg <span class="dv">2</span>) <span class="co">;; =&gt; 35.188974609374995</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>(stats/variance mpg) <span class="co">;; =&gt; 36.32410282258065</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>(stats/moment mpg <span class="dv">3</span>) <span class="co">;; =&gt; 133.68672198486328</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>(stats/moment mpg <span class="dv">4</span> {<span class="at">:normalize</span>? <span class="va">true</span>}) <span class="co">;; =&gt; 2.6272339701791085</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>(stats/moment mpg <span class="dv">1</span> {<span class="at">:absolute</span>? <span class="va">true</span>, <span class="at">:center</span> (stats/median mpg)}) <span class="co">;; =&gt; 4.634375</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="skewness" class="level3">
<h3 class="anchored" data-anchor-id="skewness">Skewness</h3>
<p>Skewness measures the asymmetry of a probability distribution about its mean. <code>fastmath.stats/skewness</code> offers several types:</p>
<p><strong>Moment-based (sensitive to outliers):</strong></p>
<ul>
<li><code>:G1</code> (Default): Sample skewness based on the 3rd standardized moment, adjusted for sample bias (via Apache Commons Math).</li>
</ul>
<p><span class="math display">\[G_1 = \frac{n}{(n-1)(n-2)} \sum_{i=1}^n \left(\frac{x_i - \bar{x}}{s}\right)^3\]</span></p>
<ul>
<li><code>:g1</code> or <code>:pearson</code>: Pearson’s moment coefficient of skewness, another bias-adjusted version of the 3rd standardized central moment <span class="math inline">\(m_3\)</span>.</li>
</ul>
<p><span class="math display">\[g_1 = \frac{m_3}{m_2^{3/2}}\]</span></p>
<ul>
<li><code>:b1</code>: Sample skewness coefficient, related to <span class="math inline">\(g_1\)</span>.</li>
</ul>
<p><span class="math display">\[b_1 = \frac{m_3}{s^3}\]</span></p>
<ul>
<li><code>:skew</code>: Skewness used in BCa</li>
</ul>
<p><span class="math display">\[SKEW = \frac{\sum_{i=1}^n (x_i - \bar{x})^3}{(\sum_{i=1}^n (x_i - \bar{x})^2)^{3/2}}  = \frac{g_1}{\sqrt{n}}\]</span></p>
<p><strong>Robust (less sensitive to outliers):</strong></p>
<ul>
<li><code>:median</code>: Median Skewness / Pearson’s first skewness coefficient.</li>
</ul>
<p><span class="math display">\[S_P = 3 \frac{\text{mean} - \text{median}}{\text{stddev}}\]</span></p>
<ul>
<li><code>:mode</code>: Pearson’s second skewness coefficient. Mode estimation method can be specified.</li>
</ul>
<p><span class="math display">\[S_K = \frac{\text{mean} - \text{mode}}{\text{stddev}}\]</span></p>
<ul>
<li><code>:bowley</code> or <code>:yule</code> (with <span class="math inline">\(u=0.25\)</span>): Based on quartiles <span class="math inline">\(Q_1, Q_2, Q_3\)</span>.</li>
</ul>
<p><span class="math display">\[S_B = \frac{(Q_3 - Q_2) - (Q_2 - Q_1)}{Q_3 - Q_1} = \frac{Q_3 + Q_1 - 2Q_2}{Q_3 - Q_1}\]</span></p>
<ul>
<li><code>:yule</code> or <code>:B1</code> (Yule’s coefficient): Generalization of Bowley’s, using quantiles <span class="math inline">\(Q_u, Q_{0.5}, Q_{1-u}\)</span>.</li>
</ul>
<p><span class="math display">\[B_1 = S_Y(u) = \frac{(Q_{1-u} - Q_{0.5}) - (Q_{0.5} - Q_u)}{Q_{1-u} - Q_u}\]</span></p>
<ul>
<li><code>:B3</code>: Robust measure by Groeneveld and Meeden</li>
</ul>
<p><span class="math display">\[B_3 = \frac{\text{mean} - \text{median}}{\text{mean}(|X_i - \text{median}|)}\]</span></p>
<ul>
<li><code>:hogg</code>: Based on comparing trimmed means (<span class="math inline">\(U_{0.05}\)</span>: mean of top 5%, <span class="math inline">\(L_{0.05}\)</span>: mean of bottom 5%, <span class="math inline">\(M_{0.25}\)</span>: 25% trimmed mean).</li>
</ul>
<p><span class="math display">\[S_H = \frac{U_{0.05} - M_{0.25}}{M_{0.25} - L_{0.05}}\]</span></p>
<ul>
<li><code>:l-skewness</code>: L-moments based skewness.</li>
</ul>
<p><span class="math display">\[\tau_3 = \lambda_3 / \lambda_2\]</span></p>
<p>Positive skewness indicates a tail on the right side of the distribution; negative skewness indicates a tail on the left. Zero indicates symmetry.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb44"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar) <span class="co">;; =&gt; 1.0770937564240939</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:G1</span>) <span class="co">;; =&gt; 1.0770937564240939</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:g1</span>) <span class="co">;; =&gt; 1.0767638711454521</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:pearson</span>) <span class="co">;; =&gt; 1.0767638711454521</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:b1</span>) <span class="co">;; =&gt; 1.07643413178962</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:skew</span>) <span class="co">;; =&gt; 0.01538548123095513</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:median</span>) <span class="co">;; =&gt; 0.7046931919610692</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:mode</span>) <span class="co">;; =&gt; 1.0235322790625094</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar [<span class="at">:mode</span> <span class="at">:histogram</span>]) <span class="co">;; =&gt; 0.9248159088272246</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar [<span class="at">:mode</span> <span class="at">:kde</span>]) <span class="co">;; =&gt; 0.9348108923665123</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:bowley</span>) <span class="co">;; =&gt; 0.1463414634146341</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:yule</span>) <span class="co">;; =&gt; 0.1463414634146341</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar [<span class="at">:yule</span> <span class="fl">0.1</span>]) <span class="co">;; =&gt; 0.37499999999999994</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:B3</span>) <span class="co">;; =&gt; 0.2864727410181956</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:hogg</span>) <span class="co">;; =&gt; 3.0343529984131266</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:l-skewness</span>) <span class="co">;; =&gt; 0.22296648073302056</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Effect of an outlier is visible for moment based skewness, while has no effect when robust method is used.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb45"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>(stats/skewness (<span class="kw">conj</span> residual-sugar -<span class="dv">1000</span>)) <span class="co">;; =&gt; -58.659786835804155</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>(stats/skewness (<span class="kw">conj</span> residual-sugar -<span class="dv">1000</span>) <span class="at">:l-skewness</span>) <span class="co">;; =&gt; 0.13914390517414776</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="kurtosis" class="level3">
<h3 class="anchored" data-anchor-id="kurtosis">Kurtosis</h3>
<p>Kurtosis measures the “tailedness” or “peakedness” of a distribution. High kurtosis means heavy tails (more outliers) and a sharp peak (leptokurtic); low kurtosis means light tails and a flatter peak (platykurtic). <code>fastmath.stats/kurtosis</code> offers several types:</p>
<p><strong>Moment-based (sensitive to outliers):</strong></p>
<ul>
<li><code>:G2</code> (Default): Sample kurtosis (Fisher’s definition, not excess), adjusted for sample bias (via Apache Commons Math). For a normal distribution, this is approximately 3.</li>
</ul>
<p><span class="math display">\[G_2 = \frac{(n+1)n}{(n-1)(n-2)(n-3)} \sum_{i=1}^n \left(\frac{x_i - \bar{x}}{s}\right)^4 - 3\frac{(n-1)^2}{(n-2)(n-3)}\]</span></p>
<ul>
<li><code>:g2</code> or <code>:excess</code>: Sample excess kurtosis. For a normal distribution, this is approximately 0.</li>
</ul>
<p><span class="math display">\[g_2 = \frac{m_4}{m_2^2}-3\]</span></p>
<ul>
<li><code>:kurt</code>: Kurtosis defined as <span class="math inline">\(g_2 + 3\)</span>.</li>
</ul>
<p><span class="math display">\[g_{kurt} = \frac{m_4}{m_2^2} = g_2 + 3\]</span></p>
<ul>
<li><code>:b2</code>: Sample kurtosis</li>
</ul>
<p><span class="math display">\[b_2 = \frac{m_4}{s^4}-3\]</span></p>
<p><strong>Robust (less sensitive to outliers):</strong></p>
<ul>
<li><code>:geary</code>: Geary’s ‘g’ measure of kurtosis. Normal <span class="math inline">\(\approx \sqrt{2/\pi} \approx 0.798\)</span>.</li>
</ul>
<p><span class="math display">\[g = \frac{MeanAD}{\sigma^2}\]</span></p>
<ul>
<li><code>:moors</code>: Based on octiles <span class="math inline">\(E_i\)</span> (quantiles <span class="math inline">\(i/8\)</span>) and centered by subtracting <span class="math inline">\(1.233\)</span> (Moors’ constant for normality).</li>
</ul>
<p><span class="math display">\[M_0 = \frac{(E_7-E_5) + (E_3-E_1)}{E_6-E_2}-1.233\]</span></p>
<ul>
<li><code>:crow</code> (Crow-Siddiqui): Based on quantiles <span class="math inline">\(Q_\alpha, Q_{1-\alpha}, Q_\beta, Q_{1-\beta}\)</span> and centered for normality (<span class="math inline">\(c\)</span> is based on <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>). By default <span class="math inline">\(\alpha=0.025\)</span> and <span class="math inline">\(\beta=0.25\)</span>.</li>
</ul>
<p><span class="math display">\[CS(\alpha, \beta) = \frac{Q_{1-\alpha} - Q_{\alpha}}{Q_{1-\beta} - Q_{\beta}}-c\]</span></p>
<ul>
<li><code>:hogg</code>: Based on trimmed means <span class="math inline">\(U_p\)</span> (mean of top <span class="math inline">\(p\%\)</span>) and <span class="math inline">\(L_p\)</span> (mean of bottom <span class="math inline">\(p\%\)</span>) and centered by subtracting <span class="math inline">\(2.585\)</span>. By default <span class="math inline">\(\alpha=0.005\)</span> and <span class="math inline">\(\beta=0.5\)</span>.</li>
</ul>
<p><span class="math display">\[K_H(\alpha, \beta) = \frac{U_{\alpha} - L_{\alpha}}{U_{\beta} - L_{\beta}}-2.585\]</span></p>
<ul>
<li><code>:l-kurtosis</code>: L-moments based kurtosis.</li>
</ul>
<p><span class="math display">\[\tau_4 = \lambda_4 / \lambda_2\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb46"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar) <span class="co">;; =&gt; 3.4698201025636317</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:G2</span>) <span class="co">;; =&gt; 3.4698201025636317</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:g1</span>) <span class="co">;; =&gt; 3.4698201025636317</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:excess</span>) <span class="co">;; =&gt; 3.4650542966048463</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:kurt</span>) <span class="co">;; =&gt; 6.465054296604846</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:b2</span>) <span class="co">;; =&gt; 3.4624146909177034</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:geary</span>) <span class="co">;; =&gt; 0.8336299967214688</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:moors</span>) <span class="co">;; =&gt; -0.35495121951219544</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:crow</span>) <span class="co">;; =&gt; -0.8936518297189449</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar [<span class="at">:crow</span> <span class="fl">0.05</span> <span class="fl">0.25</span>]) <span class="co">;; =&gt; -0.6581758315571915</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:hogg</span>) <span class="co">;; =&gt; -0.5329102382273203</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar [<span class="at">:hogg</span> <span class="fl">0.025</span> <span class="fl">0.45</span>]) <span class="co">;; =&gt; -0.5505736317691476</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:l-kurtosis</span>) <span class="co">;; =&gt; 0.02007386147996773</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Effect of an outlier is visible for moment based kurtosis, while has no effect when robust method is used.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb47"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis (<span class="kw">conj</span> residual-sugar -<span class="dv">1000</span> <span class="dv">1000</span>)) <span class="co">;; =&gt; 2167.8435026710868</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis (<span class="kw">conj</span> residual-sugar -<span class="dv">1000</span> <span class="dv">1000</span>) <span class="at">:l-kurtosis</span>) <span class="co">;; =&gt; 0.1447670840462904</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="l-moment" class="level3">
<h3 class="anchored" data-anchor-id="l-moment">L-moment</h3>
<p>L-moments are summary statistics analogous to conventional moments but are computed from linear combinations of order statistics (sorted data). They are more robust to outliers and provide better estimates for small samples compared to conventional moments.</p>
<ul>
<li><code>l-moment vs order</code>: Calculates the L-moment of a specific <code>order</code>.
<ul>
<li><span class="math inline">\(\lambda_1\)</span>: L-location (identical to the mean).</li>
<li><span class="math inline">\(\lambda_2\)</span>: L-scale (a measure of dispersion).</li>
<li>Higher orders relate to shape.</li>
</ul></li>
<li>Trimmed L-moments (TL-moments) can be calculated by specifying <code>:s</code> (left trim) and <code>:t</code> (right trim) as number of trimmed samples</li>
<li>L-moment Ratios: If <code>:ratio? true</code>, normalized L-moments are returned.
<ul>
<li><span class="math inline">\(\tau_3 = \lambda_3 / \lambda_2\)</span>: Coefficient of L-skewness (same as <code>(stats/skewness vs :l-skewness)</code>).</li>
<li><span class="math inline">\(\tau_4 = \lambda_4 / \lambda_2\)</span>: Coefficient of L-kurtosis (same as <code>(stats/kurtosis vs :l-kurtosis)</code>).</li>
</ul></li>
</ul>
<p>L-moments often provide more reliable inferences about the underlying distribution shape, especially when data may contain outliers or come from heavy-tailed distributions.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb48"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>(stats/l-moment mpg <span class="dv">1</span>) <span class="co">;; =&gt; 20.090624999999996</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>(stats/mean mpg) <span class="co">;; =&gt; 20.090625</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>(stats/l-moment mpg <span class="dv">2</span>) <span class="co">;; =&gt; 3.3980846774193565</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>(stats/l-moment mpg <span class="dv">3</span>) <span class="co">;; =&gt; 0.534375</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>(stats/l-moment residual-sugar <span class="dv">3</span>) <span class="co">;; =&gt; 0.6185370660798765</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>(stats/l-moment residual-sugar <span class="dv">3</span> {<span class="at">:s</span> <span class="dv">10</span>}) <span class="co">;; =&gt; 0.3017960335908669</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>(stats/l-moment residual-sugar <span class="dv">3</span> {<span class="at">:t</span> <span class="dv">10</span>}) <span class="co">;; =&gt; 0.029252613288362147</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>(stats/l-moment residual-sugar <span class="dv">3</span> {<span class="at">:s</span> <span class="dv">10</span>, <span class="at">:t</span> <span class="dv">10</span>}) <span class="co">;; =&gt; 0.003909359312292547</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Relation to skewness and kurtosis</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb49"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>(stats/l-moment residual-sugar <span class="dv">3</span> {<span class="at">:ratio</span>? <span class="va">true</span>}) <span class="co">;; =&gt; 0.22296648073302056</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:l-skewness</span>) <span class="co">;; =&gt; 0.22296648073302056</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>(stats/l-moment residual-sugar <span class="dv">4</span> {<span class="at">:ratio</span>? <span class="va">true</span>}) <span class="co">;; =&gt; 0.02007386147996773</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:l-kurtosis</span>) <span class="co">;; =&gt; 0.02007386147996773</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="intervals-and-extents" class="level2">
<h2 class="anchored" data-anchor-id="intervals-and-extents">Intervals and Extents</h2>
<p>This section provides functions to describe the spread or define specific ranges and intervals within a dataset.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>span</code>, <code>iqr</code></li>
<li><code>extent</code>,</li>
<li><code>stddev-extent</code>, <code>mad-extent</code>, <code>sem-extent</code></li>
<li><code>percentile-extent</code>, <code>quantile-extent</code></li>
<li><code>pi</code>, <code>pi-extent</code></li>
<li><code>hpdi-extent</code></li>
<li><code>adjacent-values</code></li>
<li><code>inner-fence-extent</code>, <code>outer-fence-extent</code></li>
<li><code>percentile-bc-extent</code>, <code>percentile-bca-extent</code></li>
<li><code>ci</code></li>
</ul>
</div>
</div>
<ul>
<li><p><strong>Basic Range:</strong> Functions like <code>span</code> (<span class="math inline">\(max - min\)</span>) and <code>extent</code> (providing <span class="math inline">\([min, max]\)</span> and optionally the mean) offer simple measures of the total spread of the data.</p></li>
<li><p><strong>Interquartile Range:</strong> <code>iqr</code> (<span class="math inline">\(Q_3 - Q_1\)</span>) specifically measures the spread of the middle 50% of the data, providing a robust alternative to the total range.</p></li>
<li><p><strong>Symmetric Spread Intervals:</strong> Functions ending in <code>-extent</code> such as <code>stddev-extent</code>, <code>mad-extent</code>, and <code>sem-extent</code> define intervals typically centered around the mean or median. They represent a range defined by adding/subtracting a multiple (usually 1) of a measure of dispersion (Standard Deviation, Median Absolute Deviation, or Standard Error of the Mean) from the central point.</p></li>
<li><p><strong>Quantile-Based Intervals:</strong> <code>percentile-extent</code>, <code>quantile-extent</code>, <code>pi</code>, <code>pi-extent</code>, and <code>hpdi-extent</code> define intervals based on quantiles or percentiles of the data. These functions capture specific ranges containing a certain percentage of the data points (e.g., the middle 95% defined by quantiles 0.025 and 0.975). <code>hpdi-extent</code> calculates the shortest interval containing a given proportion of data, based on empirical density.</p></li>
<li><p><strong>Box Plot Boundaries:</strong> <code>adjacent-values</code> (LAV, UAV) and fence functions (<code>inner-fence-extent</code>, <code>outer-fence-extent</code>) calculate specific bounds based on quartiles and multiples of the IQR. These are primarily used in box plot visualization and as a conventional method for identifying potential outliers.</p></li>
<li><p><strong>Confidence and Prediction Intervals:</strong> <code>ci</code>, <code>percentile-bc-extent</code>, and <code>percentile-bca-extent</code> provide inferential intervals. <code>ci</code> estimates a confidence interval for the population mean using the t-distribution. <code>percentile-bc-extent</code> and <code>percentile-bca-extent</code> (Bias-Corrected and Bias-Corrected Accelerated) are advanced bootstrap methods for estimating confidence intervals for statistics, offering robustness against non-normality and bias.</p></li>
</ul>
<p>Note that:</p>
<ul>
<li><span class="math inline">\(IQR = Q_3-Q_1\)</span></li>
<li><span class="math inline">\(LIF=Q_1-1.5 \times IQR\)</span></li>
<li><span class="math inline">\(UIF=Q_3+1.5 \times IQR\)</span></li>
<li><span class="math inline">\(LOF=Q_1-3\times IQR\)</span></li>
<li><span class="math inline">\(UOF=Q_3+3\times IQR\)</span></li>
<li><span class="math inline">\(CI=\bar{x} \pm t_{\alpha/2, n-1} \frac{s}{\sqrt{n}}\)</span></li>
</ul>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Function</th>
<th data-quarto-table-cell-role="th">Returned value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>span</code></td>
<td><span class="math inline">\(max-min\)</span></td>
</tr>
<tr class="even">
<td><code>iqr</code></td>
<td><span class="math inline">\(Q_3-Q_1\)</span></td>
</tr>
<tr class="odd">
<td><code>extent</code></td>
<td><code>[min, max, mean]</code> or <code>[min, max]</code> (when <code>:mean?</code> is <code>false</code>)</td>
</tr>
<tr class="even">
<td><code>stddev-extent</code></td>
<td><code>[mean - stddev, mean + stddev, mean]</code></td>
</tr>
<tr class="odd">
<td><code>mad-extent</code></td>
<td><code>[median - mad, median + mad, median]</code></td>
</tr>
<tr class="even">
<td><code>sem-extent</code></td>
<td><code>[mean - sem, mean + sem, mean]</code></td>
</tr>
<tr class="odd">
<td><code>percentile-extent</code></td>
<td><code>[p1-val, p2-val, median]</code> with default <code>p1=25</code> and <code>p2=75</code></td>
</tr>
<tr class="even">
<td><code>quantile-extent</code></td>
<td><code>[q1-val, q2-val, median]</code> with default <code>q1=0.25</code> and <code>q2=0.75</code></td>
</tr>
<tr class="odd">
<td><code>pi</code></td>
<td><code>{p1 p1-val p2 p2-val}</code> defined by <code>size=p2-p1</code></td>
</tr>
<tr class="even">
<td><code>pi-extent</code></td>
<td><code>[p1-val, p2-val, median]</code> defined by <code>size=p2-p1</code></td>
</tr>
<tr class="odd">
<td><code>hdpi-extent</code></td>
<td><code>[p1-val, p2-val, median]</code> defined by <code>size=p2-p1</code></td>
</tr>
<tr class="even">
<td><code>adjacent-values</code></td>
<td><code>[LAV, UAV, median]</code></td>
</tr>
<tr class="odd">
<td><code>inner-fence-extent</code></td>
<td><code>[LIF, UIF, median]</code></td>
</tr>
<tr class="even">
<td><code>outer-fence-extent</code></td>
<td><code>[LOF, UOF, median]</code></td>
</tr>
<tr class="odd">
<td><code>ci</code></td>
<td><code>[lower upper mean]</code></td>
</tr>
<tr class="even">
<td><code>percentile-bc-extent</code></td>
<td><code>[lower upper mean]</code></td>
</tr>
<tr class="odd">
<td><code>percentile-bca-extent</code></td>
<td><code>[lower upper mean]</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb50"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(stats/span mpg) <span class="co">;; =&gt; 23.5</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>(stats/iqr mpg) <span class="co">;; =&gt; 7.525000000000002</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>(stats/extent mpg) <span class="co">;; =&gt; #vec3 [10.4, 33.9, 20.090625]</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>(stats/extent mpg <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [10.4, 33.9]</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>(stats/stddev-extent mpg) <span class="co">;; =&gt; [14.063676947910896 26.117573052089103 20.090625]</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>(stats/mad-extent mpg) <span class="co">;; =&gt; [15.549999999999999 22.85 19.2]</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>(stats/sem-extent mpg) <span class="co">;; =&gt; [19.025201040627184 21.156048959372814 20.090625]</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>(stats/percentile-extent mpg) <span class="co">;; =&gt; [15.274999999999999 22.8 19.2]</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>(stats/percentile-extent mpg <span class="fl">2.5</span> <span class="fl">97.5</span>) <span class="co">;; =&gt; [10.4 33.9 19.2]</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>(stats/percentile-extent mpg <span class="fl">2.5</span> <span class="fl">97.5</span> <span class="at">:r9</span>) <span class="co">;; =&gt; [10.4 33.628125 19.2]</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>(stats/quantile-extent mpg) <span class="co">;; =&gt; [15.274999999999999 22.8 19.2]</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>(stats/quantile-extent mpg <span class="fl">0.025</span> <span class="fl">0.975</span>) <span class="co">;; =&gt; [10.4 33.9 19.2]</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>(stats/quantile-extent mpg <span class="fl">0.025</span> <span class="fl">0.975</span> <span class="at">:r9</span>) <span class="co">;; =&gt; [10.4 33.628125 19.2]</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>(stats/pi mpg <span class="fl">0.95</span>) <span class="co">;; =&gt; {2.5 10.4, 97.5 33.9}</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>(stats/pi-extent mpg <span class="fl">0.95</span>) <span class="co">;; =&gt; [10.4 33.9 19.2]</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>(stats/hpdi-extent mpg <span class="fl">0.95</span>) <span class="co">;; =&gt; [10.4 32.4 19.2]</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>(stats/adjacent-values mpg) <span class="co">;; =&gt; [10.4 33.9 19.2]</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>(stats/inner-fence-extent mpg) <span class="co">;; =&gt; [3.9874999999999954 34.087500000000006 19.2]</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>(stats/outer-fence-extent mpg) <span class="co">;; =&gt; [-7.300000000000008 45.37500000000001 19.2]</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>(stats/ci mpg) <span class="co">;; =&gt; [17.917678508746246 22.263571491253753 20.090625]</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>(stats/ci mpg <span class="fl">0.1</span>) <span class="co">;; =&gt; [18.284178665508097 21.8970713344919 20.090625]</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>(stats/percentile-bc-extent mpg) <span class="co">;; =&gt; [10.4 33.9 20.090625]</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>(stats/percentile-bc-extent mpg <span class="fl">10.0</span>) <span class="co">;; =&gt; [14.85121570396848 32.66635783408668 20.090625]</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>(stats/percentile-bca-extent mpg) <span class="co">;; =&gt; [10.4 33.9 20.090625]</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>(stats/percentile-bca-extent mpg <span class="fl">10.0</span>) <span class="co">;; =&gt; [14.79162798537463 32.44980004741413 20.090625]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/12.png">
</div>
</section>
<section id="outlier-detection" class="level2">
<h2 class="anchored" data-anchor-id="outlier-detection">Outlier Detection</h2>
<p>Outlier detection involves identifying data points that are significantly different from other observations. Outliers can distort statistical analyses and require careful handling. <code>fastmath.stats</code> provides functions to find and optionally remove such values based on the Interquartile Range (IQR) method.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>outliers</code></li>
</ul>
</div>
</div>
<p><code>outliers</code> function use the inner fence rule based on the IQR and returns a sequence containing only the data points identified as outliers.</p>
<ul>
<li><strong>Lower Inner Fence (LIF):</strong> <span class="math inline">\(Q_1 - 1.5 \times IQR\)</span></li>
<li><strong>Upper Inner Fence (UIF):</strong> <span class="math inline">\(Q_3 + 1.5 \times IQR\)</span></li>
</ul>
<p>Where <span class="math inline">\(Q_1\)</span> is the first quartile (25th percentile) and <span class="math inline">\(Q_3\)</span> is the third quartile (75th percentile). Points falling below the LIF or above the UIF are considered outliers.</p>
<p>Function accepts an optional <code>estimation-strategy</code> keyword (see [<a href="#quantile">quantile</a>]) to control how quartiles are calculated, which affects the fence boundaries.</p>
<p>Let’s find the outliers in the <code>residual-sugar</code> data.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb51"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>(stats/outliers residual-sugar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb52"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">23.5</span> <span class="fl">31.6</span> <span class="fl">31.6</span> <span class="fl">65.8</span> <span class="fl">26.05</span> <span class="fl">26.05</span> <span class="fl">22.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-transformation" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation">Data Transformation</h2>
<p>Functions to modify data (scaling, normalizing, transforming).</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>standardize</code>, <code>robust-standardize</code>, <code>demean</code></li>
<li><code>rescale</code></li>
<li><code>remove-outliers</code></li>
<li><code>trim</code>, <code>trim-lower</code>, <code>trim-upper</code>, <code>winsor</code></li>
<li><code>box-cox-infer-lambda</code>, <code>box-cox-transformation</code></li>
<li><code>yeo-johnson-infer-lambda</code>, <code>yeo-johnson-transformation</code></li>
</ul>
</div>
</div>
<p>Data transformations are often necessary preprocessing steps in statistical analysis and machine learning. They can help meet the assumptions of certain models (e.g., normality, constant variance), improve interpretability, or reduce the influence of outliers. <code>fastmath.stats</code> offers several functions for these purposes, broadly categorized into linear scaling/centering, outlier handling, and power transformations for normality.</p>
<p>Let’s demonstrate some of these transformations using the <code>residual-sugar</code> data from the wine quality dataset.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb53"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar) <span class="co">;; =&gt; 6.391414863209474</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar) <span class="co">;; =&gt; 5.072057784014863</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar) <span class="co">;; =&gt; 5.2</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar) <span class="co">;; =&gt; 3.6</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [0.6, 65.8]</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>(<span class="kw">count</span> residual-sugar) <span class="co">;; =&gt; 4898</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/13.png">
</div>
<p><strong>Linear Transformations:</strong> <code>standardize</code>, <code>robust-standardize</code>, <code>demean</code>, and <code>rescale</code> linearly transform data, preserving its shape but changing its location and/or scale.</p>
<ul>
<li><code>demean</code> centers the data by subtracting the mean, resulting in a dataset with a mean of zero.</li>
<li><code>standardize</code> scales the demeaned data by dividing by the standard deviation, resulting in data with mean zero and standard deviation one (z-score normalization). This makes the scale of different features comparable.</li>
<li><code>robust-standardize</code> provides a version less sensitive to outliers by centering around the median and scaling by the Median Absolute Deviation (MAD) or a quantile range (like the IQR).</li>
<li><code>rescale</code> linearly maps the data to a specific target range (e.g., [0, 1]), useful for algorithms sensitive to input scale.</li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb54"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-demeaned </span>(<span class="kw">-&gt;</span> residual-sugar stats/demean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb55"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-standardized </span>(<span class="kw">-&gt;</span> residual-sugar stats/standardize))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb56"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-robust-standardized </span>(<span class="kw">-&gt;</span> residual-sugar stats/robust-standardize))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb57"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-rescaled </span>(<span class="kw">-&gt;</span> residual-sugar stats/rescale))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb58"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-demeaned) <span class="co">;; =&gt; -3.2386416038881656E-16</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-demeaned) <span class="co">;; =&gt; 5.072057784014863</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-demeaned) <span class="co">;; =&gt; -1.1914148632094737</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-demeaned) <span class="co">;; =&gt; 3.5999999999999996</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-demeaned <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [-5.791414863209474, 59.40858513679052]</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-standardized) <span class="co">;; =&gt; -1.5386267642212256E-16</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-standardized) <span class="co">;; =&gt; 1.0000000000000004</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-standardized) <span class="co">;; =&gt; -0.23489773065368974</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-standardized) <span class="co">;; =&gt; 0.7097710935679375</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-standardized <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [-1.1418274613238324, 11.712915677739927]</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-robust-standardized) <span class="co">;; =&gt; 0.3309485731137426</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-robust-standardized) <span class="co">;; =&gt; 1.4089049400041327</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-robust-standardized) <span class="co">;; =&gt; 0.0</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-robust-standardized) <span class="co">;; =&gt; 1.0</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-robust-standardized <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [-1.277777777777778, 16.833333333333332]</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-rescaled) <span class="co">;; =&gt; 0.0888253813375686</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-rescaled) <span class="co">;; =&gt; 0.07779229730084207</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-rescaled) <span class="co">;; =&gt; 0.07055214723926381</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-rescaled) <span class="co">;; =&gt; 0.055214723926380375</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-rescaled <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [0.0, 1.0]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Outlier Handling:</strong> <code>remove-outliers</code>, <code>trim</code>, <code>trim-lower</code>, <code>trim-upper</code>, and <code>winsor</code> address outliers based on quantile fences.</p>
<ul>
<li><code>remove-outliers</code> returns a sequence containing the data points from the original sequence <em>excluding</em> those identified as outliers.</li>
<li><code>trim</code> removes values outside a specified quantile range (defaulting to 0.2 quantile, removing the bottom and top 20%). <code>trim-lower</code> and <code>trim-upper</code> remove only below or above a single quantile.</li>
<li><code>winsor</code> caps values outside a quantile range to the boundary values instead of removing them. This retains the sample size but reduces the influence of extreme values.</li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb59"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-no-outliers </span>(stats/remove-outliers residual-sugar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb60"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-trimmed </span>(stats/trim residual-sugar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb61"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-winsorized </span>(stats/winsor residual-sugar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb62"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-no-outliers) <span class="co">;; =&gt; 6.354109589041096</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-no-outliers) <span class="co">;; =&gt; 4.950545246813552</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-no-outliers) <span class="co">;; =&gt; 5.2</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-no-outliers) <span class="co">;; =&gt; 3.6</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-no-outliers <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [0.6, 22.0]</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>(<span class="kw">count</span> residual-sugar-no-outliers) <span class="co">;; =&gt; 4891</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-trimmed) <span class="co">;; =&gt; 5.27940414507772</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-trimmed) <span class="co">;; =&gt; 2.9594599192772546</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-trimmed) <span class="co">;; =&gt; 5.0</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-trimmed) <span class="co">;; =&gt; 2.7</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-trimmed <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [1.5, 11.2]</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>(<span class="kw">count</span> residual-sugar-trimmed) <span class="co">;; =&gt; 3088</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-winsorized) <span class="co">;; =&gt; 5.789893834218048</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-winsorized) <span class="co">;; =&gt; 3.8241868005472104</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-winsorized) <span class="co">;; =&gt; 5.2</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-winsorized) <span class="co">;; =&gt; 3.6</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>(stats/quantiles residual-sugar [<span class="fl">0.2</span> <span class="fl">0.8</span>]) <span class="co">;; =&gt; [1.5 11.2]</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-winsorized <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [1.5, 11.2]</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>(<span class="kw">count</span> residual-sugar-winsorized) <span class="co">;; =&gt; 4898</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/14.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/15.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/16.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Power Transformations:</strong> <code>box-cox-transformation</code> and <code>yeo-johnson-transformation</code> (and their <code>infer-lambda</code> counterparts) are non-linear transformations that can change the shape of the distribution to be more symmetric or normally distributed. They are particularly useful for data that is skewed or violates assumptions of linear models. Both are invertable.</p>
<ul>
<li><code>box-cox-transformation</code> works in general for strictly positive data. It includes the log transformation as a special case (when lambda is <span class="math inline">\(0.0\)</span>) and generalizes square root, reciprocal, and other power transformations. <code>box-cox-infer-lambda</code> helps find the optimal lambda parameter. Optional parameters:
<ul>
<li><code>:negative?</code> (default: <code>false</code>), when set to <code>true</code> specific transformation is performed to keep information about sign.</li>
<li><code>:scaled?</code> (default: <code>false</code>), when set to <code>true</code>, scale data by geometric mean, when is a number, this number is used as a scale.</li>
</ul></li>
</ul>
<p><span class="math display">\[y_{BC}^{(\lambda)}=\begin{cases}
\frac{y^\lambda-1}{\lambda} &amp; \lambda\neq 0 \\
\log(y) &amp; \lambda = 0
\end{cases}\]</span></p>
<p>Scaled version, with default scale set to geometric mean (GM):</p>
<p><span class="math display">\[y_{BC}^{(\lambda, s)}=\begin{cases}
\frac{y^\lambda-1}{\lambda s^{\lambda - 1}} &amp; \lambda\neq 0 \\
s\log(y) &amp; \lambda = 0
\end{cases}\]</span></p>
<p>When <code>:negative?</code> is set to true, formula takes the following form:</p>
<p><span class="math display">\[y_{BCneg}^{(\lambda)}=\begin{cases}
\frac{\operatorname{sgn}(y)|y|^\lambda-1}{\lambda} &amp; \lambda\neq 0 \\
\operatorname{sgn}(y)\log(|y|+1) &amp; \lambda = 0
\end{cases}\]</span></p>
<ul>
<li><code>yeo-johnson-transformation</code> extends Box-Cox to handle zero and negative values. <code>yeo-johnson-infer-lambda</code> finds the optimal lambda for this transformation.</li>
</ul>
<p><span class="math display">\[y_{YJ}^{(\lambda)}=\begin{cases}
\frac{(y+1)^\lambda - 1}{\lambda} &amp; \lambda \neq 0, y\geq 0 \\
\log(y+1) &amp; \lambda = 0, y\geq 0 \\
\frac{(1-y)^{2-\lambda} - 1}{\lambda - 2} &amp; \lambda \neq 2, y\geq 0 \\
-\log(1-y) &amp; \lambda = 2, y\geq 0  
\end{cases}\]</span></p>
<p>Both fuctions accept additional parameters:</p>
<ul>
<li><code>:alpha</code> (dafault: <code>0.0</code>): perform dataset shift by value of the <code>:alpha</code> before transformation.</li>
<li><code>:inversed?</code> (default: <code>false</code>): perform inverse transformation for given <code>lambda</code>.</li>
</ul>
<p>When <code>lambda</code> is set to <code>nil</code> optimal lambda will be calculated (only when <code>:inversed?</code> is <code>false</code>).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb63"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] <span class="fl">0.0</span>) <span class="co">;; =&gt; (##-Inf 0.0 2.302585092994046)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] <span class="fl">2.0</span>) <span class="co">;; =&gt; (-0.5 0.0 49.5)</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] -<span class="fl">2.0</span> {<span class="at">:alpha</span> <span class="dv">2</span>}) <span class="co">;; =&gt; (0.375 0.4444444444444444 0.4965277777777778)</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [<span class="fl">0.375</span> <span class="fl">0.444</span> <span class="fl">0.497</span>] -<span class="fl">2.0</span> {<span class="at">:alpha</span> <span class="dv">2</span>, <span class="at">:inverse</span>? <span class="va">true</span>}) <span class="co">;; =&gt; (0.0 0.9880715233359845 10.90994448735805)</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] <span class="va">nil</span> {<span class="at">:alpha</span> <span class="dv">1</span>}) <span class="co">;; =&gt; (-0.0 0.5989997131047903 1.493287747539177)</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] <span class="va">nil</span> {<span class="at">:scaled</span>? <span class="va">true</span>, <span class="at">:alpha</span> <span class="dv">1</span>}) <span class="co">;; =&gt; (-0.0 2.619403814271841 6.530092646346955)</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] <span class="va">nil</span> {<span class="at">:alpha</span> -<span class="dv">5</span>, <span class="at">:negative</span>? <span class="va">true</span>}) <span class="co">;; =&gt; (-42.0 -21.666666666666668 41.333333333333336)</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] <span class="fl">2.0</span> {<span class="at">:alpha</span> -<span class="dv">5</span>, <span class="at">:negative</span>? <span class="va">true</span>, <span class="at">:scaled</span>? <span class="dv">2</span>}) <span class="co">;; =&gt; (-6.5 -4.25 6.0)</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-transformation [-<span class="fl">6.5</span> -<span class="fl">4.25</span> <span class="fl">6.0</span>] <span class="fl">2.0</span> {<span class="at">:alpha</span> -<span class="dv">5</span>, <span class="at">:negative</span>? <span class="va">true</span>, <span class="at">:scaled</span>? <span class="dv">2</span>, <span class="at">:inverse</span>? <span class="va">true</span>}) <span class="co">;; =&gt; (0.0 1.0 10.0)</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>(stats/yeo-johnson-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>]) <span class="co">;; =&gt; (-0.0 0.5989997131047903 1.493287747539177)</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>(stats/yeo-johnson-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] <span class="fl">0.0</span>) <span class="co">;; =&gt; (0.0 0.6931471805599453 2.3978952727983707)</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>(stats/yeo-johnson-transformation [<span class="dv">0</span> <span class="dv">1</span> <span class="dv">10</span>] <span class="fl">2.0</span> {<span class="at">:alpha</span> -<span class="dv">5</span>}) <span class="co">;; =&gt; (-1.791759469228055 -1.6094379124341003 17.5)</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>(stats/yeo-johnson-transformation [-<span class="fl">1.79</span> -<span class="fl">1.61</span> <span class="fl">17.5</span>] <span class="fl">2.0</span> {<span class="at">:alpha</span> -<span class="dv">5</span>, <span class="at">:inverse</span>? <span class="va">true</span>}) <span class="co">;; =&gt; (0.010547533616885651 0.9971887721664103 10.0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Let’s illustrate how real data look after transformation. We’ll start with finding an optimal lambda parameter for both transformations.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb64"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-infer-lambda residual-sugar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb65"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.12450565747077313</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb66"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>(stats/yeo-johnson-infer-lambda residual-sugar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb67"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>-<span class="fl">0.004232775028107413</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb68"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-box-cox </span>(stats/box-cox-transformation residual-sugar <span class="va">nil</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb69"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-yeo-johnson </span>(stats/yeo-johnson-transformation residual-sugar <span class="va">nil</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb70"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-box-cox) <span class="co">;; =&gt; 1.6895596029306466</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-box-cox) <span class="co">;; =&gt; 1.1032589652895741</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-box-cox) <span class="co">;; =&gt; 1.83006349249072</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-box-cox) <span class="co">;; =&gt; 1.0527777588806666</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-box-cox <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [-0.4949201739139414, 5.494888687185149]</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-yeo-johnson) <span class="co">;; =&gt; 1.7445922710465025</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-yeo-johnson) <span class="co">;; =&gt; 0.7180340465417893</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-yeo-johnson) <span class="co">;; =&gt; 1.8175219821484885</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-yeo-johnson) <span class="co">;; =&gt; 0.6888246769156978</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-yeo-johnson <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [0.46953642189900135, 4.164560241279393]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/17.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/18.png" class="clay-image img-fluid"></td>
</tr>
<tr class="even">
<td><img src="stats_files/19.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/20.png" class="clay-image img-fluid"></td>
</tr>
<tr class="odd">
<td><img src="stats_files/21.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/22.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As you can see, the Yeo-Johnson transformation with the inferred lambda has made the <code>residual-sugar</code> distribution appear more symmetric and perhaps closer to a normal distribution shape.</p>
<p>Both power transformation can work on negative data as well. When Box-Cox is used, <code>:negative?</code> option should be set to <code>true</code>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb71"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>(stats/box-cox-infer-lambda residual-sugar</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                            <span class="va">nil</span> {<span class="at">:alpha</span> (<span class="kw">-</span> (stats/mean residual-sugar)) <span class="at">:negative</span>? <span class="va">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb72"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1.0967709597378346</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb73"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>(stats/yeo-johnson-infer-lambda residual-sugar <span class="va">nil</span> {<span class="at">:alpha</span> (<span class="kw">-</span> (stats/mean residual-sugar))})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb74"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.7290829398083033</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb75"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-box-cox-demeaned</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  (stats/box-cox-transformation</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>   residual-sugar <span class="va">nil</span> {<span class="at">:alpha</span> (<span class="kw">-</span> (stats/mean residual-sugar)) <span class="at">:negative</span>? <span class="va">true</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb76"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residual-sugar-yeo-johnson-demeaned </span>(stats/yeo-johnson-transformation</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                                        residual-sugar <span class="va">nil</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                                        {<span class="at">:alpha</span> (<span class="kw">-</span> (stats/mean residual-sugar))}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb77"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-box-cox-demeaned) <span class="co">;; =&gt; -0.817408751945805</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-box-cox-demeaned) <span class="co">;; =&gt; 5.608979218510315</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-box-cox-demeaned) <span class="co">;; =&gt; -2.0166286943919243</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-box-cox-demeaned) <span class="co">;; =&gt; 3.9790383049427582</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-box-cox-demeaned <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [-7.1704674516316125, 79.51310067615422]</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>(stats/mean residual-sugar-yeo-johnson-demeaned) <span class="co">;; =&gt; -1.3556628530573829</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>(stats/stddev residual-sugar-yeo-johnson-demeaned) <span class="co">;; =&gt; 4.783153826599674</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>(stats/median residual-sugar-yeo-johnson-demeaned) <span class="co">;; =&gt; -1.3457965294079925</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>(stats/mad residual-sugar-yeo-johnson-demeaned) <span class="co">;; =&gt; 4.669926884717297</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>(stats/extent residual-sugar-yeo-johnson-demeaned <span class="va">false</span>) <span class="co">;; =&gt; #vec2 [-8.192317681811963, 25.905106824581896]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/23.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/24.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="correlation-and-covariance" class="level2">
<h2 class="anchored" data-anchor-id="correlation-and-covariance">Correlation and Covariance</h2>
<p>Measures of the relationship between two or more variables.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>covariance</code>, <code>correlation</code></li>
<li><code>pearson-correlation</code>, <code>spearman-correlation</code>, <code>kendall-correlation</code></li>
<li><code>coefficient-matrix</code>, <code>correlation-matrix</code>, <code>covariance-matrix</code></li>
</ul>
</div>
</div>
<p><strong>Covariance vs.&nbsp;Correlation:</strong></p>
<ul>
<li><code>covariance</code> measures the extent to which two variables change together. A positive covariance means they tend to increase or decrease simultaneously. A negative covariance means one tends to increase when the other decreases. A covariance near zero suggests no linear relationship. The magnitude of covariance depends on the scales of the variables, making it difficult to compare covariances between different pairs of variables. The sample covariance between two sequences <span class="math inline">\(X = \{x_1, \dots, x_n\}\)</span> and <span class="math inline">\(Y = \{y_1, \dots, y_n\}\)</span> is calculated as:</li>
</ul>
<p><span class="math display">\[ \text{Cov}(X, Y) = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) \]</span></p>
<p>where <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are the sample means.</p>
<ul>
<li><code>correlation</code> standardizes the covariance, resulting in a unitless measure that ranges from -1 to +1. It indicates both the direction and strength of a relationship. A correlation of +1 indicates a perfect positive relationship, -1 a perfect negative relationship, and 0 no linear relationship. The <code>correlation</code> function in <code>fastmath.stats</code> defaults to computing the Pearson correlation coefficient.</li>
</ul>
<p><strong>Types of Correlation:</strong></p>
<ul>
<li><code>pearson-correlation</code>: The most common correlation coefficient, also known as the Pearson product-moment correlation coefficient (<span class="math inline">\(r\)</span>). It measures the strength and direction of a <em>linear</em> relationship between two continuous variables. It assumes the variables are approximately normally distributed and that the relationship is linear. It is sensitive to outliers. The formula for the sample Pearson correlation coefficient is:</li>
</ul>
<p><span class="math display">\[r = \frac{\text{Cov}(X, Y)}{s_x s_y} = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^n (x_i - \bar{x})^2 \sum_{i=1}^n (y_i - \bar{y})^2}}\]</span></p>
<p>where <span class="math inline">\(s_x\)</span> and <span class="math inline">\(s_y\)</span> are the sample standard deviations.</p>
<ul>
<li><code>spearman-correlation</code>: Spearman’s rank correlation coefficient (<span class="math inline">\(\rho\)</span>) is a non-parametric measure of the strength and direction of a <em>monotonic</em> relationship between two variables. A monotonic relationship is one that is either consistently increasing or consistently decreasing, but not necessarily linear. Spearman’s correlation is calculated by applying the Pearson formula to the <em>ranks</em> of the data values rather than the values themselves. This makes it less sensitive to outliers than Pearson correlation and suitable for ordinal data or when the relationship is monotonic but non-linear.</li>
<li><code>kendall-correlation</code>: Kendall’s Tau rank correlation coefficient (<span class="math inline">\(\tau\)</span>) is another non-parametric measure of the strength and direction of a <em>monotonic</em> relationship. It is based on the number of concordant and discordant pairs of observations. A pair of data points is concordant if their values move in the same direction (both increase or both decrease) relative to each other, and discordant if they move in opposite directions. Kendall’s Tau is generally preferred over Spearman’s Rho for smaller sample sizes or when there are many tied ranks. One common formulation, Kendall’s Tau-a, is:</li>
</ul>
<p><span class="math display">\[\tau_A = \frac{N_c - N_d}{n(n-1)/2}\]</span></p>
<p>where <span class="math inline">\(N_c\)</span> is the number of concordant pairs and <span class="math inline">\(N_d\)</span> is the number of discordant pairs.</p>
<p><strong>Comparison of Correlation Methods:</strong></p>
<ul>
<li>Use <strong>Pearson</strong> for measuring <em>linear</em> relationships between continuous, normally distributed variables.</li>
<li>Use <strong>Spearman</strong> or <strong>Kendall</strong> for measuring <em>monotonic</em> relationships (linear or non-linear) between variables, especially when data is not normally distributed, contains outliers, or is ordinal. Kendall is often more robust with ties and smaller samples.</li>
</ul>
<p><strong>Matrix Functions for Multiple Variables:</strong></p>
<ul>
<li><code>coefficient-matrix</code>: A generic function that computes a specified pairwise measure (defined by a function passed as an argument) between all pairs of sequences in a collection. Useful for generating matrices of custom similarity, distance, or correlation measures.</li>
<li><code>covariance-matrix</code>: A specialization that computes the pairwise <code>covariance</code> for all sequences in a collection. The output is a symmetric matrix where the element at row <code>i</code>, column <code>j</code> is the covariance between sequence <code>i</code> and sequence <code>j</code>. The diagonal elements are the variances of the individual sequences.</li>
<li><code>correlation-matrix</code>: A specialization that computes the pairwise <code>correlation</code> (Pearson by default, or specified via keyword like <code>:spearman</code> or <code>:kendall</code>) for all sequences in a collection. The output is a symmetric matrix where the element at row <code>i</code>, column <code>j</code> is the correlation between sequence <code>i</code> and sequence <code>j</code>. The diagonal elements are always 1.0 (a variable is perfectly correlated with itself).</li>
</ul>
<p>Let’s examine the correlations between the numerical features in the <code>iris</code> dataset.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb78"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>(stats/covariance virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.03007346938775512</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>(stats/correlation virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.13417210385493564</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>(stats/pearson-correlation virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.1341721038549354</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>(stats/spearman-correlation virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.038837958926489176</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>(stats/kendall-correlation virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.030531668042830747</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>To generate matrices we’ll use three sepal lengths samples. The last two examples use custom measure function: Euclidean distance between samples and Glass’ delta.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb79"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>(stats/covariance-matrix (<span class="kw">vals</span> sepal-lengths)) <span class="co">;; =&gt; ([0.12424897959183674 -0.014710204081632658 0.03007346938775512] [-0.014710204081632658 0.2664326530612246 -0.04649795918367346] [0.03007346938775512 -0.04649795918367346 0.4043428571428573])</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>(stats/correlation-matrix (<span class="kw">vals</span> sepal-lengths)) <span class="co">;; =&gt; ([1.0 -0.08084972701756978 0.13417210385493492] [-0.08084972701756978 0.9999999999999999 -0.14166588513698952] [0.13417210385493492 -0.14166588513698952 1.0])</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>(stats/correlation-matrix (<span class="kw">vals</span> sepal-lengths) <span class="at">:kendall</span>) <span class="co">;; =&gt; ([1.0 -0.06357129445203882 0.030531668042830747] [-0.06357129445203882 1.0 -0.10454171307909799] [0.030531668042830747 -0.10454171307909799 1.0])</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>(stats/correlation-matrix (<span class="kw">vals</span> sepal-lengths) <span class="at">:spearman</span>) <span class="co">;; =&gt; ([1.0 -0.10163684956357029 0.03883795892648921] [-0.10163684956357029 1.0 -0.14067854670792204] [0.03883795892648921 -0.14067854670792204 1.0])</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>(stats/coefficient-matrix (<span class="kw">vals</span> sepal-lengths) stats/L2 <span class="va">true</span>) <span class="co">;; =&gt; ([0.0 7.989367934949548 12.16922347563722] [7.989367934949548 0.0 7.660287200882224] [12.16922347563722 7.660287200882224 0.0])</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>(stats/coefficient-matrix (<span class="kw">vals</span> sepal-lengths) stats/glass-delta) <span class="co">;; =&gt; ([0.0 -1.8017279836157427 -2.4878923883271122] [2.6383750609896146 0.0 -1.0253513509413892] [4.488074566113517 1.263146930448887 0.0])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="distance-and-similarity-metrics" class="level2">
<h2 class="anchored" data-anchor-id="distance-and-similarity-metrics">Distance and Similarity Metrics</h2>
<p>Measures of distance, error, or similarity between sequences or distributions.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>me</code>, <code>mae</code>, <code>mape</code></li>
<li><code>rss</code>, <code>mse</code>, <code>rmse</code></li>
<li><code>r2</code></li>
<li><code>count=</code>, <code>L0</code>, <code>L1</code>, <code>L2sq</code>, <code>L2</code>, <code>LInf</code></li>
<li><code>psnr</code></li>
<li><code>dissimilarity</code>, <code>similarity</code></li>
</ul>
</div>
</div>
<p>Distance metrics quantify how <em>far apart</em> or <em>different</em> two data sequences or probability distributions are. Similarity metrics, conversely, measure how <em>close</em> or <em>alike</em> they are, often being the inverse or a transformation of a distance. <code>fastmath.stats</code> provides a range of these measures suitable for comparing numerical sequences, observed counts (histograms), or theoretical probability distributions.</p>
<section id="error-metrics" class="level3">
<h3 class="anchored" data-anchor-id="error-metrics">Error Metrics</h3>
<p>These functions typically quantify the difference between an observed sequence and a predicted or reference sequence, focusing on the magnitude of errors. All can accept a constant as a second argument.</p>
<ul>
<li><code>me</code> (Mean Error): The average of the differences between corresponding elements. <span class="math display">\[ ME = \frac{1}{n} \sum_{i=1}^n (x_i - y_i) \]</span></li>
<li><code>mae</code> (Mean Absolute Error): The average of the absolute differences. More robust to outliers than squared error. <span class="math display">\[ MAE = \frac{1}{n} \sum_{i=1}^n |x_i - y_i| \]</span></li>
<li><code>mape</code> (Mean Absolute Percentage Error): The average of the absolute percentage errors. Useful for relative error assessment, but undefined if the reference value <span class="math inline">\(x_i\)</span> is zero. <span class="math display">\[ MAPE = \frac{1}{n} \sum_{i=1}^n \left| \frac{x_i - y_i}{x_i} \right| \times 100\% \]</span></li>
<li><code>rss</code> (Residual Sum of Squares): The sum of the squared differences. Used in least squares regression. <span class="math display">\[ RSS = \sum_{i=1}^n (x_i - y_i)^2 \]</span></li>
<li><code>mse</code> (Mean Squared Error): The average of the squared differences. Penalizes larger errors more heavily. <span class="math display">\[ MSE = \frac{1}{n} \sum_{i=1}^n (x_i - y_i)^2 \]</span></li>
<li><code>rmse</code> (Root Mean Squared Error): The square root of the MSE. Has the same units as the original data. <span class="math display">\[ RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^n (x_i - y_i)^2} \]</span></li>
<li><code>r2</code> (Coefficient of Determination): Measures the proportion of the variance in the dependent variable that is predictable from the independent variable(s). Calculated as <span class="math inline">\(1 - (RSS / TSS)\)</span>, where TSS is the Total Sum of Squares. It ranges from 0 to 1 for linear regression. <span class="math display">\[ R^2 = 1 - \frac{\sum (x_i - y_i)^2}{\sum (x_i - \bar{x})^2} \]</span></li>
<li>adjusted <code>r2</code>: A modified version of <span class="math inline">\(R^2\)</span> that has been adjusted for the number of predictors in the model. It increases only if the new term improves the model more than would be expected by chance. <span class="math display">\[ R^2_{adj} = 1 - (1 - R^2) \frac{n-1}{n-p-1} \]</span></li>
</ul>
<p>Let’s use <code>setosa-sepal-length</code> as observed and <code>virginica-sepal-length</code> as predicted (though they are independent samples, not predictions) to illustrate error measures.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb80"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>(stats/me setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; -1.582</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>(stats/mae setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 1.582</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>(stats/mape setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.3211321155719454</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>(stats/rss setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 148.09000000000006</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>(stats/mse setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 2.9618</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>(stats/rmse setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 1.720988088279521</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>(stats/r2 setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; -23.324102361946068</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>(stats/r2 setosa-sepal-length virginica-sepal-length <span class="dv">2</span>) <span class="co">;; =&gt; -24.359170547560794</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>(stats/r2 setosa-sepal-length virginica-sepal-length <span class="dv">5</span>) <span class="co">;; =&gt; -26.0882049030763</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Also we can compare an observed sequence to a constant value. For example to a mean of the virginica sepal length.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb81"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> vsl-mean </span>(stats/mean virginica-sepal-length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb82"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>(stats/me setosa-sepal-length vsl-mean) <span class="co">;; =&gt; -1.582</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>(stats/mae setosa-sepal-length vsl-mean) <span class="co">;; =&gt; 1.582</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>(stats/mape setosa-sepal-length vsl-mean) <span class="co">;; =&gt; 0.32244506843926823</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>(stats/rss setosa-sepal-length vsl-mean) <span class="co">;; =&gt; 131.2244000000001</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>(stats/mse setosa-sepal-length vsl-mean) <span class="co">;; =&gt; 2.6244880000000004</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>(stats/rmse setosa-sepal-length vsl-mean) <span class="co">;; =&gt; 1.6200271602661482</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>(stats/r2 setosa-sepal-length vsl-mean) <span class="co">;; =&gt; -20.55389113366842</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>(stats/r2 setosa-sepal-length vsl-mean <span class="dv">2</span>) <span class="co">;; =&gt; -21.471077990420266</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>(stats/r2 setosa-sepal-length vsl-mean <span class="dv">5</span>) <span class="co">;; =&gt; -23.003196944312556</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="distance-metrics-l-p-norms-and-others" class="level3">
<h3 class="anchored" data-anchor-id="distance-metrics-l-p-norms-and-others">Distance Metrics (L-p Norms and others)</h3>
<p>These functions represent common distance measures, often related to L-p norms between vectors (sequences).</p>
<ul>
<li><code>count=</code>, <code>L0</code>: Counts the number of elements that are <em>equal</em> in both sequences. While related to the L0 “norm” (which counts non-zero elements), this implementation counts <em>equal</em> elements after subtraction. <span class="math display">\[ Count= = \sum_{i=1}^n \mathbb{I}(x_i = y_i) \]</span></li>
<li><code>L1</code> (Manhattan/City Block Distance): The sum of the absolute differences. <span class="math display">\[ L_1 = \sum_{i=1}^n |x_i - y_i| \]</span></li>
<li><code>L2sq</code> (Squared Euclidean Distance): The sum of the squared differences. Equivalent to <code>rss</code>. <span class="math display">\[ L_2^2 = \sum_{i=1}^n (x_i - y_i)^2 \]</span></li>
<li><code>L2</code> (Euclidean Distance): The square root of the sum of the squared differences. The most common distance metric. <span class="math display">\[ L_2 = \sqrt{\sum_{i=1}^n (x_i - y_i)^2} \]</span></li>
<li><code>LInf</code> (Chebyshev Distance): The maximum absolute difference between corresponding elements. <span class="math display">\[ L_\infty = \max_{i} |x_i - y_i| \]</span></li>
<li><code>psnr</code> (Peak Signal-to-Noise Ratio): A measure of signal quality often used in image processing, derived from the MSE. Higher PSNR indicates better quality (less distortion). Calculated based on the maximum possible value of the data and the MSE. <span class="math display">\[ PSNR = 10 \cdot \log_{10} \left( \frac{MAX^2}{MSE} \right) \]</span></li>
</ul>
<p>Using the sepal length samples again:</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb83"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>(stats/count= setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 1</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>(stats/L0 setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 1</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>(stats/L1 setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 79.10000000000005</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>(stats/L2sq setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 148.09000000000006</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>(stats/L2 setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 12.16922347563722</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>(stats/LInf setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 3.1000000000000005</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>(stats/psnr setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 13.236984537937193</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="dissimilarity-and-similarity" class="level3">
<h3 class="anchored" data-anchor-id="dissimilarity-and-similarity">Dissimilarity and Similarity</h3>
<p><code>dissimilarity</code> and <code>similarity</code> functions provide measures for comparing probability distributions or frequency counts (like histograms). They quantify how ‘far apart’ or ‘alike’ two data sequences, interpreted as distributions, are. They take a method keyword specifying the desired measure. Many methods exist, each with different properties and interpretations. They can accept raw data sequences, automatically creating histograms for comparison (controlled by <code>:bins</code>), or they can take pre-calculated frequency sequences or a data sequence and a <code>fastmath.random</code> distribution object.</p>
<p>Parameters:</p>
<ul>
<li><code>method</code> - The specific distance or similarity method to use.</li>
<li><code>P-observed</code> - Frequencies, probabilities, or raw data (when <code>Q-expected</code> is a distribution or <code>:bins</code> is set).</li>
<li><code>Q-expected</code> - Frequencies, probabilities, or a distribution object (when <code>P-observed</code> is raw data or <code>:bins</code> is set).</li>
<li><code>opts</code> (map, optional) - Configuration options, including:
<ul>
<li><code>:probabilities?</code> (boolean, default: <code>true</code>): If <code>true</code>, input sequences are normalized to sum to 1.0 before calculating the measure, treating them as probability distributions.</li>
<li><code>:epsilon</code> (double, default: <code>1.0e-6</code>): A small number used to replace zero values in denominators or logarithms to avoid division-by-zero or log-of-zero errors.</li>
<li><code>:log-base</code> (double, default: <code>m/E</code>): The base for logarithms in information-theoretic measures.</li>
<li><code>:power</code> (double, default: <code>2.0</code>): The exponent for the <code>:minkowski</code> distance.</li>
<li><code>:remove-zeros?</code> (boolean, default: <code>false</code>): Removes pairs where both <code>P</code> and <code>Q</code> are zero before calculation.</li>
<li><code>:bins</code> (number, keyword, or seq): Used for comparisons involving raw data or distributions. Specifies the number of histogram bins, an estimation method (see [<a href="#histogram">histogram</a>]), or explicit bin edges for histogram creation.</li>
</ul></li>
</ul>
<section id="dissimilarity-methods" class="level4">
<h4 class="anchored" data-anchor-id="dissimilarity-methods">Dissimilarity Methods</h4>
<p>Higher values generally indicate greater difference.</p>
<ul>
<li><strong>L-p Norms and Related:</strong>
<ul>
<li><code>:euclidean</code>: Euclidean distance (<span class="math inline">\(L_2\)</span> norm) between the frequency/probability vectors. <span class="math display">\[ D(P, Q) = \sqrt{\sum_i (P_i - Q_i)^2} \]</span></li>
<li><code>:city-block</code> / <code>:manhattan</code>: Manhattan distance (<span class="math inline">\(L_1\)</span> norm). <span class="math display">\[ D(P, Q) = \sum_i |P_i - Q_i| \]</span></li>
<li><code>:chebyshev</code>: Chebyshev distance (<span class="math inline">\(L_\infty\)</span> norm), the maximum absolute difference. <span class="math display">\[ D(P, Q) = \max_i |P_i - Q_i| \]</span></li>
<li><code>:minkowski</code>: Minkowski distance (generalized <span class="math inline">\(L_p\)</span> norm, controlled by <code>:power</code>). <span class="math display">\[ D(P, Q) = \left(\sum_i |P_i - Q_i|^p\right)^{1/p} \]</span></li>
<li><code>:euclidean-sq</code> / <code>:squared-euclidean</code>: Squared Euclidean distance. <span class="math display">\[ D(P, Q) = \sum_i (P_i - Q_i)^2 \]</span></li>
<li><code>:squared-chord</code>: Squared chord distance, related to Hellinger distance. <span class="math display">\[ D(P, Q) = \sum_i (\sqrt{P_i} - \sqrt{Q_i})^2 \]</span></li>
</ul></li>
<li><strong>Set-based/Overlap:</strong> Measures derived from the concept of set overlap applied to frequencies/probabilities.
<ul>
<li><code>:sorensen</code>: Sorensen-Dice dissimilarity (1 - Dice similarity). <span class="math display">\[ D(P, Q) = \frac{\sum_i |P_i - Q_i|}{\sum_i (P_i + Q_i)} \]</span></li>
<li><code>:gower</code>: Gower distance (average Manhattan distance). <span class="math display">\[ D(P, Q) = \frac{1}{N} \sum_i |P_i - Q_i| \]</span></li>
<li><code>:soergel</code>: Soergel distance (1 - Jaccard similarity). <span class="math display">\[ D(P, Q) = \frac{\sum_i |P_i - Q_i|}{\sum_i \max(P_i, Q_i)} \]</span></li>
<li><code>:kulczynski</code>: Kulczynski dissimilarity (1 - Kulczynski similarity, can be &gt; 1). <span class="math display">\[ D(P, Q) = \frac{\sum_i |P_i - Q_i|}{\sum_i \min(P_i, Q_i)} \]</span></li>
<li><code>:canberra</code>: Canberra distance, sensitive to small values. <span class="math display">\[ D(P, Q) = \sum_i \frac{|P_i - Q_i|}{P_i + Q_i} \]</span></li>
<li><code>:lorentzian</code>: Lorentzian distance. <span class="math display">\[ D(P, Q) = \sum_i \ln(1 + |P_i - Q_i|) \]</span></li>
<li><code>:non-intersection</code>: Non-intersection measure. <span class="math display">\[ D(P, Q) = \frac{1}{2} \sum_i |P_i - Q_i| \]</span></li>
<li><code>:wave-hedges</code>: Wave Hedges distance. <span class="math display">\[ D(P, Q) = \sum_i \frac{|P_i - Q_i|}{\max(P_i, Q_i)} \]</span></li>
<li><code>:czekanowski</code>: Czekanowski dissimilarity (same as Sorensen).</li>
<li><code>:motyka</code>: Motyka dissimilarity. <span class="math display">\[ D(P, Q) = 1 - \frac{\sum_i \min(P_i, Q_i)}{\sum_i (P_i + Q_i)} \]</span></li>
<li><code>:tanimoto</code>: Tanimoto dissimilarity (extended Jaccard or Dice). <span class="math display">\[ D(P, Q) = \frac{\sum_i (\max(P_i, Q_i) - \min(P_i, Q_i))}{\sum_i \max(P_i, Q_i)} \]</span></li>
<li><code>:jaccard</code>: Jaccard dissimilarity (1 - Jaccard similarity). <span class="math display">\[ D(P, Q) = \frac{\sum_i (P_i - Q_i)^2}{\sum_i P_i^2 + \sum_i Q_i^2 - \sum_i P_i Q_i} \]</span></li>
<li><code>:dice</code>: Dice dissimilarity (1 - Dice similarity). <span class="math display">\[ D(P, Q) = \frac{\sum_i (P_i - Q_i)^2}{\sum_i P_i^2 + \sum_i Q_i^2} \]</span></li>
<li><code>:bhattacharyya</code>: Bhattacharyya distance. <span class="math display">\[ D(P, Q) = -\ln \left( \sum_i \sqrt{P_i Q_i} \right) \]</span></li>
<li><code>:hellinger</code>: Hellinger distance, derived from Bhattacharyya coefficient. <span class="math display">\[ D(P, Q) = \sqrt{2 \sum_i (\sqrt{P_i} - \sqrt{Q_i})^2} \]</span></li>
<li><code>:matusita</code>: Matusita distance. <span class="math display">\[ D(P, Q) = \sqrt{\sum_i (\sqrt{P_i} - \sqrt{Q_i})^2} \]</span></li>
</ul></li>
<li><strong>Chi-squared based:</strong>
<ul>
<li><code>:pearson-chisq</code> / <code>:chisq</code>: Pearson’s Chi-squared statistic. <span class="math display">\[ D(P, Q) = \sum_i \frac{(P_i - Q_i)^2}{Q_i} \]</span></li>
<li><code>:neyman-chisq</code>: Neyman’s Chi-squared statistic. <span class="math display">\[ D(P, Q) = \sum_i \frac{(P_i - Q_i)^2}{P_i} \]</span></li>
<li><code>:squared-chisq</code>: Squared Chi-squared distance. <span class="math display">\[ D(P, Q) = \sum_i \frac{(P_i - Q_i)^2}{P_i + Q_i} \]</span></li>
<li><code>:symmetric-chisq</code>: Symmetric Chi-squared distance. <span class="math display">\[ D(P, Q) = 2 \sum_i \frac{(P_i - Q_i)^2}{P_i + Q_i} \]</span></li>
<li><code>:divergence</code>: Divergence statistic. <span class="math display">\[ D(P, Q) = 2 \sum_i \frac{(P_i - Q_i)^2}{(P_i + Q_i)^2} \]</span></li>
<li><code>:clark</code>: Clark distance. <span class="math display">\[ D(P, Q) = \sqrt{\sum_i \left(\frac{P_i - Q_i}{P_i + Q_i}\right)^2} \]</span></li>
<li><code>:additive-symmetric-chisq</code>: Additive Symmetric Chi-squared distance. <span class="math display">\[ D(P, Q) = \sum_i \frac{(P_i - Q_i)^2 (P_i + Q_i)}{P_i Q_i} \]</span></li>
</ul></li>
<li><strong>Information Theory based (Divergences):</strong> Measure the difference in information content.
<ul>
<li><code>:kullback-leibler</code>: Kullback-Leibler divergence (not symmetric, <span class="math inline">\(KL(P||Q)\)</span>). <span class="math display">\[ D(P, Q) = \sum_i P_i \ln\left(\frac{P_i}{Q_i}\right) \]</span></li>
<li><code>:jeffreys</code>: Jeffreys divergence (symmetric KL). <span class="math display">\[ D(P, Q) = \sum_i (P_i - Q_i) \ln\left(\frac{P_i}{Q_i}\right) \]</span></li>
<li><code>:k-divergence</code>: K divergence (related to KL). <span class="math display">\[ D(P, Q) = \sum_i P_i \ln\left(\frac{2 P_i}{P_i + Q_i}\right) \]</span></li>
<li><code>:topsoe</code>: Topsoe divergence. <span class="math display">\[ D(P, Q) = \sum_i \left( P_i \ln\left(\frac{2 P_i}{P_i + Q_i}\right) + Q_i \ln\left(\frac{2 Q_i}{P_i + Q_i}\right) \right) \]</span></li>
<li><code>:jensen-shannon</code>: Jensen-Shannon divergence (symmetric, finite, based on KL). <span class="math display">\[ D(P, Q) = \frac{1}{2} \left( KL(P || M) + KL(Q || M) \right), \text{ where } M = \frac{P+Q}{2} \]</span></li>
<li><code>:jensen-difference</code>: Jensen difference divergence. <span class="math display">\[ D(P, Q) = \sum_i \left( \frac{P_i \ln P_i + Q_i \ln Q_i}{2} - \frac{(P_i+Q_i)}{2} \ln\left(\frac{P_i+Q_i}{2}\right) \right) \]</span></li>
<li><code>:taneja</code>: Taneja divergence. <span class="math display">\[ D(P, Q) = \sum_i \frac{P_i + Q_i}{2} \ln\left(\frac{(P_i+Q_i)/2}{\sqrt{P_i Q_i}}\right) \]</span></li>
<li><code>:kumar-johnson</code>: Kumar-Johnson divergence. <span class="math display">\[ D(P, Q) = \sum_i \frac{(P_i^2 - Q_i^2)^2}{2 (P_i Q_i)^{3/2}} \]</span></li>
</ul></li>
<li><strong>Other:</strong>
<ul>
<li><code>:avg</code>: Average of Manhattan and Chebyshev distances. <span class="math display">\[ D(P, Q) = \frac{1}{2} \left( \sum_i |P_i - Q_i| + \max_i |P_i - Q_i| \right) \]</span></li>
</ul></li>
</ul>
<p>Let’s use the sepal length samples from the iris dataset.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb84"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:euclidean</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.015621495942713016</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:manhattan</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.09134539463390746</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:chebyshev</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.005564421661826087</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:minkowski</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.015621495942713016</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:minkowski</span> setosa-sepal-length virginica-sepal-length {<span class="at">:power</span> <span class="fl">0.5</span>}) <span class="co">;; =&gt; 3.931956786218106</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:euclidean-sq</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 2.4403113548819921E-4</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:squared-chord</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.0030351358423127664</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:sorensen</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.04567269731695373</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:gower</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.0018269078926781493</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:kulczynski</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.09571705050991852</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:canberra</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 2.2736449691924085</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:lorentzian</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.09122364351967303</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:non-intersection</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.04567269731695373</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:wave-hedges</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 4.267542427615257</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:czekanowski</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.04567269731695373</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:motyka</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.5228363486584767</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:tanimoto</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.08735562750016011</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:jaccard</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.012043840252620624</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:dice</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.0060584033473610865</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:bhattacharyya</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.001518720593674244</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:hellinger</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.0779119482789752</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:matusita</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.05509206696351892</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:pearson-chisq</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.01230611574919367</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:neyman-chisq</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.012113936206954518</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:squared-chisq</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.006058781702682577</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:symmetric-chisq</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.012117563405365154</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:divergence</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.30215920027968135</span></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:clark</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.38868959355743066</span></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:additive-symmetric-chisq</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.024420051956148194</span></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:kullback-leibler</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.006089967649043811</span></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:jeffreys</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.012148239424007154</span></span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:k-divergence</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.0015126771903720877</span></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:topsoe</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.0030332163488238145</span></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:jensen-shannon</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.0015166081744119081</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:jensen-difference</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.001516608174411918</span></span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:taneja</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.00152045168158987</span></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:kumar-johnson</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.024513334129211098</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:avg</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.04845490814786678</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>We can compare our data to a distribution. The method used here is based on building histogram for P and quantize distribution for Q.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb85"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:chisq</span> (stats/standardize setosa-sepal-length) r/default-normal) <span class="co">;; =&gt; 0.11684559542476217</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:chisq</span> setosa-sepal-length (r/distribution <span class="at">:normal</span> {<span class="at">:mu</span> (stats/mean setosa-sepal-length), <span class="at">:sd</span> (stats/stddev setosa-sepal-length)})) <span class="co">;; =&gt; 0.11684559542476244</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:chisq</span> (<span class="kw">repeatedly</span> <span class="dv">1000</span> r/grand) r/default-normal) <span class="co">;; =&gt; 0.021612937008293368</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>In case when counts of samples are not equal we can use histograms. Also we can bin our data before comparison.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb86"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:gower</span> (<span class="kw">repeatedly</span> <span class="dv">1000</span> r/grand) (<span class="kw">repeatedly</span> <span class="dv">800</span> r/grand) {<span class="at">:bins</span> <span class="at">:auto</span>}) <span class="co">;; =&gt; 0.007386363636363636</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:gower</span> setosa-sepal-length virginica-sepal-length {<span class="at">:bins</span> <span class="at">:auto</span>}) <span class="co">;; =&gt; 0.22499999999999998</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>(stats/dissimilarity <span class="at">:gower</span> setosa-sepal-length virginica-sepal-length {<span class="at">:bins</span> <span class="dv">10</span>}) <span class="co">;; =&gt; 0.18400000000000002</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="similarity-methods" class="level4">
<h4 class="anchored" data-anchor-id="similarity-methods">Similarity Methods</h4>
<p>Higher values generally indicate greater similarity.</p>
<ul>
<li><strong>Overlap/Set-based:</strong>
<ul>
<li><code>:intersection</code>: Intersection measure (sum of element-wise minimums). <span class="math display">\[ S(P, Q) = \sum_i \min(P_i, Q_i) \]</span></li>
<li><code>:czekanowski</code>: Czekanowski similarity (same as Sorensen-Dice). <span class="math display">\[ S(P, Q) = \frac{2 \sum_i \min(P_i, Q_i)}{\sum_i (P_i + Q_i)} \]</span></li>
<li><code>:motyka</code>: Motyka similarity. <span class="math display">\[ S(P, Q) = \frac{\sum_i \min(P_i, Q_i)}{\sum_i (P_i + Q_i)} \]</span></li>
<li><code>:kulczynski</code>: Kulczynski similarity (can be &gt; 1). <span class="math display">\[ S(P, Q) = \frac{\sum_i \min(P_i, Q_i)}{\sum_i |P_i - Q_i|} \]</span></li>
<li><code>:ruzicka</code>: Ruzicka similarity. <span class="math display">\[ S(P, Q) = \frac{\sum_i \min(P_i, Q_i)}{\sum_i \max(P_i, Q_i)} \]</span></li>
<li><code>:fidelity</code>: Probability fidelity (Bhattacharyya coefficient). <span class="math display">\[ S(P, Q) = \sum_i \sqrt{P_i Q_i} \]</span></li>
<li><code>:squared-chord</code>: Squared chord similarity (1 - Squared Chord dissimilarity). <span class="math display">\[ S(P, Q) = 2 \sum_i \sqrt{P_i Q_i} - 1 \]</span></li>
</ul></li>
<li><strong>Inner Product / Angle:</strong>
<ul>
<li><code>:inner-product</code>: Inner product of the vectors. <span class="math display">\[ S(P, Q) = \sum_i P_i Q_i \]</span></li>
<li><code>:cosine</code>: Cosine similarity. <span class="math display">\[ S(P, Q) = \frac{\sum_i P_i Q_i}{\sqrt{\sum_i P_i^2} \sqrt{\sum_i Q_i^2}} \]</span></li>
</ul></li>
<li><strong>Set-based (adapted):</strong>
<ul>
<li><code>:jaccard</code>: Jaccard similarity (generalized to distributions). <span class="math display">\[ S(P, Q) = \frac{\sum_i P_i Q_i}{\sum_i P_i^2 + \sum_i Q_i^2 - \sum_i P_i Q_i} \]</span></li>
<li><code>:dice</code>: Dice similarity (generalized to distributions). <span class="math display">\[ S(P, Q) = \frac{2 \sum_i P_i Q_i}{\sum_i P_i^2 + \sum_i Q_i^2} \]</span></li>
</ul></li>
<li><strong>Harmonic Mean:</strong>
<ul>
<li><code>:harmonic-mean</code>: Harmonic mean similarity. <span class="math display">\[ S(P, Q) = 2 \sum_i \frac{P_i Q_i}{P_i + Q_i} \]</span></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb87"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:intersection</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9543273026830466</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:czekanowski</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9543273026830466</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:motyka</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.4771636513415233</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:kulczynski</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 10.447459409505903</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:ruzicka</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9126443724998404</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:fidelity</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9984824320788436</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:squared-chord</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9969648641576871</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:inner-product</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.020017872905882722</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:cosine</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9939438317187768</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:jaccard</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9879561597473809</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:dice</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9939415966526397</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:harmonic-mean</span> setosa-sepal-length virginica-sepal-length) <span class="co">;; =&gt; 0.9969706091486588</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>As for <code>dissimilarity</code>, we can compare our data to a distribution. The method used here is based on building histogram for P and quantize distribution for Q.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb88"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:dice</span> (stats/standardize setosa-sepal-length) r/default-normal) <span class="co">;; =&gt; 0.941700344004566</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:dice</span> setosa-sepal-length (r/distribution <span class="at">:normal</span> {<span class="at">:mu</span> (stats/mean setosa-sepal-length), <span class="at">:sd</span> (stats/stddev setosa-sepal-length)})) <span class="co">;; =&gt; 0.9417003440045658</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:dice</span> (<span class="kw">repeatedly</span> <span class="dv">10000</span> r/grand) r/default-normal) <span class="co">;; =&gt; 0.9984869550039952</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>In case when counts of samples are not equal we can use histograms. Also we can bin our data before comparison.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb89"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:ruzicka</span> (<span class="kw">repeatedly</span> <span class="dv">1000</span> r/grand) (<span class="kw">repeatedly</span> <span class="dv">800</span> r/grand) {<span class="at">:bins</span> <span class="at">:auto</span>}) <span class="co">;; =&gt; 0.8535681186283597</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:ruzicka</span> setosa-sepal-length virginica-sepal-length {<span class="at">:bins</span> <span class="at">:auto</span>}) <span class="co">;; =&gt; 0.052631578947368425</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>(stats/similarity <span class="at">:ruzicka</span> setosa-sepal-length virginica-sepal-length {<span class="at">:bins</span> <span class="dv">10</span>}) <span class="co">;; =&gt; 0.04166666666666666</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="contingency-tables" class="level2">
<h2 class="anchored" data-anchor-id="contingency-tables">Contingency Tables</h2>
<p>Functions for creating and analyzing contingency tables.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>contingency-table</code>, <code>rows-&gt;contingency-table</code>, <code>contingency-table-&gt;marginals</code></li>
<li><code>contingency-2x2-measures-all</code>, <code>contingency-2x2-measures</code></li>
<li><code>mcc</code></li>
<li><code>cramers-c</code>, <code>cramers-v</code>, <code>cramers-v-corrected</code></li>
<li><code>cohens-w</code>, <code>tschuprows-t</code></li>
<li><code>cohens-kappa</code>, <code>weighted-kappa</code></li>
</ul>
</div>
</div>
<p>Contingency tables, also known as cross-tabulations or cross-tabs, are a fundamental tool in statistics for displaying the frequency distribution of two or more categorical variables. They help visualize and analyze the relationship or association between these variables.</p>
<p>For two variables, a contingency table typically looks like this:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Category 1 (Col)</th>
<th style="text-align: left;">Category 2 (Col)</th>
<th style="text-align: left;">…</th>
<th style="text-align: left;">Column Totals (Marginals)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Cat A (Row)</strong></td>
<td style="text-align: left;"><span class="math inline">\(n_{11}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_{12}\)</span></td>
<td style="text-align: left;">…</td>
<td style="text-align: left;"><span class="math inline">\(R_1 = \sum_j n_{1j}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Cat B (Row)</strong></td>
<td style="text-align: left;"><span class="math inline">\(n_{21}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_{22}\)</span></td>
<td style="text-align: left;">…</td>
<td style="text-align: left;"><span class="math inline">\(R_2 = \sum_j n_{2j}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>…</strong></td>
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Row Totals (Marginals)</strong></td>
<td style="text-align: left;"><span class="math inline">\(C_1 = \sum_i n_{i1}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(C_2 = \sum_i n_{i2}\)</span></td>
<td style="text-align: left;">…</td>
<td style="text-align: left;"><span class="math inline">\(N = \sum_i \sum_j n_{ij}\)</span></td>
</tr>
</tbody>
</table>
<p>Where <span class="math inline">\(n_{ij}\)</span> is the count of observations falling into row category <span class="math inline">\(i\)</span> and column category <span class="math inline">\(j\)</span>. <span class="math inline">\(R_i\)</span> are row marginal totals, <span class="math inline">\(C_j\)</span> are column marginal totals, and <span class="math inline">\(N\)</span> is the grand total number of observations.</p>
<p>Let’s use data from <a href="https://en.wikipedia.org/wiki/Contingency_table#Example">wikipedia article</a> as the 2x2 example.</p>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td>Right-handed</td>
<td>Left-handed</td>
<td>Total</td>
</tr>
<tr class="even">
<td>Male</td>
<td>43</td>
<td>9</td>
<td>52</td>
</tr>
<tr class="odd">
<td>Female</td>
<td>44</td>
<td>4</td>
<td>48</td>
</tr>
<tr class="even">
<td>Total</td>
<td>87</td>
<td>13</td>
<td>100</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb90"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ct-data-1 </span>[[<span class="dv">43</span> <span class="dv">9</span>] [<span class="dv">44</span> <span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Another example will be from <a href="https://openstax.org/books/introductory-business-statistics-2e/pages/3-4-contingency-tables-and-probability-trees#M05_ch03-tbl005">openstax book</a></p>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td>Lake Path</td>
<td>Hilly Path</td>
<td>Wooded Path</td>
<td>Total</td>
</tr>
<tr class="even">
<td>Younger</td>
<td>45</td>
<td>38</td>
<td>27</td>
<td>110</td>
</tr>
<tr class="odd">
<td>Older</td>
<td>26</td>
<td>52</td>
<td>12</td>
<td>90</td>
</tr>
<tr class="even">
<td>Total</td>
<td>71</td>
<td>90</td>
<td>39</td>
<td>200</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb91"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ct-data-2 </span>[[<span class="dv">45</span> <span class="dv">38</span> <span class="dv">27</span>] [<span class="dv">26</span> <span class="dv">52</span> <span class="dv">12</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last example will consist two sequences for gender and exam outcome</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb92"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> gender </span>[<span class="at">:male</span> <span class="at">:female</span> <span class="at">:male</span> <span class="at">:female</span> <span class="at">:male</span> <span class="at">:male</span> <span class="at">:female</span> <span class="at">:female</span> <span class="at">:female</span> <span class="at">:male</span> <span class="at">:male</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb93"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> outcome </span>[<span class="at">:pass</span> <span class="at">:fail</span> <span class="at">:pass</span> <span class="at">:pass</span> <span class="at">:fail</span> <span class="at">:pass</span> <span class="at">:fail</span> <span class="at">:pass</span> <span class="at">:pass</span> <span class="at">:pass</span> <span class="at">:pass</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>fastmath.stats</code> provides functions for creating and analyzing these tables:</p>
<ul>
<li><code>contingency-table</code>: Creates a frequency map from one or more sequences. If given two sequences of equal length, say <code>vars1</code> and <code>vars2</code>, it produces a map where keys are pairs <code>[value-from-vars1, value-from-vars2]</code> and values are the counts of these co-occurrences.</li>
<li><code>rows-&gt;contingency-table</code>: Takes a sequence of sequences, interpreted as rows of counts in a grid, and converts it into a map format where keys are <code>[row-index, column-index]</code> and values are the non-zero counts. This is useful for inputting tables structured as lists of lists.</li>
<li><code>contingency-table-&gt;marginals</code>: Calculates the row totals (<code>:rows</code>), column totals (<code>:cols</code>), grand total (<code>:n</code>), and diagonal elements (<code>:diag</code>) from a contingency table (either in map format or sequence of sequences format).</li>
</ul>
<p>Let’s create a simple contingency table from above data.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb94"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ct-gender-outcome </span>(stats/contingency-table gender outcome))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb95"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> contingency-table-1 </span>(stats/rows-&gt;contingency-table ct-data<span class="dv">-1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb96"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> contingency-table-2 </span>(stats/rows-&gt;contingency-table ct-data<span class="dv">-2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb97"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>ct-gender-outcome <span class="co">;; =&gt; {[:male :pass] 5, [:female :fail] 2, [:female :pass] 3, [:male :fail] 1}</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>contingency-table<span class="dv">-1</span> <span class="co">;; =&gt; {[0 0] 43, [0 1] 9, [1 0] 44, [1 1] 4}</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>contingency-table<span class="dv">-2</span> <span class="co">;; =&gt; {[0 0] 45, [0 1] 38, [0 2] 27, [1 0] 26, [1 1] 52, [1 2] 12}</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>(stats/contingency-table-&gt;marginals ct-gender-outcome) <span class="co">;; =&gt; {:rows ([:female 5.0] [:male 6.0]), :cols ([:fail 3.0] [:pass 8.0]), :n 11.0, :diag ()}</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>(stats/contingency-table-&gt;marginals contingency-table<span class="dv">-1</span>) <span class="co">;; =&gt; {:rows ([0 52.0] [1 48.0]), :cols ([0 87.0] [1 13.0]), :n 100.0, :diag ([[0 0] 43] [[1 1] 4])}</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>(stats/contingency-table-&gt;marginals contingency-table<span class="dv">-2</span>) <span class="co">;; =&gt; {:rows ([0 110.0] [1 90.0]), :cols ([0 71.0] [1 90.0] [2 39.0]), :n 200.0, :diag ([[0 0] 45] [[1 1] 52])}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Measures of Association:</strong> These statistics quantify the strength and nature of the relationship between the variables in the table. They are often derived from the Pearson’s Chi-squared statistic (<span class="math inline">\(\chi^2\)</span>, obtainable via [<a href="#chisq-test">chisq-test</a>]), which tests for independence.</p>
<ul>
<li><code>cramers-c</code>: Cramer’s C is a measure of association for any <span class="math inline">\(R \times K\)</span> contingency table. It ranges from 0 to 1, where 0 indicates no association and 1 indicates perfect association. <span class="math display">\[ C = \sqrt{\frac{\chi^2}{N + \chi^2}} \]</span></li>
<li><code>cramers-v</code>: Cramer’s V is another measure of association, also ranging from 0 to 1. It is widely used and is often preferred over Tschuprow’s T because it can attain the value 1 even for non-square tables. <span class="math display">\[ V = \sqrt{\frac{\chi^2/N}{\min(R-1, K-1)}} \]</span></li>
<li><code>cramers-v-corrected</code>: Corrected Cramer’s V (<span class="math inline">\(V^*\)</span>) applies a bias correction, which is particularly important for small sample sizes or tables with many cells having low expected counts.</li>
<li><code>cohens-w</code>: Cohen’s W is a measure of effect size for Chi-squared tests. It quantifies the magnitude of the difference between observed and expected frequencies. It ranges from 0 upwards, with 0 indicating no difference (independence). <span class="math display">\[ W = \sqrt{\frac{\chi^2}{N}} \]</span></li>
<li><code>tschuprows-t</code>: Tschuprow’s T is a measure of association ranging from 0 to 1. However, it can only reach 1 in square tables (<span class="math inline">\(R=K\)</span>). <span class="math display">\[ T = \sqrt{\frac{\chi^2/N}{\sqrt{(R-1)(K-1)}}} \]</span></li>
</ul>
<p><code>fastmath.stats</code> allows you to calculate these measures by providing either the raw sequences or a pre-calculated contingency table:</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb98"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>(stats/cramers-c ct-gender-outcome) <span class="co">;; =&gt; 0.25242645609111675</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>(stats/cramers-v ct-gender-outcome) <span class="co">;; =&gt; 0.26087459737497565</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>(stats/cramers-v-corrected ct-gender-outcome) <span class="co">;; =&gt; 0.0</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>(stats/cohens-w ct-gender-outcome) <span class="co">;; =&gt; 0.26087459737497565</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>(stats/tschuprows-t ct-gender-outcome) <span class="co">;; =&gt; 0.26087459737497565</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>(stats/cramers-c contingency-table<span class="dv">-1</span>) <span class="co">;; =&gt; 0.13215047155447307</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>(stats/cramers-v contingency-table<span class="dv">-1</span>) <span class="co">;; =&gt; 0.13331972997326805</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>(stats/cramers-v-corrected contingency-table<span class="dv">-1</span>) <span class="co">;; =&gt; 0.08804224922800516</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>(stats/cohens-w contingency-table<span class="dv">-1</span>) <span class="co">;; =&gt; 0.13331972997326805</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>(stats/tschuprows-t contingency-table<span class="dv">-1</span>) <span class="co">;; =&gt; 0.13331972997326805</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>(stats/cramers-c contingency-table<span class="dv">-2</span>) <span class="co">;; =&gt; 0.22972682313063483</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>(stats/cramers-v contingency-table<span class="dv">-2</span>) <span class="co">;; =&gt; 0.23603966869637247</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>(stats/cramers-v-corrected contingency-table<span class="dv">-2</span>) <span class="co">;; =&gt; 0.21423142299458464</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>(stats/cohens-w contingency-table<span class="dv">-2</span>) <span class="co">;; =&gt; 0.23603966869637247</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>(stats/tschuprows-t contingency-table<span class="dv">-2</span>) <span class="co">;; =&gt; 0.19848491126445403</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Measures of Agreement:</strong> These statistics are typically used for square tables (<span class="math inline">\(R=K\)</span>) to assess the consistency of agreement between two independent raters or methods that categorize items.</p>
<ul>
<li><code>cohens-kappa</code>: Cohen’s Kappa (<span class="math inline">\(\kappa\)</span>) measures the agreement between two raters for nominal (or ordinal) categories, correcting for the agreement that would be expected by chance. It ranges from -1 (perfect disagreement) to +1 (perfect agreement), with 0 indicating agreement equivalent to chance. <span class="math display">\[ \kappa = \frac{p_0 - p_e}{1 - p_e} \]</span> where <span class="math inline">\(p_0\)</span> is the observed proportional agreement (sum of diagonal cells divided by N) and <span class="math inline">\(p_e\)</span> is the proportional agreement expected by chance (based on marginal probabilities).</li>
<li><code>weighted-kappa</code>: Weighted Kappa (<span class="math inline">\(\kappa_w\)</span>) is an extension of Cohen’s Kappa that allows for different levels of disagreement penalties, suitable for ordinal categories. Disagreements between categories that are closer together (e.g., “Good” vs “Very Good”) are penalized less than disagreements between categories that are further apart (e.g., “Poor” vs “Excellent”). It requires specifying a weighting scheme (e.g., <code>:equal-spacing</code>, <code>:fleiss-cohen</code>).</li>
</ul>
<p>Examples for agreement measures (using the [<a href="#rows-contingency-table">rows-&gt;contingency-table</a>] format for clarity on cell positions):</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb99"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>(stats/cohens-kappa ct-gender-outcome) <span class="co">;; =&gt; -1.0862068965517244</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>(stats/cohens-kappa contingency-table<span class="dv">-1</span>) <span class="co">;; =&gt; -0.09233305853256403</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>(stats/weighted-kappa contingency-table<span class="dv">-1</span> <span class="at">:equal-spacing</span>) <span class="co">;; =&gt; -0.09233305853256403</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>(stats/weighted-kappa contingency-table<span class="dv">-1</span> <span class="at">:fleiss-cohen</span>) <span class="co">;; =&gt; -0.09233305853256403</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>(stats/weighted-kappa contingency-table<span class="dv">-1</span> {[<span class="dv">0</span> <span class="dv">0</span>] <span class="fl">0.1</span>, [<span class="dv">1</span> <span class="dv">0</span>] <span class="fl">0.2</span>, [<span class="dv">0</span> <span class="dv">1</span>] <span class="fl">0.4</span>, [<span class="dv">1</span> <span class="dv">1</span>] <span class="fl">0.3</span>}) <span class="co">;; =&gt; 0.005427145418423201</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>(stats/weighted-kappa contingency-table<span class="dv">-1</span> (<span class="kw">fn</span> [dim row-id col-id] (<span class="kw">/</span> (<span class="kw">max</span> row-id col-id) dim))) <span class="co">;; =&gt; 0.049513704686118425</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>2x2 Specific Measures:</strong> These functions are tailored for 2x2 tables.</p>
<ul>
<li><code>mcc</code>: Calculates the [<a href="#mcc">mcc</a>], which is equivalent to the Phi coefficient for a 2x2 table. It is a single, balanced measure of classification performance, ranging from -1 to +1.</li>
<li><code>contingency-2x2-measures</code>: A convenience function that returns a map containing a selection of commonly used statistics specifically for 2x2 tables (Chi-squared, Kappa, Phi, Yule’s Q, Odds Ratio, etc.).</li>
<li><code>contingency-2x2-measures-all</code>: Provides a very comprehensive map of measures for a 2x2 table, including various Chi-squared statistics and p-values, measures of association, agreement, and risk/effect size measures like Odds Ratio (OR), Relative Risk (RR), and Number Needed to Treat (NNT). It’s the most detailed summary for a 2x2 table.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb100"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>(stats/mcc contingency-table<span class="dv">-1</span>) <span class="co">;; =&gt; -0.133319729973268</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The <code>contingency-2x2-measures-all</code> function accepts the counts <code>a, b, c, d</code> directly, a sequence <code>[a b c d]</code>, a matrix <code>[[a b] [c d]]</code>, or a map <code>{:a a :b b :c c :d d}</code>.</p>
<p>The map returned by <code>contingency-2x2-measures-all</code> is extensive. Here’s a description of its main keys and their contents:</p>
<ul>
<li><code>:n</code>: The grand total number of observations in the table (<span class="math inline">\(N\)</span>).</li>
<li><code>:table</code>: A map representation of the input counts, typically <code>{:a a, :b b, :c c, :d d}</code> corresponding to the top-left, top-right, bottom-left, bottom-right cells.</li>
<li><code>:expected</code>: A map of the expected counts <code>{:a exp_a, :b exp_b, :c exp_c, :d exp_d}</code> for each cell under the assumption of independence.</li>
<li><code>:marginals</code>: A map containing the row totals (<code>:row1</code>, <code>:row2</code>), column totals (<code>:col1</code>, <code>:col2</code>), and the grand total (<code>:total</code>).</li>
<li><code>:proportions</code>: A nested map providing proportions:
<ul>
<li><code>:table</code>: Cell counts divided by the grand total (<code>N</code>).</li>
<li><code>:rows</code>: Cell counts divided by their respective row totals (conditional probabilities of columns given rows).</li>
<li><code>:cols</code>: Cell counts divided by their respective column totals (conditional probabilities of rows given columns).</li>
<li><code>:marginals</code>: Row and column totals divided by the grand total (<code>N</code>).</li>
</ul></li>
<li><code>:p-values</code>: A map containing p-values for various Chi-squared tests:
<ul>
<li><code>:chi2</code>: Pearson’s Chi-squared test p-value.</li>
<li><code>:yates</code>: Yates’ continuity corrected Chi-squared test p-value.</li>
<li><code>:cochran-mantel-haenszel</code>: Cochran-Mantel-Haenszel statistic p-value (useful for stratified data, but calculated for the single table here).</li>
</ul></li>
<li><code>:OR</code>: The Odds Ratio (<span class="math inline">\(OR\)</span>) for the 2x2 table, typically <span class="math inline">\((a \times d) / (b \times c)\)</span>. Quantifies the strength of association, representing the odds of an outcome occurring in one group compared to the odds in another group.</li>
<li><code>:lOR</code>: The natural logarithm of the Odds Ratio (<span class="math inline">\(\ln(OR)\)</span>). Useful for constructing confidence intervals for the OR.</li>
<li><code>:RR</code>: The Relative Risk (<span class="math inline">\(RR\)</span>) for the 2x2 table, typically <span class="math inline">\((a/(a+b)) / (c/(c+d))\)</span>. Compares the probability of an outcome in one group to the probability in another group. Requires row marginals to represent the exposed/unexposed or intervention/control groups.</li>
<li><code>:risk</code>: A map containing various risk-related measures, especially relevant in epidemiology or clinical trials, derived from the counts assuming a specific row structure (e.g., exposure/outcome):
<ul>
<li><code>:RR</code>: Relative Risk (same as top-level <code>:RR</code>).</li>
<li><code>:RRR</code>: Relative Risk Reduction (<span class="math inline">\(1 - RR\)</span>).</li>
<li><code>:RD</code>: Risk Difference (<span class="math inline">\(a/(a+b) - c/(c+d)\)</span>).</li>
<li><code>:ES</code>: Exposure Sample size (row 1 total).</li>
<li><code>:CS</code>: Control Sample size (row 2 total).</li>
<li><code>:EER</code>: Experimental Event Rate (<span class="math inline">\(a/(a+b)\)</span>).</li>
<li><code>:CER</code>: Control Event Rate (<span class="math inline">\(c/(c+d)\)</span>).</li>
<li><code>:ARR</code>: Absolute Risk Reduction (<span class="math inline">\(CER - EER\)</span>).</li>
<li><code>:NNT</code>: Number Needed to Treat (<span class="math inline">\(1 / ARR\)</span>). The average number of patients who need to be treated to prevent one additional bad outcome.</li>
<li><code>:ARI</code>: Absolute Risk Increase (<span class="math inline">\(-ARR\)</span>).</li>
<li><code>:NNH</code>: Number Needed to Harm (<span class="math inline">\(-NNT\)</span>).</li>
<li><code>:RRI</code>: Relative Risk Increase (<span class="math inline">\(RR - 1\)</span>).</li>
<li><code>:AFe</code>: Attributable Fraction among the exposed (<span class="math inline">\((EER - CER)/EER\)</span>).</li>
<li><code>:PFu</code>: Prevented Fraction among the unexposed (<span class="math inline">\(1 - RR\)</span>).</li>
</ul></li>
<li><code>:SE</code>: Standard Error related values used in some calculations.</li>
<li><code>:measures</code>: A map containing a wide array of statistical measures:
<ul>
<li><code>:chi2</code>: Pearson’s Chi-squared statistic (same as <code>:p-values :chi2</code> but the statistic value).</li>
<li><code>:yates</code>: Yates’ continuity corrected Chi-squared statistic.</li>
<li><code>:cochran-mantel-haenszel</code>: Cochran-Mantel-Haenszel statistic.</li>
<li><code>:cohens-kappa</code>: Cohen’s Kappa coefficient.</li>
<li><code>:yules-q</code>: Yule’s Q, a measure of association based on the Odds Ratio. Ranges -1 to +1.</li>
<li><code>:holley-guilfords-g</code>: Holley-Guilford’s G.</li>
<li><code>:huberts-gamma</code>: Hubert’s Gamma.</li>
<li><code>:yules-y</code>: Yule’s Y, based on square roots of cell proportions. Ranges -1 to +1.</li>
<li><code>:cramers-v</code>: Cramer’s V measure of association.</li>
<li><code>:phi</code>: Phi coefficient (equivalent to MCC for 2x2 tables), calculated as <span class="math inline">\(\frac{ad-bc}{\sqrt{(a+b)(c+d)(a+c)(b+d)}}\)</span>. Ranges -1 to +1.</li>
<li><code>:scotts-pi</code>: Scott’s Pi, another measure of inter-rater reliability, similar to Kappa.</li>
<li><code>:cohens-h</code>: Cohen’s H, a measure of effect size for comparing two proportions.</li>
<li><code>:PCC</code>: Pearson’s Contingency Coefficient.</li>
<li><code>:PCC-adjusted</code>: Adjusted Pearson’s Contingency Coefficient.</li>
<li><code>:TCC</code>: Tschuprow’s Contingency Coefficient.</li>
<li><code>:F1</code>: F1 Score, common in binary classification, the harmonic mean of precision and recall. Calculated assuming <code>a=TP, b=FP, c=FN, d=TN</code>.</li>
<li><code>:bangdiwalas-b</code>: Bangdiwala’s B, a measure of agreement/reproducibility for clustered data, but calculated for the 2x2 table.</li>
<li><code>:mcnemars-chi2</code>: McNemar’s Chi-squared test statistic, specifically for paired nominal data (e.g., before/after) to test for changes in proportions. Calculated from off-diagonal elements (<span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span>).</li>
<li><code>:gwets-ac1</code>: Gwet’s AC1, another measure of inter-rater reliability claimed to be more robust to prevalence issues than Kappa.</li>
</ul></li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb101"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>(stats/contingency<span class="dv">-2</span>x2-measures-all (flatten ct-data<span class="dv">-1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb102"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:OR</span> <span class="fl">0.43434343434343436</span>,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:RR</span> <span class="fl">0.9020979020979021</span>,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:SE</span> <span class="fl">0.6380393387494788</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:expected</span> {<span class="at">:a</span> <span class="fl">45.24</span>, <span class="at">:b</span> <span class="fl">6.76</span>, <span class="at">:c</span> <span class="fl">41.76</span>, <span class="at">:d</span> <span class="fl">6.24</span>},</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:lOR</span> -<span class="fl">0.8339197344410274</span>,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:marginals</span> {<span class="at">:col1</span> <span class="dv">87</span>, <span class="at">:col2</span> <span class="dv">13</span>, <span class="at">:row1</span> <span class="dv">52</span>, <span class="at">:row2</span> <span class="dv">48</span>, <span class="at">:total</span> <span class="dv">100</span>},</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:measures</span> {<span class="at">:F1</span> <span class="fl">0.6187050359712231</span>,</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">:PCC</span> <span class="fl">0.13215047155447307</span>,</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">:PCC-adjusted</span> <span class="fl">0.18688898914633573</span>,</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">:TCC</span> -<span class="fl">0.3172384169581813</span>,</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">:bangdiwalas-b</span> <span class="fl">0.3622766122766123</span>,</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">:chi2</span> <span class="fl">1.7774150400145103</span>,</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">:cochran-mantel-haenszel</span> <span class="fl">1.7596408896143674</span>,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">:cohens-h</span> -<span class="fl">0.27245415531951833</span>,</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">:cohens-kappa</span> -<span class="fl">0.09233305853256389</span>,</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">:cramers-v</span> <span class="fl">0.133319729973268</span>,</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">:gwets-ac1</span> <span class="fl">0.07994097734571652</span>,</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">:holley-guilfords-g</span> -<span class="fl">0.06</span>,</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">:huberts-gamma</span> <span class="fl">0.0036</span>,</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">:mcnemars-chi2</span> <span class="fl">23.11320754716981</span>,</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">:phi</span> -<span class="fl">0.133319729973268</span>,</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">:scotts-pi</span> -<span class="fl">0.2501474230451704</span>,</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">:yates</span> <span class="fl">1.0724852071005921</span>,</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">:youdens-j</span> -<span class="fl">0.08974358974358974</span>,</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">:yules-q</span> -<span class="fl">0.3943661971830986</span>,</span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">:yules-y</span> -<span class="fl">0.20551108882876298</span>},</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="dv">100</span>,</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-values</span> {<span class="at">:chi2</span> <span class="fl">0.1824670652605519</span>,</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">:cochran-mantel-haenszel</span> <span class="fl">0.18466931414678545</span>,</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">:yates</span> <span class="fl">0.3003847703905692</span>},</span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a> <span class="at">:proportions</span> {<span class="at">:cols</span> {<span class="at">:a</span> <span class="fl">0.4942528735632184</span>,</span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:b</span> <span class="fl">0.6923076923076923</span>,</span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:c</span> <span class="fl">0.5057471264367817</span>,</span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:d</span> <span class="fl">0.3076923076923077</span>},</span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">:marginals</span> {<span class="at">:col1</span> <span class="fl">0.87</span>, <span class="at">:col2</span> <span class="fl">0.13</span>, <span class="at">:row1</span> <span class="fl">0.52</span>, <span class="at">:row2</span> <span class="fl">0.48</span>},</span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">:rows</span> {<span class="at">:a</span> <span class="fl">0.8269230769230769</span>,</span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:b</span> <span class="fl">0.17307692307692307</span>,</span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:c</span> <span class="fl">0.9166666666666666</span>,</span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">:d</span> <span class="fl">0.08333333333333333</span>},</span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">:table</span> {<span class="at">:a</span> <span class="fl">0.43</span>, <span class="at">:b</span> <span class="fl">0.09</span>, <span class="at">:c</span> <span class="fl">0.44</span>, <span class="at">:d</span> <span class="fl">0.04</span>}},</span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a> <span class="at">:risk</span> {<span class="at">:AFe</span> -<span class="fl">0.10852713178294575</span>,</span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">:ARI</span> -<span class="fl">0.08974358974358976</span>,</span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">:ARR</span> <span class="fl">0.08974358974358976</span>,</span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">:CER</span> <span class="fl">0.9166666666666666</span>,</span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">:CS</span> <span class="dv">48</span>,</span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">:EER</span> <span class="fl">0.8269230769230769</span>,</span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">:ES</span> <span class="dv">52</span>,</span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">:NNH</span> -<span class="fl">11.14285714285714</span>,</span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">:NNT</span> <span class="fl">11.14285714285714</span>,</span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">:PFu</span> <span class="fl">0.09790209790209792</span>,</span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">:RD</span> -<span class="fl">0.08974358974358976</span>,</span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">:RR</span> <span class="fl">0.9020979020979021</span>,</span>
<span id="cb102-53"><a href="#cb102-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">:RRI</span> -<span class="fl">0.09790209790209792</span>,</span>
<span id="cb102-54"><a href="#cb102-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">:RRR</span> <span class="fl">0.09790209790209792</span>},</span>
<span id="cb102-55"><a href="#cb102-55" aria-hidden="true" tabindex="-1"></a> <span class="at">:table</span> {<span class="at">:a</span> <span class="dv">43</span>, <span class="at">:b</span> <span class="dv">9</span>, <span class="at">:c</span> <span class="dv">44</span>, <span class="at">:d</span> <span class="dv">4</span>}}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="binary-classification-metrics" class="level3">
<h3 class="anchored" data-anchor-id="binary-classification-metrics">Binary Classification Metrics</h3>
<p>Metrics derived from a 2x2 confusion matrix are essential for evaluating the performance of algorithms in binary classification tasks (problems where the outcome belongs to one of two classes, e.g., “positive” or “negative”, “success” or “failure”). These metrics quantify how well a classifier distinguishes between the two classes.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>confusion-matrix</code></li>
<li><code>binary-measures-all</code>, <code>binary-measures</code></li>
</ul>
</div>
</div>
<p>The foundation for these metrics is the <strong>confusion matrix</strong>, a 2x2 table summarizing the results by comparing the actual class of each instance to the predicted class:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 35%">
<col style="width: 35%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Predicted Positive (P’)</th>
<th style="text-align: left;">Predicted Negative (N’)</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Actual Positive (P)</strong></td>
<td style="text-align: left;">True Positives (TP)</td>
<td style="text-align: left;">False Negatives (FN)</td>
<td style="text-align: left;">P</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Actual Negative (N)</strong></td>
<td style="text-align: left;">False Positives (FP)</td>
<td style="text-align: left;">True Negatives (TN)</td>
<td style="text-align: left;">N</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: left;">P’</td>
<td style="text-align: left;">N’</td>
<td style="text-align: left;">Total</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>True Positives (TP):</strong> Instances correctly predicted as positive.</li>
<li><strong>False Negatives (FN):</strong> Instances incorrectly predicted as negative (Type II error). These are positive instances missed by the classifier.</li>
<li><strong>False Positives (FP):</strong> Instances incorrectly predicted as positive (Type I error). These are negative instances misclassified as positive.</li>
<li><strong>True Negatives (TN):</strong> Instances correctly predicted as negative.</li>
</ul>
<p>The counts from these four cells form the basis for almost all binary classification metrics.</p>
<p><code>fastmath.stats</code> provides functions to generate and analyze these matrices:</p>
<ul>
<li><code>confusion-matrix</code>: This function constructs the 2x2 confusion matrix counts (<code>:tp</code>, <code>:fn</code>, <code>:fp</code>, <code>:tn</code>). It can take the four counts directly, a structured map/sequence representation, or two sequences of actual and predicted outcomes. It can also handle different data types for outcomes using an <code>encode-true</code> parameter.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb103"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>(stats/confusion-matrix <span class="dv">10</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">80</span>) <span class="co">;; =&gt; {:tp 10, :fn 2, :fp 5, :tn 80}</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>(stats/confusion-matrix [<span class="dv">10</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">80</span>]) <span class="co">;; =&gt; {:tp 10, :fn 2, :fp 5, :tn 80}</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>(stats/confusion-matrix [[<span class="dv">10</span> <span class="dv">5</span>] [<span class="dv">2</span> <span class="dv">80</span>]]) <span class="co">;; =&gt; {:tp 10, :fn 5, :fp 2, :tn 80}</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>(stats/confusion-matrix {<span class="at">:tp</span> <span class="dv">10</span>, <span class="at">:fn</span> <span class="dv">2</span>, <span class="at">:fp</span> <span class="dv">5</span>, <span class="at">:tn</span> <span class="dv">80</span>}) <span class="co">;; =&gt; {:tp 10, :fn 2, :fp 5, :tn 80}</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>(stats/confusion-matrix [<span class="at">:pos</span> <span class="at">:neg</span> <span class="at">:pos</span> <span class="at">:pos</span> <span class="at">:neg</span> <span class="at">:pos</span> <span class="at">:neg</span> <span class="at">:pos</span> <span class="at">:neg</span> <span class="at">:pos</span> <span class="at">:pos</span>] [<span class="at">:pos</span> <span class="at">:neg</span> <span class="at">:pos</span> <span class="at">:pos</span> <span class="at">:neg</span> <span class="at">:pos</span> <span class="at">:neg</span> <span class="at">:neg</span> <span class="at">:pos</span> <span class="at">:pos</span> <span class="at">:pos</span>] #{<span class="at">:pos</span>}) <span class="co">;; =&gt; {:tp 6, :tn 3, :fn 1, :fp 1}</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>(stats/confusion-matrix [<span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span>] [<span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>]) <span class="co">;; =&gt; {:tp 6, :tn 3, :fn 1, :fp 1}</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>(stats/confusion-matrix [<span class="va">true</span> <span class="va">false</span> <span class="va">true</span> <span class="va">true</span> <span class="va">false</span> <span class="va">true</span> <span class="va">false</span> <span class="va">true</span> <span class="va">false</span> <span class="va">true</span> <span class="va">true</span>] [<span class="va">true</span> <span class="va">false</span> <span class="va">true</span> <span class="va">true</span> <span class="va">false</span> <span class="va">true</span> <span class="va">false</span> <span class="va">false</span> <span class="va">true</span> <span class="va">true</span> <span class="va">true</span>]) <span class="co">;; =&gt; {:tp 6, :tn 3, :fn 1, :fp 1}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li><p><code>binary-measures-all</code>: This is the primary function for calculating a wide range of metrics from a 2x2 confusion matrix. It accepts the same input formats as <code>confusion-matrix</code>. It returns a map containing a comprehensive set of derived statistics.</p></li>
<li><p><code>binary-measures</code>: A convenience function that calls <code>binary-measures-all</code> but returns a smaller, more commonly used subset of the metrics. It accepts the same input formats.</p></li>
</ul>
<p>The map returned by <code>binary-measures-all</code> contains numerous metrics. Key metrics include:</p>
<ul>
<li><code>:tp</code>, <code>:fn</code>, <code>:fp</code>, <code>:tn</code>: The raw counts from the confusion matrix.</li>
<li><code>:total</code>: Total number of instances (<span class="math inline">\(TP + FN + FP + TN\)</span>).</li>
<li><code>:cp</code>, <code>:cn</code>, <code>:pcp</code>, <code>:pcn</code>: Marginal totals (e.g., <code>:cp</code> is actual positives <span class="math inline">\(TP + FN\)</span>).</li>
<li><code>:accuracy</code>: Overall proportion of correct predictions: <span class="math display">\[ Accuracy = \frac{TP + TN}{TP + FN + FP + TN} \]</span></li>
<li><code>:sensitivity</code>, <code>:recall</code>, <code>:tpr</code>: True Positive Rate (proportion of actual positives correctly identified): <span class="math display">\[ Sensitivity = \frac{TP}{TP + FN} \]</span></li>
<li><code>:specificity</code>, <code>:tnr</code>: True Negative Rate (proportion of actual negatives correctly identified): <span class="math display">\[ Specificity = \frac{TN}{FP + TN} \]</span></li>
<li><code>:precision</code>, <code>:ppv</code>: Positive Predictive Value (proportion of positive predictions that were actually positive): <span class="math display">\[ Precision = \frac{TP}{TP + FP} \]</span></li>
<li><code>:fdr</code>: False Discovery Rate (<span class="math inline">\(1 - Precision\)</span>).</li>
<li><code>:npv</code>: Negative Predictive Value (proportion of negative predictions that were actually negative): <span class="math display">\[ NPV = \frac{TN}{FN + TN} \]</span></li>
<li><code>:for</code>: False Omission Rate (<span class="math inline">\(1 - NPV\)</span>).</li>
<li><code>:fpr</code>: False Positive Rate (proportion of actual negatives incorrectly identified as positive): <span class="math display">\[ FPR = \frac{FP}{FP + TN} \]</span></li>
<li><code>:fnr</code>: False Negative Rate (proportion of actual positives incorrectly identified as negative): <span class="math display">\[ FNR = \frac{FN}{TP + FN} \]</span></li>
<li><code>:f1-score</code>, <code>:f-measure</code>: The harmonic mean of Precision and Recall. It provides a balance between the two: <span class="math display">\[ F1 = 2 \cdot \frac{Precision \cdot Recall}{Precision + Recall} \]</span></li>
<li><code>:mcc</code>, <code>:phi</code>: Matthews Correlation Coefficient / Phi coefficient. A balanced measure ranging from -1 to +1, considered robust for imbalanced datasets: <span class="math display">\[ MCC = \frac{TP \cdot TN - FP \cdot FN}{\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}} \]</span></li>
<li><code>:prevalence</code>: Proportion of the positive class in the actual data: <span class="math display">\[ Prevalence = \frac{TP + FN}{TP + FN + FP + TN} \]</span></li>
<li>Other metrics like <code>:ba</code> (Balanced Accuracy), <code>:lr+</code>, <code>:lr-</code>, <code>:dor</code>, <code>:fm</code>, <code>:pt</code>, <code>:bm</code>, <code>:kappa</code> (Cohen’s Kappa for 2x2), <code>:mk</code>, and <code>:f-beta</code> (a function to calculate F-beta score for any beta value).</li>
</ul>
<p><code>binary-measures</code> returns a map containing <code>:tp</code>, <code>:tn</code>, <code>:fp</code>, <code>:fn</code>, <code>:accuracy</code>, <code>:fdr</code>, <code>:f-measure</code>, <code>:fall-out</code> (FPR), <code>:precision</code>, <code>:recall</code> (Sensitivity/TPR), <code>:sensitivity</code>, <code>:specificity</code> (TNR), and <code>:prevalence</code>. This provides a useful quick summary. For a deeper dive or specific niche metrics, use <code>binary-measures-all</code>.</p>
<p>Let’s calculate the metrics for a sample confusion matrix <code>{:tp 10 :fn 2 :fp 5 :tn 80}</code>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb104"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>(stats/binary-measures-all {<span class="at">:tp</span> <span class="dv">10</span>, <span class="at">:fn</span> <span class="dv">2</span>, <span class="at">:fp</span> <span class="dv">5</span>, <span class="at">:tn</span> <span class="dv">80</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb105"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:accuracy</span> <span class="fl">0.9278350515463918</span>,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:ba</span> <span class="fl">0.8872549019607843</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:bm</span> <span class="fl">0.7745098039215685</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:cn</span> <span class="fl">85.0</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:cp</span> <span class="fl">12.0</span>,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:dor</span> <span class="fl">80.00000000000003</span>,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:f-beta</span> #&lt;Fn<span class="at">@7ac1c8aa</span> fastmath.stats/binary_measures_all_calc[<span class="kw">fn</span>]<span class="kw">&gt;</span>,</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:f-measure</span> <span class="fl">0.7407407407407408</span>,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:f1-score</span> <span class="fl">0.7407407407407408</span>,</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:fall-out</span> <span class="fl">0.058823529411764705</span>,</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:fdr</span> <span class="fl">0.33333333333333337</span>,</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:fm</span> <span class="fl">0.7453559924999299</span>,</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:fn</span> <span class="dv">2</span>,</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:fnr</span> <span class="fl">0.16666666666666663</span>,</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:for</span> <span class="fl">0.024390243902439046</span>,</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:fp</span> <span class="dv">5</span>,</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:fpr</span> <span class="fl">0.058823529411764705</span>,</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:hit-rate</span> <span class="fl">0.8333333333333334</span>,</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:jaccard</span> <span class="fl">0.5882352941176471</span>,</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a> <span class="at">:kappa</span> <span class="fl">0.6994245241257193</span>,</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a> <span class="at">:lr</span>+ <span class="fl">14.166666666666668</span>,</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a> <span class="at">:lr-</span> <span class="fl">0.1770833333333333</span>,</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a> <span class="at">:mcc</span> <span class="fl">0.7053009189406806</span>,</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a> <span class="at">:miss-rate</span> <span class="fl">0.16666666666666663</span>,</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a> <span class="at">:mk</span> <span class="fl">0.6422764227642275</span>,</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="fl">85.0</span>,</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a> <span class="at">:npv</span> <span class="fl">0.975609756097561</span>,</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a> <span class="at">:p</span> <span class="fl">12.0</span>,</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a> <span class="at">:pcn</span> <span class="fl">82.0</span>,</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a> <span class="at">:pcp</span> <span class="fl">15.0</span>,</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a> <span class="at">:phi</span> <span class="fl">0.7053009189406806</span>,</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a> <span class="at">:pn</span> <span class="fl">82.0</span>,</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a> <span class="at">:pp</span> <span class="fl">15.0</span>,</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a> <span class="at">:ppv</span> <span class="fl">0.6666666666666666</span>,</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a> <span class="at">:precision</span> <span class="fl">0.6666666666666666</span>,</span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a> <span class="at">:prevalence</span> <span class="fl">0.12371134020618557</span>,</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a> <span class="at">:pt</span> <span class="fl">0.20991366558572697</span>,</span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a> <span class="at">:recall</span> <span class="fl">0.8333333333333334</span>,</span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a> <span class="at">:selectivity</span> <span class="fl">0.9411764705882353</span>,</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a> <span class="at">:sensitivity</span> <span class="fl">0.8333333333333334</span>,</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a> <span class="at">:specificity</span> <span class="fl">0.9411764705882353</span>,</span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a> <span class="at">:tn</span> <span class="dv">80</span>,</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a> <span class="at">:tnr</span> <span class="fl">0.9411764705882353</span>,</span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a> <span class="at">:total</span> <span class="fl">97.0</span>,</span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a> <span class="at">:tp</span> <span class="dv">10</span>,</span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a> <span class="at">:tpr</span> <span class="fl">0.8333333333333334</span>,</span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a> <span class="at">:ts</span> <span class="fl">0.5882352941176471</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb106"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(stats/binary-measures {<span class="at">:tp</span> <span class="dv">10</span>, <span class="at">:fn</span> <span class="dv">2</span>, <span class="at">:fp</span> <span class="dv">5</span>, <span class="at">:tn</span> <span class="dv">80</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb107"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:accuracy</span> <span class="fl">0.9278350515463918</span>,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:f-measure</span> <span class="fl">0.7407407407407408</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:fall-out</span> <span class="fl">0.058823529411764705</span>,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:fdr</span> <span class="fl">0.33333333333333337</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:fn</span> <span class="dv">2</span>,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:fp</span> <span class="dv">5</span>,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:precision</span> <span class="fl">0.6666666666666666</span>,</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:prevalence</span> <span class="fl">0.12371134020618557</span>,</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:recall</span> <span class="fl">0.8333333333333334</span>,</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:sensitivity</span> <span class="fl">0.8333333333333334</span>,</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:specificity</span> <span class="fl">0.9411764705882353</span>,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:tn</span> <span class="dv">80</span>,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:tp</span> <span class="dv">10</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="effect-size" class="level2">
<h2 class="anchored" data-anchor-id="effect-size">Effect Size</h2>
<p>Measures quantifying the magnitude of a phenomenon or relationship.</p>
<section id="difference-family" class="level3">
<h3 class="anchored" data-anchor-id="difference-family">Difference Family</h3>
<p>Measures quantifying the magnitude of the difference between two group means, standardized by a measure of variability. These are widely used effect size statistics, particularly in comparing experimental and control groups or two distinct conditions.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>cohens-d</code>, <code>cohens-d-corrected</code></li>
<li><code>hedges-g</code>, <code>hedges-g-corrected</code>, <code>hedges-g*</code></li>
<li><code>glass-delta</code></li>
</ul>
</div>
</div>
<p>These functions primarily quantify the difference between the means of two groups (usually group 1 and group 2: <span class="math inline">\(\bar{x}_1 - \bar{x}_2\)</span>), scaled by some estimate of the population standard deviation.</p>
<ul>
<li><p><strong>Cohen’s d (<code>cohens-d</code>)</strong>: Measures the difference between two means divided by the pooled standard deviation. It assumes equal variances between the groups. The formula is: <span class="math display">\[ d = \frac{\bar{x}_1 - \bar{x}_2}{s_p} \]</span> where <span class="math inline">\(s_p = \sqrt{\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1+n_2-2}}\)</span> is the <em>unbiased</em> pooled standard deviation. An optional <code>method</code> argument can be passed to select the pooled standard deviation calculation method (see [<a href="#pooled-stddev">pooled-stddev</a>]).</p></li>
<li><p><strong>Hedges’ g (<code>hedges-g</code>)</strong>: In <code>fastmath.stats</code>, this function is equivalent to <code>cohens-d</code> using the default (unbiased) pooled standard deviation. Conceptually, Hedges’ g also divides the mean difference by a pooled standard deviation, but often refers to a bias-corrected version for small samples (see below). <span class="math display">\[ g = \frac{\bar{x}_1 - \bar{x}_2}{s_p} \]</span></p></li>
<li><p><strong>Bias-Corrected Cohen’s d (<code>cohens-d-corrected</code>) / Bias-Corrected Hedges’ g (<code>hedges-g-corrected</code>)</strong>: These functions apply a small-sample bias correction factor to Cohen’s d or Hedges’ g. This correction factor (an approximation) is multiplied by the calculated d or g value to provide a less biased estimate of the population effect size, especially for small sample sizes (<span class="math inline">\(n &lt; 20\)</span>). The correction factor is approximately <span class="math inline">\(1 - \frac{3}{4\nu - 1}\)</span>, where <span class="math inline">\(\nu = n_1+n_2-2\)</span> are the degrees of freedom.</p></li>
<li><p><strong>Exact Bias-Corrected Hedges’ g (<code>hedges-g*</code>)</strong>: Applies the precise bias correction factor <span class="math inline">\(J(\nu)\)</span> (based on the Gamma function) to Hedges’ g (or Cohen’s d with unbiased pooling). This provides the most theoretically accurate bias correction for small samples. <span class="math display">\[ g^* = g \cdot J(\nu) \]</span> where <span class="math inline">\(\nu = n_1+n_2-2\)</span> and <span class="math inline">\(J(\nu) = \frac{\Gamma(\nu/2)}{\sqrt{\nu/2} \Gamma((\nu-1)/2)}\)</span>.</p></li>
<li><p><strong>Glass’s Delta (<code>glass-delta</code>)</strong>: Measures the difference between two means divided by the standard deviation of the <em>control</em> group (conventionally group 2). <span class="math display">\[ \Delta = \frac{\bar{x}_1 - \bar{x}_2}{s_2} \]</span> This is useful when the control group’s variance is considered a better estimate of the population variance than a pooled variance, or when the intervention is expected to affect variance.</p></li>
</ul>
<p>The <strong>returned value</strong> from these functions represents the difference between the means of Group 1 and Group 2, expressed in units of the relevant standard deviation (pooled for Cohen’s/Hedges’, control group’s for Glass’s).</p>
<ul>
<li>A positive value indicates that the mean of Group 1 is greater than the mean of Group 2.</li>
<li>A negative value indicates that the mean of Group 1 is less than the mean of Group 2.</li>
<li>The magnitude of the value indicates the size of the difference relative to the spread of the data. Cohen’s informal guidelines for interpreting the magnitude of <em>d</em> (and often <em>g</em>) are:
<ul>
<li><span class="math inline">\(|d| \approx 0.2\)</span>: small effect</li>
<li><span class="math inline">\(|d| \approx 0.5\)</span>: medium effect</li>
<li><span class="math inline">\(|d| \approx 0.8\)</span>: large effect</li>
</ul></li>
</ul>
<p><strong>Comparison:</strong></p>
<ul>
<li><code>cohens-d</code> and <code>hedges-g</code> (as implemented here) are standard measures for the mean difference scaled by pooled standard deviation, assuming equal variances. Cohen’s d is more commonly cited, while Hedges’ g is often used when sample size is small.</li>
<li><code>cohens-d-corrected</code>, <code>hedges-g-corrected</code>, and <code>hedges-g*</code> are preferred over the standard <code>d</code>/<code>g</code> when sample sizes are small, as they provide less biased estimates of the population effect size. <code>hedges-g*</code> uses the most accurate correction formula.</li>
<li><code>glass-delta</code> is distinct in using only the control group’s standard deviation for scaling. Use this when the variance of the control group is more appropriate as a baseline (e.g., comparing an experimental group to a control, or if the intervention might affect variance).</li>
</ul>
<p>Let’s illustrate these with the sepal lengths from the iris dataset, using ‘virginica’ as group 1 and ‘setosa’ as group 2.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb108"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(stats/cohens-d virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 3.0772391640158845</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>(stats/cohens-d-corrected virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 3.053628633345686</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>(stats/cohens-d virginica-sepal-length setosa-sepal-length <span class="at">:biased</span>) <span class="co">;; =&gt; 3.1084809717263635</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>(stats/cohens-d-corrected virginica-sepal-length setosa-sepal-length <span class="at">:biased</span>) <span class="co">;; =&gt; 3.0851089343449623</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>(stats/cohens-d virginica-sepal-length setosa-sepal-length <span class="at">:avg</span>) <span class="co">;; =&gt; 3.0772391640158845</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>(stats/cohens-d-corrected virginica-sepal-length setosa-sepal-length <span class="at">:avg</span>) <span class="co">;; =&gt; 3.053628633345686</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>(stats/hedges-g virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 3.0772391640158845</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>(stats/hedges-g-corrected virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 3.053628633345686</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>(stats/hedges-g* virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 3.0536185452069557</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>(stats/glass-delta virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 4.488074566113517</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="ratio-family" class="level3">
<h3 class="anchored" data-anchor-id="ratio-family">Ratio Family</h3>
<p>Effect size measures in the ratio family quantify the difference between two group means as a multiplicative factor, rather than a difference. This is useful when comparing values that are inherently ratios or when expressing the effect in terms of relative change.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>means-ratio</code>, <code>means-ratio-corrected</code></li>
</ul>
</div>
</div>
<ul>
<li><p><strong>Ratio of Means</strong> (<code>means-ratio</code>): Calculates the ratio of the mean of the first group (<span class="math inline">\(\bar{x}_1\)</span>) to the mean of the second group (<span class="math inline">\(\bar{x}_2\)</span>). <span class="math display">\[ Ratio = \frac{\bar{x}_1}{\bar{x}_2} \]</span> A value greater than 1 means the first group’s mean is larger; less than 1 means it’s smaller. A value of 1 indicates equal means.</p></li>
<li><p><strong>Corrected Ratio of Means</strong> (<code>means-ratio-corrected</code>): Applies a small-sample bias correction to the simple ratio of means. This provides a less biased estimate of the population ratio, especially for small sample sizes. The correction is based on incorporating the variances of the two groups. This function is equivalent to calling <code>(means-ratio group1 group2 true)</code>.</p></li>
</ul>
<p>Use <code>means-ratio</code> for a direct, uncorrected ratio. Use <code>means-ratio-corrected</code> for a less biased estimate of the population ratio, particularly advisable with small sample sizes.</p>
<p>Let’s calculate these for the virginica and setosa sepal lengths from the iris dataset.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb109"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>(stats/means-ratio virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 1.316020775069916</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>(stats/means-ratio-corrected virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 1.3160781315136816</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="ordinal-non-parametric-family" class="level3">
<h3 class="anchored" data-anchor-id="ordinal-non-parametric-family">Ordinal / Non-parametric Family</h3>
<p>Effect size measures in the ordinal or non-parametric family are suitable for data that are not normally distributed, have outliers, or are measured on an ordinal scale. They are often based on comparing pairs of observations between two groups.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>cliffs-delta</code></li>
<li><code>ameasure</code>, <code>wmw-odds</code></li>
</ul>
</div>
</div>
<ul>
<li><p><strong>Cliff’s Delta</strong> (<code>cliffs-delta</code>): A non-parametric measure of the amount of separation or overlap between two distributions. It is calculated as the probability that a randomly selected observation from one group is greater than a randomly selected observation from the other group, minus the probability of the reverse:</p>
<p><span class="math display">\[\delta = P(X &gt; Y) - P(Y &gt; X)\]</span></p>
<p>It ranges from -1 (complete separation, with values in the second group always greater than values in the first) to +1 (complete separation, with values in the first group always greater than values in the second). A value of 0 indicates complete overlap (stochastic equality). It is a robust alternative to Cohen’s d when assumptions for parametric tests are not met.</p></li>
<li><p><strong>Vargha-Delaney A</strong> (<code>ameasure</code>): A non-parametric measure of stochastic superiority. It quantifies the probability that a randomly chosen value from the first sample (<code>group1</code>) is greater than a randomly chosen value from the second sample (<code>group2</code>).</p>
<p><span class="math display">\[A = P(X &gt; Y)\]</span></p>
<p>It ranges from 0 to 1. A value of 0.5 indicates stochastic equality (distributions are overlapping). Values &gt; 0.5 mean <code>group1</code> tends to have larger values; values &lt; 0.5 mean <code>group2</code> tends to have larger values. It is directly related to Cliff’s Delta: <span class="math inline">\(A = (\delta + 1)/2\)</span>.</p></li>
<li><p><strong>Wilcoxon-Mann-Whitney Odds</strong> (<code>wmw-odds</code>): This non-parametric measure quantifies the odds that a randomly chosen observation from the first group (<code>group1</code>) is greater than a randomly chosen observation from the second group (<code>group2</code>).</p>
<p><span class="math display">\[\psi = \frac{P(X &gt; Y)}{P(Y &gt; X)} = \frac{1 + \delta}{1 - \delta}\]</span></p>
<p>It ranges from 0 to infinity. A value of 1 indicates stochastic equality. Values &gt; 1 mean <code>group1</code> values tend to be larger; values &lt; 1 mean <code>group1</code> values tend to be smaller. The natural logarithm of ψ is the log-odds that a random observation from group 1 is greater than a random observation from group 2.</p></li>
</ul>
<p>These three measures (<code>cliffs-delta</code>, <code>ameasure</code>, <code>wmw-odds</code>) are non-parametric and robust, making them suitable for ordinal data or when assumptions of normality and equal variances are violated. They are inter-related and can be transformed into one another. Cliff’s Delta is centered around 0, A is centered around 0.5, and WMW Odds is centered around 1 (or 0 on a log scale), offering different interpretations of the effect magnitude and direction.</p>
<p>Let’s illustrate these with the sepal lengths from the iris dataset, using ‘virginica’ as group 1 and ‘setosa’ as group 2.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb110"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>(stats/cliffs-delta virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.9692</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>(stats/ameasure virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.9846</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>(stats/wmw-odds virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 63.93506493506461</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="overlap-family" class="level3">
<h3 class="anchored" data-anchor-id="overlap-family">Overlap Family</h3>
<p>Measures quantifying the degree to which two distributions share common values. These metrics assess how much the data from one group tends to blend or overlap with the data from another group. They provide an alternative perspective on effect size compared to mean differences or ratios, which is particularly useful when the focus is on the proportion of scores that are shared or distinct between groups.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>p-overlap</code></li>
<li><code>cohens-u1-normal</code>, <code>cohens-u2-normal</code>, <code>cohens-u3-normal</code></li>
<li><code>cohens-u1</code>, <code>cohens-u2</code>, <code>cohens-u3</code></li>
</ul>
</div>
</div>
<p>These functions provide different ways to quantify overlap:</p>
<ul>
<li><p><strong><code>p-overlap</code></strong>: Estimates the proportion of overlap between two distributions based on Kernel Density Estimation (KDE). It calculates the area under the minimum of the two estimated density functions.</p>
<p><span class="math display">\[ \text{Overlap} = \int_{-\infty}^{\infty} \min(f_1(x), f_2(x)) \, dx \]</span></p>
<p>This measure is non-parametric, meaning it doesn’t assume the data comes from a specific distribution (like normal), and it is symmetric (<code>p-overlap(A, B) == p-overlap(B, A)</code>). The result is a proportion between 0 (no overlap) and 1 (complete overlap, identical distributions).</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb111"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>(stats/p-overlap virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.12090979659086024</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>(stats/p-overlap virginica-sepal-length setosa-sepal-length {<span class="at">:kde</span> <span class="at">:epanechnikov</span>, <span class="at">:bandwidth</span> <span class="fl">0.7</span>}) <span class="co">;; =&gt; 0.15938870929802704</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/25.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/26.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li><strong>Cohen’s U measures (<code>cohens-u1-normal</code>, <code>cohens-u2-normal</code>, <code>cohens-u3-normal</code>)</strong>: These are measures of non-overlap or overlap derived from Cohen’s d, assuming <strong>normal distributions</strong> with <strong>equal variances</strong>. They quantify the proportion of one group’s scores that fall beyond a certain point in relation to the other group.
<ul>
<li><strong><code>cohens-u1-normal</code></strong>: Quantifies the proportion of scores in the <em>lower</em>-scoring group that overlap with the scores in the <em>higher</em>-scoring group. Calculated from Cohen’s d (<span class="math inline">\(d\)</span>) using the standard normal CDF (<span class="math inline">\(\Phi\)</span>) as <span class="math inline">\((2\Phi(|d|/2) - 1) / \Phi(|d|/2)\)</span>. Range is [0, 1]. 0 means no overlap, 1 means complete overlap.</li>
<li><strong><code>cohens-u2-normal</code></strong>: Quantifies the proportion of scores in the <em>lower</em>-scoring group that are below the point located halfway between the means of the two groups. Calculated as <span class="math inline">\(\Phi(|d|/2)\)</span>. Range is [0, 1]. 0.5 means perfect overlap (medians are at the same point), 0 or 1 means no overlap (distributions are far apart).</li>
<li><strong><code>cohens-u3-normal</code></strong>: Quantifies the proportion of scores in the <em>lower</em>-scoring group that fall below the mean of the <em>higher</em>-scoring group. Calculated as <span class="math inline">\(\Phi(d)\)</span>. Range is [0, 1]. This measure is <strong>asymmetric</strong>: <code>U3(A, B)</code> is the proportion of B below A’s mean; <code>U3(B, A)</code> is the proportion of A below B’s mean.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb112"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>(stats/cohens-u1-normal virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.9339603379976781</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>(stats/cohens-u2-normal virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.9380514024419309</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>(stats/cohens-u3-normal virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.9989553620117301</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/27.png">
</div>
<ul>
<li><strong>Non-parametric Cohen’s U measures (<code>cohens-u1</code>, <code>cohens-u2</code>, <code>cohens-u3</code>)</strong>: These are analogous measures that do <strong>not assume normality</strong> or equal variances. They are based on comparing percentiles or medians of the empirical distributions.
<ul>
<li><strong><code>cohens-u1</code></strong>: Non-parametric measure of difference/separation, related to [<a href="#cohens-u2">cohens-u2</a>]. Its value indicates greater separation as it increases towards +1, and more overlap as it approaches -1. Symmetric.</li>
<li><strong><code>cohens-u2</code></strong>: Quantifies the minimum overlap between corresponding quantiles. It finds the smallest distance between quantiles <span class="math inline">\(q\)</span> and <span class="math inline">\(1-q\)</span> of the two distributions across <span class="math inline">\(q \in [0.5, 1.0]\)</span>. Range is typically [0, max_diff]. It is symmetric.</li>
<li><strong><code>cohens-u3</code></strong>: Quantifies the proportion of values in the second group (<code>group2</code>) that are less than the median of the first group (<code>group1</code>). This is a non-parametric version of the concept behind <code>cohens-u3-normal</code>, but is calculated directly from the empirical distributions’ medians and CDFs. Range is [0, 1]. This measure is also <strong>asymmetric</strong>.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb113"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>(stats/cohens-u1 virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.9372815512903497</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>(stats/cohens-u2 virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 0.9409830056250525</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>(stats/cohens-u3 virginica-sepal-length setosa-sepal-length) <span class="co">;; =&gt; 1.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Comparison:</strong></p>
<ul>
<li>Use <code>p-overlap</code> for a robust, non-parametric, symmetric measure of direct area overlap based on estimated densities.</li>
<li>Use <code>cohens-u*-normal</code> functions when you are comfortable assuming normality and equal variances, and want measures directly derived from Cohen’s d.&nbsp;<code>u1</code>, <code>u2</code>, and <code>u3</code> offer slightly different views of overlap/separation relative to means and standard deviations.</li>
<li>Use non-parametric <code>cohens-u*</code> functions when assumptions of normality are not met or when working with ordinal data. <code>u2</code> is a symmetric overlap measure based on quantiles, while <code>u3</code> is an asymmetric measure based on comparing to the median.</li>
</ul>
</section>
<section id="correlation-association-family" class="level3">
<h3 class="anchored" data-anchor-id="correlation-association-family">Correlation / Association Family</h3>
<p>Effect size measures in the correlation and association family quantify the strength and magnitude of the relationship between variables. Unlike difference-based measures (like Cohen’s d), these focus on how well one variable predicts or is associated with another, often in terms of shared or explained variance. They are widely used in regression, ANOVA, and general correlation analysis.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>pearson-r</code>, <code>r2-determination</code></li>
<li><code>eta-sq</code>, <code>omega-sq</code>, <code>epsilon-sq</code></li>
<li><code>cohens-f2</code>, <code>cohens-f</code>, <code>cohens-q</code></li>
<li><code>rank-eta-sq</code>, <code>rank-epsilon-sq</code></li>
</ul>
</div>
</div>
<ul>
<li><strong>Pearson r</strong> (<code>pearson-r</code>): The Pearson product-moment correlation coefficient. An alias for [<a href="#pearson-correlation">pearson-correlation</a>]. Measures the strength and direction of a <em>linear</em> relationship between two continuous variables (<span class="math inline">\(r\)</span>). Ranges from -1 to +1. <span class="math display">\[ r = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum(x_i - \bar{x})^2 \sum(y_i - \bar{y})^2}} \]</span></li>
<li><strong>R² Determination</strong> (<code>r2-determination</code>): The coefficient of determination. An alias for the standard [<a href="#r2">r2</a>] calculation between two sequences. For a simple linear relationship, this is the square of the Pearson correlation (<span class="math inline">\(R^2 = r^2\)</span>). It quantifies the proportion of the variance in one variable that is linearly predictable from the other. Ranges from 0 to 1. <span class="math display">\[ R^2 = 1 - \frac{RSS}{TSS} = \frac{SS_{regression}}{SS_{total}} \]</span></li>
<li><strong>Eta-squared</strong> (<code>eta-sq</code>): A measure of the proportion of the variance in a dependent variable that is associated with an independent variable. In the context of two numerical sequences, this function calculates <span class="math inline">\(R^2\)</span> from the simple linear regression of <code>group1</code> on <code>group2</code>. <span class="math display">\[ \eta^2 = \frac{SS_{regression}}{SS_{total}} \]</span></li>
<li><strong>Omega-squared</strong> (<code>omega-sq</code>): A less biased estimate of the population Eta-squared (<span class="math inline">\(\omega^2\)</span>). It estimates the proportion of variance in the dependent variable accounted for by the independent variable <em>in the population</em>. Often preferred over Eta-squared as a population effect size estimate, especially for small sample sizes. <span class="math display">\[ \omega^2 = \frac{SS_{regression} - p \cdot MSE}{SS_{total} + MSE} \]</span> where <span class="math inline">\(p\)</span> is the number of predictors (1 for simple linear regression) and <span class="math inline">\(MSE\)</span> is the Mean Squared Error of the residuals.</li>
<li><strong>Epsilon-squared</strong> (<code>epsilon-sq</code>): Another less biased estimate of population Eta-squared (<span class="math inline">\(\varepsilon^2\)</span>), similar to adjusted <span class="math inline">\(R^2\)</span>. Also aims to estimate the proportion of variance explained in the population. <span class="math display">\[ \varepsilon^2 = \frac{SS_{regression} - MSE}{SS_{total}} \]</span></li>
<li><strong>Cohen’s f²</strong> (<code>cohens-f2</code>): Measures the ratio of the variance explained by the effect to the unexplained variance. It can be calculated based on Eta-squared, Omega-squared, or Epsilon-squared (controlled by the <code>:type</code> parameter). Ranges from 0 upwards. <span class="math display">\[ f^2 = \frac{\text{Proportion of Variance Explained}}{\text{Proportion of Variance Unexplained}} = \frac{\eta^2}{1-\eta^2} \]</span></li>
<li><strong>Cohen’s f</strong> (<code>cohens-f</code>): The square root of Cohen’s f² (<span class="math inline">\(f = \sqrt{f^2}\)</span>). It quantifies the magnitude of the effect size in standardized units. Ranges from 0 upwards.</li>
</ul>
<p>Let’s look at the relationship between <code>mpg</code> (Miles Per Gallon) and <code>hp</code> (Horsepower) from the <code>mtcars</code> dataset. We expect a negative relationship (higher HP means lower MPG).</p>
<p>The Pearson r value shows a strong negative linear correlation (-0.77). Squaring this gives the R² (<code>r2-determination</code>, <code>eta-sq</code>), indicating that about 59% of the variance in MPG can be explained by the linear relationship with HP in this sample. <code>omega-sq</code> and <code>epsilon-sq</code> provide adjusted estimates for the population, which are slightly lower, as expected. Cohen’s f² and f quantify the magnitude of this effect, suggesting a large effect size according to conventional guidelines.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb114"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>(stats/pearson-r mpg hp) <span class="co">;; =&gt; -0.7761683718265864</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>(stats/r2-determination mpg hp) <span class="co">;; =&gt; 0.602437341423934</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>(stats/eta-sq mpg hp) <span class="co">;; =&gt; 0.602437341423934</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>(stats/omega-sq mpg hp) <span class="co">;; =&gt; 0.5814794357913807</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>(stats/epsilon-sq mpg hp) <span class="co">;; =&gt; 0.5891852528047318</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>(stats/cohens-f2 mpg hp) <span class="co">;; =&gt; 1.515326775360793</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>(stats/cohens-f2 mpg hp <span class="at">:omega</span>) <span class="co">;; =&gt; 1.3893688519007434</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>(stats/cohens-f2 mpg hp <span class="at">:epsilon-sq</span>) <span class="co">;; =&gt; 1.515326775360793</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>(stats/cohens-f mpg hp) <span class="co">;; =&gt; 1.2309860987682977</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>(stats/cohens-f mpg hp <span class="at">:omega</span>) <span class="co">;; =&gt; 1.178714915448491</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>(stats/cohens-f mpg hp <span class="at">:epsilon-sq</span>) <span class="co">;; =&gt; 1.2309860987682977</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ul>
<li><strong>Cohen’s q</strong> (<code>cohens-q</code>): Measures the difference between two correlation coefficients after applying the Fisher z-transformation (<code>atanh</code>). Useful for comparing the strength of correlation between different pairs of variables or in different samples. <span class="math display">\[ q = \text{atanh}(r_1) - \text{atanh}(r_2) \]</span></li>
</ul>
<p>Let’s compare correlations using <code>cohens-q</code>. We’ll compare the correlation between <code>mpg</code> and <code>hp</code> against the correlation between <code>mpg</code> and <code>wt</code> (weight). Second test is to compare correlation between setosa sepal widths and lengths against correlation between virginical sepal widths and lengths.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb115"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> r-mpg-hp </span>(stats/pearson-correlation mpg hp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb116"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> r-mpg-wt </span>(stats/pearson-correlation mpg wt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb117"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>r-mpg-hp <span class="co">;; =&gt; -0.7761683718265864</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>r-mpg-wt <span class="co">;; =&gt; -0.8676593765172276</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>(stats/cohens-q r-mpg-hp r-mpg-wt) <span class="co">;; =&gt; 0.2878712810066375</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>(stats/cohens-q mpg hp wt) <span class="co">;; =&gt; 0.2878712810066375</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>(stats/cohens-q setosa-sepal-width setosa-sepal-length virginica-sepal-width virginica-sepal-length) <span class="co">;; =&gt; 0.4718354551725414</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>The <code>cohens-q</code> value quantifies the difference in the strength of these two (dependent) correlations. A larger absolute value of <code>q</code> suggests a more substantial difference between the correlation coefficients.</p>
<ul>
<li><strong>Rank Eta-squared</strong> (<code>rank-eta-sq</code>): Effect size measure for the Kruskal-Wallis test. It represents the proportion of variation in the dependent variable accounted for by group membership, based on ranks. Ranges from 0 to 1. Calculated based on the Kruskal-Wallis H statistic (<span class="math inline">\(H\)</span>), number of groups (<span class="math inline">\(k\)</span>), and total sample size (<span class="math inline">\(n\)</span>). <span class="math display">\[ \eta^2_H = \frac{\max(0, H - (k-1))}{n - k} \]</span></li>
<li><strong>Rank Epsilon-squared</strong> (<code>rank-epsilon-sq</code>): Another effect size measure for the Kruskal-Wallis test, also based on ranks and providing a less biased estimate than Rank Eta-squared. Ranges from 0 to 1. Calculated based on <span class="math inline">\(H\)</span> and <span class="math inline">\(n\)</span>. <span class="math display">\[ \varepsilon^2_H = \frac{H}{n-1} \]</span></li>
</ul>
<p>We can treat the different species (setosa, virginica and versicolor) as groups and compare their sepal lengths using a non-parametric approach conceptually related to Kruskal-Wallis (though the function itself is a generic effect size calculation).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb118"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>(stats/rank-eta-sq (<span class="kw">vals</span> sepal-lengths)) <span class="co">;; =&gt; 0.6458328979635933</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>(stats/rank-eta-sq (<span class="kw">vals</span> sepal-widths)) <span class="co">;; =&gt; 0.41152809592198036</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>(stats/rank-epsilon-sq (<span class="kw">vals</span> sepal-lengths)) <span class="co">;; =&gt; 0.6505868187962968</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>(stats/rank-epsilon-sq (<span class="kw">vals</span> sepal-widths)) <span class="co">;; =&gt; 0.41942704765457123</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><strong>Comparison:</strong></p>
<ul>
<li><code>pearson-r</code> measures linear relationship direction and strength. <code>r2-determination</code> quantifies the proportion of shared variance (<span class="math inline">\(r^2\)</span>) for a simple linear relationship.</li>
<li><code>eta-sq</code>, <code>omega-sq</code>, and <code>epsilon-sq</code> all quantify the proportion of variance explained. <code>eta-sq</code> is a sample-based measure (equal to <span class="math inline">\(R^2\)</span> here), while <code>omega-sq</code> and <code>epsilon-sq</code> are less biased population estimates, preferred when generalizing beyond the sample.</li>
<li><code>cohens-f2</code> and <code>cohens-f</code> measure effect magnitude relative to unexplained variance. They are useful for power analysis and interpreting the practical significance of a regression or ANOVA effect. <code>cohens-f</code> is often more interpretable as it’s in the same units as standard deviations (though it’s not directly scaled by a single standard deviation like Cohen’s d).</li>
<li><code>cohens-q</code> is specifically for comparing correlation coefficients, assessing if the strength of relationship between two variables differs significantly from the strength between another pair or in another context.</li>
<li><code>rank-eta-sq</code> and <code>rank-epsilon-sq</code> are specific to rank-based tests like Kruskal-Wallis, providing effect sizes analogous to Eta-squared/Epsilon-squared but suitable for non-parametric data.</li>
</ul>
<p><strong>Interpretation Guidelines:</strong></p>
<ul>
<li><strong>Correlation (r):</strong>
<ul>
<li><span class="math inline">\(|r| &lt; 0.3\)</span>: weak/small linear relationship</li>
<li><span class="math inline">\(0.3 \le |r| &lt; 0.7\)</span>: moderate/medium linear relationship</li>
<li><span class="math inline">\(|r| \ge 0.7\)</span>: strong/large linear relationship</li>
</ul></li>
<li><strong>Proportion of Variance Explained (<span class="math inline">\(R^2, \eta^2, \omega^2, \varepsilon^2\)</span>):</strong>
<ul>
<li><span class="math inline">\(0.01\)</span>: small effect (1% of variance explained)</li>
<li><span class="math inline">\(0.06\)</span>: medium effect (6% of variance explained)</li>
<li><span class="math inline">\(0.14\)</span>: large effect (14% of variance explained)</li>
</ul></li>
<li><strong>Cohen’s f (and f²):</strong>
<ul>
<li><span class="math inline">\(f = 0.1\)</span> (<span class="math inline">\(f^2 = 0.01\)</span>): small effect</li>
<li><span class="math inline">\(f = 0.25\)</span> (<span class="math inline">\(f^2 \approx 0.06\)</span>): medium effect</li>
<li><span class="math inline">\(f = 0.4\)</span> (<span class="math inline">\(f^2 = 0.16\)</span>): large effect</li>
</ul></li>
</ul>
</section>
</section>
<section id="statistical-tests" class="level2">
<h2 class="anchored" data-anchor-id="statistical-tests">Statistical Tests</h2>
<p>Functions for hypothesis testing.</p>
<section id="normality-and-shape-tests" class="level3">
<h3 class="anchored" data-anchor-id="normality-and-shape-tests">Normality and Shape Tests</h3>
<p>These tests assess whether a dataset deviates significantly from a normal distribution, or exhibits specific characteristics related to skewness (asymmetry) and kurtosis (tailedness). Deviations from normality are important to check as many statistical methods assume normal data.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>skewness-test</code></li>
<li><code>kurtosis-test</code></li>
<li><code>normality-test</code></li>
<li><code>jarque-bera-test</code></li>
<li><code>bonett-seier-test</code></li>
</ul>
</div>
</div>
<p><code>fastmath.stats</code> provides several functions for these tests:</p>
<ul>
<li><code>skewness-test</code>: Tests if the sample skewness significantly differs from the zero skewness expected of a normal distribution. It calculates a standardized test statistic (approximately Z) and its p-value. By default, it uses the <code>:g1</code> type of skewness (Pearson’s moment coefficient).</li>
<li><code>kurtosis-test</code>: Tests if the sample kurtosis significantly differs from the value expected of a normal distribution (3 for raw kurtosis, 0 for excess kurtosis). It also calculates a standardized test statistic (approximately Z) and its p-value. By default, it uses the <code>:kurt</code> type of kurtosis (Excess Kurtosis + 3).</li>
<li><code>normality-test</code>: The D’Agostino-Pearson K² test. This is an omnibus test that combines the skewness and kurtosis tests into a single statistic (<span class="math inline">\(K^2 = Z_{skewness}^2 + Z_{kurtosis}^2\)</span>). <span class="math inline">\(K^2\)</span> follows approximately a Chi-squared distribution with 2 degrees of freedom under the null hypothesis of normality. It tests for overall departure from normality. It internally uses the default <code>:g1</code> skewness and default <code>:kurt</code> kurtosis types from the individual tests.</li>
<li><code>jarque-bera-test</code>: Another omnibus test for normality based on sample skewness (<span class="math inline">\(S\)</span>, specifically type <code>:g1</code>) and excess kurtosis (<span class="math inline">\(K\)</span>, specifically type <code>:g2</code>). The test statistic is <span class="math inline">\(JB = \frac{n}{6}(S^2 + \frac{1}{4}K^2)\)</span>, which also follows approximately a Chi-squared distribution with 2 degrees of freedom under the null hypothesis. Similar to the K² test, it assesses whether the combined deviation in skewness and kurtosis is significant. Note that the specific <code>:g1</code> and <code>:g2</code> types are used <em>for the JB statistic formula</em> regardless of any <code>:type</code> option passed to the underlying <code>skewness</code> or <code>kurtosis</code> functions.</li>
<li><code>bonett-seier-test</code>: A test for normality based on Geary’s ‘g’ measure of kurtosis, which is more robust to outliers than standard moment-based kurtosis. It calculates a Z-statistic comparing the sample Geary’s ‘g’ to its expected value for a normal distribution (<span class="math inline">\(\sqrt{2/\pi}\)</span>). This test specifically uses the <code>:geary</code> kurtosis type.</li>
</ul>
<p><strong>Interpretation:</strong> The output of these functions is typically a map containing:</p>
<ul>
<li><code>:stat</code> (or an alias like <code>:Z</code>, <code>:K2</code>, <code>:JB</code>, <code>:F</code>, <code>:chi2</code>): The calculated value of the test statistic.</li>
<li><code>:p-value</code>: The probability of observing a test statistic as extreme as, or more extreme than, the one calculated, assuming the null hypothesis (that the data comes from a normal distribution, or has the expected shape property) is true.</li>
<li>Other keys might include <code>:df</code> (degrees of freedom), <code>:skewness</code> (the value <em>of the type used in the test</em>), <code>:kurtosis</code> (the value <em>of the type used in the test</em>), <code>:n</code> (sample size), and <code>:sides</code> (the alternative hypothesis used).</li>
</ul>
<p>A small p-value (typically less than the chosen significance level, e.g., 0.05) suggests that the observed data is unlikely to have come from a normal distribution (or satisfy the specific shape property being tested), leading to rejection of the null hypothesis. A large p-value indicates that there is not enough evidence to reject the null hypothesis.</p>
<p>Let’s apply some of these tests to the <code>residual-sugar</code> data, which we observed earlier to be right-skewed. We’ll show the specific skewness/kurtosis values used by each test for clarity.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb119"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>(stats/skewness residual-sugar <span class="at">:g1</span>) <span class="co">;; =&gt; 1.0767638711454521</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:kurt</span>) <span class="co">;; =&gt; 6.465054296604846</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:g2</span>) <span class="co">;; =&gt; 3.4650542966048463</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis residual-sugar <span class="at">:geary</span>) <span class="co">;; =&gt; 0.8336299967214688</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>(stats/skewness-test residual-sugar) <span class="co">;; =&gt; {:p-value 0.0, :Z 25.47884190247254, :skewness 1.0767638711454521}</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>(stats/kurtosis-test residual-sugar) <span class="co">;; =&gt; {:p-value 0.0, :Z 20.004147071664516, :kurtosis 6.465054296604846}</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>(stats/normality-test residual-sugar) <span class="co">;; =&gt; {:p-value 0.0, :Z 1049.3372847559745, :skewness 1.0767638711454521, :kurtosis 6.465054296604846}</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>(stats/jarque-bera-test residual-sugar) <span class="co">;; =&gt; {:p-value 0.0, :Z 3396.8207586928006, :skewness 1.0767638711454521, :kurtosis 3.4650542966048463}</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>(stats/bonett-seier-test residual-sugar) <span class="co">;; =&gt; {:p-value 1.2876717402423177E-30, :stat -11.50208472276902, :Z -11.50208472276902, :kurtosis 0.8336299967214688, :n 4898, :sides :two-sided}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>As expected for the right-skewed <code>residual-sugar</code> data, the <code>skewness-test</code>, <code>normality-test</code> (K²), and <code>jarque-bera-test</code> yield very small p-values, strongly suggesting that the data is not normally distributed. The <code>kurtosis-test</code> and <code>bonett-seier-test</code> examine tailedness; their p-values indicate whether the deviation from normal kurtosis is significant.</p>
</section>
<section id="binomial-tests" class="level3">
<h3 class="anchored" data-anchor-id="binomial-tests">Binomial Tests</h3>
<p>These tests are designed for data representing counts of successes in a fixed number of trials, where each trial has only two possible outcomes (success or failure). They are used to make inferences about the true underlying proportion of successes in the population.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>binomial-test</code></li>
<li><code>binomial-ci</code></li>
</ul>
</div>
</div>
<p><strong><code>binomial-test</code></strong>: Performs an exact hypothesis test on a binomial proportion. This test is used to determine if the observed number of successes in a given number of trials is significantly different from what would be expected under a specific hypothesized probability of success (<span class="math inline">\(p_0\)</span>). The null hypothesis is typically <span class="math inline">\(H_0: p = p_0\)</span>.</p>
<pre><code>The test calculates a p-value based on the binomial probability distribution, assessing the likelihood of observing the sample results (or more extreme) if $p_0$ were the true population proportion.</code></pre>
<p>Let’s illustrate with some examples. Imagine we check the <code>am</code> column of the <code>mtcars</code> dataset, where 0 represents automatic and 1 represents manual transmission. We want to test if the proportion of cars with manual transmission is significantly different from 0.5 (an equal split). We also want to estimate a confidence interval for this proportion.</p>
<p>Let’s get the counts:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb121"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> mtcars-am </span>(ds/mtcars <span class="at">:am</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb122"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> manual-count </span>(<span class="kw">count</span> (<span class="kw">filter</span> m/one? mtcars-am)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb123"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> total-count </span>(<span class="kw">count</span> mtcars-am))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb124"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>manual-count <span class="co">;; =&gt; 13</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>total-count <span class="co">;; =&gt; 32</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>(stats/mean mtcars-am) <span class="co">;; =&gt; 0.40625</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Now, let’s perform the binomial test:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb125"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>(stats/binomial-test manual-count total-count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb126"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:ci-method</span> <span class="at">:asymptotic</span>,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [<span class="fl">0.4008057508099545</span> <span class="fl">0.4116942491900455</span>],</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> <span class="fl">0.40625</span>,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:p</span> <span class="fl">0.5</span>,</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.3770855874754484</span>,</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="dv">13</span>,</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:successes</span> <span class="dv">13</span>,</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>,</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:trials</span> <span class="dv">32</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb127"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>(stats/binomial-test manual-count total-count {<span class="at">:p</span> <span class="fl">0.5</span>, <span class="at">:sides</span> <span class="at">:one-sided-greater</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb128"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:ci-method</span> <span class="at">:asymptotic</span>,</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [<span class="fl">0.39533998822335753</span> <span class="fl">1.0</span>],</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> <span class="fl">0.40625</span>,</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:p</span> <span class="fl">0.5</span>,</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.8923364251386376</span>,</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="dv">13</span>,</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:successes</span> <span class="dv">13</span>,</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:one-sided-greater</span>,</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:trials</span> <span class="dv">32</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb129"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>(stats/binomial-test manual-count total-count {<span class="at">:p</span> <span class="fl">0.8</span>, <span class="at">:sides</span> <span class="at">:one-sided-less</span>, <span class="at">:alpha</span> <span class="fl">0.01</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb130"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.01</span>,</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:ci-method</span> <span class="at">:asymptotic</span>,</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [<span class="fl">0.0</span> <span class="fl">0.40842650129634167</span>],</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> <span class="fl">0.40625</span>,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.99</span>,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:p</span> <span class="fl">0.8</span>,</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">1.1904334239476455E-6</span>,</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="dv">13</span>,</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:successes</span> <span class="dv">13</span>,</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:one-sided-less</span>,</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:trials</span> <span class="dv">32</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output map from <code>binomial-test</code> contains:</p>
<ul>
<li><code>:p-value</code>: The probability of observing the sample result or more extreme outcomes if the true population proportion were equal to <code>:p</code>. A small p-value (typically &lt; 0.05) suggests evidence against the null hypothesis.</li>
<li><code>:stat</code>: The observed number of successes.</li>
<li><code>:estimate</code>: The observed proportion of successes (<code>:successes / :trials</code>).</li>
<li><code>:confidence-interval</code>: A confidence interval for the true population proportion, based on the observed data and using the specified <code>:ci-method</code> and <code>:alpha</code>.</li>
</ul>
<section id="binomial-confidence-intervals" class="level4">
<h4 class="anchored" data-anchor-id="binomial-confidence-intervals">Binomial Confidence Intervals</h4>
<p><strong><code>binomial-ci</code></strong>: Calculates a confidence interval for a binomial proportion. Given the observed number of successes and trials, this function estimates a range of values that is likely to contain the true population probability of success (<span class="math inline">\(p\)</span>) with a specified level of confidence.</p>
<p>The <code>binomial-ci</code> function offers various methods for calculating the confidence interval for a binomial proportion, controlled by the optional <code>method</code> keyword. These methods differ in their underlying assumptions and formulas, leading to intervals that can vary in width and coverage properties, particularly with small sample sizes or proportions close to 0 or 1.</p>
<p>Available <code>method</code> values:</p>
<ul>
<li><code>:asymptotic</code>: <strong>Normal Approximation (Wald) Interval</strong>. Based on the Central Limit Theorem, using the sample proportion and its estimated standard error. Simple to calculate but can have poor coverage (too narrow) for small sample sizes or proportions near 0 or 1.</li>
<li><code>:agresti-coull</code>: <strong>Agresti-Coull Interval</strong>. An adjusted Wald interval that adds ‘pseudo-counts’ (typically 2 successes and 2 failures) to the observed counts. This adjustment improves coverage and performance, especially for small samples.</li>
<li><code>:clopper-pearson</code>: <strong>Clopper-Pearson Interval</strong>. An ‘exact’ method based on inverting binomial tests. It provides guaranteed minimum coverage probability (i.e., the true proportion is included in the interval at least 100 * (1-alpha)% of the time). However, it is often wider than necessary and can be overly conservative.</li>
<li><code>:wilson</code>: <strong>Wilson Score Interval</strong>. Derived from the score test, which is based on the null hypothesis standard error rather than the observed standard error. It performs well across different sample sizes and probabilities and is generally recommended over the Wald interval.</li>
<li><code>:prop.test</code>: <strong>Continuity-Corrected Wald Interval</strong>. Applies a continuity correction to the Wald interval, similar to what is often used with the Chi-squared test for 2x2 tables.</li>
<li><code>:cloglog</code>: <strong>Complementary Log-log Transformation Interval</strong>. Calculates the interval on the clog-log scale and then transforms it back to the probability scale. Can be useful when dealing with skewed data or probabilities close to 0.</li>
<li><code>:logit</code>: <strong>Logit Transformation Interval</strong>. Calculates the interval on the logit scale (<code>log(p/(1-p))</code>) and transforms it back. Also useful for handling probabilities near boundaries.</li>
<li><code>:probit</code>: <strong>Probit Transformation Interval</strong>. Calculates the interval on the probit scale (inverse of the standard normal CDF) and transforms it back.</li>
<li><code>:arcsine</code>: <strong>Arcsine Transformation Interval</strong>. Calculates the interval using the arcsine square root transformation (<code>asin(sqrt(p))</code>) and transforms it back.</li>
<li><code>:all</code>: Calculates and returns a map of intervals from all the above methods.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb131"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count) <span class="co">;; =&gt; [0.23608446629942265 0.5764155337005774 0.40625]</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:asymptotic</span> <span class="fl">0.01</span>) <span class="co">;; =&gt; [0.18261458036097775 0.6298854196390222 0.40625]</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:asymptotic</span> <span class="fl">0.1</span>) <span class="co">;; =&gt; [0.26344258236512375 0.5490574176348763 0.40625]</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:agresti-coull</span>) <span class="co">;; =&gt; [0.25491682311999536 0.5776792765528302 0.40625]</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:clopper-pearson</span>) <span class="co">;; =&gt; [0.23698410097201839 0.5935507534231756 0.40625]</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:wilson</span>) <span class="co">;; =&gt; [0.25519634842665434 0.5773997512461713 0.40625]</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:prop.test</span>) <span class="co">;; =&gt; [0.24219139863150996 0.5921456974454622 0.40625]</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:cloglog</span>) <span class="co">;; =&gt; [0.238336877315159 0.5678979157795636 0.40625]</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:logit</span>) <span class="co">;; =&gt; [0.25256981246106547 0.5807794598608678 0.40625]</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:probit</span>) <span class="co">;; =&gt; [0.2495476615316991 0.5798499631463624 0.40625]</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:arcsine</span>) <span class="co">;; =&gt; [0.2450397617966424 0.578602376146695 0.40625]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>For methods other than <code>:all</code>, the function returns a vector <code>[lower-bound, upper-bound, estimated-p]</code>. * <code>lower-bound</code>, <code>upper-bound</code>: The ends of the calculated confidence interval. We are 100 * (1 - alpha)% confident that the true population proportion lies within this range. * <code>estimated-p</code>: The observed proportion of successes in the sample.</p>
<p>If the method is <code>:all</code>, a map is returned where keys are the method keywords and values are the <code>[lower, upper, estimate]</code> vectors for each method. Note that different methods can produce different interval widths and positions.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb132"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>(stats/binomial-ci manual-count total-count <span class="at">:all</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb133"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:agresti-coull</span> [<span class="fl">0.25491682311999536</span> <span class="fl">0.5776792765528302</span> <span class="fl">0.40625</span>],</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:arcsine</span> [<span class="fl">0.2450397617966424</span> <span class="fl">0.578602376146695</span> <span class="fl">0.40625</span>],</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:asymptotic</span> [<span class="fl">0.23608446629942265</span> <span class="fl">0.5764155337005774</span> <span class="fl">0.40625</span>],</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:cloglog</span> [<span class="fl">0.238336877315159</span> <span class="fl">0.5678979157795636</span> <span class="fl">0.40625</span>],</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:clopper-pearson</span> [<span class="fl">0.23698410097201839</span> <span class="fl">0.5935507534231756</span> <span class="fl">0.40625</span>],</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:logit</span> [<span class="fl">0.25256981246106547</span> <span class="fl">0.5807794598608678</span> <span class="fl">0.40625</span>],</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:probit</span> [<span class="fl">0.2495476615316991</span> <span class="fl">0.5798499631463624</span> <span class="fl">0.40625</span>],</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:prop.test</span> [<span class="fl">0.24219139863150996</span> <span class="fl">0.5921456974454622</span> <span class="fl">0.40625</span>],</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:wilson</span> [<span class="fl">0.25519634842665434</span> <span class="fl">0.5773997512461713</span> <span class="fl">0.40625</span>]}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="location-tests-tz-tests" class="level3">
<h3 class="anchored" data-anchor-id="location-tests-tz-tests">Location Tests (T/Z Tests)</h3>
<p>Location tests, specifically t-tests and z-tests, are fundamental statistical tools used to compare means. They help determine if the mean of a sample is significantly different from a known or hypothesized value (one-sample tests), or if the means of two different samples are significantly different from each other (two-sample tests). The choice between a t-test and a z-test typically depends on whether the population standard deviation is known and the sample size.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>t-test-one-sample</code>, <code>z-test-one-sample</code></li>
<li><code>t-test-two-samples</code>, <code>z-test-two-samples</code></li>
<li><code>p-value</code></li>
</ul>
</div>
</div>
<p><code>fastmath.stats</code> provides the following functions for location tests:</p>
<ul>
<li><p><code>t-test-one-sample</code>: Performs a one-sample Student’s t-test. This tests the null hypothesis that the true population mean (<span class="math inline">\(\mu\)</span>) is equal to a hypothesized value (<span class="math inline">\(\mu_0\)</span>). It is typically used when the population standard deviation is unknown and estimated from the sample. The test statistic follows a t-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom, where <span class="math inline">\(n\)</span> is the sample size.</p>
<p><span class="math display">\[ t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}} \]</span></p></li>
<li><p><code>z-test-one-sample</code>: Performs a one-sample Z-test. This tests the null hypothesis that the true population mean (<span class="math inline">\(\mu\)</span>) is equal to a hypothesized value (<span class="math inline">\(\mu_0\)</span>). It is typically used when the population standard deviation is known or when the sample size is large (generally <span class="math inline">\(n &gt; 30\)</span>), allowing the sample standard deviation to be used as a reliable estimate for the population standard deviation, and the test statistic approximates a standard normal distribution.</p>
<p><span class="math display">\[ z = \frac{\bar{x} - \mu_0}{\sigma/\sqrt{n}} \quad \text{or} \quad z \approx \frac{\bar{x} - \mu_0}{s/\sqrt{n}} \]</span></p></li>
<li><p><code>t-test-two-samples</code>: Performs a two-sample t-test to compare the means of two samples. It can perform:</p>
<ul>
<li><strong>Unpaired tests</strong>: For independent samples. By default, it performs Welch’s t-test (<code>:equal-variances? false</code>), which does not assume equal population variances. It can also perform Student’s t-test (<code>:equal-variances? true</code>), assuming equal variances and using a pooled standard deviation.</li>
<li><strong>Paired tests</strong>: For dependent samples (<code>:paired? true</code>), essentially performing a one-sample t-test on the differences between pairs. The null hypothesis is typically that the true difference between population means is zero, or equal to a hypothesized value (<span class="math inline">\(\mu_0\)</span>). The test statistic follows a t-distribution with degrees of freedom calculated appropriately for the specific variant (pooled for Student’s, Satterthwaite approximation for Welch’s, <span class="math inline">\(n-1\)</span> for paired).</li>
</ul></li>
<li><p><code>z-test-two-samples</code>: Performs a two-sample Z-test to compare the means of two independent or paired samples. Similar to the one-sample Z-test, it is used when population variances are known or samples are large. It can handle independent samples (with or without assuming equal variances, affecting the standard error calculation) or paired samples (by performing a one-sample Z-test on differences). The test statistic approximates a standard normal distribution.</p></li>
</ul>
<p><strong>Comparison:</strong></p>
<ul>
<li><strong>T vs Z</strong>: Choose Z-tests primarily when population standard deviations are known or with large samples (often <span class="math inline">\(n &gt; 30\)</span> for each group in two-sample tests), as the sampling distribution of the mean is well-approximated by the normal distribution. Use T-tests when population standard deviations are unknown and estimated from samples, especially with small to moderate sample sizes, as the sampling distribution is better described by the t-distribution.</li>
<li><strong>One-Sample vs Two-Sample</strong>: Use one-sample tests to compare a single sample mean against a known or hypothesized constant. Use two-sample tests to compare the means of two distinct samples.</li>
<li><strong>Paired vs Unpaired (Two-Sample)</strong>: Use paired tests when the two samples consist of paired observations (e.g., measurements before and after an intervention on the same subjects). Use unpaired tests for independent samples (e.g., comparing a treatment group to a control group with different subjects in each).</li>
<li><strong>Welch’s vs Student’s (Unpaired Two-Sample T-test)</strong>: Welch’s test is generally recommended as it does not assume equal variances, a common violation in practice. Student’s t-test requires the assumption of equal population variances.</li>
</ul>
<p>All these functions return a map containing key results, typically including the test statistic (<code>:t</code> or <code>:z</code>), <code>:p-value</code>, <code>:confidence-interval</code> for the mean (or mean difference), <code>:estimate</code> (sample mean or mean difference), sample size(s) (<code>:n</code>, <code>:nx</code>, <code>:ny</code>), <code>:mu</code> (hypothesized value), <code>:stderr</code> (standard error of the estimate), <code>:alpha</code> (significance level), and <code>:sides</code> (alternative hypothesis type). Two-sample tests also report <code>:paired?</code> and, if unpaired, <code>:equal-variances?</code>.</p>
<p><strong>Arguments:</strong></p>
<ul>
<li><code>xs</code> (sequence of numbers): The sample data for one-sample tests or the first sample for two-sample tests.</li>
<li><code>ys</code> (sequence of numbers): The second sample for two-sample tests.</li>
<li><code>params</code> (map, optional): A map of options. Common keys:
<ul>
<li><code>:alpha</code> (double, default <code>0.05</code>): Significance level. Confidence level is <span class="math inline">\(1 - \alpha\)</span>.</li>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Alternative hypothesis. Can be <code>:two-sided</code>, <code>:one-sided-greater</code>, or <code>:one-sided-less</code>.</li>
<li><code>:mu</code> (double, default <code>0.0</code>): Hypothesized population mean (one-sample) or hypothesized difference in population means (two-sample).</li>
<li><code>:paired?</code> (boolean, default <code>false</code>): For two-sample tests, specifies if samples are paired.</li>
<li><code>:equal-variances?</code> (boolean, default <code>false</code>): For unpaired two-sample tests, specifies if equal population variances are assumed (Student’s vs Welch’s).</li>
</ul></li>
</ul>
<p><strong>Return Value (Map):</strong></p>
<ul>
<li><code>:stat</code> (double): The calculated test statistic (alias <code>:t</code> or <code>:z</code>).</li>
<li><code>:p-value</code> (double): The probability of observing the test statistic or more extreme values under the null hypothesis.</li>
<li><code>:confidence-interval</code> (vector of doubles): <code>[lower-bound, upper-bound]</code>. A range likely containing the true population mean (one-sample) or mean difference (two-sample) with <span class="math inline">\(1-\alpha\)</span> confidence. Includes the estimate as a third value (e.g., <code>[lower upper estimate]</code>).</li>
<li><code>:estimate</code> (double): The sample mean (one-sample) or the difference between sample means (two-sample).</li>
<li><code>:n</code> (long or vector of longs): Sample size (one-sample) or sample sizes <code>[nx ny]</code> (two-sample).</li>
<li><code>:nx</code>, <code>:ny</code> (long): Sample sizes of <code>xs</code> and <code>ys</code> respectively (two-sample unpaired).</li>
<li><code>:estimated-mu</code> (vector of doubles): Sample means <code>[mean xs, mean ys]</code> (two-sample unpaired).</li>
<li><code>:mu</code> (double): The hypothesized value used in the null hypothesis.</li>
<li><code>:stderr</code> (double): The standard error of the sample mean or mean difference.</li>
<li><code>:alpha</code> (double): The significance level used.</li>
<li><code>:sides</code> / <code>:test-type</code> (keyword): The alternative hypothesis side.</li>
<li><code>:df</code> (long or vector of longs): Degrees of freedom (t-tests only).</li>
<li><code>:paired?</code> (boolean): Indicates if a paired test was performed (two-sample only).</li>
<li><code>:equal-variances?</code> (boolean): Indicates if equal variances were assumed (two-sample unpaired only).</li>
</ul>
<p><strong>Helper function <code>p-value</code>:</strong></p>
<p>The <code>p-value</code> function is a general utility used internally by many statistical tests (including t-tests and z-tests) to calculate the p-value from a given test statistic, its null distribution, and the specified alternative hypothesis (sides). It determines the probability of observing a statistic value as extreme as or more extreme than the one obtained from the sample, assuming the null hypothesis is true. The interpretation of ‘extreme’ depends on whether a two-sided, one-sided-greater, or one-sided-less test is performed. For discrete distributions, a continuity correction is applied.</p>
<p>Let’s apply these tests. First, one-sample tests on <code>mpg</code> data against a hypothesized mean of 20.0:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb134"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>(stats/t-test-one-sample mpg {<span class="at">:mu</span> <span class="fl">20.0</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb135"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [<span class="fl">17.917678508746246</span> <span class="fl">22.263571491253753</span>],</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="dv">31</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> <span class="fl">20.090625</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:mu</span> <span class="fl">20.0</span>,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="dv">32</span>,</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.9327606409093825</span>,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">0.08506003568133355</span>,</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:stderr</span> <span class="fl">1.0654239593728148</span>,</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:t</span> <span class="fl">0.08506003568133355</span>,</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb136"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>(stats/z-test-one-sample mpg {<span class="at">:mu</span> <span class="fl">20.0</span>, <span class="at">:sides</span> <span class="at">:one-sided-greater</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb137"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [<span class="fl">18.338158536184626</span> <span class="at">##</span>Inf],</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> <span class="fl">20.090625</span>,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:mu</span> <span class="fl">20.0</span>,</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="dv">32</span>,</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.4661068310107286</span>,</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">0.08506003568133355</span>,</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:stderr</span> <span class="fl">1.0654239593728148</span>,</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:one-sided-greater</span>,</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:z</span> <span class="fl">0.08506003568133355</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, two-sample tests comparing <code>setosa-sepal-length</code> and <code>virginica-sepal-length</code>. We’ll use unpaired tests first, comparing Welch’s and Student’s:</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb138"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>(stats/t-test-two-samples setosa-sepal-length virginica-sepal-length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb139"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [-<span class="fl">1.7867603323573877</span> -<span class="fl">1.3772396676426117</span>],</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="fl">76.51586702413655</span>,</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:equal-variances</span>? <span class="va">false</span>,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> -<span class="fl">1.5819999999999999</span>,</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimated-mu</span> [<span class="fl">5.006</span> <span class="fl">6.588</span>],</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:mu</span> <span class="fl">0.0</span>,</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> [<span class="dv">50</span> <span class="dv">50</span>],</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:nx</span> <span class="dv">50</span>,</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:ny</span> <span class="dv">50</span>,</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">3.966867270985708E-25</span>,</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:paired</span>? <span class="va">false</span>,</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> -<span class="fl">15.386195820079422</span>,</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:stderr</span> <span class="fl">0.10281943753344443</span>,</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:t</span> -<span class="fl">15.386195820079422</span>,</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb140"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>(stats/t-test-two-samples setosa-sepal-length virginica-sepal-length {<span class="at">:equal-variances</span>? <span class="va">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb141"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [-<span class="fl">1.786041827461154</span> -<span class="fl">1.377958172538846</span>],</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="fl">98.0</span>,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:equal-variances</span>? <span class="va">true</span>,</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> -<span class="fl">1.5819999999999999</span>,</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimated-mu</span> [<span class="fl">5.006</span> <span class="fl">6.588</span>],</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:mu</span> <span class="fl">0.0</span>,</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> [<span class="dv">50</span> <span class="dv">50</span>],</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:nx</span> <span class="dv">50</span>,</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:ny</span> <span class="dv">50</span>,</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">6.892546060673613E-28</span>,</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:paired</span>? <span class="va">false</span>,</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> -<span class="fl">15.386195820079422</span>,</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:stderr</span> <span class="fl">0.10281943753344443</span>,</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:t</span> -<span class="fl">15.386195820079422</span>,</span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And the corresponding Z-tests (note the Z-test doesn’t need degrees of freedom):</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb142"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>(stats/z-test-two-samples setosa-sepal-length virginica-sepal-length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb143"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [-<span class="fl">1.7835223944762166</span> -<span class="fl">1.380477605523783</span>],</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:equal-variances</span>? <span class="va">false</span>,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> -<span class="fl">1.5819999999999999</span>,</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimated-mu</span> [<span class="fl">5.006</span> <span class="fl">6.588</span>],</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:mu</span> <span class="fl">0.0</span>,</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> [<span class="dv">50</span> <span class="dv">50</span>],</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:nx</span> <span class="dv">50</span>,</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:ny</span> <span class="dv">50</span>,</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">2.0259860303505476E-53</span>,</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:paired</span>? <span class="va">false</span>,</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> -<span class="fl">15.386195820079422</span>,</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:stderr</span> <span class="fl">0.10281943753344443</span>,</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>,</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:z</span> -<span class="fl">15.386195820079422</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb144"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>(stats/z-test-two-samples setosa-sepal-length virginica-sepal-length {<span class="at">:equal-variances</span>? <span class="va">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb145"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [-<span class="fl">1.7835223944762166</span> -<span class="fl">1.380477605523783</span>],</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:equal-variances</span>? <span class="va">true</span>,</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> -<span class="fl">1.5819999999999999</span>,</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimated-mu</span> [<span class="fl">5.006</span> <span class="fl">6.588</span>],</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:mu</span> <span class="fl">0.0</span>,</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> [<span class="dv">50</span> <span class="dv">50</span>],</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:nx</span> <span class="dv">50</span>,</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:ny</span> <span class="dv">50</span>,</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">2.0259860303505476E-53</span>,</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:paired</span>? <span class="va">false</span>,</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> -<span class="fl">15.386195820079422</span>,</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:stderr</span> <span class="fl">0.10281943753344443</span>,</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>,</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:z</span> -<span class="fl">15.386195820079422</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we had paired data (e.g., <code>hp</code> measurements before and after a modification for the same cars, stored in <code>hp-before</code> and <code>hp-after</code>), we would use the paired option:</p>
<p>Assume <code>hp-before</code> and <code>hp-after</code> are sequences of the same length</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb146"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> hp-before </span>[<span class="dv">100</span> <span class="dv">120</span> <span class="dv">150</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb147"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> hp-after </span>[<span class="dv">110</span> <span class="dv">125</span> <span class="dv">165</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb148"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>(stats/t-test-two-samples hp-before hp-after {<span class="at">:paired</span>? <span class="va">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb149"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [-<span class="fl">22.420688558603995</span> <span class="fl">2.4206885586039952</span>],</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="dv">2</span>,</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> -<span class="fl">10.0</span>,</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:mu</span> <span class="fl">0.0</span>,</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="dv">3</span>,</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.07417990022744848</span>,</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:paired</span>? <span class="va">true</span>,</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> -<span class="fl">3.4641016151377544</span>,</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stderr</span> <span class="fl">2.886751345948129</span>,</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:t</span> -<span class="fl">3.4641016151377544</span>,</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb150"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>(stats/z-test-two-samples hp-before hp-after {<span class="at">:paired</span>? <span class="va">true</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb151"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [-<span class="fl">15.65792867038086</span> -<span class="fl">4.3420713296191416</span>],</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> -<span class="fl">10.0</span>,</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:mu</span> <span class="fl">0.0</span>,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="dv">3</span>,</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">5.320055051392497E-4</span>,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:paired</span>? <span class="va">true</span>,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> -<span class="fl">3.4641016151377544</span>,</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:stderr</span> <span class="fl">2.886751345948129</span>,</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>,</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:z</span> -<span class="fl">3.4641016151377544</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variance-tests" class="level3">
<h3 class="anchored" data-anchor-id="variance-tests">Variance Tests</h3>
<p>Variance tests are used to assess whether the variances of two or more independent samples are statistically different. The null hypothesis for these tests is typically that the population variances are equal (homogeneity of variances, or homoscedasticity). This assumption is important for many statistical procedures, such as ANOVA and Student’s t-test.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>f-test</code></li>
<li><code>levene-test</code></li>
<li><code>brown-forsythe-test</code></li>
<li><code>fligner-killeen-test</code></li>
</ul>
</div>
</div>
<ul>
<li><p><code>f-test</code>: Performs an F-test for the equality of variances of <strong>two</strong> independent samples.</p>
<p>It calculates the ratio of the sample variances (<span class="math inline">\(s_1^2 / s_2^2\)</span>) which follows an F-distribution under the null hypothesis of equal population variances, assuming the data in both groups are normally distributed.</p>
<p><span class="math display">\[ F = \frac{s_1^2}{s_2^2} \]</span></p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The first sample.</li>
<li><code>ys</code> (seq of numbers): The second sample.</li>
<li><code>params</code> (map, optional): Options map with <code>:sides</code> (default <code>:two-sided</code>) and <code>:alpha</code> (default <code>0.05</code>).</li>
</ul>
<p>Returns a map with keys like <code>:F</code> (the F-statistic), <code>:p-value</code>, <code>:df</code> ([numerator-df, denominator-df]), <code>:estimate</code> (the variance ratio), <code>:n</code> ([nx, ny]), and <code>:sides</code>.</p>
<p>Assumptions: Independent samples, normality within each sample. Sensitive to departures from normality.</p></li>
<li><p><code>levene-test</code>: Performs Levene’s test for homogeneity of variances across <strong>two or more</strong> independent groups.</p>
<p>This test is more robust to departures from normality than the F-test. It performs a one-way ANOVA on the absolute deviations of each observation from its group’s <strong>mean</strong>.</p>
<p><span class="math display">\[ W = \frac{N-k}{k-1} \frac{\sum_{i=1}^k n_i (\bar{Z}_{i\cdot} - \bar{Z}_{\cdot\cdot})^2}{\sum_{i=1}^k \sum_{j=1}^{n_i} (Z_{ij} - \bar{Z}_{i\cdot})^2} \]</span></p>
<p>where <span class="math inline">\(Z_{ij} = |X_{ij} - \bar{X}_{i\cdot}|\)</span> are the absolute deviations from the group means, <span class="math inline">\(N\)</span> is total sample size, <span class="math inline">\(k\)</span> is number of groups, <span class="math inline">\(n_i\)</span> is size of group <span class="math inline">\(i\)</span>, <span class="math inline">\(\bar{Z}_{i\cdot}\)</span> is mean of absolute deviations in group <span class="math inline">\(i\)</span>, and <span class="math inline">\(\bar{Z}_{\cdot\cdot}\)</span> is the grand mean of absolute deviations.</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences): Collection of groups.</li>
<li><code>params</code> (map, optional): Options map with <code>:sides</code> (default <code>:one-sided-greater</code>), <code>:statistic</code> (default [<a href="#mean">mean</a>]), and <code>:scorediff</code> (default [[abs]]).</li>
</ul>
<p>Returns a map with keys like <code>:W</code> (the F-statistic for the ANOVA on deviations), <code>:p-value</code>, <code>:df</code> ([DFt, DFe]), <code>:n</code> (group sizes), and standard ANOVA output keys.</p>
<p>Assumptions: Independent samples. Less sensitive to non-normality than F-test.</p></li>
<li><p><code>brown-forsythe-test</code>: Performs the Brown-Forsythe test, a modification of Levene’s test using the <strong>median</strong> as the center.</p>
<p>This version is even more robust to non-normality than the standard Levene’s test. It performs an ANOVA on the absolute deviations from group <strong>medians</strong>.</p>
<p><span class="math display">\[ F^* = \frac{N-k}{k-1} \frac{\sum_{i=1}^k n_i (\tilde{Z}_{i\cdot} - \tilde{Z}_{\cdot\cdot})^2}{\sum_{i=1}^k \sum_{j=1}^{n_i} (Z_{ij} - \tilde{Z}_{i\cdot})^2} \]</span></p>
<p>where <span class="math inline">\(Z_{ij} = |X_{ij} - \tilde{X}_{i\cdot}|\)</span> are the absolute deviations from the group medians, <span class="math inline">\(\tilde{Z}_{i\cdot}\)</span> is the median of absolute deviations in group <span class="math inline">\(i\)</span>, and <span class="math inline">\(\tilde{Z}_{\cdot\cdot}\)</span> is the grand median of absolute deviations.</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences): Collection of groups.</li>
<li><code>params</code> (map, optional): Options map with <code>:sides</code> (default <code>:one-sided-greater</code>) and <code>:scorediff</code> (default [[abs]]). Internally sets <code>:statistic</code> to [<a href="#median">median</a>] in [<a href="#levene-test">levene-test</a>].</li>
</ul>
<p>Returns a map similar to <code>levene-test</code>, with an F-statistic derived from the ANOVA on median deviations.</p>
<p>Assumptions: Independent samples. Most robust to non-normality among parametric-based tests.</p></li>
<li><p><code>fligner-killeen-test</code>: Performs the Fligner-Killeen test for homogeneity of variances across <strong>two or more</strong> independent groups.</p>
<p>This is a non-parametric test based on ranks of the absolute deviations from group medians. It is generally considered one of the most robust tests for homogeneity of variances when assumptions about the underlying distribution are questionable.</p>
<p>The test statistic is based on the ranks of <span class="math inline">\(|X_{ij} - \tilde{X}_{i\cdot}|\)</span>, where <span class="math inline">\(\tilde{X}_{i\cdot}\)</span> is the median of group <span class="math inline">\(i\)</span>.</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences): Collection of groups.</li>
<li><code>params</code> (map, optional): Options map with <code>:sides</code> (default <code>:one-sided-greater</code>).</li>
</ul>
<p>Returns a map with keys like <code>:chi2</code> (the Chi-squared statistic), <code>:p-value</code>, <code>:df</code> (number of groups - 1), <code>:n</code> (group sizes), and standard ANOVA output keys (calculated on transformed ranks).</p>
<p>Assumptions: Independent samples. Non-parametric, robust to non-normality. Requires distributions to have similar shape for valid inference.</p></li>
</ul>
<p>Comparison: - The F-test is simple but highly sensitive to non-normality. Use cautiously if data isn’t clearly normal. - Levene’s and Brown-Forsythe tests are more robust to non-normality. Brown-Forsythe (median-based) is generally preferred over standard Levene’s (mean-based) when distributions are potentially heavy-tailed or skewed. - Fligner-Killeen is a non-parametric alternative and the most robust to non-normality, based on ranks.</p>
<p>The choice depends on sample size, suspected distribution shape, and the need for robustness.</p>
<p><strong>Function-specific keys:</strong></p>
<ul>
<li><code>f-test</code> additionally returns:
<ul>
<li><code>:F</code>: The calculated F-statistic (ratio of sample variances, Var(xs) / Var(ys)). Alias for <code>:stat</code>.</li>
<li><code>:nx</code>, <code>:ny</code>: Sample sizes of the first (<code>xs</code>) and second (<code>ys</code>) groups.</li>
<li><code>:estimate</code>: The ratio of the sample variances (same value as <code>:F</code>).</li>
<li><code>:confidence-interval</code>: A confidence interval for the true ratio of population variances (Var(xs) / Var(ys)).</li>
</ul></li>
<li><code>levene-test</code> and <code>brown-forsythe-test</code> additionally return:
<ul>
<li><code>:W</code>: The calculated test statistic (which is an F-statistic derived from the ANOVA on deviations). Alias for <code>:stat</code>.</li>
<li><code>:F</code>: Alias for <code>:W</code> (as it’s an F-statistic).</li>
<li><code>:SSt</code>: Sum of Squares Treatment (between groups of deviations).</li>
<li><code>:SSe</code>: Sum of Squares Error (within groups of deviations).</li>
<li><code>:DFt</code>: Degrees of Freedom Treatment (number of groups - 1).</li>
<li><code>:DFe</code>: Degrees of Freedom Error (total sample size - number of groups).</li>
<li><code>:MSt</code>: Mean Square Treatment (SSt / DFt).</li>
<li><code>:MSe</code>: Mean Square Error (SSe / DFe).</li>
</ul></li>
<li><code>fligner-killeen-test</code> additionally returns:
<ul>
<li><code>:chi2</code>: The calculated Chi-squared statistic. Alias for <code>:stat</code>.</li>
<li><code>:SSt</code>: Sum of Squares Treatment, calculated from transformed ranks.</li>
<li><code>:SSe</code>: Sum of Squares Error, calculated from transformed ranks.</li>
<li><code>:DFt</code>: Degrees of Freedom Treatment (number of groups - 1).</li>
<li><code>:DFe</code>: Degrees of Freedom Error (total sample size - number of groups).</li>
<li><code>:MSt</code>: Mean Square Treatment (SSt / DFt).</li>
<li><code>:MSe</code>: Mean Square Error (SSe / DFe).</li>
</ul></li>
</ul>
<p>Let’s apply these tests to compare variances of sepal lengths for ‘setosa’ and ‘virginica’ species, and then across all three species (including ‘versicolor’ from the original <code>sepal-lengths</code> map).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb152"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>(stats/f-test setosa-sepal-length virginica-sepal-length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb153"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:F</span> <span class="fl">0.30728619882096414</span>,</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [<span class="fl">0.1743775950172501</span> <span class="fl">0.5414962165868265</span>],</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> [<span class="dv">49</span> <span class="dv">49</span>],</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> <span class="fl">0.30728619882096414</span>,</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> [<span class="dv">50</span> <span class="dv">50</span>],</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:nx</span> <span class="dv">50</span>,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:ny</span> <span class="dv">50</span>,</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">6.366473152645907E-5</span>,</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">0.30728619882096414</span>,</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb154"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>(stats/levene-test (<span class="kw">vals</span> sepal-lengths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb155"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:DFe</span> <span class="dv">147</span>,</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:DFt</span> <span class="dv">2</span>,</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSe</span> <span class="fl">0.09376069877551022</span>,</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSt</span> <span class="fl">0.6920563200000005</span>,</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSe</span> <span class="fl">13.782822720000002</span>,</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSt</span> <span class="fl">1.384112640000001</span>,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:W</span> <span class="fl">7.381091747801285</span>,</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> [<span class="dv">2</span> <span class="dv">147</span>],</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> (<span class="dv">50</span> <span class="dv">50</span> <span class="dv">50</span>),</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">8.817887814641656E-4</span>,</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">7.381091747801285</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb156"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>(stats/brown-forsythe-test (<span class="kw">vals</span> sepal-lengths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb157"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:DFe</span> <span class="dv">147</span>,</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:DFt</span> <span class="dv">2</span>,</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSe</span> <span class="fl">0.10096462585034013</span>,</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSt</span> <span class="fl">0.6414000000000003</span>,</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSe</span> <span class="fl">14.8418</span>,</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSt</span> <span class="fl">1.2828000000000006</span>,</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:W</span> <span class="fl">6.352720020482694</span>,</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> [<span class="dv">2</span> <span class="dv">147</span>],</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> (<span class="dv">50</span> <span class="dv">50</span> <span class="dv">50</span>),</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.0022585277836218998</span>,</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">6.352720020482694</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb158"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>(stats/fligner-killeen-test (<span class="kw">vals</span> sepal-lengths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb159"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:DFe</span> <span class="dv">147</span>,</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:DFt</span> <span class="dv">2</span>,</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSe</span> <span class="fl">0.3194726743934957</span>,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSt</span> <span class="fl">1.9857373674434182</span>,</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSe</span> <span class="fl">46.96248313584387</span>,</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSt</span> <span class="fl">3.9714747348868364</span>,</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:chi2</span> <span class="fl">11.617980621101287</span>,</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="dv">2</span>,</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> (<span class="dv">50</span> <span class="dv">50</span> <span class="dv">50</span>),</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.0030004580742586384</span>,</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">11.617980621101287</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also compare sepal widths across species using these tests.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb160"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>(stats/f-test (sepal-widths <span class="at">:setosa</span>) (sepal-widths <span class="at">:virginica</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb161"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:F</span> <span class="fl">1.3959028295592801</span>,</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> [<span class="fl">0.7921415905767488</span> <span class="fl">2.459843962499585</span>],</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> [<span class="dv">49</span> <span class="dv">49</span>],</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> <span class="fl">1.3959028295592801</span>,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> [<span class="dv">50</span> <span class="dv">50</span>],</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:nx</span> <span class="dv">50</span>,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:ny</span> <span class="dv">50</span>,</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.24654059117021854</span>,</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">1.3959028295592801</span>,</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:two-sided</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb162"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>(stats/levene-test (<span class="kw">vals</span> sepal-widths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb163"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:DFe</span> <span class="dv">147</span>,</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:DFt</span> <span class="dv">2</span>,</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSe</span> <span class="fl">0.04547069387755103</span>,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSt</span> <span class="fl">0.029199786666666727</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSe</span> <span class="fl">6.684192000000001</span>,</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSt</span> <span class="fl">0.058399573333333454</span>,</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:W</span> <span class="fl">0.642167166951519</span>,</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> [<span class="dv">2</span> <span class="dv">147</span>],</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> (<span class="dv">50</span> <span class="dv">50</span> <span class="dv">50</span>),</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.5276204473923196</span>,</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">0.642167166951519</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb164"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>(stats/brown-forsythe-test (<span class="kw">vals</span> sepal-widths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb165"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:DFe</span> <span class="dv">147</span>,</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:DFt</span> <span class="dv">2</span>,</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSe</span> <span class="fl">0.04818367346938773</span>,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSt</span> <span class="fl">0.031199999999999922</span>,</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSe</span> <span class="fl">7.082999999999997</span>,</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSt</span> <span class="fl">0.062399999999999844</span>,</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:W</span> <span class="fl">0.6475222363405323</span>,</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> [<span class="dv">2</span> <span class="dv">147</span>],</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> (<span class="dv">50</span> <span class="dv">50</span> <span class="dv">50</span>),</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.5248269975064549</span>,</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">0.6475222363405323</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb166"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>(stats/fligner-killeen-test (<span class="kw">vals</span> sepal-widths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb167"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:DFe</span> <span class="dv">147</span>,</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:DFt</span> <span class="dv">2</span>,</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSe</span> <span class="fl">0.3425246920779396</span>,</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSt</span> <span class="fl">0.17247526965670978</span>,</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSe</span> <span class="fl">50.35112973545712</span>,</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSt</span> <span class="fl">0.34495053931341957</span>,</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:chi2</span> <span class="fl">1.0138383496145384</span>,</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="dv">2</span>,</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> (<span class="dv">50</span> <span class="dv">50</span> <span class="dv">50</span>),</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.6023484534454747</span>,</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">1.0138383496145384</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="goodness-of-fit-and-independence-tests" class="level3">
<h3 class="anchored" data-anchor-id="goodness-of-fit-and-independence-tests">Goodness-of-Fit and Independence Tests</h3>
<p>These tests are used to evaluate how well an observed distribution of data matches a hypothesized theoretical distribution (Goodness-of-Fit) or whether there is a statistically significant association between two or more categorical variables (Independence). They are commonly applied to categorical data or data that has been grouped into categories (e.g., histograms).</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>power-divergence-test</code></li>
<li><code>chisq-test</code></li>
<li><code>multinomial-likelihood-ratio-test</code></li>
<li><code>minimum-discrimination-information-test</code></li>
<li><code>neyman-modified-chisq-test</code></li>
<li><code>freeman-tukey-test</code></li>
<li><code>cressie-read-test</code></li>
<li><code>ad-test-one-sample</code></li>
<li><code>ks-test-one-sample</code>, <code>ks-test-two-samples</code></li>
</ul>
</div>
</div>
<p><strong>Power Divergence Tests:</strong></p>
<p>The <code>power-divergence-test</code> is a generalized framework for several statistical tests that compare observed frequencies to expected frequencies. The specific test performed is determined by the <code>lambda</code> parameter.</p>
<p>The general test statistic is:</p>
<p><span class="math display">\[ 2 \sum_i O_i \left( \frac{\left(\frac{O_i}{E_i}\right)^\lambda - 1}{\lambda(\lambda+1)} \right) \]</span></p>
<p>where <span class="math inline">\(O_i\)</span> are the observed counts, <span class="math inline">\(E_i\)</span> are the expected counts, and <span class="math inline">\(\lambda\)</span> is the power parameter.</p>
<p>This test can be used for two main purposes:</p>
<ul>
<li><strong>Goodness-of-Fit:</strong> Testing if a sequence of observed counts matches a set of expected counts (proportions/weights) or if a dataset matches a theoretical distribution.</li>
<li><strong>Independence:</strong> Testing if there is an association between categorical variables in a contingency table.</li>
</ul>
<p>The test statistic approximately follows a Chi-squared distribution with degrees of freedom determined by the specific application (e.g., number of categories - 1 - number of estimated parameters for GOF, <span class="math inline">\((rows-1)(cols-1)\)</span> for independence).</p>
<p><code>fastmath.stats</code> provides the general <code>power-divergence-test</code> and aliases for common <code>lambda</code> values:</p>
<ul>
<li><code>chisq-test</code>: Pearson’s Chi-squared test (<span class="math inline">\(\lambda=1\)</span>). The most common test in this family. <span class="math display">\[ \chi^2 = \sum_i \frac{(O_i - E_i)^2}{E_i} \]</span></li>
<li><code>multinomial-likelihood-ratio-test</code>: G-test (<span class="math inline">\(\lambda=0\)</span>). Based on the ratio of likelihoods under the null and alternative hypotheses. <span class="math display">\[ G = 2 \sum_i O_i \ln\left(\frac{O_i}{E_i}\right) \]</span></li>
<li><code>minimum-discrimination-information-test</code>: Minimum Discrimination Information test (<span class="math inline">\(\lambda=-1\)</span>). Also known as the G-test on expected counts vs observed. <span class="math display">\[ I = 2 \sum_i E_i \ln\left(\frac{E_i}{O_i}\right) \]</span></li>
<li><code>neyman-modified-chisq-test</code>: Neyman Modified Chi-squared test (<span class="math inline">\(\lambda=-2\)</span>). <span class="math display">\[ NM = \sum_i \frac{(O_i - E_i)^2}{O_i} \]</span></li>
<li><code>freeman-tukey-test</code>: Freeman-Tukey test (<span class="math inline">\(\lambda=-0.5\)</span>). <span class="math display">\[ FT = \sum_i (\sqrt{O_i} - \sqrt{E_i})^2 \]</span></li>
<li><code>cressie-read-test</code>: Cressie-Read test (<span class="math inline">\(\lambda=2/3\)</span>, default for <code>power-divergence-test</code>). A compromise test.</li>
</ul>
<p><strong>Arguments:</strong></p>
<ul>
<li><code>contingency-table-or-xs</code>: For independence tests, a contingency table (sequence of sequences or map). For goodness-of-fit with counts, a sequence of observed counts. For goodness-of-fit with data, a sequence of raw data.</li>
<li><code>params</code> (map, optional): Options including:
<ul>
<li><code>:lambda</code> (double): Power parameter (default 2/3).</li>
<li><code>:p</code>: For GOF, expected probabilities/weights (seq) or a <code>fastmath.random</code> distribution. Ignored for independence tests.</li>
<li><code>:sides</code> (keyword, default <code>:one-sided-greater</code>): For p-value calculation.</li>
<li><code>:alpha</code> (double, default 0.05): For confidence intervals.</li>
<li><code>:ci-sides</code> (keyword, default <code>:two-sided</code>): For confidence intervals.</li>
<li><code>:bootstrap-samples</code> (long, default 1000): For bootstrap CI.</li>
<li><code>:ddof</code> (long, default 0): Delta degrees of freedom subtracted from the calculated DF.</li>
<li><code>:bins</code>: For GOF with data vs distribution, histogram bins (see [<a href="#histogram">histogram</a>]).</li>
</ul></li>
</ul>
<p><strong>Returns:</strong> A map with keys:</p>
<ul>
<li><code>:stat</code> (or <code>:chi2</code>): The calculated test statistic.</li>
<li><code>:df</code>: Degrees of freedom.</li>
<li><code>:p-value</code>: P-value.</li>
<li><code>:n</code>: Total number of observations.</li>
<li><code>:estimate</code>: Observed proportions.</li>
<li><code>:expected</code>: Expected counts or proportions.</li>
<li><code>:confidence-interval</code>: Bootstrap confidence intervals for observed proportions.</li>
<li><code>:lambda</code>, <code>:alpha</code>, <code>:sides</code>, <code>:ci-sides</code>: Input parameters.</li>
</ul>
<p><strong>Examples:</strong></p>
<p>Goodness-of-Fit test comparing observed counts to expected proportions (e.g., testing if a six-sided die is fair based on 60 rolls).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb168"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> observed-rolls </span>[<span class="dv">10</span> <span class="dv">12</span> <span class="dv">8</span> <span class="dv">11</span> <span class="dv">9</span> <span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb169"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> expected-proportions </span>[<span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using weights proportional to expected, they will be normalized</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb170"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>(stats/chisq-test observed-rolls {<span class="at">:p</span> expected-proportions})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb171"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:chi2</span> <span class="fl">1.0000000000000009</span>,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:ci-sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> ([<span class="fl">0.08333333333333333</span> <span class="fl">0.25</span>]</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.1</span> <span class="fl">0.3</span>]</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.05</span> <span class="fl">0.21666666666666667</span>]</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.1</span> <span class="fl">0.3</span>]</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.06666666666666667</span> <span class="fl">0.23333333333333334</span>]</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.06666666666666667</span> <span class="fl">0.26666666666666666</span>]),</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="dv">5</span>,</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> (<span class="fl">0.16666666666666666</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.2</span></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.13333333333333333</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.18333333333333332</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.15</span></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.16666666666666666</span>),</span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:expected</span> (<span class="fl">10.0</span> <span class="fl">10.0</span> <span class="fl">10.0</span> <span class="fl">10.0</span> <span class="fl">10.0</span> <span class="fl">10.0</span>),</span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:lambda</span> <span class="fl">1.0</span>,</span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="fl">60.0</span>,</span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a> <span class="at">:p</span> (<span class="fl">0.16666666666666666</span></span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.16666666666666666</span></span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.16666666666666666</span></span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.16666666666666666</span></span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.16666666666666666</span></span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.16666666666666666</span>),</span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.9625657732472963</span>,</span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:one-sided-greater</span>,</span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">1.0000000000000009</span>,</span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:one-sided-greater</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Goodness-of-Fit test comparing sample data (<code>mpg</code>) to a theoretical distribution (Normal). This implicitly creates a histogram from <code>mpg</code> and compares its counts to the counts expected from a Normal distribution within those bins.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb172"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>(stats/chisq-test mpg {<span class="at">:p</span> (r/distribution <span class="at">:normal</span> {<span class="at">:mu</span> (stats/mean mpg), <span class="at">:sd</span> (stats/stddev mpg)})})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb173"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:chi2</span> <span class="fl">5.1376170090363775</span>,</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:ci-sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> ([<span class="fl">0.0625</span> <span class="fl">0.34375</span>]</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.21875</span> <span class="fl">0.53125</span>]</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.09375</span> <span class="fl">0.40625</span>]</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.0</span> <span class="fl">0.15625</span>]</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>                       [<span class="fl">0.03125</span> <span class="fl">0.25</span>]),</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="dv">4</span>,</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> (<span class="fl">0.1875</span> <span class="fl">0.375</span> <span class="fl">0.25</span> <span class="fl">0.0625</span> <span class="fl">0.125</span>),</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:expected</span> (<span class="fl">6.522258911613709</span></span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>            <span class="fl">8.862383891077252</span></span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>            <span class="fl">9.18485015889101</span></span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>            <span class="fl">5.339688018565394</span></span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>            <span class="fl">2.090819019852639</span>),</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:lambda</span> <span class="fl">1.0</span>,</span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="fl">32.0</span>,</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:p</span> (<span class="fl">0.2038205909879284</span></span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.27694949659616414</span></span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.28702656746534405</span></span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.16686525058016857</span></span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.06533809437039496</span>),</span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.27346634528388103</span>,</span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:one-sided-greater</span>,</span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">5.1376170090363775</span>,</span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:one-sided-greater</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Independence test using a contingency table (from the previous section).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb174"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>(stats/chisq-test ct-data<span class="dv">-1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb175"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:chi2</span> <span class="fl">1.7774150400145103</span>,</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:ci-sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> {[<span class="dv">0</span> <span class="dv">0</span>] [<span class="fl">0.33</span> <span class="fl">0.5297500000000003</span>],</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span> <span class="dv">1</span>] [<span class="fl">0.04</span> <span class="fl">0.15</span>],</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span> <span class="dv">0</span>] [<span class="fl">0.35000000000000003</span> <span class="fl">0.53</span>],</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span> <span class="dv">1</span>] [<span class="fl">0.01</span> <span class="fl">0.08</span>]},</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="dv">1</span>,</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span> {[<span class="dv">0</span> <span class="dv">0</span>] <span class="fl">0.43</span>, [<span class="dv">0</span> <span class="dv">1</span>] <span class="fl">0.09</span>, [<span class="dv">1</span> <span class="dv">0</span>] <span class="fl">0.44</span>, [<span class="dv">1</span> <span class="dv">1</span>] <span class="fl">0.04</span>},</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:expected</span> {[<span class="dv">0</span> <span class="dv">0</span>] <span class="fl">45.24</span>, [<span class="dv">0</span> <span class="dv">1</span>] <span class="fl">6.76</span>, [<span class="dv">1</span> <span class="dv">0</span>] <span class="fl">41.76</span>, [<span class="dv">1</span> <span class="dv">1</span>] <span class="fl">6.24</span>},</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:k</span> <span class="dv">2</span>,</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a> <span class="at">:lambda</span> <span class="fl">1.0</span>,</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="fl">100.0</span>,</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.1824670652605519</span>,</span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:r</span> <span class="dv">2</span>,</span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:one-sided-greater</span>,</span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">1.7774150400145103</span>,</span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:one-sided-greater</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb176"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>(stats/multinomial-likelihood-ratio-test ct-data<span class="dv">-2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb177"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:alpha</span> <span class="fl">0.05</span>,</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:chi2</span> <span class="fl">11.250923175273865</span>,</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:ci-sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:confidence-interval</span> {[<span class="dv">0</span> <span class="dv">0</span>] [<span class="fl">0.165</span> <span class="fl">0.28500000000000003</span>],</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span> <span class="dv">1</span>] [<span class="fl">0.14</span> <span class="fl">0.245</span>],</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span> <span class="dv">2</span>] [<span class="fl">0.095</span> <span class="fl">0.18</span>],</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span> <span class="dv">0</span>] [<span class="fl">0.085</span> <span class="fl">0.18</span>],</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span> <span class="dv">1</span>] [<span class="fl">0.2</span> <span class="fl">0.32</span>],</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span> <span class="dv">2</span>] [<span class="fl">0.03</span> <span class="fl">0.095</span>]},</span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> <span class="dv">2</span>,</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:estimate</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>   {[<span class="dv">0</span> <span class="dv">0</span>] <span class="fl">0.225</span>, [<span class="dv">0</span> <span class="dv">1</span>] <span class="fl">0.19</span>, [<span class="dv">0</span> <span class="dv">2</span>] <span class="fl">0.135</span>, [<span class="dv">1</span> <span class="dv">0</span>] <span class="fl">0.13</span>, [<span class="dv">1</span> <span class="dv">1</span>] <span class="fl">0.26</span>, [<span class="dv">1</span> <span class="dv">2</span>] <span class="fl">0.06</span>},</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a> <span class="at">:expected</span></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a>   {[<span class="dv">0</span> <span class="dv">0</span>] <span class="fl">39.05</span>, [<span class="dv">0</span> <span class="dv">1</span>] <span class="fl">49.5</span>, [<span class="dv">0</span> <span class="dv">2</span>] <span class="fl">21.45</span>, [<span class="dv">1</span> <span class="dv">0</span>] <span class="fl">31.95</span>, [<span class="dv">1</span> <span class="dv">1</span>] <span class="fl">40.5</span>, [<span class="dv">1</span> <span class="dv">2</span>] <span class="fl">17.55</span>},</span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a> <span class="at">:k</span> <span class="dv">2</span>,</span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a> <span class="at">:lambda</span> <span class="fl">0.0</span>,</span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:level</span> <span class="fl">0.95</span>,</span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="fl">200.0</span>,</span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.0036048987752140826</span>,</span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a> <span class="at">:r</span> <span class="dv">3</span>,</span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:one-sided-greater</span>,</span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">11.250923175273865</span>,</span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a> <span class="at">:test-type</span> <span class="at">:one-sided-greater</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Distribution Comparison Tests (AD/KS):</strong></p>
<p>These tests directly compare empirical cumulative distribution functions (ECDFs) or density estimates, providing non-parametric ways to assess goodness-of-fit or compare two samples without strong assumptions about the underlying distribution shape.</p>
<ul>
<li><p><code>ad-test-one-sample</code>: Anderson-Darling test. Primarily a Goodness-of-Fit test. It is particularly sensitive to differences in the tails of the distributions being compared. It tests if a sample <code>xs</code> comes from a specified distribution or an empirical distribution estimated from <code>ys</code>. <span class="math display">\[ A^2 = -n - \sum_{i=1}^n \frac{2i-1}{n} [\ln(F(X_i)) + \ln(1-F(X_{n-i+1}))] \]</span> where <span class="math inline">\(X_i\)</span> are the ordered data, <span class="math inline">\(n\)</span> is the sample size, and <span class="math inline">\(F\)</span> is the CDF of the hypothesized distribution.</p>
<p><strong>Arguments:</strong> <code>xs</code> (sample), <code>distribution-or-ys</code> (reference distribution or sample), <code>opts</code> (map: <code>:sides</code>, <code>:kernel</code>, <code>:bandwidth</code>).</p>
<p><strong>Returns:</strong> Map with <code>:A2</code>, <code>:stat</code>, <code>:p-value</code>, <code>:n</code>, <code>:mean</code>, <code>:stddev</code>, <code>:sides</code>.</p></li>
<li><p><code>ks-test-one-sample</code>: One-sample Kolmogorov-Smirnov test. Compares the ECDF of a sample <code>xs</code> to a theoretical CDF or the ECDF of another sample <code>ys</code>. It is sensitive to the largest vertical difference between the two CDFs. <span class="math display">\[ D = \max_i(|F_n(X_i) - F(X_i)|) \]</span> where <span class="math inline">\(F_n\)</span> is the ECDF of the sample, <span class="math inline">\(F\)</span> is the reference CDF, and <span class="math inline">\(X_i\)</span> are the ordered data.</p>
<p><strong>Arguments:</strong> <code>xs</code> (sample), <code>distribution-or-ys</code> (reference distribution or sample), <code>opts</code> (map: <code>:sides</code>, <code>:kernel</code>, <code>:bandwidth</code>, <code>:distinct?</code>).</p>
<p><strong>Returns:</strong> Map with <code>:n</code>, <code>:dp</code>, <code>:dn</code>, <code>:d</code>, <code>:stat</code>, <code>:KS</code>, <code>:p-value</code>, <code>:sides</code>.</p></li>
<li><p><code>ks-test-two-samples</code>: Two-sample Kolmogorov-Smirnov test. Compares the ECDFs of two independent samples <code>xs</code> and <code>ys</code>. It is sensitive to the largest vertical difference between the two ECDFs. <span class="math display">\[ D_{n,m} = \max_i(|F_n(X_i) - G_m(X_i)|) \]</span> where <span class="math inline">\(F_n\)</span> and <span class="math inline">\(G_m\)</span> are the ECDFs of the two samples.</p>
<p><strong>Arguments:</strong> <code>xs</code> (sample 1), <code>ys</code> (sample 2), <code>opts</code> (map: <code>:method</code> (exact/approx), <code>:sides</code>, <code>:distinct?</code>, <code>:correct?</code>).</p>
<p><strong>Returns:</strong> Map with <code>:nx</code>, <code>:ny</code>, <code>:n</code>, <code>:dp</code>, <code>:dn</code>, <code>:d</code>, <code>:stat</code>, <code>:KS</code>, <code>:p-value</code>, <code>:sides</code>, <code>:method</code>.</p></li>
</ul>
<p><strong>Notes:</strong></p>
<ul>
<li>The AD test is generally more sensitive to differences in the tails of the distributions than the KS test.</li>
<li>The KS test (both one-sample and two-sample) is based on the maximum difference between CDFs, making it sensitive to any point where the distributions diverge, but perhaps less so specifically in the extreme tails compared to AD.</li>
<li>The KS test has issues with discrete data and ties; the <code>distinct?</code> option attempts to mitigate this.</li>
<li>The Power Divergence tests are typically applied to counts or binned data, while AD/KS can be applied directly to continuous data (or compared against continuous distributions).</li>
</ul>
<p>Handling Ties in KS Tests:</p>
<p>The Kolmogorov-Smirnov (KS) test is theoretically defined for continuous distributions, where the probability of observing duplicate values (ties) is zero. In practice, real-world data often contains ties, which can affect the accuracy of the KS test, particularly for the exact p-value calculation methods. The <code>ks-test-one-sample</code> and <code>ks-test-two-samples</code> functions in <code>fastmath.stats</code> provide the <code>:distinct?</code> option to address this.</p>
<p>The <code>:distinct?</code> option controls how ties are handled:</p>
<ul>
<li><code>:ties</code> (default): This is the default behavior. It keeps all observed data points, including ties. If the <code>:method</code> is <code>:exact</code>, information about the ties is passed to the underlying exact calculation algorithm to attempt a correction. The accuracy depends on the specific algorithm’s tie-handling capabilities.</li>
<li><code>true</code>: This applies the Clojure <code>distinct</code> function <em>separately</em> to each input sequence (<code>xs</code> and <code>ys</code> for the two-sample test) before combining and processing. This removes duplicate values <em>within</em> each sample but does not guarantee that ties between the samples are resolved or correctly handled for the exact method.</li>
<li><code>:jitter</code>: This adds a small amount of random noise to each data point to break all ties. This is a common pragmatic approach for dealing with ties in continuous data tests when an exact tie correction is unavailable or complex, but it slightly alters the original data.</li>
<li><code>false</code>: The data is used exactly as provided, without any specific handling or correction for ties.</li>
</ul>
<p>The presence and handling of ties can significantly influence the calculated p-value, especially when using exact calculation methods. Choosing the appropriate method depends on the nature of the data and the required accuracy.</p>
<p><strong>Examples:</strong></p>
<p>AD test comparing <code>setosa-sepal-length</code> data to a normal distribution.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb178"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>(stats/ad-test-one-sample setosa-sepal-length (r/distribution <span class="at">:normal</span> {<span class="at">:mu</span> (stats/mean setosa-sepal-length), <span class="at">:sd</span> (stats/stddev setosa-sepal-length)}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb179"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:A2</span> <span class="fl">0.407985975495866</span>,</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:mean</span> <span class="fl">5.006</span>,</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="dv">50</span>,</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.8401982598779278</span>,</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:right</span>,</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">0.407985975495866</span>,</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:stddev</span> <span class="fl">0.3524896872134514</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>KS test comparing <code>setosa-sepal-length</code> data to an estimated empirical distribution build from normal samples (KDE based).</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb180"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> [d (r/distribution <span class="at">:normal</span> {<span class="at">:mu</span> (stats/mean setosa-sepal-length), <span class="at">:sd</span> (stats/stddev setosa-sepal-length)})] (stats/ks-test-one-sample setosa-sepal-length (r/-&gt;seq d <span class="dv">100</span>) {<span class="at">:kernel</span> <span class="at">:epanechnikov</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb181"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:d</span> <span class="fl">0.18037563101349066</span>,</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:dn</span> <span class="fl">0.11196480467914216</span>,</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:dp</span> <span class="fl">0.18037563101349066</span>,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="dv">15</span>,</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.6493949905686411</span>,</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">0.18037563101349066</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Two-sample KS test comparing <code>setosa-sepal-length</code> and <code>virginica-sepal-length</code>.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb182"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>(stats/ks-test-two-samples setosa-sepal-length virginica-sepal-length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb183"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:KS</span> <span class="fl">0.9200000000000005</span>,</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:d</span> <span class="fl">0.9200000000000005</span>,</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:dn</span> <span class="fl">6.245004513516506E-17</span>,</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:dp</span> <span class="fl">0.9200000000000005</span>,</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:method</span> <span class="at">:exact</span>,</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> <span class="dv">100</span>,</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:nx</span> <span class="dv">50</span>,</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:ny</span> <span class="dv">50</span>,</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">4.719076766639571E-23</span>,</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:sides</span> <span class="at">:two-sided</span>,</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">0.9200000000000005</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="anova-and-rank-sum-tests" class="level3">
<h3 class="anchored" data-anchor-id="anova-and-rank-sum-tests">ANOVA and Rank Sum Tests</h3>
<p>;; Analysis of Variance (ANOVA) and rank sum tests are used to determine if there are statistically significant differences between the means (ANOVA) or distributions (rank sum tests) of two or more independent groups. One-way tests are used when comparing groups based on a single categorical independent variable.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>one-way-anova-test</code></li>
<li><code>kruskal-test</code></li>
</ul>
</div>
</div>
<ul>
<li><strong>One-way ANOVA Test</strong> (<code>one-way-anova-test</code>): A parametric test used to compare the means of two or more independent groups. It assesses whether the variation among group means is larger than the variation within groups.
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>)</strong>: The means of all groups are equal.</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_1\)</span>)</strong>: At least one group mean is different from the others.</li>
<li><strong>Assumptions</strong>: Independence of observations, normality within each group, and homogeneity of variances (equal variances across groups).</li>
<li><strong>Test Statistic (F-statistic)</strong>: Calculated as the ratio of the variance between groups (Mean Square Treatment, <span class="math inline">\(MSt\)</span>) to the variance within groups (Mean Square Error, <span class="math inline">\(MSe\)</span>). <span class="math display">\[ F = \frac{MSt}{MSe} \]</span> Where <span class="math inline">\(MSt = SSt / DFt\)</span> and <span class="math inline">\(MSe = SSe / DFe\)</span>. <span class="math inline">\(SSt\)</span> is the Sum of Squares Treatment (between groups), <span class="math inline">\(SSe\)</span> is the Sum of Squares Error (within groups), <span class="math inline">\(DFt\)</span> is the degrees of freedom for the treatment (number of groups - 1), and <span class="math inline">\(DFe\)</span> is the degrees of freedom for the error (total observations - number of groups).</li>
</ul></li>
<li><strong>Kruskal-Wallis H-Test</strong> (<code>kruskal-test</code>): A non-parametric alternative to the one-way ANOVA. It is used to compare the distributions of two or more independent groups when the assumptions of ANOVA (especially normality) are not met. It tests whether the groups come from the same distribution.
<ul>
<li><strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>)</strong>: The distributions of all groups are identical (specifically, that the median ranks are equal).</li>
<li><strong>Alternative Hypothesis (<span class="math inline">\(H_1\)</span>)</strong>: At least one group’s distribution is different from the others.</li>
<li><strong>Assumptions</strong>: Independence of observations. While it doesn’t assume normality, it assumes that the distributions have similar shapes if the intent is to compare medians.</li>
<li><strong>Test Statistic (H)</strong>: Calculated based on the ranks of the combined data from all groups. The sum of ranks is computed for each group, and H is derived from deviations of these rank sums from what would be expected under the null hypothesis.</li>
</ul></li>
</ul>
<p><strong>Comparison:</strong></p>
<ul>
<li><strong><code>one-way-anova-test</code></strong> is a parametric test that compares <em>means</em>. It assumes normality and equal variances.</li>
<li><strong><code>kruskal-test</code></strong> is a non-parametric test that compares <em>distributions</em> (or median ranks). It does not assume normality or equal variances, making it suitable for ordinal data or data violating ANOVA assumptions.</li>
</ul>
<p>Both functions accept a sequence of sequences (<code>xss</code>) where each inner sequence represents a group. Both return a map containing the test statistic, degrees of freedom, and p-value.</p>
<p><strong>Arguments:</strong></p>
<ul>
<li><code>xss</code> (sequence of sequences of numbers): The groups of data to compare.</li>
<li><code>params</code> (map, optional): An options map.
<ul>
<li><code>:sides</code> (keyword, default <code>:one-sided-greater</code> for both): Specifies the alternative hypothesis side for the test statistic’s distribution.</li>
</ul></li>
</ul>
<p><strong>Return Value (Map):</strong></p>
<ul>
<li><code>:stat</code> (double): The calculated test statistic (F for ANOVA, H for Kruskal-Wallis).</li>
<li><code>:p-value</code> (double): The probability of observing the test statistic or more extreme values under the null hypothesis.</li>
<li><code>:df</code> (long or vector): Degrees of freedom. Vector <code>[DFt, DFe]</code> for ANOVA, scalar <code>DFt</code> for Kruskal-Wallis.</li>
<li><code>:n</code> (sequence of longs): Sample sizes of each group.</li>
<li><code>:k</code> (long): Number of groups (Kruskal-Wallis only).</li>
<li><code>:sides</code> (keyword): The alternative hypothesis side used.</li>
<li><strong>ANOVA only</strong>: <code>:F</code> (alias for <code>:stat</code>), <code>:SSt</code>, <code>:SSe</code>, <code>:DFt</code>, <code>:DFe</code>, <code>:MSt</code>, <code>:MSe</code>.</li>
<li><strong>Kruskal-Wallis only</strong>: <code>:H</code> (alias for <code>:stat</code>).</li>
</ul>
<p>Let’s compare the sepal lengths across the three iris species using both tests.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb184"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>(stats/one-way-anova-test (<span class="kw">vals</span> sepal-lengths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb185"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:DFe</span> <span class="dv">147</span>,</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:DFt</span> <span class="dv">2</span>,</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:F</span> <span class="fl">119.26450218450461</span>,</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSe</span> <span class="fl">0.2650081632653062</span>,</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a> <span class="at">:MSt</span> <span class="fl">31.606066666666663</span>,</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSe</span> <span class="fl">38.95620000000001</span>,</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a> <span class="at">:SSt</span> <span class="fl">63.21213333333333</span>,</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a> <span class="at">:df</span> [<span class="dv">2</span> <span class="dv">147</span>],</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a> <span class="at">:n</span> (<span class="dv">50</span> <span class="dv">50</span> <span class="dv">50</span>),</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a> <span class="at">:p-value</span> <span class="fl">0.0</span>,</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a> <span class="at">:stat</span> <span class="fl">119.26450218450461</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb186"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>(stats/kruskal-test (<span class="kw">vals</span> sepal-lengths))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb187"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:df</span> <span class="dv">2</span>, <span class="at">:k</span> <span class="dv">3</span>, <span class="at">:n</span> <span class="dv">150</span>, <span class="at">:p-value</span> <span class="fl">0.0</span>, <span class="at">:sides</span> <span class="at">:right</span>, <span class="at">:stat</span> <span class="fl">96.93743600064822</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="autocorrelation-tests" class="level3">
<h3 class="anchored" data-anchor-id="autocorrelation-tests">Autocorrelation Tests</h3>
<p>Autocorrelation tests examine whether values in a sequence are correlated with past values in the same sequence. This is particularly important when analyzing time series data or the residuals from a regression analysis, as autocorrelated residuals violate the assumption of independent errors, which can invalidate statistical inferences. <code>fastmath.stats</code> provides the Durbin-Watson test, a common method for detecting first-order (lag-1) autocorrelation in regression residuals.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>durbin-watson</code></li>
</ul>
</div>
</div>
<ul>
<li><p><strong>Durbin-Watson Test</strong> (<code>durbin-watson</code>): Calculates the Durbin-Watson statistic (d), which is used to test for the presence of serial correlation, especially first-order (lag-1) autocorrelation, in the residuals of a regression analysis.</p>
<p>The Durbin-Watson statistic is calculated as: <span class="math display">\[ d = \frac{\sum_{t=2}^T (e_t - e_{t-1})^2}{\sum_{t=1}^T e_t^2} \]</span> where <span class="math inline">\(e_t\)</span> are the residuals at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(T\)</span> is the total number of observations.</p>
<p>The value of the statistic <span class="math inline">\(d\)</span> ranges from 0 to 4.</p>
<ul>
<li>Values near 2 suggest no first-order autocorrelation.</li>
<li>Values less than 2 suggest positive autocorrelation (residuals tend to be followed by residuals of the same sign).</li>
<li>Values greater than 2 suggest negative autocorrelation (residuals tend to be followed by residuals of the opposite sign).</li>
</ul>
<p>Testing for significance requires comparing the calculated statistic to lower (<span class="math inline">\(d_L\)</span>) and upper (<span class="math inline">\(d_U\)</span>) critical values from Durbin-Watson tables, which depend on the sample size and number of predictors in the regression model.</p>
<p>Parameters:</p>
<ul>
<li><code>rs</code> (sequence of numbers): The sequence of residuals from a regression model. The sequence should represent observations ordered by time or sequence index.</li>
</ul>
<p>Returns the calculated Durbin-Watson statistic as a double.</p>
<p>Note: This function only calculates the statistic. Determining statistical significance typically requires consulting Durbin-Watson critical value tables based on the sample size and the number of independent variables in the model.</p>
<p>Let’s calculate the Durbin-Watson statistic for a few example sequences representing different scenarios: no autocorrelation, positive autocorrelation, and negative autocorrelation.</p></li>
</ul>
<div class="sourceClojure">
<div class="sourceCode" id="cb188"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residuals-no-autocorrelation </span>(<span class="kw">repeatedly</span> <span class="dv">100</span> r/grand))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb189"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residuals-positive-autocorrelation </span>[<span class="fl">2.0</span> <span class="fl">1.8</span> <span class="fl">1.5</span> <span class="fl">1.0</span> -<span class="fl">0.3</span> -<span class="fl">0.8</span> -<span class="fl">1.2</span> -<span class="fl">1.5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb190"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> residuals-negative-autocorrelation </span>[<span class="fl">1.0</span> -<span class="fl">1.0</span> <span class="fl">0.5</span> -<span class="fl">0.5</span> <span class="fl">0.2</span> -<span class="fl">0.2</span> <span class="fl">0.1</span> -<span class="fl">0.1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb191"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>(stats/durbin-watson residuals-no-autocorrelation) <span class="co">;; =&gt; 2.064286029995981</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>(stats/durbin-watson residuals-positive-autocorrelation) <span class="co">;; =&gt; 0.17236753856472167</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>(stats/durbin-watson residuals-negative-autocorrelation) <span class="co">;; =&gt; 3.0884615384615386</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="time-series-analysis" class="level2">
<h2 class="anchored" data-anchor-id="time-series-analysis">Time Series Analysis</h2>
<p>Functions specifically for analyzing sequential data, such as time series. These functions help identify patterns like trends, seasonality, and autocorrelation, which are crucial for understanding the underlying process generating the data and for building forecasting models (like ARIMA).</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>acf</code></li>
<li><code>pacf</code></li>
<li><code>acf-ci</code>, <code>pacf-ci</code></li>
</ul>
</div>
</div>
<p>Autocorrelation and Partial Autocorrelation functions are fundamental tools for analyzing the dependence structure of a time series. They measure the correlation between a series and its lagged values.</p>
<ul>
<li><p><strong>Autocorrelation Function (ACF)</strong> (<code>acf</code>): Measures the linear dependence between a time series and its lagged values. Specifically, the ACF at lag <span class="math inline">\(k\)</span> is the correlation between the series and itself shifted by <span class="math inline">\(k\)</span> time units. It captures both direct and indirect dependencies. For a stationary series, the sample ACF at lag <span class="math inline">\(k\)</span> is estimated as: <span class="math display">\[ \rho_k = \frac{\sum_{t=k+1}^n (y_t - \bar{y})(y_{t-k} - \bar{y})}{\sum_{t=1}^n (y_t - \bar{y})^2} \]</span> where <span class="math inline">\(y_t\)</span> is the observation at time <span class="math inline">\(t\)</span>, <span class="math inline">\(\bar{y}\)</span> is the sample mean, and <span class="math inline">\(n\)</span> is the series length.</p></li>
<li><p><strong>Partial Autocorrelation Function (PACF)</strong> (<code>pacf</code>): Measures the linear dependence between a time series and its lagged values <em>after removing the linear dependence from the intermediate lags</em>. The PACF at lag <span class="math inline">\(k\)</span> is the correlation between <span class="math inline">\(y_t\)</span> and <span class="math inline">\(y_{t-k}\)</span>, conditional on the intermediate observations <span class="math inline">\(y_{t-1}, y_{t-2}, \dots, y_{t-k+1}\)</span>. It isolates the direct relationship at each lag. The PACF values (<span class="math inline">\(\phi_{kk}\)</span>) are the last coefficients in a sequence of autoregressive models of increasing order. For example, <span class="math inline">\(\phi_{11}\)</span> is the correlation at lag 1, <span class="math inline">\(\phi_{22}\)</span> is the correlation at lag 2 after accounting for lag 1, etc.</p></li>
</ul>
<p><strong>Comparison:</strong></p>
<ul>
<li>The <strong>ACF</strong> shows correlations at various lags, including those that are simply due to preceding correlations. It tends to decay gradually for autoregressive (AR) processes and cut off sharply for moving average (MA) processes.</li>
<li>The <strong>PACF</strong> shows only the <em>direct</em> correlation at each lag, after removing the effects of shorter lags. It tends to cut off sharply for AR processes and decay gradually for MA processes.</li>
</ul>
<p>These patterns in ACF and PACF plots are diagnostic tools for identifying the order of AR or MA components in time series models (e.g., ARIMA).</p>
<p><strong>Confidence Intervals:</strong></p>
<ul>
<li><code>acf-ci</code>, <code>pacf-ci</code>: Calculate ACF and PACF values, respectively, and provide approximate confidence intervals around these estimates. These intervals help determine whether the autocorrelation/partial autocorrelation at a given lag is statistically significant (i.e., unlikely to be zero in the population). For a stationary series, the standard error of the sample ACF at lag <span class="math inline">\(k\)</span> is approximately <span class="math inline">\(1/\sqrt{n}\)</span> for <span class="math inline">\(k&gt;0\)</span>. The PACF has a similar standard error for lags <span class="math inline">\(k&gt;0\)</span>. The confidence interval at level <span class="math inline">\(\alpha\)</span> is typically <span class="math inline">\(\pm z_{\alpha/2} / \sqrt{n}\)</span>. <code>acf-ci</code> also provides cumulative confidence intervals (<code>:cis</code>) based on the variance of the sum of squared autocorrelations up to each lag.</li>
</ul>
<p><strong>Arguments:</strong></p>
<ul>
<li><code>data</code> (seq of numbers): The time series data.</li>
<li><code>lags</code> (long or seq of longs, optional): The maximum lag to calculate ACF/PACF for (if a number), or a specific list of lags (for <code>acf</code> only). Defaults to <code>(dec (count data))</code>.</li>
<li><code>alpha</code> (double, optional, for <code>*-ci</code> functions): Significance level for the confidence intervals (default 0.05 for 95% CI).</li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><code>acf</code>: A sequence of doubles representing the autocorrelation coefficients at lags 0 (always 1.0) up to <code>lags</code> (or specified lags).</li>
<li><code>pacf</code>: A sequence of doubles representing the partial autocorrelation coefficients at lags 0 (always 0.0) up to <code>lags</code>.</li>
<li><code>acf-ci</code>, <code>pacf-ci</code>: A map containing:
<ul>
<li><code>:ci</code> (double): The value of the standard confidence interval (e.g., <span class="math inline">\(1.96/\sqrt{n}\)</span> for 95% CI).</li>
<li><code>:acf</code> or <code>:pacf</code> (seq of doubles): The calculated ACF or PACF values.</li>
<li><code>:cis</code> (seq of doubles, only for <code>acf-ci</code>): The cumulative confidence intervals for ACF.</li>
</ul></li>
</ul>
<p>Let’s illustrate ACF and PACF with the white noise data (<span class="math inline">\(sigma=0.5\)</span>) and AR, MA and ARFIMA processes.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb192"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> white-noise </span>(<span class="kw">take</span> <span class="dv">1000</span> (r/white-noise (r/rng <span class="at">:mersenne</span> <span class="dv">1</span>) <span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb193"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>(stats/acf white-noise <span class="dv">10</span>) <span class="co">;; =&gt; (1.0 -0.018326052355220286 -0.003929181207704636 0.03404395796429751 -0.0437602077864766 -0.019833239371372824 -0.03199281424195406 0.01948375863906099 -0.0358413563927969 -0.03550751208554428 0.005884896971007567)</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>(stats/pacf white-noise <span class="dv">10</span>) <span class="co">;; =&gt; (0.0 -0.018326052355220286 -0.004266458267873071 0.033905460948715424 -0.0425955681599929 -0.021160385359453224 -0.034290284810821074 0.021155121365213258 -0.03604909879044502 -0.0363697118356963 -4.2588688461055706E-4)</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>(stats/acf-ci white-noise <span class="dv">10</span>) <span class="co">;; =&gt; {:ci 0.06197950323045615, :acf (1.0 -0.018326052355220286 -0.003929181207704636 0.03404395796429751 -0.0437602077864766 -0.019833239371372824 -0.03199281424195406 0.01948375863906099 -0.0358413563927969 -0.03550751208554428 0.005884896971007567), :cis (0.06197950323045615 0.06200031519261883 0.062001271732432243 0.06207303866741653 0.06219143491666359 0.062215727186766975 0.062278892765961415 0.06230230372268246 0.062381459961140466 0.06245905092154892 0.062461180879962185)}</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>(stats/pacf-ci white-noise <span class="dv">10</span>) <span class="co">;; =&gt; {:ci 0.06197950323045615, :pacf (0.0 -0.018326052355220286 -0.004266458267873071 0.033905460948715424 -0.0425955681599929 -0.021160385359453224 -0.034290284810821074 0.021155121365213258 -0.03604909879044502 -0.0363697118356963 -4.2588688461055706E-4)}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/28.png">
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/29.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/30.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>And now for AR(30) time series.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb194"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ar20 </span>(<span class="kw">take</span> <span class="dv">10000</span> (<span class="kw">drop</span> <span class="dv">100</span> (r/ar (v/sq (m/slice-range <span class="fl">0.35</span> <span class="fl">0.001</span> <span class="dv">20</span>)) white-noise))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb195"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>(stats/acf ar20 <span class="dv">10</span>) <span class="co">;; =&gt; (1.0 0.29824685915970284 0.2896474498894056 0.311904955709081 0.2564971222020911 0.28562296383470065 0.2594494703108183 0.2895861922578007 0.25082092948344153 0.2345937181515176 0.2551966287040645)</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>(stats/pacf ar20 <span class="dv">10</span>) <span class="co">;; =&gt; (0.0 0.29824685915970284 0.22029144703035636 0.2063218881353284 0.10446181152034764 0.13372974449872 0.08364335528216932 0.12094872497857509 0.053209972317661176 0.03814507902442836 0.061857342887178354)</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>(stats/acf-ci ar20 <span class="dv">10</span>) <span class="co">;; =&gt; {:ci 0.06683421715111557, :acf (1.0 0.29824685915970284 0.2896474498894056 0.311904955709081 0.2564971222020911 0.28562296383470065 0.2594494703108183 0.2895861922578007 0.25082092948344153 0.2345937181515176 0.2551966287040645), :cis (0.06683421715111557 0.07253598529450296 0.07753039023526297 0.08294616607495518 0.08641652954167832 0.09053521958042302 0.09379757073484547 0.09770956726933358 0.10054443827222243 0.10296037633006667 0.10574802260744404)}</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>(stats/pacf-ci ar20 <span class="dv">10</span>) <span class="co">;; =&gt; {:ci 0.06683421715111557, :pacf (0.0 0.29824685915970284 0.22029144703035636 0.2063218881353284 0.10446181152034764 0.13372974449872 0.08364335528216932 0.12094872497857509 0.053209972317661176 0.03814507902442836 0.061857342887178354)}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/31.png">
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/32.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/33.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>MA(10) time series.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb196"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> ma10 </span>(<span class="kw">take</span> <span class="dv">1000</span> (<span class="kw">drop</span> <span class="dv">100</span> (r/ma [<span class="fl">0.1</span> <span class="fl">0.1</span> <span class="fl">0.1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="fl">0.1</span> <span class="fl">0.1</span> <span class="fl">0.1</span> -<span class="dv">1</span> -<span class="dv">2</span>]))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb197"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>(stats/acf ma10 <span class="dv">10</span>) <span class="co">;; =&gt; (1.0 0.385702458512537 0.04677749712292603 0.015329673475288177 0.07335709504773863 -0.25435008347071675 -0.3159141304758406 0.022781954102575677 0.007952754205943258 -0.04087218543410736 -0.1727078997841402)</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>(stats/pacf ma10 <span class="dv">10</span>) <span class="co">;; =&gt; (0.0 0.385702458512537 -0.11981304281518793 0.049269704608729654 0.06480706040969768 -0.37216315015740936 -0.0790292772389699 0.24734444245934886 -0.19319521190654776 0.10054167393292807 -0.254768975858849)</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>(stats/acf-ci ma10 <span class="dv">10</span>) <span class="co">;; =&gt; {:ci 0.06197950323045615, :acf (1.0 0.385702458512537 0.04677749712292603 0.015329673475288177 0.07335709504773863 -0.25435008347071675 -0.3159141304758406 0.022781954102575677 0.007952754205943258 -0.04087218543410736 -0.1727078997841402), :cis (0.06197950323045615 0.07060041583447403 0.07071937479313911 0.07073213872237571 0.0710237935603479 0.07444069892469737 0.0794240907322573 0.07944918978086538 0.07945224775263338 0.07953297592780786 0.08096085764497853)}</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>(stats/pacf-ci ma10 <span class="dv">10</span>) <span class="co">;; =&gt; {:ci 0.06197950323045615, :pacf (0.0 0.385702458512537 -0.11981304281518793 0.049269704608729654 0.06480706040969768 -0.37216315015740936 -0.0790292772389699 0.24734444245934886 -0.19319521190654776 0.10054167393292807 -0.254768975858849)}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/34.png">
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/35.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/36.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>ARFIMA(3,0.1,3)</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb198"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> arfima </span>(<span class="kw">take</span> <span class="dv">1000</span> (<span class="kw">drop</span> <span class="dv">100</span> (r/arfima [<span class="fl">0.1</span> <span class="fl">0.1</span> -<span class="fl">0.2</span>] <span class="fl">0.1</span> [<span class="fl">0.9</span> <span class="fl">0.1</span> <span class="fl">0.01</span>]))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb199"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>(stats/acf arfima <span class="dv">10</span>) <span class="co">;; =&gt; (1.0 0.6727700639300987 0.20844613515846414 -0.04185280596654289 -0.11758570761710747 -0.06265673715845702 0.0197394233211984 0.05614234117796338 0.020904270850215578 0.0029238820288109216 0.037860348078019086)</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>(stats/pacf arfima <span class="dv">10</span>) <span class="co">;; =&gt; (0.0 0.6727700639300987 -0.4460762669570541 0.1264915370932827 -0.09496427048631927 0.11893779272115486 -0.029988994500891947 0.021679484443286202 -0.0743581241851621 0.10061472299264049 0.02460520708516682)</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>(stats/acf-ci arfima <span class="dv">10</span>) <span class="co">;; =&gt; {:ci 0.06197950323045615, :acf (1.0 0.6727700639300987 0.20844613515846414 -0.04185280596654289 -0.11758570761710747 -0.06265673715845702 0.0197394233211984 0.05614234117796338 0.020904270850215578 0.0029238820288109216 0.037860348078019086), :cis (0.06197950323045615 0.08555055589978286 0.08747981928746296 0.08755670517930575 0.08816123696870322 0.08833213353285523 0.08834907709550738 0.088486019752932 0.08850498877847297 0.08850535984109767 0.08856755309092225)}</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>(stats/pacf-ci arfima <span class="dv">10</span>) <span class="co">;; =&gt; {:ci 0.06197950323045615, :pacf (0.0 0.6727700639300987 -0.4460762669570541 0.1264915370932827 -0.09496427048631927 0.11893779272115486 -0.029988994500891947 0.021679484443286202 -0.0743581241851621 0.10061472299264049 0.02460520708516682)}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/37.png">
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/38.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/39.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="histograms" class="level2">
<h2 class="anchored" data-anchor-id="histograms">Histograms</h2>
<p>Histograms are fundamental graphical and statistical tools used to represent the distribution of numerical data. They group data into bins along the x-axis and display the frequency (count or proportion) of data points falling into each bin as bars on the y-axis. Histograms provide a visual summary of the shape, center, and spread of the data, highlighting features like modality, symmetry, and outliers.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>histogram</code></li>
<li><code>estimate-bins</code></li>
</ul>
</div>
</div>
<p><code>fastmath.stats</code> provides functions to construct histograms and assist in choosing appropriate binning strategies:</p>
<ul>
<li><code>histogram</code>: Computes and returns the data structure representing a histogram. It takes the input data and parameters defining the bins (number, estimation method, or explicit intervals). It can also process collections of data sequences (for grouped histograms).</li>
<li><code>estimate-bins</code>: A utility function to recommend the number of bins for a given dataset based on various commonly used heuristic rules.</li>
</ul>
<p>The <code>histogram</code> function calculates the counts of data points falling into predefined intervals (bins).</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>vs</code> (sequence of numbers or sequence of sequences): The input data. Can be a single sequence for a simple histogram or a collection of sequences for grouped histograms.</li>
<li><code>bins-or-estimate-method</code> (number, keyword, or sequence, optional): Defines the histogram bins.
<ul>
<li>A number: The desired number of bins. The function calculates equally spaced intervals between the minimum and maximum values.</li>
<li>A keyword (default: <code>:freedman-diaconis</code>): Uses a specific heuristic to estimate the number of bins (see [<a href="#estimate-bins">estimate-bins</a>]).</li>
<li>A sequence of numbers: Explicitly defines the bin edges (intervals). Data points are counted if they fall into <code>[edge_i, edge_{i+1})</code>.</li>
<li>If omitted, uses the default <code>:freedman-diaconis</code> estimation method.</li>
</ul></li>
<li><code>mn</code>, <code>mx</code> (doubles, optional): Explicit minimum and maximum values to consider for binning. Data outside <code>[mn, mx]</code> are excluded. If omitted, the minimum and maximum of the data are used. When explicit <code>bins-or-estimate-method</code> (sequence of edges) is provided, <code>mn</code> and <code>mx</code> are inferred from the provided edges and <code>vs</code> data is filtered to fit.</li>
</ul>
<p><strong>Return Value (Map):</strong></p>
<p>Returns a map describing the histogram structure and counts. Key elements include:</p>
<ul>
<li><code>:size</code>: The number of bins.</li>
<li><code>:step</code>: The average width of the bins (only applicable for equally spaced bins).</li>
<li><code>:samples</code>: The total number of data points included in the histogram (may be less than input if <code>mn</code>/<code>mx</code> are specified).</li>
<li><code>:min</code>, <code>:max</code>: The minimum and maximum data values used for binning.</li>
<li><code>:intervals</code>: The sequence of numbers defining the bin edges.</li>
<li><code>:bins</code>: A sequence of <code>[lower-edge, count]</code> pairs for each bin.</li>
<li><code>:frequencies</code>: A map where keys are the average value of each bin and values are the counts.</li>
<li><code>:bins-maps</code>: A sequence of detailed maps for each bin, including <code>:min</code>, <code>:max</code>, <code>:step</code> (bin width), <code>:count</code>, <code>:avg</code> (mean value within the bin), and <code>:probability</code> (count / total samples).</li>
</ul>
<p>If the input <code>vs</code> is a sequence of sequences, the function returns a sequence of such maps, one for each inner sequence.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb200"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>(stats/histogram mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb201"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:bins</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>   ([<span class="fl">10.4</span> <span class="dv">6</span>] [<span class="fl">15.100000000000001</span> <span class="dv">12</span>] [<span class="fl">19.8</span> <span class="dv">8</span>] [<span class="fl">24.5</span> <span class="dv">2</span>] [<span class="fl">29.200000000000003</span> <span class="dv">4</span>]),</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a> <span class="at">:bins-maps</span> ({<span class="at">:avg</span> <span class="fl">13.016666666666666</span>,</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">:count</span> <span class="dv">6</span>,</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">:max</span> <span class="fl">15.100000000000001</span>,</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">:min</span> <span class="fl">10.4</span>,</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">:probability</span> <span class="fl">0.1875</span>,</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">:step</span> <span class="fl">4.700000000000001</span>}</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>             {<span class="at">:avg</span> <span class="fl">17.341666666666665</span>,</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">:count</span> <span class="dv">12</span>,</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">:max</span> <span class="fl">19.8</span>,</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">:min</span> <span class="fl">15.100000000000001</span>,</span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">:probability</span> <span class="fl">0.375</span>,</span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">:step</span> <span class="fl">4.699999999999999</span>}</span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a>             {<span class="at">:avg</span> <span class="fl">22.0375</span>,</span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">:count</span> <span class="dv">8</span>,</span>
<span id="cb201-17"><a href="#cb201-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">:max</span> <span class="fl">24.5</span>,</span>
<span id="cb201-18"><a href="#cb201-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">:min</span> <span class="fl">19.8</span>,</span>
<span id="cb201-19"><a href="#cb201-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">:probability</span> <span class="fl">0.25</span>,</span>
<span id="cb201-20"><a href="#cb201-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">:step</span> <span class="fl">4.699999999999999</span>}</span>
<span id="cb201-21"><a href="#cb201-21" aria-hidden="true" tabindex="-1"></a>             {<span class="at">:avg</span> <span class="fl">26.65</span>,</span>
<span id="cb201-22"><a href="#cb201-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">:count</span> <span class="dv">2</span>,</span>
<span id="cb201-23"><a href="#cb201-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">:max</span> <span class="fl">29.200000000000003</span>,</span>
<span id="cb201-24"><a href="#cb201-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">:min</span> <span class="fl">24.5</span>,</span>
<span id="cb201-25"><a href="#cb201-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">:probability</span> <span class="fl">0.0625</span>,</span>
<span id="cb201-26"><a href="#cb201-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">:step</span> <span class="fl">4.700000000000003</span>}</span>
<span id="cb201-27"><a href="#cb201-27" aria-hidden="true" tabindex="-1"></a>             {<span class="at">:avg</span> <span class="fl">31.775</span>,</span>
<span id="cb201-28"><a href="#cb201-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">:count</span> <span class="dv">4</span>,</span>
<span id="cb201-29"><a href="#cb201-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">:max</span> <span class="fl">33.9</span>,</span>
<span id="cb201-30"><a href="#cb201-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">:min</span> <span class="fl">29.200000000000003</span>,</span>
<span id="cb201-31"><a href="#cb201-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">:probability</span> <span class="fl">0.125</span>,</span>
<span id="cb201-32"><a href="#cb201-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">:step</span> <span class="fl">4.699999999999996</span>}),</span>
<span id="cb201-33"><a href="#cb201-33" aria-hidden="true" tabindex="-1"></a> <span class="at">:frequencies</span></span>
<span id="cb201-34"><a href="#cb201-34" aria-hidden="true" tabindex="-1"></a>   {<span class="fl">13.016666666666666</span> <span class="dv">6</span>, <span class="fl">17.341666666666665</span> <span class="dv">12</span>, <span class="fl">22.0375</span> <span class="dv">8</span>, <span class="fl">26.65</span> <span class="dv">2</span>, <span class="fl">31.775</span> <span class="dv">4</span>},</span>
<span id="cb201-35"><a href="#cb201-35" aria-hidden="true" tabindex="-1"></a> <span class="at">:intervals</span> (<span class="fl">10.4</span> <span class="fl">15.100000000000001</span> <span class="fl">19.8</span> <span class="fl">24.5</span> <span class="fl">29.200000000000003</span> <span class="fl">33.9</span>),</span>
<span id="cb201-36"><a href="#cb201-36" aria-hidden="true" tabindex="-1"></a> <span class="at">:max</span> <span class="fl">33.9</span>,</span>
<span id="cb201-37"><a href="#cb201-37" aria-hidden="true" tabindex="-1"></a> <span class="at">:min</span> <span class="fl">10.4</span>,</span>
<span id="cb201-38"><a href="#cb201-38" aria-hidden="true" tabindex="-1"></a> <span class="at">:samples</span> <span class="dv">32</span>,</span>
<span id="cb201-39"><a href="#cb201-39" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span> <span class="dv">5</span>,</span>
<span id="cb201-40"><a href="#cb201-40" aria-hidden="true" tabindex="-1"></a> <span class="at">:step</span> <span class="fl">4.7</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/40.png">
</div>
<p>Histogram with 3 bins</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb202"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>(stats/histogram mpg <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb203"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:bins</span> ([<span class="fl">10.4</span> <span class="dv">14</span>] [<span class="fl">18.233333333333334</span> <span class="dv">13</span>] [<span class="fl">26.066666666666666</span> <span class="dv">5</span>]),</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:bins-maps</span> ({<span class="at">:avg</span> <span class="fl">14.957142857142857</span>,</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">:count</span> <span class="dv">14</span>,</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">:max</span> <span class="fl">18.233333333333334</span>,</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">:min</span> <span class="fl">10.4</span>,</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">:probability</span> <span class="fl">0.4375</span>,</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">:step</span> <span class="fl">7.833333333333334</span>}</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>             {<span class="at">:avg</span> <span class="fl">21.469230769230766</span>,</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">:count</span> <span class="dv">13</span>,</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">:max</span> <span class="fl">26.066666666666666</span>,</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">:min</span> <span class="fl">18.233333333333334</span>,</span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">:probability</span> <span class="fl">0.40625</span>,</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">:step</span> <span class="fl">7.833333333333332</span>}</span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>             {<span class="at">:avg</span> <span class="fl">30.879999999999995</span>,</span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">:count</span> <span class="dv">5</span>,</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">:max</span> <span class="fl">33.9</span>,</span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">:min</span> <span class="fl">26.066666666666666</span>,</span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">:probability</span> <span class="fl">0.15625</span>,</span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">:step</span> <span class="fl">7.833333333333332</span>}),</span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a> <span class="at">:frequencies</span></span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>   {<span class="fl">14.957142857142857</span> <span class="dv">14</span>, <span class="fl">21.469230769230766</span> <span class="dv">13</span>, <span class="fl">30.879999999999995</span> <span class="dv">5</span>},</span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a> <span class="at">:intervals</span> (<span class="fl">10.4</span> <span class="fl">18.233333333333334</span> <span class="fl">26.066666666666666</span> <span class="fl">33.9</span>),</span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a> <span class="at">:max</span> <span class="fl">33.9</span>,</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a> <span class="at">:min</span> <span class="fl">10.4</span>,</span>
<span id="cb203-25"><a href="#cb203-25" aria-hidden="true" tabindex="-1"></a> <span class="at">:samples</span> <span class="dv">32</span>,</span>
<span id="cb203-26"><a href="#cb203-26" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span> <span class="dv">3</span>,</span>
<span id="cb203-27"><a href="#cb203-27" aria-hidden="true" tabindex="-1"></a> <span class="at">:step</span> <span class="fl">7.833333333333333</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/41.png">
</div>
<p>Histogram with irregular bins</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb204"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>(stats/histogram mpg [<span class="dv">10</span> <span class="dv">20</span> <span class="dv">25</span> <span class="dv">27</span> <span class="dv">35</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb205"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:bins</span> ([<span class="fl">10.0</span> <span class="dv">18</span>] [<span class="fl">20.0</span> <span class="dv">8</span>] [<span class="fl">25.0</span> <span class="dv">1</span>] [<span class="fl">27.0</span> <span class="dv">5</span>]),</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:bins-maps</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>   ({<span class="at">:avg</span> <span class="fl">15.899999999999999</span>,</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">:count</span> <span class="dv">18</span>,</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">:max</span> <span class="fl">20.0</span>,</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">:min</span> <span class="fl">10.0</span>,</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">:probability</span> <span class="fl">0.5625</span>,</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">:step</span> <span class="fl">10.0</span>}</span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>    {<span class="at">:avg</span> <span class="fl">22.0375</span>, <span class="at">:count</span> <span class="dv">8</span>, <span class="at">:max</span> <span class="fl">25.0</span>, <span class="at">:min</span> <span class="fl">20.0</span>, <span class="at">:probability</span> <span class="fl">0.25</span>, <span class="at">:step</span> <span class="fl">5.0</span>}</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>    {<span class="at">:avg</span> <span class="fl">26.0</span>, <span class="at">:count</span> <span class="dv">1</span>, <span class="at">:max</span> <span class="fl">27.0</span>, <span class="at">:min</span> <span class="fl">25.0</span>, <span class="at">:probability</span> <span class="fl">0.03125</span>, <span class="at">:step</span> <span class="fl">2.0</span>}</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>    {<span class="at">:avg</span> <span class="fl">30.879999999999995</span>,</span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">:count</span> <span class="dv">5</span>,</span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">:max</span> <span class="fl">35.0</span>,</span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">:min</span> <span class="fl">27.0</span>,</span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">:probability</span> <span class="fl">0.15625</span>,</span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">:step</span> <span class="fl">8.0</span>}),</span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a> <span class="at">:frequencies</span> {<span class="fl">15.899999999999999</span> <span class="dv">18</span>, <span class="fl">22.0375</span> <span class="dv">8</span>, <span class="fl">26.0</span> <span class="dv">1</span>, <span class="fl">30.879999999999995</span> <span class="dv">5</span>},</span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a> <span class="at">:intervals</span> (<span class="dv">10</span> <span class="dv">20</span> <span class="dv">25</span> <span class="dv">27</span> <span class="dv">35</span>),</span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true" tabindex="-1"></a> <span class="at">:max</span> <span class="fl">35.0</span>,</span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true" tabindex="-1"></a> <span class="at">:min</span> <span class="fl">10.0</span>,</span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true" tabindex="-1"></a> <span class="at">:samples</span> <span class="dv">32</span>,</span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true" tabindex="-1"></a> <span class="at">:size</span> <span class="dv">4</span>,</span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true" tabindex="-1"></a> <span class="at">:step</span> <span class="fl">6.25</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/42.png">
</div>
<p>Histogram with given min and max range</p>
<div class="clay-image">
<img class="clay-image" src="stats_files/43.png">
</div>
<p>The <code>estimate-bins</code> function provides recommendations for the number of bins in a histogram based on common rules.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>vs</code> (sequence of numbers): The input data.</li>
<li><code>bins-or-estimate-method</code> (keyword, optional): The rule to use for estimation.
<ul>
<li>A keyword (default: <code>:freedman-diaconis</code>): Specifies the rule.
<ul>
<li><code>:sqrt</code>: Square root rule (simple). <span class="math inline">\(k = \lceil\sqrt{n}\rceil\)</span></li>
<li><code>:sturges</code>: Sturges’ rule (assumes approximately normal data). <span class="math inline">\(k = \lceil\log_2(n) + 1\rceil\)</span></li>
<li><code>:rice</code>: Rice rule. <span class="math inline">\(k = \lceil 2 n^{1/3} \rceil\)</span></li>
<li><code>:doane</code>: Doane’s rule (modification of Sturges’ for non-normal data). <span class="math inline">\(k = \lceil \log_2(n) + 1 + \log_2(1 + \frac{|g_1|}{\sigma_{g_1}}) \rceil\)</span>, where <span class="math inline">\(g_1\)</span> is sample skewness and <span class="math inline">\(\sigma_{g_1}\)</span> is its standard error.</li>
<li><code>:scott</code>: Scott’s normal reference rule (bin width <span class="math inline">\(h = 3.5 \hat{\sigma} n^{-1/3}\)</span>). <span class="math inline">\(k = \lceil (max - min)/h \rceil\)</span></li>
<li><code>:freedman-diaconis</code> (default): Freedman-Diaconis rule (robust to outliers, bin width <span class="math inline">\(h = 2 \cdot IQR \cdot n^{-1/3}\)</span>). <span class="math inline">\(k = \lceil (max - min)/h \rceil\)</span></li>
</ul></li>
<li>A number: Returns the number itself (useful for passing a fixed value through).</li>
<li>If omitted, uses the default <code>:freedman-diaconis</code> rule.</li>
</ul></li>
</ul>
<p><strong>Return Value (Long):</strong></p>
<p>Returns the estimated number of bins as a long integer. The returned value is constrained to be no greater than the number of samples.</p>
<hr>
<p>Estimate bins for <code>alcohol</code> data using different methods</p>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb206"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>(stats/estimate-bins alcohol) <span class="co">;; =&gt; 28</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>(stats/estimate-bins alcohol <span class="at">:sqrt</span>) <span class="co">;; =&gt; 69</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>(stats/estimate-bins alcohol <span class="at">:sturges</span>) <span class="co">;; =&gt; 14</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>(stats/estimate-bins alcohol <span class="at">:rice</span>) <span class="co">;; =&gt; 34</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>(stats/estimate-bins alcohol <span class="at">:doane</span>) <span class="co">;; =&gt; 17</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>(stats/estimate-bins alcohol <span class="at">:scott</span>) <span class="co">;; =&gt; 25</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>(stats/estimate-bins alcohol <span class="dv">3</span>) <span class="co">;; =&gt; 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/44.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/45.png" class="clay-image img-fluid"></td>
</tr>
<tr class="even">
<td><img src="stats_files/46.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/47.png" class="clay-image img-fluid"></td>
</tr>
<tr class="odd">
<td><img src="stats_files/48.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/49.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="bootstrap" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap">Bootstrap</h2>
<p>Bootstrap is a widely used resampling technique in statistics. It involves repeatedly drawing samples with replacement from an original dataset (or simulating data from a model) to create many “bootstrap samples”. By analyzing the distribution of a statistic computed from each of these bootstrap samples, one can estimate the sampling distribution of the statistic, its standard error, bias, and construct confidence intervals without relying on strong parametric assumptions.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Defined functions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>bootstrap</code></li>
<li><code>jackknife</code>, <code>jackknife+</code></li>
<li><code>bootstrap-stats</code></li>
<li><code>ci-normal</code>, <code>ci-basic</code>, <code>ci-percentile</code>, <code>ci-bc</code>, <code>ci-bca</code>, <code>ci-studentized</code>, <code>ci-t</code></li>
</ul>
</div>
</div>
<p>The core of the bootstrap process is generating the resamples. <code>fastmath.stats</code> provides the main <code>bootstrap</code> function for general resampling, and dedicated functions for specific resampling techniques like Jackknife.</p>
<ul>
<li><code>bootstrap</code>: Generates bootstrap samples from data or a probabilistic model. It supports various sampling methods (standard resampling with replacement, Jackknife variants, or sampling from a distribution) and options like smoothing, antithetic sampling, and handling multidimensional data.</li>
<li><code>jackknife</code>: Generates samples using the leave-one-out Jackknife method. For a dataset of size <span class="math inline">\(n\)</span>, it produces <span class="math inline">\(n\)</span> samples, each by removing one observation from the original dataset. This is a less computationally intensive resampling method than standard bootstrap, primarily used for bias and variance estimation.</li>
<li><code>jackknife+</code>: Generates samples using the positive Jackknife method. For a dataset of size <span class="math inline">\(n\)</span>, it produces <span class="math inline">\(n\)</span> samples, each by adding one extra copy of an observation to the original dataset, resulting in samples of size <span class="math inline">\(n+1\)</span>.</li>
</ul>
<p>The primary function for generating bootstrap samples. It’s flexible, supporting both nonparametric (resampling from data) and parametric (sampling from a model) approaches, and various options.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>input</code> (sequence or map): The data source.
<ul>
<li>If a sequence of data values (e.g., <code>[1.2 3.4 5.0]</code>), it’s treated as nonparametric input.</li>
<li>If a map <code>{:data data-sequence :model model-object (optional)}</code>, it supports parametric bootstrap. If <code>:model</code> is omitted, a distribution is automatically built from <code>:data</code>.</li>
<li>Can be a sequence of sequences (e.g., <code>[[1 2] [3 4]]</code>) for multidimensional data when <code>:dimensions</code> is <code>:multi</code>.</li>
</ul></li>
<li><code>statistic</code> (function, optional): A function <code>(fn [sample-sequence])</code> that calculates a statistic (e.g., <code>fastmath.stats/mean</code>). If provided, <code>bootstrap-stats</code> is automatically called on the results. If <code>nil</code>, the raw bootstrap samples are returned.</li>
<li><code>params</code> (map, optional): Configuration options:
<ul>
<li><code>:samples</code> (long, default: 500): Number of bootstrap samples. Ignored for <code>:jackknife</code>/<code>:jackknife+</code>.</li>
<li><code>:size</code> (long, optional): Size of each sample. Defaults to original data size. Ignored for <code>:jackknife</code>/<code>:jackknife+</code>.</li>
<li><code>:method</code> (keyword, optional): Sampling method.
<ul>
<li><code>nil</code> (default): Standard resampling with replacement from data or model.</li>
<li><code>:jackknife</code>: Uses [<a href="#jackknife">jackknife</a>].</li>
<li><code>:jackknife+</code>: Uses [<a href="#jackknife-1">jackknife+</a>].</li>
<li>Other keywords are passed to <code>fastmath.random/-&gt;seq</code> for sampling from a distribution model.</li>
</ul></li>
<li><code>:rng</code> (random number generator, optional): <code>fastmath.random</code> RNG. Defaults to JVM RNG.</li>
<li><code>:smoothing</code> (keyword, optional): Applies smoothing. <code>:kde</code> for Kernel Density Estimation on the model; <code>:gaussian</code> adds noise to resampled values.</li>
<li><code>:distribution</code> (keyword, default <code>:real-discrete-distribution</code>): Type of distribution to build if <code>:model</code> is missing.</li>
<li><code>:dimensions</code> (keyword, optional): <code>:multi</code> for multidimensional data (sequence of sequences).</li>
<li><code>:antithetic?</code> (boolean, default <code>false</code>): Uses antithetic sampling (requires distribution model).</li>
<li><code>:include?</code> (boolean, default <code>false</code>): Includes original dataset as one sample.</li>
</ul></li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li>If <code>statistic</code> is provided: A map including original input + analysis results from <code>bootstrap-stats</code> (e.g., <code>:t0</code>, <code>:ts</code>, <code>:bias</code>, <code>:mean</code>, <code>:stddev</code>).</li>
<li>If <code>statistic</code> is <code>nil</code>: A map including original input + <code>:samples</code> (a collection of bootstrap sample sequences).</li>
</ul>
<p>Let’s demonstrate various sampling methods for <code>mpg</code> data and see the outcome.</p>
<p>First we’ll generate two samples using default (resampling with replacement) method without calculating statistics.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb207"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> rng </span>(r/rng <span class="at">:mersenne</span> <span class="dv">12345</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb208"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg </span>(boot/bootstrap mpg {<span class="at">:samples</span> <span class="dv">2</span> <span class="at">:rng</span> rng}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb209"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>boot-mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb210"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:data</span> (<span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">33.9</span> <span class="fl">21.5</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span> <span class="fl">27.3</span> <span class="dv">26</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="dv">15</span> <span class="fl">21.4</span>), <span class="at">:model</span> #object[fastmath.random$eval76580$fn$reify__76594 <span class="bn">0x5f97f7db</span> <span class="st">"fastmath.random$eval76580$fn$reify__76594@5f97f7db"</span>], <span class="at">:samples</span> ((<span class="fl">30.4</span> <span class="fl">21.4</span> <span class="fl">18.1</span> <span class="fl">21.4</span> <span class="fl">26.0</span> <span class="fl">19.2</span> <span class="fl">22.8</span> <span class="fl">33.9</span> <span class="fl">30.4</span> <span class="fl">15.0</span> <span class="fl">22.8</span> <span class="fl">33.9</span> <span class="fl">16.4</span> <span class="fl">30.4</span> <span class="fl">21.4</span> <span class="fl">21.0</span> <span class="fl">21.5</span> <span class="fl">21.4</span> <span class="fl">14.7</span> <span class="fl">19.2</span> <span class="fl">21.0</span> <span class="fl">18.1</span> <span class="fl">15.2</span> <span class="fl">18.1</span> <span class="fl">16.4</span> <span class="fl">26.0</span> <span class="fl">14.7</span> <span class="fl">18.1</span> <span class="fl">21.4</span> <span class="fl">26.0</span> <span class="fl">21.4</span> <span class="fl">19.7</span>) (<span class="fl">17.3</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">15.8</span> <span class="fl">15.2</span> <span class="fl">32.4</span> <span class="fl">21.0</span> <span class="fl">18.7</span> <span class="fl">21.0</span> <span class="fl">22.8</span> <span class="fl">10.4</span> <span class="fl">22.8</span> <span class="fl">22.8</span> <span class="fl">15.8</span> <span class="fl">13.3</span> <span class="fl">18.1</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">26.0</span> <span class="fl">24.4</span> <span class="fl">15.2</span> <span class="fl">22.8</span> <span class="fl">16.4</span> <span class="fl">17.8</span> <span class="fl">22.8</span> <span class="fl">33.9</span> <span class="fl">14.7</span> <span class="fl">21.5</span> <span class="fl">27.3</span> <span class="fl">15.8</span> <span class="fl">27.3</span> <span class="fl">15.5</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/50.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/51.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now we’ll create set of samples using various bootstrapping methods: jackknife, jackknife+, gaussian and kde (epanechnikov kernel) smoothing, antithetic, systematic, stratified.</p>
<p><strong>jackknife</strong></p>
<p>Removes one selected data point from each sample.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb211"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-jacknife </span>(boot/bootstrap mpg {<span class="at">:method</span> <span class="at">:jackknife</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb212"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">count</span> (<span class="at">:samples</span> boot-mpg-jacknife))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb213"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="dv">32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/52.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/53.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>jackknife+</strong></p>
<p>Duplicates one selected data point to each sample.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb214"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-jacknife+ </span>(boot/bootstrap mpg {<span class="at">:method</span> <span class="at">:jackknife</span>+}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb215"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">count</span> (<span class="at">:samples</span> boot-mpg-jacknife))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb216"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="dv">32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/54.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/55.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>gaussian smoothing</strong></p>
<p>Adds random gaussian noise to bootstrapped samples.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb217"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-gaussian </span>(boot/bootstrap mpg {<span class="at">:samples</span> <span class="dv">2</span> <span class="at">:rng</span> rng <span class="at">:smoothing</span> <span class="at">:gaussian</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb218"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>boot-mpg-gaussian</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb219"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:data</span> (<span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">33.9</span> <span class="fl">21.5</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span> <span class="fl">27.3</span> <span class="dv">26</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="dv">15</span> <span class="fl">21.4</span>), <span class="at">:model</span> #object[fastmath.stats.bootstrap$build_model$reify__81181 <span class="bn">0x3dad2c2b</span> <span class="st">"fastmath.stats.bootstrap$build_model$reify__81181@3dad2c2b"</span>], <span class="at">:samples</span> ((<span class="fl">17.67627223078807</span> <span class="fl">14.421273983904124</span> <span class="fl">19.78342723622221</span> <span class="fl">16.07408954450633</span> <span class="fl">14.316546938062789</span> <span class="fl">27.798521999070797</span> <span class="fl">30.77113828285854</span> <span class="fl">18.302867531466383</span> <span class="fl">15.960192150840488</span> <span class="fl">15.864337425252026</span> <span class="fl">14.941708701743925</span> <span class="fl">26.804072729895143</span> <span class="fl">16.574983247993774</span> <span class="fl">29.666351699518902</span> <span class="fl">17.339228247855342</span> <span class="fl">31.40604151247253</span> <span class="fl">22.395701311599353</span> <span class="fl">32.930311855428364</span> <span class="fl">33.78970082261317</span> <span class="fl">30.756294112465746</span> <span class="fl">21.585229731828957</span> <span class="fl">26.74839610035781</span> <span class="fl">23.885829284382098</span> <span class="fl">30.639999179485162</span> <span class="fl">21.687174326300102</span> <span class="fl">27.024298138739095</span> <span class="fl">20.996894755344975</span> <span class="fl">15.037358451484616</span> <span class="fl">27.75666678457644</span> <span class="fl">21.681540315448597</span> <span class="fl">18.258506429956125</span> <span class="fl">21.224613290413426</span>) (<span class="fl">15.557680619017212</span> <span class="fl">21.857534902478296</span> <span class="fl">17.173787452087744</span> <span class="fl">21.772458916268835</span> <span class="fl">30.79048018443092</span> <span class="fl">14.401834047062994</span> <span class="fl">29.91805443291403</span> <span class="fl">23.84835433680409</span> <span class="fl">14.97275468619625</span> <span class="fl">15.831977361111361</span> <span class="fl">12.75807146600363</span> <span class="fl">29.478799801629</span> <span class="fl">13.031673716237787</span> <span class="fl">19.899937617191505</span> <span class="fl">10.412081378944666</span> <span class="fl">15.807822683372736</span> <span class="fl">20.77838101998807</span> <span class="fl">34.10293524709373</span> <span class="fl">23.32318729591913</span> <span class="fl">15.691254243065426</span> <span class="fl">15.523902532414375</span> <span class="fl">22.156319169598923</span> <span class="fl">13.174824168708717</span> <span class="fl">21.945995006952142</span> <span class="fl">16.102210424539535</span> <span class="fl">12.657658291816556</span> <span class="fl">22.057155613451208</span> <span class="fl">13.808960669738454</span> <span class="fl">27.20472770459077</span> <span class="fl">15.71216788846756</span> <span class="fl">15.340973186948972</span> <span class="fl">21.86783436275048</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/56.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/57.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>KDE (epanechnikov) smoothing</strong></p>
<p>Builds KDE based continuous distributions and samples from it.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb220"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-kde </span>(boot/bootstrap mpg {<span class="at">:samples</span> <span class="dv">2</span> <span class="at">:rng</span> rng <span class="at">:smoothing</span> <span class="at">:kde</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">:kernel</span> <span class="at">:epanechnikov</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb221"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>boot-mpg-kde</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb222"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:data</span> (<span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">33.9</span> <span class="fl">21.5</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span> <span class="fl">27.3</span> <span class="dv">26</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="dv">15</span> <span class="fl">21.4</span>), <span class="at">:model</span> #object[fastmath.random$eval76472$fn$reify__76487 <span class="bn">0x78868d31</span> <span class="st">"fastmath.random$eval76472$fn$reify__76487@78868d31"</span>], <span class="at">:samples</span> ((<span class="fl">22.71166231862099</span> <span class="fl">21.5726212037736</span> <span class="fl">21.491485668355004</span> <span class="fl">26.80401596363164</span> <span class="fl">11.036961153662787</span> <span class="fl">19.671900487652536</span> <span class="fl">19.19056125766834</span> <span class="fl">14.688160551611023</span> <span class="fl">16.200514869948623</span> <span class="fl">24.206628273571038</span> <span class="fl">17.059352260277656</span> <span class="fl">12.680303574909846</span> <span class="fl">22.250524161111514</span> <span class="fl">17.436331799861314</span> <span class="fl">25.681192054352337</span> <span class="fl">22.158874322682465</span> <span class="fl">15.681506740965093</span> <span class="fl">31.02194432899891</span> <span class="fl">19.462270416888536</span> <span class="fl">33.728606429171</span> <span class="fl">20.47057953199578</span> <span class="fl">18.524421058031663</span> <span class="fl">14.958105453393623</span> <span class="fl">14.69506556273741</span> <span class="fl">17.17075042372946</span> <span class="fl">28.295932367320248</span> <span class="fl">13.829212961072399</span> <span class="fl">24.535423656489346</span> <span class="fl">27.104003147221192</span> <span class="fl">18.25942212803992</span> <span class="fl">27.780775341929104</span> <span class="fl">17.920535668692203</span>) (<span class="fl">17.28666485268042</span> <span class="fl">12.638080093377924</span> <span class="fl">14.96857016839802</span> <span class="fl">15.521948357649412</span> <span class="fl">8.753906073248814</span> <span class="fl">29.75592094916252</span> <span class="fl">16.347734250920293</span> <span class="fl">34.81462170357484</span> <span class="fl">32.232667295931996</span> <span class="fl">23.212608320127185</span> <span class="fl">10.744533703230774</span> <span class="fl">20.269444624032467</span> <span class="fl">17.09041749905982</span> <span class="fl">17.345419179032728</span> <span class="fl">19.814015784485466</span> <span class="fl">12.438328238728095</span> <span class="fl">15.908886080593</span> <span class="fl">16.16469970328886</span> <span class="fl">20.98631911829065</span> <span class="fl">13.02615677642237</span> <span class="fl">26.615189109218168</span> <span class="fl">12.421811034398033</span> <span class="fl">14.480450305155927</span> <span class="fl">17.91739680794446</span> <span class="fl">16.56234614189687</span> <span class="fl">20.673676874252102</span> <span class="fl">22.65887627864257</span> <span class="fl">28.21681519740815</span> <span class="fl">11.93320510417053</span> <span class="fl">20.01124443774085</span> <span class="fl">18.687367694505223</span> <span class="fl">14.7899861991578</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/58.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/59.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>antithetic</strong></p>
<p>Samples in pairs.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb223"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-antithetic </span>(boot/bootstrap mpg {<span class="at">:samples</span> <span class="dv">2</span> <span class="at">:rng</span> rng <span class="at">:antithetic</span>? <span class="va">true</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb224"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>boot-mpg-antithetic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb225"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:data</span> (<span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">33.9</span> <span class="fl">21.5</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span> <span class="fl">27.3</span> <span class="dv">26</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="dv">15</span> <span class="fl">21.4</span>), <span class="at">:model</span> #object[fastmath.random$eval76580$fn$reify__76594 <span class="bn">0x6fdabd60</span> <span class="st">"fastmath.random$eval76580$fn$reify__76594@6fdabd60"</span>], <span class="at">:samples</span> ((<span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">21.0</span> <span class="fl">21.5</span> <span class="fl">30.4</span> <span class="fl">21.5</span> <span class="fl">18.7</span> <span class="fl">21.0</span> <span class="fl">21.5</span> <span class="fl">30.4</span> <span class="fl">17.8</span> <span class="fl">14.7</span> <span class="fl">14.3</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">27.3</span> <span class="fl">30.4</span> <span class="fl">15.0</span> <span class="fl">18.7</span> <span class="fl">24.4</span> <span class="fl">15.2</span> <span class="fl">19.2</span> <span class="fl">19.2</span> <span class="fl">14.7</span> <span class="fl">21.4</span> <span class="fl">22.8</span> <span class="fl">21.0</span> <span class="fl">21.0</span> <span class="fl">17.8</span> <span class="fl">24.4</span> <span class="fl">21.5</span> <span class="fl">15.8</span>) (<span class="fl">10.4</span> <span class="fl">13.3</span> <span class="fl">18.1</span> <span class="fl">15.8</span> <span class="fl">14.3</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="fl">17.8</span> <span class="fl">15.8</span> <span class="fl">13.3</span> <span class="fl">21.0</span> <span class="fl">27.3</span> <span class="fl">30.4</span> <span class="fl">13.3</span> <span class="fl">21.5</span> <span class="fl">14.7</span> <span class="fl">13.3</span> <span class="fl">26.0</span> <span class="fl">19.7</span> <span class="fl">15.2</span> <span class="fl">24.4</span> <span class="fl">19.2</span> <span class="fl">19.2</span> <span class="fl">27.3</span> <span class="fl">16.4</span> <span class="fl">15.5</span> <span class="fl">18.1</span> <span class="fl">17.8</span> <span class="fl">21.0</span> <span class="fl">15.2</span> <span class="fl">15.8</span> <span class="fl">21.5</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/60.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/61.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>systematic</strong></p>
<p>When <code>:systematic</code> method is used, the result will be visible when model is continuous.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb226"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-systematic </span>(boot/bootstrap mpg {<span class="at">:samples</span> <span class="dv">2</span> <span class="at">:rng</span> rng <span class="at">:method</span> <span class="at">:systematic</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">:smoothing</span> <span class="at">:kde</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb227"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>boot-mpg-systematic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb228"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:data</span> (<span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">33.9</span> <span class="fl">21.5</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span> <span class="fl">27.3</span> <span class="dv">26</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="dv">15</span> <span class="fl">21.4</span>), <span class="at">:model</span> #object[fastmath.random$eval76472$fn$reify__76487 <span class="bn">0x17589cf7</span> <span class="st">"fastmath.random$eval76472$fn$reify__76487@17589cf7"</span>], <span class="at">:samples</span> ((<span class="fl">7.606150009949184</span> <span class="fl">10.075237326852191</span> <span class="fl">11.413673809250726</span> <span class="fl">12.393660938519448</span> <span class="fl">13.192701804947857</span> <span class="fl">13.883853741720861</span> <span class="fl">14.504864771667009</span> <span class="fl">15.077964794554122</span> <span class="fl">15.617447530191576</span> <span class="fl">16.133133483769825</span> <span class="fl">16.632135165532496</span> <span class="fl">17.11985976024962</span> <span class="fl">17.600623861695897</span> <span class="fl">18.078056714893737</span> <span class="fl">18.555409167666742</span> <span class="fl">19.035805185460838</span> <span class="fl">19.52248025896614</span> <span class="fl">20.019034758408264</span> <span class="fl">20.529731011895603</span> <span class="fl">21.059877586339276</span> <span class="fl">21.61637474894962</span> <span class="fl">22.208511540390997</span> <span class="fl">22.849235227484154</span> <span class="fl">23.55710632341578</span> <span class="fl">24.359299899230063</span> <span class="fl">25.29497771190241</span> <span class="fl">26.413769034642186</span> <span class="fl">27.750946296365644</span> <span class="fl">29.27566787162567</span> <span class="fl">30.9234351368731</span> <span class="fl">32.76189217919069</span> <span class="fl">35.34339715127126</span>) (<span class="fl">8.676493856283274</span> <span class="fl">10.569043222796827</span> <span class="fl">11.758115889203658</span> <span class="fl">12.66764775786899</span> <span class="fl">13.42609913122416</span> <span class="fl">14.091376822965778</span> <span class="fl">14.694919542040203</span> <span class="fl">15.255831778482156</span> <span class="fl">15.78668865312256</span> <span class="fl">16.29628956322358</span> <span class="fl">16.79110934287723</span> <span class="fl">17.27614772688062</span> <span class="fl">17.755459243241486</span> <span class="fl">18.232521242300177</span> <span class="fl">18.710516956755633</span> <span class="fl">19.19258011239735</span> <span class="fl">19.68203595423166</span> <span class="fl">20.182661491418965</span> <span class="fl">20.69901308885707</span> <span class="fl">21.23684228788875</span> <span class="fl">21.803719707918162</span> <span class="fl">22.409951783548575</span> <span class="fl">23.07004582120764</span> <span class="fl">23.804977419951637</span> <span class="fl">24.645471268906874</span> <span class="fl">25.634844499022098</span> <span class="fl">26.822677828928917</span> <span class="fl">28.227959649536935</span> <span class="fl">29.79700481962044</span> <span class="fl">31.487573747147117</span> <span class="fl">33.45546155582857</span> <span class="fl">36.89510371835037</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/62.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/63.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>stratified</strong></p>
<p>Similarly to a <code>:systematic</code>, we should sample from conitinuous distribution.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb229"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-stratified </span>(boot/bootstrap mpg {<span class="at">:samples</span> <span class="dv">2</span> <span class="at">:rng</span> rng <span class="at">:method</span> <span class="at">:stratified</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">:smoothing</span> <span class="at">:kde</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb230"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>boot-mpg-stratified</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb231"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:data</span> (<span class="dv">21</span> <span class="dv">21</span> <span class="fl">22.8</span> <span class="fl">21.4</span> <span class="fl">18.7</span> <span class="fl">18.1</span> <span class="fl">14.3</span> <span class="fl">24.4</span> <span class="fl">22.8</span> <span class="fl">19.2</span> <span class="fl">17.8</span> <span class="fl">16.4</span> <span class="fl">17.3</span> <span class="fl">15.2</span> <span class="fl">10.4</span> <span class="fl">10.4</span> <span class="fl">14.7</span> <span class="fl">32.4</span> <span class="fl">30.4</span> <span class="fl">33.9</span> <span class="fl">21.5</span> <span class="fl">15.5</span> <span class="fl">15.2</span> <span class="fl">13.3</span> <span class="fl">19.2</span> <span class="fl">27.3</span> <span class="dv">26</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">19.7</span> <span class="dv">15</span> <span class="fl">21.4</span>), <span class="at">:model</span> #object[fastmath.random$eval76472$fn$reify__76487 <span class="bn">0x47a02207</span> <span class="st">"fastmath.random$eval76472$fn$reify__76487@47a02207"</span>], <span class="at">:samples</span> ((<span class="fl">7.246091436112749</span> <span class="fl">9.941275520026366</span> <span class="fl">11.32406615601483</span> <span class="fl">12.32370249682059</span> <span class="fl">13.133759200629084</span> <span class="fl">13.831823291372558</span> <span class="fl">14.45745740742365</span> <span class="fl">15.03376742295543</span> <span class="fl">15.575522401157436</span> <span class="fl">16.092810948228664</span> <span class="fl">16.59292399884376</span> <span class="fl">17.081376183935813</span> <span class="fl">17.56255414339351</span> <span class="fl">18.04012960877534</span> <span class="fl">18.51737397306466</span> <span class="fl">18.99741250071758</span> <span class="fl">19.483462705173242</span> <span class="fl">19.97908634934658</span> <span class="fl">20.48847962773443</span> <span class="fl">21.016853572877427</span> <span class="fl">21.570950008680434</span> <span class="fl">22.159839800707662</span> <span class="fl">22.796108151907163</span> <span class="fl">23.497783186703003</span> <span class="fl">24.291216370254393</span> <span class="fl">25.21453611919852</span> <span class="fl">26.316973452729822</span> <span class="fl">27.636791537277393</span> <span class="fl">29.149395484719662</span> <span class="fl">30.78779806206383</span> <span class="fl">32.6021090153638</span> <span class="fl">35.06525265475502</span>) (<span class="fl">7.015778582858773</span> <span class="fl">9.864058413269005</span> <span class="fl">11.273191811589978</span> <span class="fl">12.284239339511783</span> <span class="fl">13.100626827648787</span> <span class="fl">13.802643523386974</span> <span class="fl">14.43091808088285</span> <span class="fl">15.00905552836559</span> <span class="fl">15.552100855151096</span> <span class="fl">16.070304383761837</span> <span class="fl">16.57105020709445</span> <span class="fl">17.059919878505468</span> <span class="fl">17.541338233013303</span> <span class="fl">18.01900226855315</span> <span class="fl">18.49619503554834</span> <span class="fl">18.97604305379609</span> <span class="fl">19.461755664336977</span> <span class="fl">19.956872139879</span> <span class="fl">20.465554298720164</span> <span class="fl">20.992957541911824</span> <span class="fl">21.54574327611805</span> <span class="fl">22.13285599843595</span> <span class="fl">22.766691619155246</span> <span class="fl">23.4649857783239</span> <span class="fl">24.253644833601463</span> <span class="fl">25.170221950551866</span> <span class="fl">26.263670285499295</span> <span class="fl">27.573746699267982</span> <span class="fl">29.079371999052828</span> <span class="fl">30.712664195652117</span> <span class="fl">32.51454108242075</span> <span class="fl">34.92000288227524</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/64.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/65.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Model</strong></p>
<p>Automatically created model is in most cases a distribution object and it can be used to generate more data.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb232"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>(r/-&gt;seq (<span class="at">:model</span> boot-mpg) <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb233"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">27.3</span> <span class="fl">18.7</span> <span class="fl">15.5</span> <span class="fl">22.8</span> <span class="fl">10.4</span> <span class="fl">33.9</span> <span class="fl">14.3</span> <span class="fl">30.4</span> <span class="fl">15.8</span> <span class="fl">30.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb234"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>(r/-&gt;seq (<span class="at">:model</span> boot-mpg) <span class="dv">10</span> <span class="at">:stratified</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb235"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">10.4</span> <span class="fl">14.3</span> <span class="fl">15.2</span> <span class="fl">15.8</span> <span class="fl">17.8</span> <span class="fl">19.2</span> <span class="fl">21.0</span> <span class="fl">21.5</span> <span class="fl">24.4</span> <span class="fl">30.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s extract median</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb236"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>(r/icdf (<span class="at">:model</span> boot-mpg) <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="printedClojure">
<div class="sourceCode" id="cb237"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fl">19.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Model based sampling</strong></p>
<p>Now let’s simulate our data when model is given. Let’s assume that <code>mpg</code> follows normal distribution. So instead of resampling we will draw samples from fitted normal distribution.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb238"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-model </span>(boot/bootstrap {<span class="at">:data</span> mpg</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">:model</span> (r/distribution <span class="at">:normal</span> {<span class="at">:mu</span> (stats/mean mpg)</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">:sd</span> (stats/stddev mpg)})}</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>                                  stats/mean</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>                                  {<span class="at">:samples</span> <span class="dv">10000</span> <span class="at">:rng</span> rng}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/66.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/67.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Non-numerical data</strong></p>
<p>Bootstrap can be also called on categorical data.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb239"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>(boot/bootstrap [<span class="at">:cat</span> <span class="at">:dog</span> <span class="at">:cat</span> <span class="at">:dog</span> <span class="at">:dog</span>] {<span class="at">:samples</span> <span class="dv">2</span>, <span class="at">:size</span> <span class="dv">20</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb240"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:data</span> [<span class="at">:cat</span> <span class="at">:dog</span> <span class="at">:cat</span> <span class="at">:dog</span> <span class="at">:dog</span>],</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:model</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>   #object[fastmath.random$eval76605$fn$reify__76609 <span class="bn">0x1b48604d</span> <span class="st">"fastmath.random$eval76605$fn$reify__76609@1b48604d"</span>],</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a> <span class="at">:samples</span> ((<span class="at">:dog</span> <span class="at">:dog</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:dog</span> <span class="at">:cat</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:dog</span> <span class="at">:cat</span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:dog</span> <span class="at">:dog</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:cat</span> <span class="at">:dog</span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:cat</span> <span class="at">:dog</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:dog</span> <span class="at">:cat</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:cat</span> <span class="at">:dog</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:dog</span> <span class="at">:dog</span></span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">:cat</span> <span class="at">:dog</span>)</span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>            (<span class="at">:dog</span> <span class="at">:cat</span></span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:cat</span> <span class="at">:dog</span></span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:cat</span> <span class="at">:dog</span></span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:dog</span> <span class="at">:dog</span></span>
<span id="cb240-18"><a href="#cb240-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:cat</span> <span class="at">:dog</span></span>
<span id="cb240-19"><a href="#cb240-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:dog</span> <span class="at">:dog</span></span>
<span id="cb240-20"><a href="#cb240-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:dog</span> <span class="at">:dog</span></span>
<span id="cb240-21"><a href="#cb240-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:cat</span> <span class="at">:dog</span></span>
<span id="cb240-22"><a href="#cb240-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:cat</span> <span class="at">:cat</span></span>
<span id="cb240-23"><a href="#cb240-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">:dog</span> <span class="at">:cat</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="statistics" class="level3">
<h3 class="anchored" data-anchor-id="statistics">Statistics</h3>
<p>Once bootstrap samples are generated, one typically applies the statistic of interest to each sample to get the bootstrap distribution of the statistic.</p>
<ul>
<li><code>bootstrap-stats</code>: Computes a specified statistic on the original data (<code>t0</code>) and on each bootstrap sample (<code>ts</code>), and calculates descriptive statistics (mean, median, variance, stddev, SEM, bias) for the distribution of <code>ts</code>. This function is called automatically by <code>bootstrap</code> when a statistic function is provided.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>boot-data</code> (map): A map containing <code>:data</code> (original data) and <code>:samples</code> (collection of bootstrap samples).</li>
<li><code>statistic</code> (function): The function <code>(fn [sample-sequence])</code> to apply to the data and samples.</li>
</ul>
<p><strong>Returns:</strong> The input <code>boot-data</code> map augmented with results:</p>
<ul>
<li><code>:statistic</code> - statistic calculation function</li>
<li><code>:t0</code> - statistic for original data</li>
<li><code>:ts</code> - statistics for all bootstrapped samples</li>
<li><code>:bias</code> - difference between <code>t0</code> and mean of <code>ts</code></li>
<li><code>:mean</code> - mean of <code>ts</code></li>
<li><code>:median</code> - median of <code>ts</code></li>
<li><code>:variance</code> - variance of <code>ts</code></li>
<li><code>:stddev</code> - standard deviation of <code>ts</code></li>
<li><code>:sem</code> - standard error of mean of <code>ts</code></li>
</ul>
<p>Example (usually called internally by <code>bootstrap</code>):</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb241"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> raw-boot-samples </span>(boot/bootstrap mpg {<span class="at">:samples</span> <span class="dv">1000</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb242"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> analyzed-boot-data </span>(boot/bootstrap-stats raw-boot-samples stats/mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb243"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">dissoc</span> analyzed-boot-data <span class="at">:samples</span> <span class="at">:ts</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceClojure">
<div class="sourceCode" id="cb244"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>{<span class="at">:bias</span> <span class="fl">0.014178125000000819</span>,</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a> <span class="at">:data</span> (<span class="dv">21</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">21</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">22.8</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">21.4</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">18.7</span></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>        <span class="fl">18.1</span></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">14.3</span></span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>        <span class="fl">24.4</span></span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>        <span class="fl">22.8</span></span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>        <span class="fl">19.2</span></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>        <span class="fl">17.8</span></span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a>        <span class="fl">16.4</span></span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">17.3</span></span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">15.2</span></span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a>        <span class="fl">10.4</span></span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a>        <span class="fl">10.4</span></span>
<span id="cb244-18"><a href="#cb244-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">14.7</span></span>
<span id="cb244-19"><a href="#cb244-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">32.4</span></span>
<span id="cb244-20"><a href="#cb244-20" aria-hidden="true" tabindex="-1"></a>        <span class="fl">30.4</span></span>
<span id="cb244-21"><a href="#cb244-21" aria-hidden="true" tabindex="-1"></a>        <span class="fl">33.9</span></span>
<span id="cb244-22"><a href="#cb244-22" aria-hidden="true" tabindex="-1"></a>        <span class="fl">21.5</span></span>
<span id="cb244-23"><a href="#cb244-23" aria-hidden="true" tabindex="-1"></a>        <span class="fl">15.5</span></span>
<span id="cb244-24"><a href="#cb244-24" aria-hidden="true" tabindex="-1"></a>        <span class="fl">15.2</span></span>
<span id="cb244-25"><a href="#cb244-25" aria-hidden="true" tabindex="-1"></a>        <span class="fl">13.3</span></span>
<span id="cb244-26"><a href="#cb244-26" aria-hidden="true" tabindex="-1"></a>        <span class="fl">19.2</span></span>
<span id="cb244-27"><a href="#cb244-27" aria-hidden="true" tabindex="-1"></a>        <span class="fl">27.3</span></span>
<span id="cb244-28"><a href="#cb244-28" aria-hidden="true" tabindex="-1"></a>        <span class="dv">26</span></span>
<span id="cb244-29"><a href="#cb244-29" aria-hidden="true" tabindex="-1"></a>        <span class="fl">30.4</span></span>
<span id="cb244-30"><a href="#cb244-30" aria-hidden="true" tabindex="-1"></a>        <span class="fl">15.8</span></span>
<span id="cb244-31"><a href="#cb244-31" aria-hidden="true" tabindex="-1"></a>        <span class="fl">19.7</span></span>
<span id="cb244-32"><a href="#cb244-32" aria-hidden="true" tabindex="-1"></a>        <span class="dv">15</span></span>
<span id="cb244-33"><a href="#cb244-33" aria-hidden="true" tabindex="-1"></a>        <span class="fl">21.4</span>),</span>
<span id="cb244-34"><a href="#cb244-34" aria-hidden="true" tabindex="-1"></a> <span class="at">:mean</span> <span class="fl">20.104803125</span>,</span>
<span id="cb244-35"><a href="#cb244-35" aria-hidden="true" tabindex="-1"></a> <span class="at">:median</span> <span class="fl">20.115625</span>,</span>
<span id="cb244-36"><a href="#cb244-36" aria-hidden="true" tabindex="-1"></a> <span class="at">:model</span></span>
<span id="cb244-37"><a href="#cb244-37" aria-hidden="true" tabindex="-1"></a>   #object[fastmath.random$eval76580$fn$reify__76594 <span class="bn">0x32ec6494</span> <span class="st">"fastmath.random$eval76580$fn$reify__76594@32ec6494"</span>],</span>
<span id="cb244-38"><a href="#cb244-38" aria-hidden="true" tabindex="-1"></a> <span class="at">:sem</span> <span class="fl">0.18112806364309966</span>,</span>
<span id="cb244-39"><a href="#cb244-39" aria-hidden="true" tabindex="-1"></a> <span class="at">:statistic</span> #&lt;Fn<span class="at">@21ad8741</span> fastmath.stats/mean&gt;,</span>
<span id="cb244-40"><a href="#cb244-40" aria-hidden="true" tabindex="-1"></a> <span class="at">:stddev</span> <span class="fl">1.0246150565217946</span>,</span>
<span id="cb244-41"><a href="#cb244-41" aria-hidden="true" tabindex="-1"></a> <span class="at">:t0</span> <span class="fl">20.090625</span>,</span>
<span id="cb244-42"><a href="#cb244-42" aria-hidden="true" tabindex="-1"></a> <span class="at">:variance</span> <span class="fl">1.0498360140511602</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’ll see bootstrapped <code>ts</code> for different types of sampling methods and sample size = 10000. Vertical line marks <code>t0</code>.</p>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/68.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/69.png" class="clay-image img-fluid"></td>
</tr>
<tr class="even">
<td><img src="stats_files/70.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/71.png" class="clay-image img-fluid"></td>
</tr>
<tr class="odd">
<td><img src="stats_files/72.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/73.png" class="clay-image img-fluid"></td>
</tr>
<tr class="even">
<td><img src="stats_files/74.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/75.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Different statistic</strong></p>
<p>We can also estimate median instead of mean from smoothed samples.</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb245"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-mpg-median </span>(boot/bootstrap mpg stats/median {<span class="at">:samples</span> <span class="dv">10000</span> <span class="at">:smoothing</span> <span class="at">:gaussian</span> <span class="at">:rng</span> rng}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="clay-image">
<img class="clay-image" src="stats_files/76.png">
</div>
</section>
<section id="ci" class="level3">
<h3 class="anchored" data-anchor-id="ci">CI</h3>
<p>Bootstrap confidence intervals are constructed from the distribution of the statistic calculated on the bootstrap samples (<code>:ts</code>). <code>fastmath.stats.bootstrap</code> provides several methods, varying in complexity and robustness. All CI functions take the results map (typically from <code>bootstrap-stats</code>) and an optional significance level <code>alpha</code> (default 0.05 for 95% CI). They return a vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<ul>
<li><code>ci-normal</code>: Normal approximation interval. Assumes the distribution of <code>ts</code> is normal.</li>
<li><code>ci-basic</code>: Basic (Percentile-t) interval.</li>
<li><code>ci-percentile</code>: Percentile interval. The simplest method, directly using the quantiles of the bootstrap distribution of the statistic.</li>
<li><code>ci-bc</code>: Bias-Corrected (BC) interval. Adjusts the Percentile interval by correcting for median bias in the bootstrap distribution.</li>
<li><code>ci-bca</code>: Bias-Corrected and Accelerated (BCa) interval. Corrects for both bias (<span class="math inline">\(z_0\)</span>) and skewness/non-constant variance (acceleration factor <span class="math inline">\(a\)</span>). This is often considered the most accurate method but is more complex. Requires original <code>:data</code> and <code>:statistic</code> in the input map to calculate <span class="math inline">\(a\)</span> via Jackknife, or it estimates <span class="math inline">\(a\)</span> from <code>ts</code> skewness if data/statistic are missing.</li>
<li><code>ci-studentized</code>: Studentized (Bootstrap-t) interval.</li>
<li><code>ci-t</code>: T-distribution based interval.</li>
</ul>
<p><strong>Parameters (common to most CI functions):</strong></p>
<ul>
<li><code>boot-data</code> (map): Bootstrap analysis results, typically from [<a href="#bootstrap-stats">bootstrap-stats</a>]. Must contain <code>:t0</code> and <code>:ts</code>. Some methods (<code>ci-bca</code>, <code>ci-studentized</code>) require additional keys like <code>:data</code>, <code>:samples</code>, <code>:statistic</code>.</li>
<li><code>alpha</code> (double, optional): Significance level. Default is 0.05 (for 95% CI).</li>
<li><code>estimation-strategy</code> (keyword, optional, for <code>ci-basic</code>, <code>ci-percentile</code>, <code>ci-bc</code>, <code>ci-bca</code>): Quantile estimation strategy for <code>:s</code>. Defaults to <code>:legacy</code>. See [<a href="#quantiles">quantiles</a>].</li>
</ul>
<p><strong>Returns (common):</strong> A vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<p>Let’s calculate various confidence intervals for the mean of <code>mpg</code> using the <code>boot-results</code> map obtained earlier (which includes <code>:t0</code>, <code>:ts</code>, etc.):</p>
<div class="sourceClojure">
<div class="sourceCode" id="cb246"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> boot-results </span>(boot/bootstrap mpg stats/mean {<span class="at">:samples</span> <span class="dv">500</span> <span class="at">:rng</span> rng}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Examples">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceClojure">
<div class="sourceCode" id="cb247"><pre class="sourceCode clojure code-with-copy"><code class="sourceCode clojure"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">:t0</span> boot-results) <span class="co">;; =&gt; 20.090625</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>(boot/ci-normal boot-results) <span class="co">;; =&gt; [18.029228142021623 22.207409357978378 20.090625]</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>(boot/ci-basic boot-results) <span class="co">;; =&gt; [17.969375 22.1184375 20.090625]</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>(boot/ci-percentile boot-results) <span class="co">;; =&gt; [18.0628125 22.211875 20.090625]</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>(boot/ci-bc boot-results) <span class="co">;; =&gt; [18.077650533275566 22.225951643655776 20.090625]</span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>(boot/ci-bca boot-results) <span class="co">;; =&gt; [18.166803016582605 22.32402694368883 20.090625]</span></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>(boot/ci-studentized boot-results) <span class="co">;; =&gt; [18.114093259364665 22.75279971068179 20.090625]</span></span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a>(boot/ci-t boot-results) <span class="co">;; =&gt; [17.99645503084558 22.184794969154417 20.090625]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="clay-table">
<div class="table-responsive">
<table class="table table-hover clay-table caption-top" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td><img src="stats_files/77.png" class="clay-image img-fluid"></td>
<td><img src="stats_files/78.png" class="clay-image img-fluid"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="reference" class="level2">
<h2 class="anchored" data-anchor-id="reference">Reference</h2>
<section id="fastmath.stats" class="level3">
<h3 class="anchored" data-anchor-id="fastmath.stats">fastmath.stats</h3>
<p>Namespace provides a comprehensive collection of functions for performing statistical analysis in Clojure. It focuses on providing efficient implementations for common statistical tasks, leveraging fastmath’s underlying numerical capabilities.</p>
<p>This namespace covers a wide range of statistical methods, including:</p>
<ul>
<li><strong>Descriptive Statistics</strong>: Measures of central tendency (mean, median, mode, expectile), dispersion (variance, standard deviation, MAD, SEM), and shape (skewness, kurtosis, L-moments).</li>
<li><strong>Quantiles and Percentiles</strong>: Functions for calculating percentiles, quantiles, and the median, including weighted versions and various estimation strategies.</li>
<li><strong>Intervals and Extents</strong>: Methods for defining ranges within data, such as span, IQR, standard deviation/MAD/SEM extents, percentile/quantile intervals, prediction intervals (PI, HPDI), and fence boundaries for outlier detection.</li>
<li><strong>Outlier Detection</strong>: Functions for identifying data points outside conventional fence boundaries.</li>
<li><strong>Data Transformation</strong>: Utilities for scaling, centering, trimming, winsorizing, and applying power transformations (Box-Cox, Yeo-Johnson) to data.</li>
<li><strong>Correlation and Covariance</strong>: Measures of the linear and monotonic relationship between two or more variables (Pearson, Spearman, Kendall), and functions for generating covariance and correlation matrices.</li>
<li><strong>Distance and Similarity Metrics</strong>: Functions for quantifying differences or likeness between data sequences or distributions, including error metrics (MAE, MSE, RMSE), L-p norms, and various distribution dissimilarity/similarity measures.</li>
<li><strong>Contingency Tables</strong>: Functions for creating, analyzing, and deriving measures of association and agreement (Cramer’s V, Cohen’s Kappa) from contingency tables, including specialized functions for 2x2 tables.</li>
<li><strong>Binary Classification Metrics</strong>: Functions for generating confusion matrices and calculating a wide array of performance metrics (Accuracy, Precision, Recall, F1, MCC, etc.).</li>
<li><strong>Effect Size</strong>: Measures quantifying the magnitude of statistical effects, including difference-based (Cohen’s d, Hedges’ g, Glass’s delta), ratio-based, ordinal/non-parametric (Cliff’s Delta, Vargha-Delaney A), and overlap-based (Cohen’s U, p-overlap), as well as measures related to explained variance (Eta-squared, Omega-squared, Cohen’s f²).</li>
<li><strong>Statistical Tests</strong>: Functions for performing hypothesis tests, including:
<ul>
<li>Normality and Shape tests (Skewness, Kurtosis, D’Agostino-Pearson K², Jarque-Bera, Bonett-Seier).</li>
<li>Binomial tests and confidence intervals.</li>
<li>Location tests (one-sample and two-sample T/Z tests, paired/unpaired).</li>
<li>Variance tests (F-test, Levene’s, Brown-Forsythe, Fligner-Killeen).</li>
<li>Goodness-of-Fit and Independence tests (Power Divergence family including Chi-squared, G-test; AD/KS tests).</li>
<li>ANOVA and Rank Sum tests (One-way ANOVA, Kruskal-Wallis).</li>
<li>Autocorrelation tests (Durbin-Watson).</li>
</ul></li>
<li><strong>Time Series Analysis</strong>: Functions for analyzing the dependence structure of time series data, such as Autocorrelation (ACF) and Partial Autocorrelation (PACF).</li>
<li><strong>Histograms</strong>: Functions for computing histograms and estimating optimal binning strategies.</li>
</ul>
<p>This namespace aims to provide a robust set of statistical tools for data analysis and modeling within the Clojure ecosystem.</p>
<span id="#LOS-->confusion-matrix"></span>
<section id="confusion-matrix-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-deprecated">-&gt;confusion-matrix <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use <code>confusion-matrix</code></em></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4148">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-L0"></span>
</section>
<section id="l0" class="level4">
<h4 class="anchored" data-anchor-id="l0">L0</h4>
<p>Count equal values in both seqs. Alias for <a href="#LOS-count==">count==</a></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2065">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-L1"></span>
</section>
<section id="l1" class="level4">
<h4 class="anchored" data-anchor-id="l1">L1</h4>
<ul>
<li><code>(L1 [vs1 vs2-or-val])</code></li>
<li><code>(L1 vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the L1 distance (Manhattan or City Block distance) between two sequences or a sequence and a constant value.</p>
<p>The L1 distance is the sum of the absolute differences between corresponding elements.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence.</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence of numbers, or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated L1 distance as a double.</p>
<p>See also <a href="#LOS-L2">L2</a>, <a href="#LOS-L2sq">L2sq</a>, <a href="#LOS-LInf">LInf</a>, <a href="#LOS-mae">mae</a> (Mean Absolute Error).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2067">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-L2"></span>
</section>
<section id="l2" class="level4">
<h4 class="anchored" data-anchor-id="l2">L2</h4>
<ul>
<li><code>(L2 [vs1 vs2-or-val])</code></li>
<li><code>(L2 vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the L2 distance (Euclidean distance) between two sequences or a sequence and a constant value.</p>
<p>This is the standard straight-line distance between two points (vectors) in Euclidean space. It is the square root of the <a href="#LOS-L2sq">L2sq</a> distance.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence.</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence of numbers, or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated L2 distance as a double.</p>
<p>See also <a href="#LOS-L1">L1</a>, <a href="#LOS-L2sq">L2sq</a>, <a href="#LOS-LInf">LInf</a>, <a href="#LOS-rmse">rmse</a> (Root Mean Squared Error).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2112">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-L2sq"></span>
</section>
<section id="l2sq" class="level4">
<h4 class="anchored" data-anchor-id="l2sq">L2sq</h4>
<ul>
<li><code>(L2sq [vs1 vs2-or-val])</code></li>
<li><code>(L2sq vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the Squared Euclidean distance between two sequences or a sequence and a constant value.</p>
<p>This is the sum of the squared differences between corresponding elements. It is equivalent to the <a href="#LOS-rss">rss</a> (Residual Sum of Squares).</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence.</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence of numbers, or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated Squared Euclidean distance as a double.</p>
<p>See also <a href="#LOS-L1">L1</a>, <a href="#LOS-L2">L2</a>, <a href="#LOS-LInf">LInf</a>, <a href="#LOS-rss">rss</a> (Residual Sum of Squares), <a href="#LOS-mse">mse</a> (Mean Squared Error).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2089">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-LInf"></span>
</section>
<section id="linf" class="level4">
<h4 class="anchored" data-anchor-id="linf">LInf</h4>
<ul>
<li><code>(LInf [vs1 vs2-or-val])</code></li>
<li><code>(LInf vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the L-infinity distance (Chebyshev distance) between two sequences or a sequence and a constant value.</p>
<p>The Chebyshev distance is the maximum absolute difference between corresponding elements.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence.</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence of numbers, or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated L-infinity distance as a double.</p>
<p>See also <a href="#LOS-L1">L1</a>, <a href="#LOS-L2">L2</a>, <a href="#LOS-L2sq">L2sq</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2135">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-acf"></span>
</section>
<section id="acf" class="level4">
<h4 class="anchored" data-anchor-id="acf">acf</h4>
<ul>
<li><code>(acf data)</code></li>
<li><code>(acf data lags)</code></li>
</ul>
<p>Calculates the Autocorrelation Function (ACF) for a given time series <code>data</code>.</p>
<p>The ACF measures the linear dependence between a time series and its lagged values. It helps identify patterns (like seasonality or trend) and inform the selection of models for time series analysis (e.g., in ARIMA modeling).</p>
<p>Parameters:</p>
<ul>
<li><code>data</code> (seq of numbers): The time series data.</li>
<li><code>lags</code> (long or seq of longs, optional):
<ul>
<li>If a number, calculates ACF for lags from 0 up to this maximum lag.</li>
<li>If a sequence of numbers, calculates ACF for each lag specified in the sequence.</li>
<li>If omitted (1-arity call), calculates ACF for lags from 0 up to <code>(dec (count data))</code>.</li>
</ul></li>
</ul>
<p>Returns a sequence of doubles: the autocorrelation coefficients for the specified lags. The value at lag 0 is always 1.0.</p>
<p>See also <a href="#LOS-acf-ci">acf-ci</a> (Calculates ACF with confidence intervals), <a href="#LOS-pacf">pacf</a>, <a href="#LOS-pacf-ci">pacf-ci</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4489">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-acf-ci"></span>
</section>
<section id="acf-ci" class="level4">
<h4 class="anchored" data-anchor-id="acf-ci">acf-ci</h4>
<ul>
<li><code>(acf-ci data)</code></li>
<li><code>(acf-ci data lags)</code></li>
<li><code>(acf-ci data lags alpha)</code></li>
</ul>
<p>Calculates the Autocorrelation Function (ACF) for a time series and provides approximate confidence intervals.</p>
<p>This function computes the ACF of the input time series <code>data</code> for specified lags (see <a href="#LOS-acf">acf</a>) and includes approximate confidence intervals around the ACF estimates. These intervals help determine whether the autocorrelation at a specific lag is statistically significant (i.e., likely non-zero in the population).</p>
<p>Parameters:</p>
<ul>
<li><code>data</code> (seq of numbers): The time series data.</li>
<li><code>lags</code> (long or seq of longs, optional):
<ul>
<li>If a number, calculates ACF for lags from 0 up to this maximum lag.</li>
<li>If a sequence of numbers, calculates ACF for each lag specified in the sequence.</li>
<li>If omitted (1-arity call), calculates ACF for lags from 0 up to <code>(dec (count data))</code>.</li>
</ul></li>
<li><code>alpha</code> (double, optional): The significance level for the confidence intervals. Defaults to <code>0.05</code> (for a 95% CI).</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:ci</code> (double): The value of the approximate standard confidence interval bound for lags &gt; 0. If the absolute value of an ACF coefficient at lag <code>k &gt; 0</code> exceeds this value, it is considered statistically significant.</li>
<li><code>:acf</code> (seq of doubles): The sequence of autocorrelation coefficients at lags from 0 up to <code>lags</code> (or specified lags if <code>lags</code> is a sequence), calculated using <a href="#LOS-acf">acf</a>.</li>
<li><code>:cis</code> (seq of doubles): Cumulative confidence intervals for ACF. These are based on the variance of the sum of squared sample autocorrelations up to each lag.</li>
</ul>
<p>See also <a href="#LOS-acf">acf</a>, <a href="#LOS-pacf">pacf</a>, <a href="#LOS-pacf-ci">pacf-ci</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4589">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ad-test-one-sample"></span>
</section>
<section id="ad-test-one-sample" class="level4">
<h4 class="anchored" data-anchor-id="ad-test-one-sample">ad-test-one-sample</h4>
<ul>
<li><code>(ad-test-one-sample xs)</code></li>
<li><code>(ad-test-one-sample xs distribution-or-ys)</code></li>
<li><code>(ad-test-one-sample xs distribution-or-ys {:keys [sides kernel bandwidth], :or {sides :right, kernel :gaussian}})</code></li>
</ul>
<p>Performs the Anderson-Darling (AD) test for goodness-of-fit.</p>
<p>This test assesses the null hypothesis that a sample <code>xs</code> comes from a specified theoretical distribution or another empirical distribution. It is sensitive to differences in the tails of the distributions.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data to be tested.</li>
<li><code>distribution-or-ys</code> (optional):
<ul>
<li>A <code>fastmath.random</code> distribution object to test against. If omitted, defaults to the standard normal distribution (<code>fastmath.random/default-normal</code>).</li>
<li>A sequence of numbers (<code>ys</code>). In this case, an empirical distribution is estimated from <code>ys</code> using Kernel Density Estimation (KDE) or an enumerated distribution (see <code>:kernel</code> option).</li>
</ul></li>
<li><code>opts</code> (map, optional): Options map:
<ul>
<li><code>:sides</code> (keyword, default <code>:right</code>): Specifies the side(s) of the A^2 statistic’s distribution used for p-value calculation.
<ul>
<li><code>:right</code> (default): Tests if the observed A^2 statistic is significantly large (standard approach for AD test, indicating poor fit).</li>
<li><code>:left</code>: Tests if the observed A^2 statistic is significantly small.</li>
<li><code>:two-sided</code>: Tests if the observed A^2 statistic is extreme in either tail.</li>
</ul></li>
<li><code>:kernel</code> (keyword, default <code>:gaussian</code>): Used only when <code>distribution-or-ys</code> is a sequence. Specifies the method to estimate the empirical distribution:
<ul>
<li><code>:gaussian</code> (or other KDE kernels): Uses Kernel Density Estimation.</li>
<li><code>:enumerated</code>: Creates a discrete empirical distribution from <code>ys</code>.</li>
</ul></li>
<li><code>:bandwidth</code> (double, optional): Bandwidth for KDE (if applicable).</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:A2</code>: The Anderson-Darling test statistic (A^2).</li>
<li><code>:stat</code>: Alias for <code>:A2</code>.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic and the specified <code>:sides</code>.</li>
<li><code>:n</code>: Sample size of <code>xs</code>.</li>
<li><code>:mean</code>: Mean of the sample <code>xs</code> (for context).</li>
<li><code>:stddev</code>: Standard deviation of the sample <code>xs</code> (for context).</li>
<li><code>:sides</code>: The alternative hypothesis side used for p-value calculation.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5954">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-adjacent-values"></span>
</section>
<section id="adjacent-values" class="level4">
<h4 class="anchored" data-anchor-id="adjacent-values">adjacent-values</h4>
<ul>
<li><code>(adjacent-values vs)</code></li>
<li><code>(adjacent-values vs estimation-strategy)</code></li>
<li><code>(adjacent-values vs q1 q3 m)</code></li>
</ul>
<p>Lower and upper adjacent values (LAV and UAV).</p>
<p>Let Q1 is 25-percentile and Q3 is 75-percentile. IQR is <code>(- Q3 Q1)</code>.</p>
<ul>
<li>LAV is smallest value which is greater or equal to the LIF = <code>(- Q1 (* 1.5 IQR))</code>.</li>
<li>UAV is largest value which is lower or equal to the UIF = <code>(+ Q3 (* 1.5 IQR))</code>.</li>
<li>third value is a median of samples</li>
</ul>
<p>Optional <code>estimation-strategy</code> argument can be set to change quantile calculations estimation type. See <a href="#LOS-estimation-strategies">estimation-strategies</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L772">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ameasure"></span>
</section>
<section id="ameasure" class="level4">
<h4 class="anchored" data-anchor-id="ameasure">ameasure</h4>
<ul>
<li><code>(ameasure [group1 group2])</code></li>
<li><code>(ameasure group1 group2)</code></li>
</ul>
<p>Calculates the Vargha-Delaney A measure for two independent samples.</p>
<p>A non-parametric effect size measure quantifying the probability that a randomly chosen value from the first sample (<code>group1</code>) is greater than a randomly chosen value from the second sample (<code>group2</code>).</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code>: The first independent sample.</li>
<li><code>group2</code>: The second independent sample.</li>
</ul>
<p>Returns the calculated A measure (a double) in the range [0, 1]. A value of 0.5 indicates stochastic equality (distributions are overlapping). Values &gt; 0.5 mean <code>group1</code> tends to be larger; values &lt; 0.5 mean <code>group2</code> tends to be larger.</p>
<p>Related to <a href="#LOS-cliffs-delta">cliffs-delta</a> and the Wilcoxon-Mann-Whitney U test statistic.</p>
<p>See also <a href="#LOS-cliffs-delta">cliffs-delta</a>, <a href="#LOS-wmw-odds">wmw-odds</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2872">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-binary-measures"></span>
</section>
<section id="binary-measures" class="level4">
<h4 class="anchored" data-anchor-id="binary-measures">binary-measures</h4>
<ul>
<li><code>(binary-measures tp fn fp tn)</code></li>
<li><code>(binary-measures confusion-matrix)</code></li>
<li><code>(binary-measures actual prediction)</code></li>
<li><code>(binary-measures actual prediction true-value)</code></li>
</ul>
<p>Calculates a selected subset of common evaluation metrics for binary classification results.</p>
<p>This function is a convenience wrapper around <a href="#LOS-binary-measures-all">binary-measures-all</a>, providing a map containing the most frequently used metrics derived from a 2x2 confusion matrix.</p>
<p>The 2x2 confusion matrix is based on True Positives (TP), False Positives (FP), False Negatives (FN), and True Negatives (TN):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Predicted True</th>
<th style="text-align: left;">Predicted False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Actual True</strong></td>
<td style="text-align: left;">TP</td>
<td style="text-align: left;">FN</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Actual False</strong></td>
<td style="text-align: left;">FP</td>
<td style="text-align: left;">TN</td>
</tr>
</tbody>
</table>
<p>The function accepts the same input formats as <a href="#LOS-binary-measures-all">binary-measures-all</a>:</p>
<ol type="1">
<li><code>(binary-measures tp fn fp tn)</code>: Direct input of the four counts.</li>
<li><code>(binary-measures confusion-matrix)</code>: Input as a structured representation (map with keys like <code>:tp</code>, <code>:fn</code>, <code>:fp</code>, <code>:tn</code>; sequence of sequences <code>[ [TP FP] [FN TN] ]</code>; or flat sequence <code>[TP FN FP TN]</code>).</li>
<li><code>(binary-measures actual prediction)</code>: Input as two sequences of outcomes.</li>
<li><code>(binary-measures actual prediction true-value)</code>: Input as two sequences with a specified encoding for <code>true</code> (success).</li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>tp, fn, fp, tn</code> (long): Counts from the confusion matrix.</li>
<li><code>confusion-matrix</code> (map or sequence): Representation of the confusion matrix.</li>
<li><code>actual</code>, <code>prediction</code> (sequences): Sequences of true and predicted outcomes.</li>
<li><code>true-value</code> (optional): Specifies how outcomes are converted to boolean <code>true</code>/<code>false</code>.</li>
</ul>
<p>Returns a map containing the following selected metrics:</p>
<ul>
<li><code>:tp</code> (True Positives)</li>
<li><code>:tn</code> (True Negatives)</li>
<li><code>:fp</code> (False Positives)</li>
<li><code>:fn</code> (False Negatives)</li>
<li><code>:accuracy</code></li>
<li><code>:fdr</code> (False Discovery Rate, 1 - Precision)</li>
<li><code>:f-measure</code> (F1 Score, harmonic mean of Precision and Recall)</li>
<li><code>:fall-out</code> (False Positive Rate)</li>
<li><code>:precision</code> (Positive Predictive Value)</li>
<li><code>:recall</code> (True Positive Rate / Sensitivity)</li>
<li><code>:sensitivity</code> (Alias for Recall/TPR)</li>
<li><code>:specificity</code> (True Negative Rate)</li>
<li><code>:prevalence</code> (Proportion of positive cases)</li>
</ul>
<p>See also <a href="#LOS-confusion-matrix">confusion-matrix</a>, <a href="#LOS-binary-measures-all">binary-measures-all</a>, <a href="#LOS-mcc">mcc</a>, <a href="#LOS-contingency-2x2-measures-all">contingency-2x2-measures-all</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4243">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-binary-measures-all"></span>
</section>
<section id="binary-measures-all" class="level4">
<h4 class="anchored" data-anchor-id="binary-measures-all">binary-measures-all</h4>
<ul>
<li><code>(binary-measures-all tp fn fp tn)</code></li>
<li><code>(binary-measures-all confusion-matrix)</code></li>
<li><code>(binary-measures-all actual prediction)</code></li>
<li><code>(binary-measures-all actual prediction true-value)</code></li>
</ul>
<p>Calculates a comprehensive set of evaluation metrics for binary classification results.</p>
<p>This function computes various statistics derived from a 2x2 confusion matrix, summarizing the performance of a binary classifier.</p>
<p>The 2x2 confusion matrix is based on True Positives (TP), False Positives (FP), False Negatives (FN), and True Negatives (TN):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Predicted True</th>
<th style="text-align: left;">Predicted False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Actual True</strong></td>
<td style="text-align: left;">TP</td>
<td style="text-align: left;">FN</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Actual False</strong></td>
<td style="text-align: left;">FP</td>
<td style="text-align: left;">TN</td>
</tr>
</tbody>
</table>
<p>The function supports several input formats:</p>
<ol type="1">
<li><code>(binary-measures-all tp fn fp tn)</code>: Direct input of the four counts as arguments.
<ul>
<li><code>tp</code> (long): True Positive count.</li>
<li><code>fn</code> (long): False Negative count.</li>
<li><code>fp</code> (long): False Positive count.</li>
<li><code>tn</code> (long): True Negative count.</li>
</ul></li>
<li><code>(binary-measures-all confusion-matrix)</code>: Input as a structured representation of the confusion matrix.
<ul>
<li><code>confusion-matrix</code>: Can be:
<ul>
<li>A map with keys like <code>:tp</code>, <code>:fn</code>, <code>:fp</code>, <code>:tn</code> (e.g., <code>{:tp 10 :fn 2 :fp 5 :tn 80}</code>).</li>
<li>A sequence of sequences representing rows <code>[TP FP] [FN TN](#LOS-TP FP] [FN TN)</code> (e.g., <code>[10 5] [2 80](#LOS-10 5] [2 80)</code>).</li>
<li>A flat sequence <code>[TP FN FP TN]</code> (e.g., <code>[10 2 5 80]</code>).</li>
</ul></li>
</ul></li>
<li><code>(binary-measures-all actual prediction)</code>: Input as two sequences of outcomes.
<ul>
<li><code>actual</code> (sequence): Sequence of true outcomes.</li>
<li><code>prediction</code> (sequence): Sequence of predicted outcomes. Must have the same length as <code>actual</code>. Values in <code>actual</code> and <code>prediction</code> are converted to boolean <code>true</code>/<code>false</code>. By default, any non-<code>nil</code> or non-zero numeric value is treated as <code>true</code>, and <code>nil</code> or <code>0.0</code> is treated as <code>false</code>.</li>
</ul></li>
<li><code>(binary-measures-all actual prediction true-value)</code>: Input as two sequences with a specified encoding for <code>true</code>.
<ul>
<li><code>actual</code>, <code>prediction</code>: Sequences as in the previous arity.</li>
<li><code>true-value</code> (optional): Specifies how values in <code>actual</code> and <code>prediction</code> are converted to boolean <code>true</code> (success) or <code>false</code> (failure).
<ul>
<li><code>nil</code> (default): Non-<code>nil</code>/non-zero (for numbers) is true.</li>
<li>Any sequence/set: Values found in this collection are true.</li>
<li>A map: Values are mapped according to the map; if a key is not found or maps to <code>false</code>, the value is false.</li>
<li>A predicate function: Returns <code>true</code> if the value satisfies the predicate.</li>
</ul></li>
</ul></li>
</ol>
<p>Returns a map containing a wide array of calculated metrics. This includes, but is not limited to:</p>
<ul>
<li>Basic Counts: <code>:tp</code>, <code>:fn</code>, <code>:fp</code>, <code>:tn</code></li>
<li>Totals: <code>:cp</code> (Actual Positives), <code>:cn</code> (Actual Negatives), <code>:pcp</code> (Predicted Positives), <code>:pcn</code> (Predicted Negatives), <code>:total</code> (Grand Total)</li>
<li>Rates (often ratios of counts):
<ul>
<li><code>:tpr</code> (True Positive Rate, Recall, Sensitivity, Hit Rate)</li>
<li><code>:fnr</code> (False Negative Rate, Miss Rate)</li>
<li><code>:fpr</code> (False Positive Rate, Fall-out)</li>
<li><code>:tnr</code> (True Negative Rate, Specificity, Selectivity)</li>
<li><code>:ppv</code> (Positive Predictive Value, Precision)</li>
<li><code>:fdr</code> (False Discovery Rate, <code>1 - ppv</code>)</li>
<li><code>:npv</code> (Negative Predictive Value)</li>
<li><code>:for</code> (False Omission Rate, <code>1 - npv</code>)</li>
</ul></li>
<li>Ratios/Odds:
<ul>
<li><code>:lr+</code> (Positive Likelihood Ratio)</li>
<li><code>:lr-</code> (Negative Likelihood Ratio)</li>
<li><code>:dor</code> (Diagnostic Odds Ratio)</li>
</ul></li>
<li>Combined Scores:
<ul>
<li><code>:accuracy</code></li>
<li><code>:ba</code> (Balanced Accuracy)</li>
<li><code>:fm</code> (Fowlkes–Mallows index)</li>
<li><code>:pt</code> (Prevalence Threshold)</li>
<li><code>:ts</code> (Threat Score, Jaccard index)</li>
<li><code>:f-measure</code> / <code>:f1-score</code> (F1 Score, special case of F-beta score)</li>
<li><code>:f-beta</code> (Function to calculate F-beta for any beta)</li>
<li><code>:mcc</code> / <code>:phi</code> (Matthews Correlation Coefficient, Phi coefficient)</li>
<li><code>:bm</code> (Bookmaker Informedness)</li>
<li><code>:kappa</code> (Cohen’s Kappa, for 2x2 table)</li>
<li><code>:mk</code> (Markedness)</li>
</ul></li>
</ul>
<p>Metrics are generally calculated using standard formulas based on the TP, FN, FP, TN counts. For more details on specific metrics, refer to standard classification literature or the Wikipedia page on <a href="https://en.wikipedia.org/wiki/Precision_and_recall">Precision and recall</a>, which covers many of these concepts.</p>
<p>See also <a href="#LOS-confusion-matrix">confusion-matrix</a>, <a href="#LOS-binary-measures">binary-measures</a> (for a selected subset of metrics), <a href="#LOS-mcc">mcc</a>, <a href="#LOS-contingency-2x2-measures-all">contingency-2x2-measures-all</a> (for a broader set of 2x2 table measures).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4150">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-binomial-ci"></span>
</section>
<section id="binomial-ci" class="level4">
<h4 class="anchored" data-anchor-id="binomial-ci">binomial-ci</h4>
<ul>
<li><code>(binomial-ci number-of-successes number-of-trials)</code></li>
<li><code>(binomial-ci number-of-successes number-of-trials method)</code></li>
<li><code>(binomial-ci number-of-successes number-of-trials method alpha)</code></li>
</ul>
<p>Calculates a confidence interval for a binomial proportion.</p>
<p>Given the number of observed <code>successes</code> in a fixed number of <code>trials</code>, this function estimates a confidence interval for the true underlying probability of success (<code>p</code>).</p>
<p>Different statistical methods are available for calculating the interval, as the accuracy and behavior of the interval can vary, especially for small sample sizes or probabilities close to 0 or 1.</p>
<p>Parameters:</p>
<ul>
<li><code>number-of-successes</code> (long): The count of successful outcomes.</li>
<li><code>number-of-trials</code> (long): The total number of independent trials.</li>
<li><code>method</code> (keyword, optional): The method used to calculate the confidence interval. Defaults to <code>:asymptotic</code>.</li>
<li><code>alpha</code> (double, optional): The significance level (alpha) for the interval. The confidence level is <code>1 - alpha</code>. Defaults to <code>0.05</code> (yielding a 95% CI).</li>
</ul>
<p>Available <code>method</code> values:</p>
<ul>
<li><code>:asymptotic</code>: Normal approximation interval (Wald interval), based on the Central Limit Theorem. Simple but can be inaccurate for small samples or probabilities near 0 or 1.</li>
<li><code>:agresti-coull</code>: An adjustment to the asymptotic interval, adding ‘pseudo-counts’ to improve performance for small samples.</li>
<li><code>:clopper-pearson</code>: An exact method based on inverting binomial tests. Provides guaranteed coverage but can be overly conservative (wider than necessary).</li>
<li><code>:wilson</code>: Score interval, derived from the score test. Generally recommended as a good balance of accuracy and coverage for various sample sizes.</li>
<li><code>:prop.test</code>: Interval typically used with <code>prop.test</code> in R, applies a continuity correction.</li>
<li><code>:cloglog</code>: Confidence interval based on the complementary log-log transformation.</li>
<li><code>:logit</code>: Confidence interval based on the logit transformation.</li>
<li><code>:probit</code>: Confidence interval based on the probit transformation (inverse of standard normal CDF).</li>
<li><code>:arcsine</code>: Confidence interval based on the arcsine transformation.</li>
<li><code>:all</code>: Applies all available methods and returns a map where keys are method keywords and values are their respective confidence intervals (as triplets).</li>
</ul>
<p>Returns:</p>
<ul>
<li>A vector <code>[lower-bound, upper-bound, estimated-p]</code>.
<ul>
<li><code>lower-bound</code> (double): The lower limit of the confidence interval.</li>
<li><code>upper-bound</code> (double): The upper limit of the confidence interval.</li>
<li><code>estimated-p</code> (double): The observed proportion of successes (<code>number-of-successes / number-of-trials</code>).</li>
</ul></li>
</ul>
<p>If <code>method</code> is <code>:all</code>, returns a map of results from each method.</p>
<p>See also <a href="#LOS-binomial-test">binomial-test</a> for performing a hypothesis test on a binomial proportion.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4696">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-binomial-ci-methods"></span>
</section>
<section id="binomial-ci-methods" class="level4">
<h4 class="anchored" data-anchor-id="binomial-ci-methods">binomial-ci-methods</h4>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4693">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-binomial-test"></span>
</section>
<section id="binomial-test" class="level4">
<h4 class="anchored" data-anchor-id="binomial-test">binomial-test</h4>
<ul>
<li><code>(binomial-test xs)</code></li>
<li><code>(binomial-test xs maybe-params)</code></li>
<li><code>(binomial-test number-of-successes number-of-trials {:keys [alpha p ci-method sides], :or {alpha 0.05, p 0.5, ci-method :asymptotic, sides :two-sided}})</code></li>
</ul>
<p>Performs an exact test of a simple null hypothesis about the probability of success in a Bernoulli experiment, based on the binomial distribution.</p>
<p>This test assesses the null hypothesis that the true probability of success (<code>p</code>) in the underlying population is equal to a specified value (default 0.5).</p>
<p>The function can be called in two ways:</p>
<ol type="1">
<li>With counts: <code>(binomial-test number-of-successes number-of-trials params)</code></li>
<li>With data: <code>(binomial-test xs params)</code>, where <code>xs</code> is a sequence of outcomes. In this case, the outcomes in <code>xs</code> are converted to true/false based on the <code>:true-false-conv</code> parameter (if provided, otherwise numeric 1s are true), and the number of successes and total trials are derived from <code>xs</code>.</li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>number-of-successes</code> (long): Observed number of successful outcomes.</li>
<li><code>number-of-trials</code> (long): Total number of trials.</li>
<li><code>xs</code> (sequence): Sample data (used in the alternative call signature).</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:p</code> (double, default <code>0.5</code>): The hypothesized probability of success under the null hypothesis.</li>
<li><code>:alpha</code> (double, default <code>0.05</code>): Significance level for confidence interval calculation.</li>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis.
<ul>
<li><code>:two-sided</code> (default): True probability <code>p</code> is not equal to the hypothesized <code>p</code>.</li>
<li><code>:one-sided-greater</code>: True probability <code>p</code> is greater than the hypothesized <code>p</code>.</li>
<li><code>:one-sided-less</code>: True probability <code>p</code> is less than the hypothesized <code>p</code>.</li>
</ul></li>
<li><code>:ci-method</code> (keyword, default <code>:asymptotic</code>): Method used to calculate the confidence interval for the probability of success. See <a href="#LOS-binomial-ci">binomial-ci</a> and <a href="#LOS-binomial-ci-methods">binomial-ci-methods</a> for available options (e.g., <code>:wilson</code>, <code>:clopper-pearson</code>).</li>
<li><code>:true-false-conv</code> (optional, used only with <code>xs</code>): A function, set, or map to convert elements of <code>xs</code> into boolean <code>true</code> (success) or <code>false</code> (failure). See <a href="#LOS-binary-measures-all">binary-measures-all</a> documentation for details. If <code>nil</code> and <code>xs</code> contains numbers, <code>1.0</code> is treated as success.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:p-value</code>: The probability of observing a result as extreme as, or more extreme than, the observed number of successes, assuming the null hypothesis is true. Calculated using the binomial distribution.</li>
<li><code>:p</code>: The hypothesized probability of success used in the test.</li>
<li><code>:successes</code>: The observed number of successes.</li>
<li><code>:trials</code>: The total number of trials.</li>
<li><code>:alpha</code>: Significance level used for the confidence interval.</li>
<li><code>:level</code>: Confidence level (<code>1 - alpha</code>).</li>
<li><code>:sides</code> / <code>:test-type</code>: Alternative hypothesis side used.</li>
<li><code>:stat</code>: The test statistic (the observed number of successes).</li>
<li><code>:estimate</code>: The observed proportion of successes (<code>successes / trials</code>).</li>
<li><code>:ci-method</code>: Confidence interval method used.</li>
<li><code>:confidence-interval</code>: A confidence interval for the true probability of success, calculated using the specified <code>:ci-method</code> and adjusted for the <code>:sides</code> parameter.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5161">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-bonett-seier-test"></span>
</section>
<section id="bonett-seier-test" class="level4">
<h4 class="anchored" data-anchor-id="bonett-seier-test">bonett-seier-test</h4>
<ul>
<li><code>(bonett-seier-test xs)</code></li>
<li><code>(bonett-seier-test xs params)</code></li>
<li><code>(bonett-seier-test xs geary-kurtosis {:keys [sides], :or {sides :two-sided}})</code></li>
</ul>
<p>Performs the Bonett-Seier test for normality based on Geary’s ‘g’ kurtosis measure.</p>
<p>This test assesses the null hypothesis that the data comes from a normally distributed population by checking if the sample Geary’s ‘g’ statistic significantly deviates from the value expected under normality (<code>sqrt(2/pi)</code>).</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data. Requires <code>(count xs) &gt; 3</code> for variance calculation.</li>
<li><code>geary-kurtosis</code> (double, optional): A pre-calculated Geary’s ‘g’ kurtosis value. If omitted, it’s calculated from <code>xs</code>.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis regarding the deviation from normal kurtosis.
<ul>
<li><code>:two-sided</code> (default): The population kurtosis (measured by ‘g’) is different from normal.</li>
<li><code>:one-sided-greater</code>: Population is leptokurtic (‘g’ &lt; sqrt(2/pi)). Note Geary’s ‘g’ decreases with peakedness.</li>
<li><code>:one-sided-less</code>: Population is platykurtic (‘g’ &gt; sqrt(2/pi)). Note Geary’s ‘g’ increases with flatness.</li>
</ul></li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:Z</code>: The final test statistic (approximately standard normal under H0).</li>
<li><code>:stat</code>: Alias for <code>:Z</code>.</li>
<li><code>:p-value</code>: The p-value associated with <code>Z</code> and the specified <code>:sides</code>.</li>
<li><code>:kurtosis</code>: The Geary’s ‘g’ kurtosis value used in the test.</li>
<li><code>:n</code>: The sample size.</li>
<li><code>:sides</code>: The alternative hypothesis side used.</li>
</ul>
<p>References: - Bonett, D. G., &amp; Seier, E. (2002). A test of normality with high uniform power. Computational Statistics &amp; Data Analysis, 40(3), 435-445. (Provides theoretical basis)</p>
<p>See also <a href="#LOS-kurtosis">kurtosis</a>, <a href="#LOS-kurtosis-test">kurtosis-test</a>, <a href="#LOS-normality-test">normality-test</a>, <a href="#LOS-jarque-bera-test">jarque-bera-test</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5113">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-bootstrap"></span>
</section>
<section id="bootstrap-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="bootstrap-deprecated">bootstrap <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Please use fastmath.stats.bootstrap/bootstrap instead</em></p>
<ul>
<li><code>(bootstrap vs)</code></li>
<li><code>(bootstrap vs samples)</code></li>
<li><code>(bootstrap vs samples size)</code></li>
</ul>
<p>Generate set of samples of given size from provided data.</p>
<p>Default <code>samples</code> is 200, number of <code>size</code> defaults to sample size.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1435">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-bootstrap-ci"></span>
</section>
<section id="bootstrap-ci-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="bootstrap-ci-deprecated">bootstrap-ci <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Please use fastmath.stats.boostrap/ci-basic instead</em></p>
<ul>
<li><code>(bootstrap-ci vs)</code></li>
<li><code>(bootstrap-ci vs alpha)</code></li>
<li><code>(bootstrap-ci vs alpha samples)</code></li>
<li><code>(bootstrap-ci vs alpha samples stat-fn)</code></li>
</ul>
<p>Bootstrap method to calculate confidence interval.</p>
<p>Alpha defaults to 0.98, samples to 1000. Last parameter is statistical function used to measure, default: <a href="#LOS-mean">mean</a>.</p>
<p>Returns ci and statistical function value.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1414">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-box-cox-infer-lambda"></span>
</section>
<section id="box-cox-infer-lambda" class="level4">
<h4 class="anchored" data-anchor-id="box-cox-infer-lambda">box-cox-infer-lambda</h4>
<ul>
<li><code>(box-cox-infer-lambda xs)</code></li>
<li><code>(box-cox-infer-lambda xs lambda-range)</code></li>
<li><code>(box-cox-infer-lambda xs lambda-range opts)</code></li>
</ul>
<p>Finds the optimal lambda (λ) parameter for the Box-Cox transformation of a dataset using the Maximum Likelihood Estimation (MLE) method.</p>
<p>The Box-Cox transformation is a family of power transformations often applied to positive data to make it more closely resemble a normal distribution and stabilize variance. This function estimates the lambda value that maximizes the log-likelihood function of the transformed data, assuming the transformed data is normally distributed.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (sequence of numbers): The input numerical data sequence.</li>
<li><code>lambda-range</code> (vector of two numbers, optional): A sequence <code>[min-lambda, max-lambda]</code> defining the closed interval within which the optimal lambda is searched. Defaults to <code>[-3.0, 3.0]</code>.</li>
<li><code>opts</code> (map, optional): Additional options affecting the data used for the likelihood calculation. These options are passed to the internal data preparation step. Key options include:
<ul>
<li><code>:alpha</code> (double, default 0.0): A constant value added to <code>xs</code> before estimating lambda. This is often used when <code>xs</code> contains zero or negative values and the standard Box-Cox (which requires positive input) is desired, or to explore transformations around a shifted location.</li>
<li><code>:negative?</code> (boolean, default <code>false</code>): If <code>true</code>, indicates that the likelihood is estimated based on the modified Box-Cox transformation (Bickel and Doksum approach) suitable for negative values. The estimation process will work with the absolute values of the data shifted by <code>:alpha</code>.</li>
</ul></li>
</ul>
<p>Returns the estimated optimal lambda value as a double.</p>
<p>The inferred lambda value can then be used as the <code>lambda</code> parameter for the <a href="#LOS-box-cox-transformation">box-cox-transformation</a> function to apply the actual transformation to the dataset.</p>
<p>See also <a href="#LOS-box-cox-transformation">box-cox-transformation</a>, <a href="#LOS-yeo-johnson-infer-lambda">yeo-johnson-infer-lambda</a>, <a href="#LOS-yeo-johnson-transformation">yeo-johnson-transformation</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6367">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-box-cox-transformation"></span>
</section>
<section id="box-cox-transformation" class="level4">
<h4 class="anchored" data-anchor-id="box-cox-transformation">box-cox-transformation</h4>
<ul>
<li><code>(box-cox-transformation xs)</code></li>
<li><code>(box-cox-transformation xs lambda)</code></li>
<li><code>(box-cox-transformation xs lambda {:keys [scaled? inverse?], :as opts})</code></li>
</ul>
<p>Applies Box-Cox transformation to a data.</p>
<p>The Box-Cox transformation is a family of power transformations used to stabilize variance and make data more normally distributed.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The input data.</li>
<li><code>lambda</code> (default <code>0.0</code>): The power parameter. If <code>nil</code> or <code>[lambda-min, lambda-max]</code>, <code>lambda</code> is inferred using maximum log likelihood.</li>
<li>Options map:
<ul>
<li><code>alpha</code> (optional): A shift parameter applied before transformation.</li>
<li><code>scaled?</code> (default <code>false</code>): Scale by geometric mean or any other number</li>
<li><code>negative?</code> (default <code>false</code>): Allow negative values</li>
<li><code>inverse?</code> (default: <code>false</code>): Perform inverse operation, <code>lambda</code> can’t be inferred.</li>
</ul></li>
</ul>
<p>Returns transformed data.</p>
<p>Related: <code>yeo-johnson-transformation</code></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6391">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-brown-forsythe-test"></span>
</section>
<section id="brown-forsythe-test" class="level4">
<h4 class="anchored" data-anchor-id="brown-forsythe-test">brown-forsythe-test</h4>
<ul>
<li><code>(brown-forsythe-test xss)</code></li>
<li><code>(brown-forsythe-test xss params)</code></li>
</ul>
<p>Brown-Forsythe test for homogeneity of variances.</p>
<p>This test is a modification of Levene’s test, using the median instead of the mean for calculating the spread within each group. This makes the test more robust against non-normally distributed data.</p>
<p>Calls <a href="#LOS-levene-test">levene-test</a> with <code>:statistic</code> set to <a href="#LOS-median">median</a>. Accepts the same parameters as <a href="#LOS-levene-test">levene-test</a>, except for <code>:statistic</code>.</p>
<p>Parameters: - <code>xss</code> (sequence of sequences): A collection of data groups. - <code>params</code> (map, optional): Options map (see <a href="#LOS-levene-test">levene-test</a>).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5877">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-chisq-test"></span>
</section>
<section id="chisq-test" class="level4">
<h4 class="anchored" data-anchor-id="chisq-test">chisq-test</h4>
<ul>
<li><code>(chisq-test contingency-table-or-xs)</code></li>
<li><code>(chisq-test contingency-table-or-xs params)</code></li>
</ul>
<p>Chi square test, a power divergence test for <code>lambda</code> 1.0</p>
<p>Performs a power divergence test, which encompasses several common statistical tests like Chi-squared, G-test (likelihood ratio), etc., based on the lambda parameter. This function can perform either a goodness-of-fit test or a test for independence in a contingency table.</p>
<p>Usage:</p>
<ol type="1">
<li><strong>Goodness-of-Fit (GOF):</strong>
<ul>
<li>Input: <code>observed-counts</code> (sequence of numbers) and <code>:p</code> (expected probabilities/weights).</li>
<li>Input: <code>data</code> (sequence of numbers) and <code>:p</code> (a distribution object). In this case, a histogram of <code>data</code> is created (controlled by <code>:bins</code>) and compared against the probability mass/density of the distribution in those bins.</li>
</ul></li>
<li><strong>Test for Independence:</strong>
<ul>
<li>Input: <code>contingency-table</code> (2D sequence or map format). The <code>:p</code> option is ignored.</li>
</ul></li>
</ol>
<p>Options map:</p>
<ul>
<li><code>:lambda</code> (double, default: <code>2/3</code>): Determines the specific test statistic. Common values:
<ul>
<li><code>1.0</code>: Pearson Chi-squared test (<a href="#LOS-chisq-test">chisq-test</a>).</li>
<li><code>0.0</code>: G-test / Multinomial Likelihood Ratio test (<a href="#LOS-multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</a>).</li>
<li><code>-0.5</code>: Freeman-Tukey test (<a href="#LOS-freeman-tukey-test">freeman-tukey-test</a>).</li>
<li><code>-1.0</code>: Minimum Discrimination Information test (<a href="#LOS-minimum-discrimination-information-test">minimum-discrimination-information-test</a>).</li>
<li><code>-2.0</code>: Neyman Modified Chi-squared test (<a href="#LOS-neyman-modified-chisq-test">neyman-modified-chisq-test</a>).</li>
<li><code>2/3</code>: Cressie-Read test (default, <a href="#LOS-cressie-read-test">cressie-read-test</a>).</li>
</ul></li>
<li><code>:p</code> (seq of numbers or distribution): Expected probabilities/weights (for GOF with counts) or a <code>fastmath.random</code> distribution object (for GOF with data). Ignored for independence tests.</li>
<li><code>:alpha</code> (double, default: <code>0.05</code>): Significance level for confidence intervals.</li>
<li><code>:ci-sides</code> (keyword, default: <code>:two-sided</code>): Sides for bootstrap confidence intervals (<code>:two-sided</code>, <code>:one-sided-greater</code>, <code>:one-sided-less</code>).</li>
<li><code>:sides</code> (keyword, default: <code>:one-sided-greater</code>): Alternative hypothesis side for the p-value calculation against the Chi-squared distribution (<code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>).</li>
<li><code>:bootstrap-samples</code> (long, default: <code>1000</code>): Number of bootstrap samples for confidence interval estimation.</li>
<li><code>:ddof</code> (long, default: <code>0</code>): Delta degrees of freedom. Adjustment subtracted from the calculated degrees of freedom.</li>
<li><code>:bins</code> (number, keyword, or seq): Used only for GOF test against a distribution. Specifies the number of bins, an estimation method (see <a href="#LOS-histogram">histogram</a>), or explicit bin edges for histogram creation.</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:stat</code>: The calculated power divergence test statistic.</li>
<li><code>:chi2</code>: Alias for <code>:stat</code>.</li>
<li><code>:df</code>: Degrees of freedom for the test.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic.</li>
<li><code>:n</code>: Total number of observations.</li>
<li><code>:estimate</code>: Observed proportions.</li>
<li><code>:expected</code>: Expected counts or proportions under the null hypothesis.</li>
<li><code>:confidence-interval</code>: Bootstrap confidence intervals for the observed proportions.</li>
<li><code>:lambda</code>, <code>:alpha</code>, <code>:sides</code>, <code>:ci-sides</code>: Input options used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5733">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ci"></span>
</section>
<section id="ci-1" class="level4">
<h4 class="anchored" data-anchor-id="ci-1">ci</h4>
<ul>
<li><code>(ci vs)</code></li>
<li><code>(ci vs alpha)</code></li>
</ul>
<p>T-student based confidence interval for given data. Alpha value defaults to 0.05.</p>
<p>Last value is mean.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1399">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cliffs-delta"></span>
</section>
<section id="cliffs-delta" class="level4">
<h4 class="anchored" data-anchor-id="cliffs-delta">cliffs-delta</h4>
<ul>
<li><code>(cliffs-delta [group1 group2])</code></li>
<li><code>(cliffs-delta group1 group2)</code></li>
</ul>
<p>Calculates Cliff’s Delta (δ), a non-parametric effect size measure for assessing the difference between two groups of ordinal or continuous data.</p>
<p>Cliff’s Delta quantifies the degree of overlap between two distributions. It represents the probability that a randomly chosen value from the first group is greater than a randomly chosen value from the second group, minus the reverse probability.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sample.</li>
<li><code>group2</code> (seq of numbers): The second sample.</li>
</ul>
<p>Returns the calculated Cliff’s Delta value as a double.</p>
<p>Interpretation:</p>
<ul>
<li>A value of +1 indicates complete separation where every value in <code>group1</code> is greater than every value in <code>group2</code>.</li>
<li>A value of -1 indicates complete separation where every value in <code>group2</code> is greater than every value in <code>group1</code>.</li>
<li>A value of 0 indicates complete overlap between the distributions.</li>
<li>Values between -1 and 1 indicate varying degrees of overlap. Cohen (1988) suggested guidelines for effect size: |δ| &lt; 0.147 (negligible), 0.147 ≤ |δ| &lt; 0.33 (small), 0.33 ≤ |δ| &lt; 0.474 (medium), |δ| ≥ 0.474 (large).</li>
</ul>
<p>Cliff’s Delta is a robust measure, suitable for ordinal data or when assumptions of parametric tests (like normality or equal variances) are violated. It is closely related to the <a href="#LOS-wmw-odds">wmw-odds</a> (Wilcoxon-Mann-Whitney odds) and the <a href="#LOS-ameasure">ameasure</a> (Vargha-Delaney A).</p>
<p>See also <a href="#LOS-wmw-odds">wmw-odds</a>, <a href="#LOS-ameasure">ameasure</a>, <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-glass-delta">glass-delta</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2841">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-coefficient-matrix"></span>
</section>
<section id="coefficient-matrix" class="level4">
<h4 class="anchored" data-anchor-id="coefficient-matrix">coefficient-matrix</h4>
<ul>
<li><code>(coefficient-matrix vss)</code></li>
<li><code>(coefficient-matrix vss measure-fn)</code></li>
<li><code>(coefficient-matrix vss measure-fn symmetric?)</code></li>
</ul>
<p>Generates a matrix of pairwise coefficients from a sequence of sequences.</p>
<p>This function calculates a matrix where the element at row <code>i</code> and column <code>j</code> is the result of applying the provided <code>measure-fn</code> to the <code>i</code>-th sequence and the <code>j</code>-th sequence from the input <code>vss</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vss</code> (sequence of sequences of numbers): The collection of data sequences. Each inner sequence is treated as a variable or set of observations. All inner sequences should ideally have the same length if the <code>measure-fn</code> expects it.</li>
<li><code>measure-fn</code> (function, optional): A function of two arguments (sequences) that returns a double representing the coefficient or measure between them. Defaults to <a href="#LOS-pearson-correlation">pearson-correlation</a>.</li>
<li><code>symmetric?</code> (boolean, optional): If <code>true</code>, the function assumes that <code>measure-fn(a, b)</code> is equal to <code>measure-fn(b, a)</code>. It calculates the upper (or lower) triangle of the matrix and mirrors the values to the other side. This is an optimization for symmetric measures like correlation and covariance. If <code>false</code> (default), all pairwise combinations <code>(i, j)</code> are calculated independently.</li>
</ul>
<p>Returns a sequence of sequences (a matrix) of doubles.</p>
<p>Note: While this function’s <code>symmetric?</code> parameter defaults to <code>false</code>, convenience functions like <a href="#LOS-correlation-matrix">correlation-matrix</a> and <a href="#LOS-covariance-matrix">covariance-matrix</a> wrap this function and explicitly set <code>symmetric?</code> to <code>true</code> as their respective measures are symmetric.</p>
<p>See also <a href="#LOS-correlation-matrix">correlation-matrix</a>, <a href="#LOS-covariance-matrix">covariance-matrix</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1712">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-d"></span>
</section>
<section id="cohens-d" class="level4">
<h4 class="anchored" data-anchor-id="cohens-d">cohens-d</h4>
<ul>
<li><code>(cohens-d [group1 group2])</code></li>
<li><code>(cohens-d group1 group2)</code></li>
<li><code>(cohens-d group1 group2 method)</code></li>
</ul>
<p>Calculate Cohen’s d effect size between two groups.</p>
<p>Cohen’s d is a standardized measure used to quantify the magnitude of the difference between the means of two independent groups. It expresses the mean difference in terms of standard deviation units.</p>
<p>The most common formula for Cohen’s d is:</p>
<pre><code>  d = (mean(group1) - mean(group2)) / pooled_stddev</code></pre>
<p>where <code>pooled_stddev</code> is the pooled standard deviation of the two groups, calculated under the assumption of equal variances.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first independent sample.</li>
<li><code>group2</code> (seq of numbers): The second independent sample.</li>
<li><code>method</code> (optional keyword): Specifies the method for calculating the pooled standard deviation, affecting the denominator of the formula. Possible values are <code>:unbiased</code> (default), <code>:biased</code>, or <code>:avg</code>. See <a href="#LOS-pooled-stddev">pooled-stddev</a> for details on these methods.</li>
</ul>
<p>Returns the calculated Cohen’s d effect size as a double.</p>
<p>Interpretation guidelines (approximate for normal distributions): - |d| = 0.2: small effect - |d| = 0.5: medium effect - |d| = 0.8: large effect</p>
<p>Assumptions: - The two samples are independent. - Data within each group are approximately normally distributed. - The choice of <code>:method</code> implies assumptions about equal variances (default <code>:unbiased</code> and <code>:biased</code> assume equal variances, while <code>:avg</code> does not but might be less standard).</p>
<p>See also <a href="#LOS-hedges-g">hedges-g</a> (a version bias-corrected for small sample sizes), <a href="#LOS-glass-delta">glass-delta</a> (an alternative effect size measure using the control group standard deviation), <a href="#LOS-pooled-stddev">pooled-stddev</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2569">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-d-corrected"></span>
</section>
<section id="cohens-d-corrected" class="level4">
<h4 class="anchored" data-anchor-id="cohens-d-corrected">cohens-d-corrected</h4>
<ul>
<li><code>(cohens-d-corrected [group1 group2])</code></li>
<li><code>(cohens-d-corrected group1 group2)</code></li>
<li><code>(cohens-d-corrected group1 group2 method)</code></li>
</ul>
<p>Calculates Cohen’s d effect size corrected for bias in small sample sizes.</p>
<p>This function applies a correction factor (derived from the gamma function) to Cohen’s d (<a href="#LOS-cohens-d">cohens-d</a>) to provide a less biased estimate of the population effect size when sample sizes are small. This corrected measure is sometimes referred to as Hedges’ g, though this function specifically implements the correction applied to Cohen’s d.</p>
<p>The correction factor is <code>(1 - 3 / (4 * df - 1))</code> where <code>df</code> is the degrees of freedom used in the standard Cohen’s d calculation.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first independent sample.</li>
<li><code>group2</code> (seq of numbers): The second independent sample.</li>
<li><code>method</code> (optional keyword): Specifies the method for calculating the pooled standard deviation, affecting the denominator of the formula (passed to <a href="#LOS-cohens-d">cohens-d</a>). Possible values are <code>:unbiased</code> (default), <code>:biased</code>, or <code>:avg</code>. See <a href="#LOS-pooled-stddev">pooled-stddev</a> for details on these methods.</li>
</ul>
<p>Returns the calculated bias-corrected Cohen’s d effect size as a double.</p>
<p>Note: While this function is named <code>cohens-d-corrected</code>, Hedges’ g (calculated by <a href="#LOS-hedges-g-corrected">hedges-g-corrected</a>) also applies a similar small-sample bias correction. Differences might exist based on the specific correction formula or degree of freedom definition used. This function uses <code>(count group1) + (count group2) - 2</code> as the degrees of freedom for the correction by default (when <code>:unbiased</code> method is used for <code>cohens-d</code>).</p>
<p>See also <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-hedges-g">hedges-g</a>, <a href="#LOS-hedges-g-corrected">hedges-g-corrected</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2618">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-f"></span>
</section>
<section id="cohens-f" class="level4">
<h4 class="anchored" data-anchor-id="cohens-f">cohens-f</h4>
<ul>
<li><code>(cohens-f [group1 group2])</code></li>
<li><code>(cohens-f group1 group2)</code></li>
<li><code>(cohens-f group1 group2 type)</code></li>
</ul>
<p>Calculates Cohen’s f, a measure of effect size derived as the square root of Cohen’s f² (<a href="#LOS-cohens-f2">cohens-f2</a>).</p>
<p>Cohen’s f is a standardized measure quantifying the magnitude of an effect, often used in the context of ANOVA or regression. It is the square root of the ratio of the variance explained by the effect to the unexplained variance.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The dependent variable.</li>
<li><code>group2</code> (seq of numbers): The independent variable (or predictor). Must have the same length as <code>group1</code>.</li>
<li><code>type</code> (keyword, optional): Specifies the measure of ‘Proportion of Variance Explained’ used in the underlying <a href="#LOS-cohens-f2">cohens-f2</a> calculation. Defaults to <code>:eta</code>.
<ul>
<li><code>:eta</code> (default): Uses Eta-squared (sample R²), a measure of variance explained in the sample.</li>
<li><code>:omega</code>: Uses Omega-squared, a less biased estimate of variance explained in the population.</li>
<li><code>:epsilon</code>: Uses Epsilon-squared, another less biased estimate of variance explained in the population.</li>
<li>Any function: A function accepting <code>group1</code> and <code>group2</code> and returning a double representing the proportion of variance explained.</li>
</ul></li>
</ul>
<p>Returns the calculated Cohen’s f effect size as a double. Values range from 0 upwards.</p>
<p>Interpretation:</p>
<ul>
<li>Values are positive. Larger values indicate a stronger effect (more variance in <code>group1</code> explained by <code>group2</code>).</li>
<li>Cohen’s guidelines for interpreting the magnitude of f² (and by extension, f) are:
<ul>
<li><span class="math inline">\(f = 0.10\)</span> (approx. <span class="math inline">\(f^2 = 0.01\)</span>): small effect</li>
<li><span class="math inline">\(f = 0.25\)</span> (approx. <span class="math inline">\(f^2 = 0.0625\)</span>): medium effect</li>
<li><span class="math inline">\(f = 0.40\)</span> (approx. <span class="math inline">\(f^2 = 0.16\)</span>): large effect (Note: Guidelines are often quoted for f², interpret f as <span class="math inline">\(\sqrt{f^2}\)</span>)</li>
</ul></li>
</ul>
<p>See also <a href="#LOS-cohens-f2">cohens-f2</a>, <a href="#LOS-eta-sq">eta-sq</a>, <a href="#LOS-omega-sq">omega-sq</a>, <a href="#LOS-epsilon-sq">epsilon-sq</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3340">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-f2"></span>
</section>
<section id="cohens-f2" class="level4">
<h4 class="anchored" data-anchor-id="cohens-f2">cohens-f2</h4>
<ul>
<li><code>(cohens-f2 [group1 group2])</code></li>
<li><code>(cohens-f2 group1 group2)</code></li>
<li><code>(cohens-f2 group1 group2 type)</code></li>
</ul>
<p>Calculates Cohen’s f², a measure of effect size often used in ANOVA or regression.</p>
<p>Cohen’s f² quantifies the magnitude of the effect of an independent variable or set of predictors on a dependent variable, expressed as the ratio of the variance explained by the effect to the unexplained variance.</p>
<p>This function allows calculating f² using different measures for the ‘Proportion of Variance Explained’, specified by the <code>type</code> parameter:</p>
<ul>
<li><code>:eta</code> (default): Uses <a href="#LOS-eta-sq">eta-sq</a> (Eta-squared), which in this implementation is equivalent to the sample <span class="math inline">\(R^2\)</span> from a linear regression of <code>group1</code> on <code>group2</code>. This is a measure of the proportion of variance explained in the sample.</li>
<li><code>:omega</code>: Uses <a href="#LOS-omega-sq">omega-sq</a> (Omega-squared), a less biased estimate of the proportion of variance explained in the population.</li>
<li><code>:epsilon</code>: Uses <a href="#LOS-epsilon-sq">epsilon-sq</a> (Epsilon-squared), another less biased estimate of the proportion of variance explained in the population, similar to adjusted <span class="math inline">\(R^2\)</span>.</li>
<li>Any function: A function accepting <code>group1</code> and <code>group2</code> and returning a double representing the proportion of variance explained.</li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The dependent variable.</li>
<li><code>group2</code> (seq of numbers): The independent variable (or predictor). Must have the same length as <code>group1</code>.</li>
<li><code>type</code> (keyword, optional): Specifies the measure of ‘Proportion of Variance Explained’ to use (<code>:eta</code>, <code>:omega</code>, <code>:epsilon</code> or any function). Defaults to <code>:eta</code>.</li>
</ul>
<p>Returns the calculated Cohen’s f² effect size as a double. Values range from 0 upwards.</p>
<p>Interpretation Guidelines (approximate, often used for F-tests in ANOVA/regression): - <span class="math inline">\(f^2 = 0.02\)</span>: small effect - <span class="math inline">\(f^2 = 0.15\)</span>: medium effect - <span class="math inline">\(f^2 = 0.35\)</span>: large effect</p>
<p>See also <a href="#LOS-cohens-f">cohens-f</a>, <a href="#LOS-eta-sq">eta-sq</a>, <a href="#LOS-omega-sq">omega-sq</a>, <a href="#LOS-epsilon-sq">epsilon-sq</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3296">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-kappa"></span>
</section>
<section id="cohens-kappa" class="level4">
<h4 class="anchored" data-anchor-id="cohens-kappa">cohens-kappa</h4>
<ul>
<li><code>(cohens-kappa group1 group2)</code></li>
<li><code>(cohens-kappa contingency-table)</code></li>
</ul>
<p>Calculates Cohen’s Kappa coefficient (κ), a statistic that measures inter-rater agreement for categorical items, while correcting for chance agreement.</p>
<p>It is often used to assess the consistency of agreement between two raters or methods. Its value typically ranges from -1 to +1:</p>
<ul>
<li><code>κ = 1</code>: Perfect agreement.</li>
<li><code>κ = 0</code>: Agreement is no better than chance.</li>
<li><code>κ &lt; 0</code>: Agreement is worse than chance.</li>
</ul>
<p>The function can be called in two ways:</p>
<ol type="1">
<li><p>With two sequences <code>group1</code> and <code>group2</code>: The function will automatically construct a 2x2 contingency table from the unique values in the sequences (assuming they represent two binary variables). The mapping of values to table cells (e.g., what corresponds to TP, TN, FP, FN) depends on how <code>contingency-table</code> orders the unique values. For direct control over which cell is which, use the contingency table input.</p></li>
<li><p>With a contingency table: The contingency table can be provided as:</p>
<ul>
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] TP, [0 1] FP, [1 0] FN, [1 1] TN}</code>). This is the output format of <a href="#LOS-contingency-table">contingency-table</a> with two inputs. The mapping of indices to TP/TN/FP/FN depends on the order of unique values in the original data if generated by <a href="#LOS-contingency-table">contingency-table</a>, or the explicit structure if created manually or via <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>. Standard convention maps <code>[0 0]</code> to TP, <code>[0 1]</code> to FP, <code>[1 0]</code> to FN, and <code>[1 1]</code> to TN for binary outcomes.</li>
<li>A sequence of sequences representing the rows of the table (e.g., <code>[TP FP] [FN TN](#LOS-TP FP] [FN TN)</code>). This is equivalent to <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>.</li>
</ul></li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (sequence): The first sequence of binary outcomes/categories.</li>
<li><code>group2</code> (sequence): The second sequence of binary outcomes/categories. Must have the same length as <code>group1</code>.</li>
<li><code>contingency-table</code> (map or sequence of sequences): A pre-computed 2x2 contingency table. The cell values should represent counts (e.g., TP, FN, FP, TN).</li>
</ul>
<p>Returns the calculated Cohen’s Kappa coefficient as a double.</p>
<p>See also <a href="#LOS-weighted-kappa">weighted-kappa</a> (for ordinal data with partial agreement), <a href="#LOS-contingency-table">contingency-table</a>, <a href="#LOS-contingency-2x2-measures">contingency-2x2-measures</a>, <a href="#LOS-binary-measures-all">binary-measures-all</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3827">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-q"></span>
</section>
<section id="cohens-q" class="level4">
<h4 class="anchored" data-anchor-id="cohens-q">cohens-q</h4>
<ul>
<li><code>(cohens-q r1 r2)</code></li>
<li><code>(cohens-q group1 group2a group2b)</code></li>
<li><code>(cohens-q group1a group2a group1b group2b)</code></li>
</ul>
<p>Compares two correlation coefficients by calculating the difference between their Fisher z-transformations.</p>
<p>The Fisher z-transformation (<code>atanh</code>) of a correlation coefficient <code>r</code> helps normalize the sampling distribution of correlation coefficients. The difference between two z’-transformed correlations is often used as a test statistic.</p>
<p>The function supports comparing correlations in different scenarios via its arities:</p>
<ul>
<li><code>(cohens-q r1 r2)</code>: Calculates the difference between the Fisher z-transformations of two correlation values <code>r1</code> and <code>r2</code> provided directly. This is typically used when comparing two <em>independent</em> correlation coefficients (e.g., correlations from two separate studies). Returns <code>atanh(r1) - atanh(r2)</code>.
<ul>
<li><code>r1</code>, <code>r2</code> (double): Correlation coefficient values (-1.0 to 1.0).</li>
</ul></li>
<li><code>(cohens-q group1 group2a group2b)</code>: Calculates the difference between the correlation of <code>group1</code> with <code>group2a</code> and the correlation of <code>group1</code> with <code>group2b</code>. This is commonly used for comparing <em>dependent</em> correlations (where <code>group1</code> is a common variable). Calculates <code>atanh(pearson-correlation(group1, group2a)) - atanh(pearson-correlation(group1, group2b))</code>.
<ul>
<li><code>group1</code>, <code>group2a</code>, <code>group2b</code> (sequences): Data sequences from which Pearson correlations are computed.</li>
</ul></li>
<li><code>(cohens-q group1a group2a group1b group2b)</code>: Calculates the difference between the correlation of <code>group1a</code> with <code>group2a</code> and the correlation of <code>group1b</code> with <code>group2b</code>. This is typically used for comparing two <em>independent</em> correlations obtained from two distinct pairs of variables (all four sequences are independent). Calculates <code>atanh(pearson-correlation(group1a, group2a)) - atanh(pearson-correlation(group1b, group2b))</code>.
<ul>
<li><code>group1a</code>, <code>group2a</code>, <code>group1b</code>, <code>group2b</code> (sequences): Data sequences from which Pearson correlations are computed.</li>
</ul></li>
</ul>
<p>Returns the difference between the Fisher z-transformed correlation values as a double.</p>
<p>Note: For comparing dependent correlations (3-arity case), standard statistical tests (e.g., Steiger’s test) are more complex than a simple difference of z-transforms and involve the correlation between <code>group2a</code> and <code>group2b</code>. This function provides the basic difference value.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3374">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-u1"></span>
</section>
<section id="cohens-u1" class="level4">
<h4 class="anchored" data-anchor-id="cohens-u1">cohens-u1</h4>
<ul>
<li><code>(cohens-u1 [group1 group2])</code></li>
<li><code>(cohens-u1 group1 group2)</code></li>
</ul>
<p>Calculates a non-parametric measure of difference or separation between two samples.</p>
<p>This function computes a value derived from <a href="#LOS-cohens-u2">cohens-u2</a>, which internally quantifies a minimal difference between corresponding quantiles of the two empirical distributions.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sample.</li>
<li><code>group2</code> (seq of numbers): The second sample.</li>
</ul>
<p>Returns the calculated measure as a double.</p>
<p>Interpretation:</p>
<ul>
<li>Values close to -1 indicate high similarity or maximum overlap between the distributions (as the minimal difference between quantiles approaches zero).</li>
<li>Increasing values indicate greater difference or separation between the distributions (as the minimal difference between quantiles is larger).</li>
</ul>
<p>This measure is symmetric, meaning the order of <code>group1</code> and <code>group2</code> does not affect the result. It is a non-parametric measure applicable to any data samples.</p>
<p>See also <a href="#LOS-cohens-u2">cohens-u2</a> (the measure this calculation is based on), <a href="#LOS-cohens-u3">cohens-u3</a> (related non-parametric measure), <a href="#LOS-cohens-u1-normal">cohens-u1-normal</a> (the version applicable to normal data).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3090">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-u1-normal"></span>
</section>
<section id="cohens-u1-normal" class="level4">
<h4 class="anchored" data-anchor-id="cohens-u1-normal">cohens-u1-normal</h4>
<ul>
<li><code>(cohens-u1-normal group1 group2)</code></li>
<li><code>(cohens-u1-normal group1 group2 method)</code></li>
<li><code>(cohens-u1-normal d)</code></li>
</ul>
<p>Calculates Cohen’s U1, a measure of non-overlap between two distributions assumed to be normal with equal variances.</p>
<p>Cohen’s U1 quantifies the proportion of scores in the lower-scoring group that overlap with the scores in the higher-scoring group. A U1 of 0 means no overlap, while a U1 of 1 means complete overlap (distributions are identical).</p>
<p>This measure is calculated directly from Cohen’s d statistic (<a href="#LOS-cohens-d">cohens-d</a>) assuming normal distributions and equal variances.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sample.</li>
<li><code>group2</code> (seq of numbers): The second sample.</li>
<li><code>method</code> (optional keyword): Specifies the method for calculating the pooled standard deviation used in the underlying <a href="#LOS-cohens-d">cohens-d</a> calculation. Possible values are <code>:unbiased</code> (default), <code>:biased</code>, or <code>:avg</code>. See <a href="#LOS-pooled-stddev">pooled-stddev</a> for details.</li>
<li><code>d</code> (double): A pre-calculated Cohen’s d value. If provided, <code>group1</code>, <code>group2</code>, and <code>method</code> are ignored.</li>
</ul>
<p>Returns the calculated Cohen’s U1 as a double [0, 1].</p>
<p>Assumptions: - Both samples are drawn from normally distributed populations. - The populations have equal variances (homoscedasticity).</p>
<p>See also <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-cohens-u2-normal">cohens-u2-normal</a>, <a href="#LOS-cohens-u3-normal">cohens-u3-normal</a>, <a href="#LOS-p-overlap">p-overlap</a> (a non-parametric overlap measure).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2972">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-u2"></span>
</section>
<section id="cohens-u2" class="level4">
<h4 class="anchored" data-anchor-id="cohens-u2">cohens-u2</h4>
<ul>
<li><code>(cohens-u2 [group1 group2])</code></li>
<li><code>(cohens-u2 group1 group2)</code></li>
</ul>
<p>Calculates a measure of overlap between two samples, referred to as Cohen’s U2.</p>
<p>This function quantifies the degree to which the distributions of <code>group1</code> and <code>group2</code> overlap. It is related to comparing values at corresponding percentile levels across the two groups or the proportion of values in one group that are below the median of the other. A value of 0 indicates no overlap, while a value of 1 indicates complete overlap (distributions are identical).</p>
<p>The measure is symmetric, meaning <code>(cohens-u2 group1 group2)</code> is equal to <code>(cohens-u2 group2 group1)</code>.</p>
<p>This is a non-parametric measure, suitable for any data samples, and does not assume normality, unlike <a href="#LOS-cohens-u2-normal">cohens-u2-normal</a>.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code>, <code>group2</code> (sequences): The two samples directly as arguments.</li>
</ul>
<p>Returns the calculated Cohen’s U2 value as a double. The value typically ranges from 0 to 1. A value closer to 0.5 indicates substantial overlap between the distributions (e.g., the median of one group is near the median of the other); values closer to 0 or 1 indicate less overlap (greater separation between the distributions).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3064">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-u2-normal"></span>
</section>
<section id="cohens-u2-normal" class="level4">
<h4 class="anchored" data-anchor-id="cohens-u2-normal">cohens-u2-normal</h4>
<ul>
<li><code>(cohens-u2-normal group1 group2)</code></li>
<li><code>(cohens-u2-normal group1 group2 method)</code></li>
<li><code>(cohens-u2-normal d)</code></li>
</ul>
<p>Calculates Cohen’s U2, a measure of overlap between two distributions assumed to be normal with equal variances.</p>
<p>Cohen’s U2 quantifies the proportion of scores in the lower-scoring group that are below the point located halfway between the means of the two groups (or equivalently, the proportion of scores in the higher-scoring group that are above this halfway point). This measure is calculated from Cohen’s d statistic (<a href="#LOS-cohens-d">cohens-d</a>) using the standard normal cumulative distribution function (<span class="math inline">\(\Phi\)</span>): <span class="math inline">\(\Phi(0.5 |d|)\)</span>.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sample.</li>
<li><code>group2</code> (seq of numbers): The second sample.</li>
<li><code>method</code> (optional keyword): Specifies the method for calculating the pooled standard deviation used in the underlying <a href="#LOS-cohens-d">cohens-d</a> calculation. Possible values are <code>:unbiased</code> (default), <code>:biased</code>, or <code>:avg</code>. See <a href="#LOS-pooled-stddev">pooled-stddev</a> for details.</li>
<li><code>d</code> (double): A pre-calculated Cohen’s d value. If provided, <code>group1</code>, <code>group2</code>, and <code>method</code> are ignored.</li>
</ul>
<p>Returns the calculated Cohen’s U2 as a double [0.0, 1.0]. A value closer to 0.5 indicates greater overlap between the distributions; values closer to 0 or 1 indicate less overlap.</p>
<p>Assumptions: - Both samples are drawn from normally distributed populations. - The populations have equal variances (homoscedasticity).</p>
<p>See also <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-cohens-u1-normal">cohens-u1-normal</a>, <a href="#LOS-cohens-u3-normal">cohens-u3-normal</a>, <a href="#LOS-p-overlap">p-overlap</a> (a non-parametric overlap measure).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3004">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-u3"></span>
</section>
<section id="cohens-u3" class="level4">
<h4 class="anchored" data-anchor-id="cohens-u3">cohens-u3</h4>
<ul>
<li><code>(cohens-u3 [group1 group2])</code></li>
<li><code>(cohens-u3 group1 group2)</code></li>
<li><code>(cohens-u3 group1 group2 estimation-strategy)</code></li>
</ul>
<p>Calculates Cohen’s U3 for two samples.</p>
<p>In this implementation, Cohen’s U3 is defined as the proportion of values in the second sample (<code>group2</code>) that are less than the median of the first sample (<code>group1</code>).</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sample. The median of this sample is used as the threshold.</li>
<li><code>group2</code> (seq of numbers): The second sample. Values from this sample are counted if they fall below the median of <code>group1</code>.</li>
<li><code>estimation-strategy</code> (optional keyword): The strategy used to estimate the median of <code>group1</code>. Defaults to <code>:legacy</code>. See <a href="#LOS-median">median</a> or <a href="#LOS-quantile">quantile</a> for available strategies (e.g., <code>:r1</code> through <code>:r9</code>).</li>
</ul>
<p>Returns the calculated proportion as a double between 0.0 and 1.0.</p>
<p>Interpretation:</p>
<ul>
<li>A value close to 0 means most values in <code>group2</code> are greater than or equal to the median of <code>group1</code>.</li>
<li>A value close to 0.5 means approximately half the values in <code>group2</code> are below the median of <code>group1</code>.</li>
<li>A value close to 1 means most values in <code>group2</code> are less than the median of <code>group1</code>.</li>
</ul>
<p>Note: This measure is <strong>not symmetric</strong>. <code>(cohens-u3 group1 group2)</code> is generally not equal to <code>(cohens-u3 group2 group1)</code>.</p>
<p>This is a non-parametric measure, suitable for any data samples, and does not assume normality, unlike <a href="#LOS-cohens-u3-normal">cohens-u3-normal</a>.</p>
<p>See also <a href="#LOS-cohens-u3-normal">cohens-u3-normal</a> (the version applicable to normal data), <a href="#LOS-cohens-u2">cohens-u2</a> (a related symmetric non-parametric measure), <a href="#LOS-median">median</a>, <a href="#LOS-quantile">quantile</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3122">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-u3-normal"></span>
</section>
<section id="cohens-u3-normal" class="level4">
<h4 class="anchored" data-anchor-id="cohens-u3-normal">cohens-u3-normal</h4>
<ul>
<li><code>(cohens-u3-normal group1 group2)</code></li>
<li><code>(cohens-u3-normal group1 group2 method)</code></li>
<li><code>(cohens-u3-normal d)</code></li>
</ul>
<p>Calculates Cohen’s U3, a measure of overlap between two distributions assumed to be normal with equal variances.</p>
<p>Cohen’s U3 quantifies the proportion of scores in the lower-scoring group that fall below the mean of the higher-scoring group. It is calculated from Cohen’s d statistic (<a href="#LOS-cohens-d">cohens-d</a>) using the standard normal cumulative distribution function (<span class="math inline">\(\Phi\)</span>): <code>U3 = Φ(d)</code>.</p>
<p>The measure is asymmetric: <code>U3(group1, group2)</code> is not necessarily equal to <code>U3(group2, group1)</code>. The interpretation depends on which group is considered the ‘higher-scoring’ one based on the sign of d.&nbsp;By convention, the result often represents the proportion of the <em>first</em> group (<code>group1</code>) that is below the mean of the <em>second</em> group (<code>group2</code>) if d is negative, or the proportion of the <em>second</em> group (<code>group2</code>) that is below the mean of the <em>first</em> group (<code>group1</code>) if d is positive.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sample.</li>
<li><code>group2</code> (seq of numbers): The second sample.</li>
<li><code>method</code> (optional keyword): Specifies the method for calculating the pooled standard deviation used in the underlying <a href="#LOS-cohens-d">cohens-d</a> calculation. Possible values are <code>:unbiased</code> (default), <code>:biased</code>, or <code>:avg</code>. See <a href="#LOS-pooled-stddev">pooled-stddev</a> for details.</li>
<li><code>d</code> (double): A pre-calculated Cohen’s d value. If provided, <code>group1</code>, <code>group2</code>, and <code>method</code> are ignored.</li>
</ul>
<p>Returns the calculated Cohen’s U3 as a double [0.0, 1.0]. A value close to 0.5 suggests significant overlap. Values closer to 0 or 1 suggest less overlap (greater separation between the means).</p>
<p>Assumptions: - Both samples are drawn from normally distributed populations. - The populations have equal variances (homoscedasticity).</p>
<p>See also <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-cohens-u1-normal">cohens-u1-normal</a>, <a href="#LOS-cohens-u2-normal">cohens-u2-normal</a>, <a href="#LOS-p-overlap">p-overlap</a> (a non-parametric overlap measure).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3027">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cohens-w"></span>
</section>
<section id="cohens-w" class="level4">
<h4 class="anchored" data-anchor-id="cohens-w">cohens-w</h4>
<ul>
<li><code>(cohens-w group1 group2)</code></li>
<li><code>(cohens-w contingency-table)</code></li>
</ul>
<p>Calculates Cohen’s W effect size for the association between two nominal variables represented in a contingency table.</p>
<p>Cohen’s W is a measure of association derived from the Pearson’s Chi-squared statistic. It quantifies the magnitude of the difference between the observed frequencies and the frequencies expected under the assumption of independence between the variables.</p>
<p>Its value ranges from 0 upwards: - A value of 0 indicates no association between the variables. - Larger values indicate a stronger association.</p>
<p>The function can be called in two ways:</p>
<ol type="1">
<li>With two sequences <code>group1</code> and <code>group2</code>: The function will automatically construct a contingency table from the unique values in the sequences.</li>
<li>With a contingency table: The contingency table can be provided as:
<ul>
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] 10, [0 1] 5, [1 0] 3, [1 1] 12}</code>). This is the output format of <a href="#LOS-contingency-table">contingency-table</a> with two inputs.</li>
<li>A sequence of sequences representing the rows of the table (e.g., <code>[10 5] [3 12](#LOS-10 5] [3 12)</code>). This is equivalent to <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>.</li>
</ul></li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (sequence): The first sequence of categorical data.</li>
<li><code>group2</code> (sequence): The second sequence of categorical data. Must have the same length as <code>group1</code>.</li>
<li><code>contingency-table</code> (map or sequence of sequences): A pre-computed contingency table.</li>
</ul>
<p>Returns the calculated Cohen’s W coefficient as a double.</p>
<p>See also <a href="#LOS-chisq-test">chisq-test</a>, <a href="#LOS-cramers-v">cramers-v</a>, <a href="#LOS-cramers-c">cramers-c</a>, <a href="#LOS-tschuprows-t">tschuprows-t</a>, <a href="#LOS-contingency-table">contingency-table</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3746">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-confusion-matrix"></span>
</section>
<section id="confusion-matrix" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix">confusion-matrix</h4>
<ul>
<li><code>(confusion-matrix tp fn fp tn)</code></li>
<li><code>(confusion-matrix confusion-mat)</code></li>
<li><code>(confusion-matrix actual prediction)</code></li>
<li><code>(confusion-matrix actual prediction encode-true)</code></li>
</ul>
<p>Creates a 2x2 confusion matrix for binary classification.</p>
<p>A confusion matrix summarizes the results of a binary classification problem, showing the counts of True Positives (TP), False Positives (FP), False Negatives (FN), and True Negatives (TN).</p>
<p>TP: Actual is True, Predicted is True FP: Actual is False, Predicted is True (Type I error) FN: Actual is True, Predicted is False (Type II error) TN: Actual is False, Predicted is False</p>
<p>The function supports several input formats:</p>
<ol type="1">
<li><code>(confusion-matrix tp fn fp tn)</code>: Direct input of the four counts.
<ul>
<li><code>tp</code> (long): True Positive count.</li>
<li><code>fn</code> (long): False Negative count.</li>
<li><code>fp</code> (long): False Positive count.</li>
<li><code>tn</code> (long): True Negative count.</li>
</ul></li>
<li><code>(confusion-matrix confusion-matrix-representation)</code>: Input as a structured representation.
<ul>
<li><code>confusion-matrix-representation</code>: Can be:
<ul>
<li>A map with keys like <code>:tp</code>, <code>:fn</code>, <code>:fp</code>, <code>:tn</code> (e.g., <code>{:tp 10 :fn 2 :fp 5 :tn 80}</code>).</li>
<li>A sequence of sequences representing rows <code>[TP FP] [FN TN](#LOS-TP FP] [FN TN)</code> (e.g., <code>[10 5] [2 80](#LOS-10 5] [2 80)</code>).</li>
<li>A flat sequence <code>[TP FN FP TN]</code> (e.g., <code>[10 2 5 80]</code>).</li>
</ul></li>
</ul></li>
<li><code>(confusion-matrix actual prediction)</code>: Input as two sequences of outcomes.
<ul>
<li><code>actual</code> (sequence): Sequence of true outcomes.</li>
<li><code>prediction</code> (sequence): Sequence of predicted outcomes. Must have the same length as <code>actual</code>. Values in <code>actual</code> and <code>prediction</code> are compared element-wise. By default, any non-<code>nil</code> or non-zero value is treated as <code>true</code>, and <code>nil</code> or <code>0.0</code> is treated as <code>false</code>.</li>
</ul></li>
<li><code>(confusion-matrix actual prediction encode-true)</code>: Input as two sequences with a specified encoding for <code>true</code>.
<ul>
<li><code>actual</code>, <code>prediction</code>: Sequences as in the previous arity.</li>
<li><code>encode-true</code>: Specifies how values in <code>actual</code> and <code>prediction</code> are converted to boolean <code>true</code> or <code>false</code>.
<ul>
<li><code>nil</code> (default): Non-<code>nil</code>/non-zero is true.</li>
<li>Any sequence/set: Values found in this collection are true.</li>
<li>A map: Values are mapped according to the map; if a key is not found or maps to <code>false</code>, the value is false.</li>
<li>A predicate function: Returns <code>true</code> if the value satisfies the predicate.</li>
</ul></li>
</ul></li>
</ol>
<p>Returns a map with keys <code>:tp</code>, <code>:fn</code>, <code>:fp</code>, and <code>:tn</code> representing the counts.</p>
<p>This function is commonly used to prepare input for binary classification metrics like those provided by <a href="#LOS-binary-measures-all">binary-measures-all</a> and <a href="#LOS-binary-measures">binary-measures</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4095">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-contingency-2x2-measures"></span>
</section>
<section id="contingency-2x2-measures" class="level4">
<h4 class="anchored" data-anchor-id="contingency-2x2-measures">contingency-2x2-measures</h4>
<ul>
<li><code>(contingency-2x2-measures &amp; args)</code></li>
</ul>
<p>Calculates a subset of common statistics and measures for a 2x2 contingency table.</p>
<p>This function provides a selection of the most frequently used measures from the more comprehensive <a href="#LOS-contingency-2x2-measures-all">contingency-2x2-measures-all</a>.</p>
<p>The function accepts the same input formats as <a href="#LOS-contingency-2x2-measures-all">contingency-2x2-measures-all</a>:</p>
<ol type="1">
<li><code>(contingency-2x2-measures a b c d)</code>: Takes the four counts as arguments.</li>
<li><code>(contingency-2x2-measures [a b c d])</code>: Takes a sequence of the four counts.</li>
<li><code>(contingency-2x2-measures [a b] [c d](#LOS-a b] [c d))</code>: Takes a sequence of sequences representing the rows.</li>
<li><code>(contingency-2x2-measures {:a a :b b :c c :d d})</code>: Takes a map of counts (accepts <code>:a/:b/:c/:d</code> keys).</li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>a, b, c, d</code> (long): Counts in the 2x2 table cells.</li>
<li><code>map-or-seq</code> (map or sequence): A representation of the 2x2 table.</li>
</ul>
<p>Returns a map containing a selection of measures:</p>
<ul>
<li><code>:OR</code>: Odds Ratio (Odds Ratio)</li>
<li><code>:chi2</code>: Pearson’s Chi-squared statistic</li>
<li><code>:yates</code>: Yates’ continuity corrected Chi-squared statistic</li>
<li><code>:cochran-mantel-haenszel</code>: Cochran-Mantel-Haenszel statistic</li>
<li><code>:cohens-kappa</code>: Cohen’s Kappa coefficient</li>
<li><code>:yules-q</code>: Yule’s Q measure of association</li>
<li><code>:holley-guilfords-g</code>: Holley-Guilford’s G measure</li>
<li><code>:huberts-gamma</code>: Hubert’s Gamma measure</li>
<li><code>:yules-y</code>: Yule’s Y measure of association</li>
<li><code>:cramers-v</code>: Cramer’s V measure of association</li>
<li><code>:phi</code>: Phi coefficient (Matthews Correlation Coefficient)</li>
<li><code>:scotts-pi</code>: Scott’s Pi measure of agreement</li>
<li><code>:cohens-h</code>: Cohen’s H measure</li>
<li><code>:PCC</code>: Pearson’s Contingency Coefficient</li>
<li><code>:PCC-adjusted</code>: Adjusted Pearson’s Contingency Coefficient</li>
<li><code>:TCC</code>: Tschuprow’s Contingency Coefficient</li>
<li><code>:F1</code>: F1 Score</li>
<li><code>:bangdiwalas-b</code>: Bangdiwala’s B statistic</li>
<li><code>:mcnemars-chi2</code>: McNemar’s Chi-squared test statistic</li>
<li><code>:gwets-ac1</code>: Gwet’s AC1 measure</li>
</ul>
<p>For a more comprehensive set of 2x2 measures and their detailed descriptions, see <a href="#LOS-contingency-2x2-measures-all">contingency-2x2-measures-all</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4435">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-contingency-2x2-measures-all"></span>
</section>
<section id="contingency-2x2-measures-all" class="level4">
<h4 class="anchored" data-anchor-id="contingency-2x2-measures-all">contingency-2x2-measures-all</h4>
<ul>
<li><code>(contingency-2x2-measures-all a b c d)</code></li>
<li><code>(contingency-2x2-measures-all map-or-seq)</code></li>
<li><code>(contingency-2x2-measures-all [a b] [c d])</code></li>
</ul>
<p>Calculates a comprehensive set of statistics and measures for a 2x2 contingency table.</p>
<p>A 2x2 contingency table cross-tabulates two categorical variables, each with two levels. The table counts are typically represented as:</p>
<p>+—+—+ | a | b | +—+—+ | c | d | +—+—+</p>
<p>Where <code>a, b, c, d</code> are the counts in the respective cells.</p>
<p>This function calculates numerous measures, including:</p>
<ul>
<li>Chi-squared statistics (Pearson, Yates’ corrected, CMH) and their p-values.</li>
<li>Measures of association (Phi, Yule’s Q, Holley-Guilford’s G, Hubert’s Gamma, Yule’s Y, Cramer’s V, Scott’s Pi, Cohen’s H, Pearson/Tschuprow’s CC).</li>
<li>Measures of agreement (Cohen’s Kappa).</li>
<li>Risk and effect size measures (Odds Ratio (OR), Relative Risk (RR), Risk Difference (RD), NNT, etc.).</li>
<li>Table marginals and proportions.</li>
</ul>
<p>The function can be called with the four counts directly or with a representation of the contingency table:</p>
<ol type="1">
<li><code>(contingency-2x2-measures-all a b c d)</code>: Takes the four counts as arguments.</li>
<li><code>(contingency-2x2-measures-all [a b c d])</code>: Takes a sequence of the four counts.</li>
<li><code>(contingency-2x2-measures-all [a b] [c d](#LOS-a b] [c d))</code>: Takes a sequence of sequences representing the rows.</li>
<li><code>(contingency-2x2-measures-all {:a a :b b :c c :d d})</code>: Takes a map of counts (accepts <code>:a/:b/:c/:d</code> keys).</li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>a</code> (long): Count in the top-left cell.</li>
<li><code>b</code> (long): Count in the top-right cell.</li>
<li><code>c</code> (long): Count in the bottom-left cell.</li>
<li><code>d</code> (long): Count in the bottom-right cell.</li>
<li><code>map-or-seq</code> (map or sequence): A representation of the 2x2 table as described above.</li>
</ul>
<p>Returns a map containing a wide range of calculated statistics. Keys include: <code>:n</code>, <code>:table</code>, <code>:expected</code>, <code>:marginals</code>, <code>:proportions</code>, <code>:p-values</code> (map), <code>:OR</code>, <code>:lOR</code>, <code>:RR</code>, <code>:risk</code> (map), <code>:SE</code>, <code>:measures</code> (map).</p>
<p>See also <a href="#LOS-contingency-2x2-measures">contingency-2x2-measures</a> for a selected subset of these measures, <a href="#LOS-mcc">mcc</a> for the Matthews Correlation Coefficient (Phi), and <a href="#LOS-binary-measures-all">binary-measures-all</a> for metrics derived from a confusion matrix (often a 2x2 table in binary classification).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4383">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-contingency-table"></span>
</section>
<section id="contingency-table" class="level4">
<h4 class="anchored" data-anchor-id="contingency-table">contingency-table</h4>
<ul>
<li><code>(contingency-table &amp; seqs)</code></li>
</ul>
<p>Creates a frequency map (contingency table) from one or more sequences.</p>
<p>If one sequence <code>xs</code> is provided, it returns a simple frequency map of the values in <code>xs</code>.</p>
<p>If multiple sequences <code>s1, s2, ..., sn</code> are provided, it creates a contingency table of the tuples formed by the corresponding elements <code>[s1_i, s2_i, ..., sn_i]</code> at each index <code>i</code>. The returned map keys are these tuples, and values are their frequencies.</p>
<p>Parameters:</p>
<ul>
<li><code>seqs</code> (one or more sequences): The input sequences. All sequences should ideally have the same length, as elements are paired by index.</li>
</ul>
<p>Returns a map where keys represent unique combinations of values (or single values if only one sequence is input) and values are the counts of these combinations.</p>
<p>See also <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>, <a href="#LOS-contingency-table-%3Emarginals">contingency-table-&gt;marginals</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3474">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-contingency-table->marginals"></span>
</section>
<section id="contingency-table-marginals" class="level4">
<h4 class="anchored" data-anchor-id="contingency-table-marginals">contingency-table-&gt;marginals</h4>
<ul>
<li><code>(contingency-table-&gt;marginals ct)</code></li>
</ul>
<p>Calculates marginal sums (row and column totals) and the grand total from a contingency table.</p>
<p>A contingency table represents the frequency distribution of observations for two or more categorical variables. This function summarizes these frequencies along the rows and columns.</p>
<p>The function accepts two main input formats for the contingency table:</p>
<ol type="1">
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] 10, [0 1] 5, [1 0] 3, [1 1] 12}</code>). This format is produced by <a href="#LOS-contingency-table">contingency-table</a> when given multiple sequences or by <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>.</li>
<li>A sequence of sequences representing the rows of the table, where each inner sequence contains counts for the columns in that row (e.g., <code>[10 5] [3 12](#LOS-10 5] [3 12)</code>). The function internally converts this format to the map format.</li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>ct</code> (map or sequence of sequences): The contingency table input.</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:rows</code>: A sequence of <code>[row-index, row-total]</code> pairs.</li>
<li><code>:cols</code>: A sequence of <code>[column-index, column-total]</code> pairs.</li>
<li><code>:n</code>: The grand total of all counts in the table.</li>
<li><code>:diag</code>: A sequence of <code>[[index, index], count]</code> pairs for cells on the diagonal (where row index equals column index). This is useful for square tables like confusion matrices.</li>
</ul>
<p>See also <a href="#LOS-contingency-table">contingency-table</a>, <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3540">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-correlation"></span>
</section>
<section id="correlation" class="level4">
<h4 class="anchored" data-anchor-id="correlation">correlation</h4>
<ul>
<li><code>(correlation [vs1 vs2])</code></li>
<li><code>(correlation vs1 vs2)</code></li>
</ul>
<p>Calculates the correlation coefficient between two sequences.</p>
<p>By default, this function calculates the Pearson product-moment correlation coefficient, which measures the linear relationship between two datasets.</p>
<p>This function handles the standard deviation normalization based on whether the inputs <code>vs1</code> and <code>vs2</code> are treated as samples or populations (it uses sample standard deviation derived from <a href="#LOS-variance">variance</a>).</p>
<p>Parameters:</p>
<ul>
<li><code>[vs1 vs2]</code> (sequence of two sequences): A sequence containing the two sequences of numbers.</li>
<li><code>vs1</code>, <code>vs2</code> (sequences): The two sequences of numbers directly as arguments.</li>
</ul>
<p>Both sequences must have the same length.</p>
<p>Returns the calculated correlation coefficient (a value between -1.0 and 1.0) as a double. Returns <code>NaN</code> if one or both sequences have zero variance (are constant).</p>
<p>See also <a href="#LOS-covariance">covariance</a>, <a href="#LOS-pearson-correlation">pearson-correlation</a>, <a href="#LOS-spearman-correlation">spearman-correlation</a>, <a href="#LOS-kendall-correlation">kendall-correlation</a>, <a href="#LOS-correlation-matrix">correlation-matrix</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1590">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-correlation-matrix"></span>
</section>
<section id="correlation-matrix" class="level4">
<h4 class="anchored" data-anchor-id="correlation-matrix">correlation-matrix</h4>
<ul>
<li><code>(correlation-matrix vss)</code></li>
<li><code>(correlation-matrix vss measure)</code></li>
</ul>
<p>Generates a matrix of pairwise correlation coefficients from a sequence of sequences.</p>
<p>Given a collection of data sequences <code>vss</code>, where each inner sequence represents a variable, this function calculates a square matrix where the element at row <code>i</code> and column <code>j</code> is the correlation coefficient between the <code>i</code>-th and <code>j</code>-th sequences in <code>vss</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vss</code> (sequence of sequences of numbers): The collection of data sequences. Each inner sequence is treated as a variable. All inner sequences must have the same length.</li>
<li><code>measure</code> (keyword, optional): Specifies the type of correlation coefficient to calculate. Defaults to <code>:pearson</code>.
<ul>
<li><code>:pearson</code> (default): Calculates the Pearson product-moment correlation coefficient.</li>
<li><code>:kendall</code>: Calculates Kendall’s Tau rank correlation coefficient.</li>
<li><code>:spearman</code>: Calculates Spearman’s rank correlation coefficient.</li>
</ul></li>
</ul>
<p>Returns a sequence of sequences (a matrix) of doubles representing the correlation matrix. The matrix is symmetric, as correlation is a symmetric measure.</p>
<p>See also <a href="#LOS-pearson-correlation">pearson-correlation</a>, <a href="#LOS-spearman-correlation">spearman-correlation</a>, <a href="#LOS-kendall-correlation">kendall-correlation</a>, <a href="#LOS-covariance-matrix">covariance-matrix</a>, <a href="#LOS-coefficient-matrix">coefficient-matrix</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1759">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-count="></span>
</section>
<section id="count" class="level4">
<h4 class="anchored" data-anchor-id="count">count=</h4>
<ul>
<li><code>(count= [vs1 vs2-or-val])</code></li>
<li><code>(count= vs1 vs2-or-val)</code></li>
</ul>
<p>Count equal values in both seqs. Same as <a href="#LOS-L0">L0</a></p>
<p>Calculates the number of pairs of corresponding elements that are equal between two sequences, or between a sequence and a single scalar value.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence.</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence of numbers, or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the count of equal elements as a long integer.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2043">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-covariance"></span>
</section>
<section id="covariance" class="level4">
<h4 class="anchored" data-anchor-id="covariance">covariance</h4>
<ul>
<li><code>(covariance [vs1 vs2])</code></li>
<li><code>(covariance vs1 vs2)</code></li>
</ul>
<p>Covariance of two sequences.</p>
<p>This function calculates the <em>sample</em> covariance.</p>
<p>Parameters:</p>
<ul>
<li><code>[vs1 vs2]</code> (sequence of two sequences): A sequence containing the two sequences of numbers.</li>
<li><code>vs1</code>, <code>vs2</code> (sequences): The two sequences of numbers directly as arguments.</li>
</ul>
<p>Both sequences must have the same length.</p>
<p>Returns the calculated sample covariance as a double.</p>
<p>See also <a href="#LOS-correlation">correlation</a>, <a href="#LOS-covariance-matrix">covariance-matrix</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1567">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-covariance-matrix"></span>
</section>
<section id="covariance-matrix" class="level4">
<h4 class="anchored" data-anchor-id="covariance-matrix">covariance-matrix</h4>
<ul>
<li><code>(covariance-matrix vss)</code></li>
</ul>
<p>Generates a matrix of pairwise covariance coefficients from a sequence of sequences.</p>
<p>Given a collection of data sequences <code>vss</code>, where each inner sequence represents a variable, this function calculates a square matrix where the element at row <code>i</code> and column <code>j</code> is the sample covariance between the <code>i</code>-th and <code>j</code>-th sequences in <code>vss</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vss</code> (sequence of sequences of numbers): The collection of data sequences. Each inner sequence is treated as a variable. All inner sequences must have the same length.</li>
</ul>
<p>Returns a sequence of sequences (a matrix) of doubles representing the covariance matrix. The matrix is symmetric, as covariance is a symmetric measure (<span class="math inline">\(Cov(X,Y) = Cov(Y,X)\)</span>).</p>
<p>Internally uses <a href="#LOS-coefficient-matrix">coefficient-matrix</a> with the <a href="#LOS-covariance">covariance</a> function and <code>symmetric?</code> set to <code>true</code>.</p>
<p>See also <a href="#LOS-covariance">covariance</a>, <a href="#LOS-correlation-matrix">correlation-matrix</a>, <a href="#LOS-coefficient-matrix">coefficient-matrix</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1789">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cramers-c"></span>
</section>
<section id="cramers-c" class="level4">
<h4 class="anchored" data-anchor-id="cramers-c">cramers-c</h4>
<ul>
<li><code>(cramers-c group1 group2)</code></li>
<li><code>(cramers-c contingency-table)</code></li>
</ul>
<p>Calculates Cramer’s C, a measure of association (effect size) between two nominal variables represented in a contingency table.</p>
<p>Its value ranges from 0 to 1, where 0 indicates no association and 1 indicates a perfect association. It is particularly useful for tables larger than 2x2.</p>
<p>The function can be called in two ways:</p>
<ol type="1">
<li>With two sequences <code>group1</code> and <code>group2</code>: The function will automatically construct a contingency table from the unique values in the sequences.</li>
<li>With a contingency table: The contingency table can be provided as:
<ul>
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] 10, [0 1] 5, [1 0] 3, [1 1] 12}</code>). This is the output format of <a href="#LOS-contingency-table">contingency-table</a> with two inputs.</li>
<li>A sequence of sequences representing the rows of the table (e.g., <code>[10 5] [3 12](#LOS-10 5] [3 12)</code>). This is equivalent to <code>rows-&gt;contingency-table</code>.</li>
</ul></li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (sequence): The first sequence of categorical data.</li>
<li><code>group2</code> (sequence): The second sequence of categorical data. Must have the same length as <code>group1</code>.</li>
<li><code>contingency-table</code> (map or sequence of sequences): A pre-computed contingency table.</li>
</ul>
<p>Returns the calculated Cramer’s C coefficient as a double.</p>
<p>See also <a href="#LOS-chisq-test">chisq-test</a>, <a href="#LOS-cramers-v">cramers-v</a>, <a href="#LOS-cohens-w">cohens-w</a>, <a href="#LOS-tschuprows-t">tschuprows-t</a>, <a href="#LOS-contingency-table">contingency-table</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3630">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cramers-v"></span>
</section>
<section id="cramers-v" class="level4">
<h4 class="anchored" data-anchor-id="cramers-v">cramers-v</h4>
<ul>
<li><code>(cramers-v group1 group2)</code></li>
<li><code>(cramers-v contingency-table)</code></li>
</ul>
<p>Calculates Cramer’s V, a measure of association (effect size) between two nominal variables represented in a contingency table.</p>
<p>Its value ranges from 0 to 1, where 0 indicates no association and 1 indicates a perfect association. It is related to the Pearson’s Chi-squared statistic and is useful for tables of any size.</p>
<p>The function can be called in two ways:</p>
<ol type="1">
<li>With two sequences <code>group1</code> and <code>group2</code>: The function will automatically construct a contingency table from the unique values in the sequences.</li>
<li>With a contingency table: The contingency table can be provided as:
<ul>
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] 10, [0 1] 5, [1 0] 3, [1 1] 12}</code>). This is the output format of <a href="#LOS-contingency-table">contingency-table</a> with two inputs.</li>
<li>A sequence of sequences representing the rows of the table (e.g., <code>[10 5] [3 12](#LOS-10 5] [3 12)</code>). This is equivalent to <code>rows-&gt;contingency-table</code>.</li>
</ul></li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (sequence): The first sequence of categorical data.</li>
<li><code>group2</code> (sequence): The second sequence of categorical data. Must have the same length as <code>group1</code>.</li>
<li><code>contingency-table</code> (map or sequence of sequences): A pre-computed contingency table.</li>
</ul>
<p>Returns the calculated Cramer’s V coefficient as a double.</p>
<p>See also <a href="#LOS-chisq-test">chisq-test</a>, <a href="#LOS-cramers-c">cramers-c</a>, <a href="#LOS-cohens-w">cohens-w</a>, <a href="#LOS-tschuprows-t">tschuprows-t</a>, <a href="#LOS-contingency-table">contingency-table</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3664">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cramers-v-corrected"></span>
</section>
<section id="cramers-v-corrected" class="level4">
<h4 class="anchored" data-anchor-id="cramers-v-corrected">cramers-v-corrected</h4>
<ul>
<li><code>(cramers-v-corrected group1 group2)</code></li>
<li><code>(cramers-v-corrected contingency-table)</code></li>
</ul>
<p>Calculates the <strong>corrected Cramer’s V</strong>, a measure of association (effect size) between two nominal variables represented in a contingency table, with a correction to reduce bias, particularly for small sample sizes or tables with many cells having small expected counts.</p>
<p>Like the uncorrected Cramer’s V (<a href="#LOS-cramers-v">cramers-v</a>), its value ranges from 0 to 1, where 0 indicates no association and 1 indicates a perfect association. The correction tends to yield a value closer to the true population value in biased situations.</p>
<p>The function can be called in two ways:</p>
<ol type="1">
<li>With two sequences <code>group1</code> and <code>group2</code>: The function will automatically construct a contingency table from the unique values in the sequences.</li>
<li>With a contingency table: The contingency table can be provided as:
<ul>
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] 10, [0 1] 5, [1 0] 3, [1 1] 12}</code>). This is the output format of <a href="#LOS-contingency-table">contingency-table</a> with two inputs.</li>
<li>A sequence of sequences representing the rows of the table (e.g., <code>[10 5] [3 12](#LOS-10 5] [3 12)</code>). This is equivalent to <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>.</li>
</ul></li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (sequence): The first sequence of categorical data.</li>
<li><code>group2</code> (sequence): The second sequence of categorical data. Must have the same length as <code>group1</code>.</li>
<li><code>contingency-table</code> (map or sequence of sequences): A pre-computed contingency table.</li>
</ul>
<p>Returns the calculated corrected Cramer’s V coefficient as a double.</p>
<p>See also <a href="#LOS-chisq-test">chisq-test</a>, <a href="#LOS-cramers-v">cramers-v</a> (uncorrected), <a href="#LOS-cramers-c">cramers-c</a>, <a href="#LOS-cohens-w">cohens-w</a>, <a href="#LOS-tschuprows-t">tschuprows-t</a>, <a href="#LOS-contingency-table">contingency-table</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3700">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-cressie-read-test"></span>
</section>
<section id="cressie-read-test" class="level4">
<h4 class="anchored" data-anchor-id="cressie-read-test">cressie-read-test</h4>
<ul>
<li><code>(cressie-read-test contingency-table-or-xs)</code></li>
<li><code>(cressie-read-test contingency-table-or-xs params)</code></li>
</ul>
<p>Cressie-Read test, a power divergence test for <code>lambda</code> 2/3</p>
<p>Performs a power divergence test, which encompasses several common statistical tests like Chi-squared, G-test (likelihood ratio), etc., based on the lambda parameter. This function can perform either a goodness-of-fit test or a test for independence in a contingency table.</p>
<p>Usage:</p>
<ol type="1">
<li><strong>Goodness-of-Fit (GOF):</strong>
<ul>
<li>Input: <code>observed-counts</code> (sequence of numbers) and <code>:p</code> (expected probabilities/weights).</li>
<li>Input: <code>data</code> (sequence of numbers) and <code>:p</code> (a distribution object). In this case, a histogram of <code>data</code> is created (controlled by <code>:bins</code>) and compared against the probability mass/density of the distribution in those bins.</li>
</ul></li>
<li><strong>Test for Independence:</strong>
<ul>
<li>Input: <code>contingency-table</code> (2D sequence or map format). The <code>:p</code> option is ignored.</li>
</ul></li>
</ol>
<p>Options map:</p>
<ul>
<li><code>:lambda</code> (double, default: <code>2/3</code>): Determines the specific test statistic. Common values:
<ul>
<li><code>1.0</code>: Pearson Chi-squared test (<a href="#LOS-chisq-test">chisq-test</a>).</li>
<li><code>0.0</code>: G-test / Multinomial Likelihood Ratio test (<a href="#LOS-multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</a>).</li>
<li><code>-0.5</code>: Freeman-Tukey test (<a href="#LOS-freeman-tukey-test">freeman-tukey-test</a>).</li>
<li><code>-1.0</code>: Minimum Discrimination Information test (<a href="#LOS-minimum-discrimination-information-test">minimum-discrimination-information-test</a>).</li>
<li><code>-2.0</code>: Neyman Modified Chi-squared test (<a href="#LOS-neyman-modified-chisq-test">neyman-modified-chisq-test</a>).</li>
<li><code>2/3</code>: Cressie-Read test (default, <a href="#LOS-cressie-read-test">cressie-read-test</a>).</li>
</ul></li>
<li><code>:p</code> (seq of numbers or distribution): Expected probabilities/weights (for GOF with counts) or a <code>fastmath.random</code> distribution object (for GOF with data). Ignored for independence tests.</li>
<li><code>:alpha</code> (double, default: <code>0.05</code>): Significance level for confidence intervals.</li>
<li><code>:ci-sides</code> (keyword, default: <code>:two-sided</code>): Sides for bootstrap confidence intervals (<code>:two-sided</code>, <code>:one-sided-greater</code>, <code>:one-sided-less</code>).</li>
<li><code>:sides</code> (keyword, default: <code>:one-sided-greater</code>): Alternative hypothesis side for the p-value calculation against the Chi-squared distribution (<code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>).</li>
<li><code>:bootstrap-samples</code> (long, default: <code>1000</code>): Number of bootstrap samples for confidence interval estimation.</li>
<li><code>:ddof</code> (long, default: <code>0</code>): Delta degrees of freedom. Adjustment subtracted from the calculated degrees of freedom.</li>
<li><code>:bins</code> (number, keyword, or seq): Used only for GOF test against a distribution. Specifies the number of bins, an estimation method (see <a href="#LOS-histogram">histogram</a>), or explicit bin edges for histogram creation.</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:stat</code>: The calculated power divergence test statistic.</li>
<li><code>:chi2</code>: Alias for <code>:stat</code>.</li>
<li><code>:df</code>: Degrees of freedom for the test.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic.</li>
<li><code>:n</code>: Total number of observations.</li>
<li><code>:estimate</code>: Observed proportions.</li>
<li><code>:expected</code>: Expected counts or proportions under the null hypothesis.</li>
<li><code>:confidence-interval</code>: Bootstrap confidence intervals for the observed proportions.</li>
<li><code>:lambda</code>, <code>:alpha</code>, <code>:sides</code>, <code>:ci-sides</code>: Input options used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5763">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-demean"></span>
</section>
<section id="demean" class="level4">
<h4 class="anchored" data-anchor-id="demean">demean</h4>
<ul>
<li><code>(demean vs)</code></li>
</ul>
<p>Subtract mean from a sequence</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1550">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-dissimilarity"></span>
</section>
<section id="dissimilarity" class="level4">
<h4 class="anchored" data-anchor-id="dissimilarity">dissimilarity</h4>
<ul>
<li><code>(dissimilarity method P-observed Q-expected)</code></li>
<li><code>(dissimilarity method P-observed Q-expected {:keys [bins probabilities? epsilon log-base power remove-zeros?], :or {probabilities? true, epsilon 1.0E-6, log-base m/E, power 2.0}})</code></li>
</ul>
<p>Various PDF distance between two histograms (frequencies) or probabilities.</p>
<p>Q can be a distribution object. Then, histogram will be created out of P.</p>
<p>Arguments:</p>
<ul>
<li><code>method</code> - distance method</li>
<li><code>P-observed</code> - frequencies, probabilities or actual data (when Q is a distribution of <code>:bins</code> is set)</li>
<li><code>Q-expected</code> - frequencies, probabilities or distribution object (when P is a data or <code>:bins</code> is set)</li>
</ul>
<p>Options:</p>
<ul>
<li><code>:probabilities?</code> - should P/Q be converted to a probabilities, default: <code>true</code>.</li>
<li><code>:epsilon</code> - small number which replaces <code>0.0</code> when division or logarithm is used`</li>
<li><code>:log-base</code> - base for logarithms, default: <code>e</code></li>
<li><code>:power</code> - exponent for <code>:minkowski</code> distance, default: <code>2.0</code></li>
<li><code>:bins</code> - number of bins or bins estimation method, see <a href="#LOS-histogram">histogram</a>.</li>
</ul>
<p>The list of methods: <code>:euclidean</code>, <code>:city-block</code>, <code>:manhattan</code>, <code>:chebyshev</code>, <code>:minkowski</code>, <code>:sorensen</code>, <code>:gower</code>, <code>:soergel</code>, <code>:kulczynski</code>, <code>:canberra</code>, <code>:lorentzian</code>, <code>:non-intersection</code>, <code>:wave-hedges</code>, <code>:czekanowski</code>, <code>:motyka</code>, <code>:tanimoto</code>, <code>:jaccard</code>, <code>:dice</code>, <code>:bhattacharyya</code>, <code>:hellinger</code>, <code>:matusita</code>, <code>:squared-chord</code>, <code>:euclidean-sq</code>, <code>:squared-euclidean</code>, <code>:pearson-chisq</code>, <code>:chisq</code>, <code>:neyman-chisq</code>, <code>:squared-chisq</code>, <code>:symmetric-chisq</code>, <code>:divergence</code>, <code>:clark</code>, <code>:additive-symmetric-chisq</code>, <code>:kullback-leibler</code>, <code>:jeffreys</code>, <code>:k-divergence</code>, <code>:topsoe</code>, <code>:jensen-shannon</code>, <code>:jensen-difference</code>, <code>:taneja</code>, <code>:kumar-johnson</code>, <code>:avg</code></p>
<p>See more: Comprehensive Survey on Distance/Similarity Measures between Probability Density Functions by Sung-Hyuk Cha</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2376">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-durbin-watson"></span>
</section>
<section id="durbin-watson" class="level4">
<h4 class="anchored" data-anchor-id="durbin-watson">durbin-watson</h4>
<ul>
<li><code>(durbin-watson rs)</code></li>
</ul>
<p>Calculates the Durbin-Watson statistic (d) for a sequence of residuals.</p>
<p>This statistic is used to test for the presence of serial correlation, especially first-order (lag-1) autocorrelation, in the residuals from a regression analysis. Autocorrelation violates the assumption of independent errors.</p>
<p>Parameters:</p>
<ul>
<li><code>rs</code> (sequence of numbers): The sequence of residuals from a regression model. The sequence should represent observations ordered by time or sequence index.</li>
</ul>
<p>Returns the calculated Durbin-Watson statistic as a double. The value ranges from 0 to 4.</p>
<p>Interpretation:</p>
<ul>
<li>Values near 2 suggest no first-order autocorrelation.</li>
<li>Values less than 2 suggest positive autocorrelation (residuals tend to be followed by residuals of the same sign).</li>
<li>Values greater than 2 suggest negative autocorrelation (residuals tend to be followed by residuals of the opposite sign).</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3962">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-epsilon-sq"></span>
</section>
<section id="epsilon-sq" class="level4">
<h4 class="anchored" data-anchor-id="epsilon-sq">epsilon-sq</h4>
<ul>
<li><code>(epsilon-sq [group1 group2])</code></li>
<li><code>(epsilon-sq group1 group2)</code></li>
</ul>
<p>Calculates Epsilon squared (ε²), an effect size measure for the simple linear regression of <code>group1</code> on <code>group2</code>.</p>
<p>Epsilon squared estimates the proportion of variance in the dependent variable (<code>group1</code>) that is accounted for by the independent variable (<code>group2</code>) in the population. It is considered a less biased alternative to the sample R-squared (<a href="#LOS-r2-determination">r2-determination</a>).</p>
<p>The calculation is based on the sums of squares from the simple linear regression of <code>group1</code> on <code>group2</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The dependent variable.</li>
<li><code>group2</code> (seq of numbers): The independent variable. Must have the same length as <code>group1</code>.</li>
</ul>
<p>Returns the calculated Epsilon squared value as a double. The value typically ranges from 0.0 to 1.0.</p>
<p>Interpretation:</p>
<ul>
<li>0.0 indicates that <code>group2</code> explains none of the variance in <code>group1</code> in the population.</li>
<li>1.0 indicates that <code>group2</code> perfectly explains the variance in <code>group1</code> in the population.</li>
</ul>
<p>Note: While often presented in the context of ANOVA, this implementation applies the formula to the sums of squares obtained from a simple linear regression between the two sequences.</p>
<p>See also <a href="#LOS-eta-sq">eta-sq</a> (Eta-squared, often based on <span class="math inline">\(R^2\)</span>), <a href="#LOS-omega-sq">omega-sq</a> (another adjusted R²-like measure), <a href="#LOS-r2-determination">r2-determination</a> (R-squared).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3261">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-estimate-bins"></span>
</section>
<section id="estimate-bins" class="level4">
<h4 class="anchored" data-anchor-id="estimate-bins">estimate-bins</h4>
<ul>
<li><code>(estimate-bins vs)</code></li>
<li><code>(estimate-bins vs bins-or-estimate-method)</code></li>
</ul>
<p>Estimate number of bins for histogram.</p>
<p>Possible methods are: <code>:sqrt</code> <code>:sturges</code> <code>:rice</code> <code>:doane</code> <code>:scott</code> <code>:freedman-diaconis</code> (default).</p>
<p>The number returned is not higher than number of samples.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2204">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-estimation-strategies-list"></span>
</section>
<section id="estimation-strategies-list" class="level4">
<h4 class="anchored" data-anchor-id="estimation-strategies-list">estimation-strategies-list</h4>
<p>List of estimation strategies for <a href="#LOS-percentile">percentile</a>/<a href="#LOS-quantile">quantile</a> functions.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L87">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-eta-sq"></span>
</section>
<section id="eta-sq" class="level4">
<h4 class="anchored" data-anchor-id="eta-sq">eta-sq</h4>
<ul>
<li><code>(eta-sq [group1 group2])</code></li>
<li><code>(eta-sq group1 group2)</code></li>
</ul>
<p>Calculates a measure of association between two sequences, named <code>eta-sq</code> (Eta-squared).</p>
<p><em>Note</em>: The current implementation calculates the R-squared coefficient of determination from a simple linear regression where the first input sequence (<code>group1</code>) is treated as the dependent variable and the second (<code>group2</code>) as the independent variable. In this context, it quantifies the proportion of the variance in <code>group1</code> that is linearly predictable from <code>group2</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sequence (treated as dependent variable).</li>
<li><code>group2</code> (seq of numbers): The second sequence (treated as independent variable).</li>
</ul>
<p>Returns the calculated R-squared value as a double [0.0, 1.0].</p>
<p>Interpretation:</p>
<ul>
<li>0.0 indicates that <code>group2</code> explains none of the variance in <code>group1</code> linearly.</li>
<li>1.0 indicates that <code>group2</code> linearly explains all the variance in <code>group1</code>.</li>
</ul>
<p>While Eta-squared (<span class="math inline">\(\eta^2\)</span>) is commonly used in ANOVA to quantify the proportion of variance in a dependent variable explained by group membership, this function’s calculation method differs from the standard ANOVA <span class="math inline">\(\eta^2\)</span> unless <code>group2</code> explicitly represents numeric codes for two groups.</p>
<p>See also <a href="#LOS-r2-determination">r2-determination</a> (which is equivalent to this function), <a href="#LOS-pearson-correlation">pearson-correlation</a>, <a href="#LOS-omega-sq">omega-sq</a>, <a href="#LOS-epsilon-sq">epsilon-sq</a>, <a href="#LOS-one-way-anova-test">one-way-anova-test</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3204">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-expectile"></span>
</section>
<section id="expectile-1" class="level4">
<h4 class="anchored" data-anchor-id="expectile-1">expectile</h4>
<ul>
<li><code>(expectile vs tau)</code></li>
<li><code>(expectile vs weights tau)</code></li>
</ul>
<p>Calculate the tau-th expectile of a sequence <code>vs</code>.</p>
<p>Expectiles are related to quantiles but are determined by minimizing an asymmetrically weighted sum of squared differences, rather than absolute differences. The <code>tau</code> parameter controls the asymmetry.</p>
<p>A key property is that the expectile for <code>tau = 0.5</code> is equal to the <a href="#LOS-mean">mean</a>.</p>
<p>The calculation involves finding the value <code>t</code> such that the weighted sum of <code>w_i * (v_i - t)</code> is zero, where the effective weights depend on <code>tau</code> and whether <code>v_i</code> is above or below <code>t</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of data values.</li>
<li><code>weights</code> (optional): Sequence of corresponding non-negative weights. Must have the same count as <code>vs</code>. If omitted, calculates the unweighted expectile.</li>
<li><code>tau</code>: The expectile level, a value between 0.0 and 1.0 (inclusive).</li>
</ul>
<p>Returns the calculated expectile as a double.</p>
<p>See also <a href="#LOS-quantile">quantile</a>, <a href="#LOS-mean">mean</a>, <a href="#LOS-median">median</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1122">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-extent"></span>
</section>
<section id="extent" class="level4">
<h4 class="anchored" data-anchor-id="extent">extent</h4>
<ul>
<li><code>(extent vs)</code></li>
<li><code>(extent vs mean?)</code></li>
</ul>
<p>Return extent (min, max, mean) values from sequence. Mean is optional (default: true)</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L821">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-f-test"></span>
</section>
<section id="f-test" class="level4">
<h4 class="anchored" data-anchor-id="f-test">f-test</h4>
<ul>
<li><code>(f-test xs ys)</code></li>
<li><code>(f-test xs ys {:keys [sides alpha], :or {sides :two-sided, alpha 0.05}})</code></li>
</ul>
<p>Performs an F-test to compare the variances of two independent samples.</p>
<p>The test assesses the null hypothesis that the variances of the populations from which <code>xs</code> and <code>ys</code> are drawn are equal.</p>
<p>Assumes independence of samples. The test is sensitive to departures from the assumption that both populations are normally distributed.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The first sample.</li>
<li><code>ys</code> (seq of numbers): The second sample.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis regarding the ratio of variances (Var(xs) / Var(ys)).
<ul>
<li><code>:two-sided</code> (default): Variances are not equal (ratio != 1).</li>
<li><code>:one-sided-greater</code>: Variance of <code>xs</code> is greater than variance of <code>ys</code> (ratio &gt; 1).</li>
<li><code>:one-sided-less</code>: Variance of <code>xs</code> is less than variance of <code>ys</code> (ratio &lt; 1).</li>
</ul></li>
<li><code>:alpha</code> (double, default <code>0.05</code>): Significance level for the confidence interval.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:F</code>: The calculated F-statistic (ratio of sample variances: Var(xs) / Var(ys)).</li>
<li><code>:stat</code>: Alias for <code>:F</code>.</li>
<li><code>:estimate</code>: Alias for <code>:F</code>, representing the estimated ratio of variances.</li>
<li><code>:df</code>: Degrees of freedom as <code>[numerator-df, denominator-df]</code>, corresponding to <code>[(count xs)-1, (count ys)-1]</code>.</li>
<li><code>:n</code>: Sample sizes as <code>[count xs, count ys]</code>.</li>
<li><code>:nx</code>: Sample size of <code>xs</code>.</li>
<li><code>:ny</code>: Sample size of <code>ys</code>.</li>
<li><code>:sides</code>: The alternative hypothesis side used (<code>:two-sided</code>, <code>:one-sided-greater</code>, or <code>:one-sided-less</code>).</li>
<li><code>:test-type</code>: Alias for <code>:sides</code>.</li>
<li><code>:p-value</code>: The p-value associated with the F-statistic and the specified <code>:sides</code>.</li>
<li><code>:confidence-interval</code>: A confidence interval for the true ratio of the population variances (Var(xs) / Var(ys)).</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5541">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-fligner-killeen-test"></span>
</section>
<section id="fligner-killeen-test" class="level4">
<h4 class="anchored" data-anchor-id="fligner-killeen-test">fligner-killeen-test</h4>
<ul>
<li><code>(fligner-killeen-test xss)</code></li>
<li><code>(fligner-killeen-test xss {:keys [sides], :or {sides :one-sided-greater}})</code></li>
</ul>
<p>Performs the Fligner-Killeen test for homogeneity of variances across two or more groups.</p>
<p>The Fligner-Killeen test is a non-parametric test that assesses the null hypothesis that the variances of the groups are equal. It is robust against departures from normality. The test is based on ranks of the absolute deviations from the group medians.</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences): A collection where each element is a sequence representing a group of observations.</li>
<li><code>params</code> (map, optional): Options map with the following key:
<ul>
<li><code>:sides</code> (keyword, default <code>:one-sided-greater</code>): Alternative hypothesis side for the Chi-squared test. Possible values: <code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:chi2</code>: The Fligner-Killeen test statistic (Chi-squared value).</li>
<li><code>:stat</code>: Alias for <code>:chi2</code>.</li>
<li><code>:p-value</code>: The p-value for the test.</li>
<li><code>:df</code>: Degrees of freedom for the test (number of groups - 1).</li>
<li><code>:n</code>: Sequence of sample sizes for each group.</li>
<li><code>:SSt</code>: Sum of squares between groups (treatment) based on transformed ranks.</li>
<li><code>:SSe</code>: Sum of squares within groups (error) based on transformed ranks.</li>
<li><code>:DFt</code>: Degrees of freedom between groups.</li>
<li><code>:DFe</code>: Degrees of freedom within groups.</li>
<li><code>:MSt</code>: Mean square between groups.</li>
<li><code>:MSe</code>: Mean square within groups.</li>
<li><code>:sides</code>: Test side used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5893">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-freeman-tukey-test"></span>
</section>
<section id="freeman-tukey-test" class="level4">
<h4 class="anchored" data-anchor-id="freeman-tukey-test">freeman-tukey-test</h4>
<ul>
<li><code>(freeman-tukey-test contingency-table-or-xs)</code></li>
<li><code>(freeman-tukey-test contingency-table-or-xs params)</code></li>
</ul>
<p>Freeman-Tukey test, a power divergence test for <code>lambda</code> -0.5</p>
<p>Performs a power divergence test, which encompasses several common statistical tests like Chi-squared, G-test (likelihood ratio), etc., based on the lambda parameter. This function can perform either a goodness-of-fit test or a test for independence in a contingency table.</p>
<p>Usage:</p>
<ol type="1">
<li><strong>Goodness-of-Fit (GOF):</strong>
<ul>
<li>Input: <code>observed-counts</code> (sequence of numbers) and <code>:p</code> (expected probabilities/weights).</li>
<li>Input: <code>data</code> (sequence of numbers) and <code>:p</code> (a distribution object). In this case, a histogram of <code>data</code> is created (controlled by <code>:bins</code>) and compared against the probability mass/density of the distribution in those bins.</li>
</ul></li>
<li><strong>Test for Independence:</strong>
<ul>
<li>Input: <code>contingency-table</code> (2D sequence or map format). The <code>:p</code> option is ignored.</li>
</ul></li>
</ol>
<p>Options map:</p>
<ul>
<li><code>:lambda</code> (double, default: <code>2/3</code>): Determines the specific test statistic. Common values:
<ul>
<li><code>1.0</code>: Pearson Chi-squared test (<a href="#LOS-chisq-test">chisq-test</a>).</li>
<li><code>0.0</code>: G-test / Multinomial Likelihood Ratio test (<a href="#LOS-multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</a>).</li>
<li><code>-0.5</code>: Freeman-Tukey test (<a href="#LOS-freeman-tukey-test">freeman-tukey-test</a>).</li>
<li><code>-1.0</code>: Minimum Discrimination Information test (<a href="#LOS-minimum-discrimination-information-test">minimum-discrimination-information-test</a>).</li>
<li><code>-2.0</code>: Neyman Modified Chi-squared test (<a href="#LOS-neyman-modified-chisq-test">neyman-modified-chisq-test</a>).</li>
<li><code>2/3</code>: Cressie-Read test (default, <a href="#LOS-cressie-read-test">cressie-read-test</a>).</li>
</ul></li>
<li><code>:p</code> (seq of numbers or distribution): Expected probabilities/weights (for GOF with counts) or a <code>fastmath.random</code> distribution object (for GOF with data). Ignored for independence tests.</li>
<li><code>:alpha</code> (double, default: <code>0.05</code>): Significance level for confidence intervals.</li>
<li><code>:ci-sides</code> (keyword, default: <code>:two-sided</code>): Sides for bootstrap confidence intervals (<code>:two-sided</code>, <code>:one-sided-greater</code>, <code>:one-sided-less</code>).</li>
<li><code>:sides</code> (keyword, default: <code>:one-sided-greater</code>): Alternative hypothesis side for the p-value calculation against the Chi-squared distribution (<code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>).</li>
<li><code>:bootstrap-samples</code> (long, default: <code>1000</code>): Number of bootstrap samples for confidence interval estimation.</li>
<li><code>:ddof</code> (long, default: <code>0</code>): Delta degrees of freedom. Adjustment subtracted from the calculated degrees of freedom.</li>
<li><code>:bins</code> (number, keyword, or seq): Used only for GOF test against a distribution. Specifies the number of bins, an estimation method (see <a href="#LOS-histogram">histogram</a>), or explicit bin edges for histogram creation.</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:stat</code>: The calculated power divergence test statistic.</li>
<li><code>:chi2</code>: Alias for <code>:stat</code>.</li>
<li><code>:df</code>: Degrees of freedom for the test.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic.</li>
<li><code>:n</code>: Total number of observations.</li>
<li><code>:estimate</code>: Observed proportions.</li>
<li><code>:expected</code>: Expected counts or proportions under the null hypothesis.</li>
<li><code>:confidence-interval</code>: Bootstrap confidence intervals for the observed proportions.</li>
<li><code>:lambda</code>, <code>:alpha</code>, <code>:sides</code>, <code>:ci-sides</code>: Input options used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5757">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-geomean"></span>
</section>
<section id="geomean" class="level4">
<h4 class="anchored" data-anchor-id="geomean">geomean</h4>
<ul>
<li><code>(geomean vs)</code></li>
<li><code>(geomean vs weights)</code></li>
</ul>
<p>Calculates the geometric mean of a sequence <code>vs</code>.</p>
<p>The geometric mean is suitable for averaging ratios or rates of change and requires all values in the sequence to be positive. It is calculated as the n-th root of the product of n numbers.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of numbers. Non-positive values will result in <code>NaN</code> or <code>0.0</code> due to the internal use of <code>log</code>.</li>
<li><code>weights</code> (optional): Sequence of non-negative weights corresponding to <code>vs</code>. Must have the same count as <code>vs</code>.</li>
</ul>
<p>Returns the calculated geometric mean as a double.</p>
<p>See also <a href="#LOS-mean">mean</a>, <a href="#LOS-harmean">harmean</a>, <a href="#LOS-powmean">powmean</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L397">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-glass-delta"></span>
</section>
<section id="glass-delta" class="level4">
<h4 class="anchored" data-anchor-id="glass-delta">glass-delta</h4>
<ul>
<li><code>(glass-delta [group1 group2])</code></li>
<li><code>(glass-delta group1 group2)</code></li>
</ul>
<p>Calculates Glass’s delta (Δ), an effect size measure for the difference between two group means, using the standard deviation of the control group.</p>
<p>Glass’s delta is used to quantify the magnitude of the difference between an experimental group and a control group, specifically when the control group’s standard deviation is considered a better estimate of the population standard deviation than a pooled variance.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The experimental group.</li>
<li><code>group2</code> (seq of numbers): The control group.</li>
</ul>
<p>Returns the calculated Glass’s delta as a double.</p>
<p>This measure is less common than <a href="#LOS-cohens-d">cohens-d</a> or <a href="#LOS-hedges-g">hedges-g</a> but is preferred when the intervention is expected to affect the variance or when group2 (the control) is clearly the baseline against which variability should be assessed.</p>
<p>See also <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-hedges-g">hedges-g</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2751">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-harmean"></span>
</section>
<section id="harmean" class="level4">
<h4 class="anchored" data-anchor-id="harmean">harmean</h4>
<ul>
<li><code>(harmean vs)</code></li>
<li><code>(harmean vs weights)</code></li>
</ul>
<p>Calculates the harmonic mean of a sequence <code>vs</code>.</p>
<p>The harmonic mean is the reciprocal of the arithmetic mean of the reciprocals of the observations.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of numbers. Values must be non-zero.</li>
<li><code>weights</code> (optional): Sequence of non-negative weights corresponding to <code>vs</code>. Must have the same count as <code>vs</code>.</li>
</ul>
<p>Returns the calculated harmonic mean as a double.</p>
<p>See also <a href="#LOS-mean">mean</a>, <a href="#LOS-geomean">geomean</a>, <a href="#LOS-powmean">powmean</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L417">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-hedges-g"></span>
</section>
<section id="hedges-g" class="level4">
<h4 class="anchored" data-anchor-id="hedges-g">hedges-g</h4>
<ul>
<li><code>(hedges-g [group1 group2])</code></li>
<li><code>(hedges-g group1 group2)</code></li>
</ul>
<p>Calculates Hedges’s g effect size for comparing the means of two independent groups.</p>
<p>Hedges’s g is a standardized measure quantifying the magnitude of the difference between the means of two independent groups. It is similar to Cohen’s d but uses the <em>unbiased</em> pooled standard deviation in the denominator.</p>
<p>This implementation calculates g using the unbiased pooled standard deviation as the denominator.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code>, <code>group2</code> (sequences): The two independent samples directly as arguments.</li>
</ul>
<p>Returns the calculated Hedges’s g effect size as a double.</p>
<p>Note: This specific function uses the unbiased pooled standard deviation but does <em>not</em> apply the small-sample bias correction factor (often denoted as J) sometimes associated with Hedges’s g. For a bias-corrected version, see <a href="#LOS-hedges-g-corrected">hedges-g-corrected</a>. This function is equivalent to calling <code>(cohens-d group1 group2 :unbiased)</code>.</p>
<p>See also <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-hedges-g-corrected">hedges-g-corrected</a>, <a href="#LOS-glass-delta">glass-delta</a>, <a href="#LOS-pooled-stddev">pooled-stddev</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2659">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-hedges-g*"></span>
</section>
<section id="hedges-g-1" class="level4">
<h4 class="anchored" data-anchor-id="hedges-g-1">hedges-g*</h4>
<ul>
<li><code>(hedges-g* [group1 group2])</code></li>
<li><code>(hedges-g* group1 group2)</code></li>
</ul>
<p>Calculates a less biased estimate of Hedges’s g effect size for comparing the means of two independent groups, using the exact J bias correction.</p>
<p>Hedges’s g is a standardized measure of the difference between two means. For small sample sizes, the standard Hedges’s g (and Cohen’s d) can overestimate the true population effect size. This function applies a specific correction factor, often denoted as J, to mitigate this bias.</p>
<p>The calculation involves: 1. Calculating the standard Hedges’s g (equivalent to <a href="#LOS-hedges-g">hedges-g</a>, which uses the unbiased pooled standard deviation). 2. Calculating the J correction factor based on the degrees of freedom (<code>n1 + n2 - 2</code>) using the gamma function. 3. Multiplying the standard Hedges’s g by the J factor.</p>
<p>The J factor is calculated as <code>(Gamma(df/2) / (sqrt(df/2) * Gamma((df-1)/2)))</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first independent sample.</li>
<li><code>group2</code> (seq of numbers): The second independent sample.</li>
</ul>
<p>Returns the calculated bias-corrected Hedges’s g effect size as a double.</p>
<p>This version of Hedges’s g is generally preferred over the standard version or Cohen’s d when working with small sample sizes, as it provides a more accurate estimate of the population effect size.</p>
<p>Assumptions: - The two samples are independent. - Data within each group are approximately normally distributed. - Equal variances are assumed for calculating the pooled standard deviation.</p>
<p>See also <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-hedges-g">hedges-g</a> (uncorrected), <a href="#LOS-hedges-g-corrected">hedges-g-corrected</a> (another correction method).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2715">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-hedges-g-corrected"></span>
</section>
<section id="hedges-g-corrected" class="level4">
<h4 class="anchored" data-anchor-id="hedges-g-corrected">hedges-g-corrected</h4>
<ul>
<li><code>(hedges-g-corrected [group1 group2])</code></li>
<li><code>(hedges-g-corrected group1 group2)</code></li>
</ul>
<p>Calculates a small-sample bias-corrected effect size for comparing the means of two independent groups, often referred to as a form of Hedges’s g.</p>
<p>This function calculates Cohen’s d (<a href="#LOS-cohens-d">cohens-d</a>) using the <em>unbiased</em> pooled standard deviation (equivalent to <a href="#LOS-hedges-g">hedges-g</a>), and then applies a specific correction factor designed to reduce the bias in the effect size estimate for small sample sizes.</p>
<p>The correction factor applied is <code>(1 - 3 / (4 * df - 1))</code>, where <code>df</code> is the degrees of freedom for the unbiased pooled variance calculation (<code>n1 + n2 - 2</code>). This corresponds to calling <a href="#LOS-cohens-d-corrected">cohens-d-corrected</a> with the <code>:unbiased</code> method for pooled standard deviation.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first independent sample.</li>
<li><code>group2</code> (seq of numbers): The second independent sample.</li>
</ul>
<p>Returns the calculated bias-corrected effect size as a double.</p>
<p>Note: This function applies <em>a</em> correction factor. For the more standard Hedges’s g bias correction using the exact gamma function based correction factor, see <a href="#LOS-hedges-g*">hedges-g*</a>.</p>
<p>See also <a href="#LOS-cohens-d">cohens-d</a>, <a href="#LOS-cohens-d-corrected">cohens-d-corrected</a>, <a href="#LOS-hedges-g">hedges-g</a>, <a href="#LOS-hedges-g*">hedges-g*</a>, <a href="#LOS-pooled-stddev">pooled-stddev</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2684">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-histogram"></span>
</section>
<section id="histogram" class="level4">
<h4 class="anchored" data-anchor-id="histogram">histogram</h4>
<ul>
<li><code>(histogram vs)</code></li>
<li><code>(histogram vs bins-or-estimate-method)</code></li>
<li><code>(histogram vs bins-or-estimate-method [mn mx])</code></li>
<li><code>(histogram vs bins-or-estimate-method mn mx)</code></li>
</ul>
<p>Calculate histogram.</p>
<p>Estimation method can be a number, named method: <code>:sqrt</code> <code>:sturges</code> <code>:rice</code> <code>:doane</code> <code>:scott</code> <code>:freedman-diaconis</code> (default) or a sequence of points used as intervals. In the latter case or when <code>mn</code> and <code>mx</code> values are provided - data will be filtered to fit in desired interval(s).</p>
<p>Returns map with keys:</p>
<ul>
<li><code>:size</code> - number of bins</li>
<li><code>:step</code> - average distance between bins</li>
<li><code>:bins</code> - seq of pairs of range lower value and number of elements</li>
<li><code>:min</code> - min value</li>
<li><code>:max</code> - max value</li>
<li><code>:samples</code> - number of used samples</li>
<li><code>:frequencies</code> - a map containing counts for bin’s average</li>
<li><code>:intervals</code> - intervals used to create bins</li>
<li><code>:bins-maps</code> - seq of maps containing:
<ul>
<li><code>:min</code> - lower bound</li>
<li><code>:max</code> - upper bound</li>
<li><code>:step</code> - actual distance between bins</li>
<li><code>:count</code> - number of elements</li>
<li><code>:avg</code> - average value</li>
<li><code>:probability</code> - probability for bin</li>
</ul></li>
</ul>
<p>If difference between min and max values is <code>0</code>, number of bins is set to 1.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2279">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-hpdi-extent"></span>
</section>
<section id="hpdi-extent" class="level4">
<h4 class="anchored" data-anchor-id="hpdi-extent">hpdi-extent</h4>
<ul>
<li><code>(hpdi-extent vs)</code></li>
<li><code>(hpdi-extent vs size)</code></li>
</ul>
<p>Higher Posterior Density interval + median.</p>
<p><code>size</code> parameter is the target probability content of the interval.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L743">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-inner-fence-extent"></span>
</section>
<section id="inner-fence-extent" class="level4">
<h4 class="anchored" data-anchor-id="inner-fence-extent">inner-fence-extent</h4>
<ul>
<li><code>(inner-fence-extent vs)</code></li>
<li><code>(inner-fence-extent vs estimation-strategy)</code></li>
</ul>
<p>Returns LIF, UIF and median</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L799">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-iqr"></span>
</section>
<section id="iqr" class="level4">
<h4 class="anchored" data-anchor-id="iqr">iqr</h4>
<ul>
<li><code>(iqr vs)</code></li>
<li><code>(iqr vs estimation-strategy)</code></li>
</ul>
<p>Interquartile range.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L765">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-jarque-bera-test"></span>
</section>
<section id="jarque-bera-test" class="level4">
<h4 class="anchored" data-anchor-id="jarque-bera-test">jarque-bera-test</h4>
<ul>
<li><code>(jarque-bera-test xs)</code></li>
<li><code>(jarque-bera-test xs params)</code></li>
<li><code>(jarque-bera-test xs skew kurt {:keys [sides], :or {sides :one-sided-greater}})</code></li>
</ul>
<p>Performs the Jarque-Bera goodness-of-fit test to determine if sample data exhibits skewness and kurtosis consistent with a normal distribution.</p>
<p>The test assesses the null hypothesis that the data comes from a normally distributed population (i.e., population skewness is 0 and population excess kurtosis is 0).</p>
<p>The test statistic is calculated as: <code>JB = (n/6) * (S^2 + (1/4)*K^2)</code> where <code>n</code> is the sample size, <code>S</code> is the sample skewness (using <code>:g1</code> type), and <code>K</code> is the excess kurtosis <code>:g2</code>. Under the null hypothesis, the JB statistic asymptotically follows a Chi-squared distribution with 2 degrees of freedom.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data.</li>
<li><code>skew</code> (double, optional): A pre-calculated sample skewness value (type <code>:g1</code>). If omitted, it’s calculated from <code>xs</code>.</li>
<li><code>kurt</code> (double, optional): A pre-calculated sample <em>excess</em> kurtosis value (type <code>:g2</code>). If omitted, it’s calculated from <code>xs</code>.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:sides</code> (keyword, default <code>:one-sided-greater</code>): Specifies the side(s) of the Chi-squared(2) distribution used for p-value calculation.
<ul>
<li><code>:one-sided-greater</code> (default and standard for JB): Tests if the JB statistic is significantly large, indicating departure from normality.</li>
<li><code>:one-sided-less</code>: Tests if the statistic is significantly small.</li>
<li><code>:two-sided</code>: Tests if the statistic is extreme in either tail.</li>
</ul></li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:Z</code>: The calculated Jarque-Bera test statistic (labeled <code>:Z</code> for consistency, though it follows Chi-squared(2)).</li>
<li><code>:stat</code>: Alias for <code>:Z</code>.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic and <code>:sides</code>, derived from the Chi-squared(2) distribution.</li>
<li><code>:skewness</code>: The sample skewness (type <code>:g1</code>) used in the calculation.</li>
<li><code>:kurtosis</code>: The sample kurtosis (type <code>:g2</code>) used in the calculation.</li>
</ul>
<p>See also <a href="#LOS-skewness-test">skewness-test</a>, <a href="#LOS-kurtosis-test">kurtosis-test</a>, <a href="#LOS-normality-test">normality-test</a>, <a href="#LOS-bonett-seier-test">bonett-seier-test</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5059">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-jensen-shannon-divergence"></span>
</section>
<section id="jensen-shannon-divergence-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="jensen-shannon-divergence-deprecated">jensen-shannon-divergence <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use <a href="#LOS-dissimilarity">dissimilarity</a>.</em></p>
<ul>
<li><code>(jensen-shannon-divergence [vs1 vs2])</code></li>
<li><code>(jensen-shannon-divergence vs1 vs2)</code></li>
</ul>
<p>Jensen-Shannon divergence of two sequences.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1704">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-kendall-correlation"></span>
</section>
<section id="kendall-correlation" class="level4">
<h4 class="anchored" data-anchor-id="kendall-correlation">kendall-correlation</h4>
<ul>
<li><code>(kendall-correlation [vs1 vs2])</code></li>
<li><code>(kendall-correlation vs1 vs2)</code></li>
</ul>
<p>Calculates Kendall’s rank correlation coefficient (Kendall’s Tau) between two sequences.</p>
<p>Kendall’s Tau is a non-parametric statistic used to measure the ordinal association between two measured quantities. It assesses the degree of similarity between the orderings of data when ranked by each of the quantities.</p>
<p>The coefficient value ranges from -1.0 (perfect disagreement in ranking) to 1.0 (perfect agreement in ranking), with 0.0 indicating no monotonic relationship. Unlike Pearson correlation, it does not require the relationship to be linear.</p>
<p>Parameters:</p>
<ul>
<li><code>[vs1 vs2]</code> (sequence of two sequences): A sequence containing the two sequences of numbers.</li>
<li><code>vs1</code>, <code>vs2</code> (sequences): The two sequences of numbers directly as arguments.</li>
</ul>
<p>Both input sequences must contain only numbers and must have the same length.</p>
<p>Returns the calculated Kendall’s Tau coefficient as a double.</p>
<p>See also <a href="#LOS-pearson-correlation">pearson-correlation</a>, <a href="#LOS-spearman-correlation">spearman-correlation</a>, <a href="#LOS-correlation">correlation</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1670">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-kruskal-test"></span>
</section>
<section id="kruskal-test" class="level4">
<h4 class="anchored" data-anchor-id="kruskal-test">kruskal-test</h4>
<ul>
<li><code>(kruskal-test xss)</code></li>
<li><code>(kruskal-test xss {:keys [sides], :or {sides :right}})</code></li>
</ul>
<p>Performs the Kruskal-Wallis H-test (rank sum test) for independent samples.</p>
<p>The Kruskal-Wallis test is a non-parametric alternative to one-way ANOVA. It determines whether there is a statistically significant difference between the distributions of two or more independent groups. It does not assume normality but requires that distributions have a similar shape for the test to be valid.</p>
<p>Parameters:</p>
<ul>
<li><code>data-groups</code> (vector of sequences): A collection where each element is a sequence representing a group of observations.</li>
<li>a map containing <code>:sides</code> key with values of: <code>:right</code> (default), <code>:left</code> or <code>:both</code></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:stat</code>: The Kruskal-Wallis H statistic.</li>
<li><code>:n</code>: Total number of observations across all groups.</li>
<li><code>:df</code>: Degrees of freedom (number of groups - 1).</li>
<li><code>:k</code>: Number of groups.</li>
<li><code>:sides</code>: Test side</li>
<li><code>:p-value</code>: The p-value for the test (null hypothesis: all groups have the same distribution).</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6245">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ks-test-one-sample"></span>
</section>
<section id="ks-test-one-sample" class="level4">
<h4 class="anchored" data-anchor-id="ks-test-one-sample">ks-test-one-sample</h4>
<ul>
<li><code>(ks-test-one-sample xs)</code></li>
<li><code>(ks-test-one-sample xs distribution-or-ys)</code></li>
<li><code>(ks-test-one-sample xs distribution-or-ys {:keys [sides kernel bandwidth distinct?], :or {sides :two-sided, kernel :gaussian, distinct? true}})</code></li>
</ul>
<p>Performs the one-sample Kolmogorov-Smirnov (KS) test.</p>
<p>This test compares the empirical cumulative distribution function (ECDF) of a sample <code>xs</code> against a specified theoretical distribution or the ECDF of another empirical sample. It assesses the null hypothesis that <code>xs</code> is drawn from the reference distribution.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data to be tested.</li>
<li><code>distribution-or-ys</code> (optional):
<ul>
<li>A <code>fastmath.random</code> distribution object to test against. If omitted, defaults to the standard normal distribution (<code>fastmath.random/default-normal</code>).</li>
<li>A sequence of numbers (<code>ys</code>). In this case, an empirical distribution is estimated from <code>ys</code> using Kernel Density Estimation (KDE) or an enumerated distribution (see <code>:kernel</code> option).</li>
</ul></li>
<li><code>opts</code> (map, optional): Options map:
<ul>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis regarding the difference between the ECDF of <code>xs</code> and the reference CDF.
<ul>
<li><code>:two-sided</code> (default): Tests if the ECDF of <code>xs</code> is different from the reference CDF.</li>
<li><code>:right</code>: Tests if the ECDF of <code>xs</code> is significantly <em>below</em> the reference CDF (i.e., <code>xs</code> tends to have larger values, stochastically greater).</li>
<li><code>:left</code>: Tests if the ECDF of <code>xs</code> is significantly <em>above</em> the reference CDF (i.e., <code>xs</code> tends to have smaller values, stochastically smaller).</li>
</ul></li>
<li><code>:kernel</code> (keyword, default <code>:gaussian</code>): Used only when <code>distribution-or-ys</code> is a sequence. Specifies the method to estimate the empirical distribution:
<ul>
<li><code>:gaussian</code> (or other KDE kernels): Uses Kernel Density Estimation.</li>
<li><code>:enumerated</code>: Creates a discrete empirical distribution from <code>ys</code>.</li>
</ul></li>
<li><code>:bandwidth</code> (double, optional): Bandwidth for KDE (if applicable).</li>
<li><code>:distinct?</code> (boolean or keyword, default <code>true</code>): How to handle duplicate values in <code>xs</code>.
<ul>
<li><code>true</code> (default): Removes duplicate values from <code>xs</code> before computation.</li>
<li><code>false</code>: Uses all values in <code>xs</code>, including duplicates.</li>
<li><code>:jitter</code>: Adds a small amount of random noise to each value in <code>xs</code> to break ties.</li>
</ul></li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:n</code>: Sample size of <code>xs</code> (after applying <code>:distinct?</code>).</li>
<li><code>:dp</code>: Maximum positive difference (ECDF(xs) - CDF(ref)).</li>
<li><code>:dn</code>: Maximum positive difference (CDF(ref) - ECDF(xs)).</li>
<li><code>:d</code>: The KS test statistic (max absolute difference: <code>max(dp, dn)</code>).</li>
<li><code>:stat</code>: The specific statistic used for p-value calculation, depending on <code>:sides</code> (<code>d</code>, <code>dp</code>, or <code>dn</code>).</li>
<li><code>:p-value</code>: The p-value associated with the test statistic and the specified <code>:sides</code>.</li>
<li><code>:sides</code>: The alternative hypothesis side used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6028">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ks-test-two-samples"></span>
</section>
<section id="ks-test-two-samples" class="level4">
<h4 class="anchored" data-anchor-id="ks-test-two-samples">ks-test-two-samples</h4>
<ul>
<li><code>(ks-test-two-samples xs ys)</code></li>
<li><code>(ks-test-two-samples xs ys {:keys [method sides distinct? correct?], :or {sides :two-sided, distinct? :ties, correct? true}})</code></li>
</ul>
<p>Performs the two-sample Kolmogorov-Smirnov (KS) test.</p>
<p>This test compares the empirical cumulative distribution functions (ECDFs) of two independent samples, <code>xs</code> and <code>ys</code>, to assess the null hypothesis that they are drawn from the same continuous distribution.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The first sample.</li>
<li><code>ys</code> (seq of numbers): The second sample.</li>
<li><code>opts</code> (map, optional): Options map:
<ul>
<li><code>:method</code> (keyword, optional): Specifies the calculation method for the p-value.
<ul>
<li><code>:exact</code>: Attempts an exact calculation (suitable for small samples, sensitive to ties). Default if <code>nx * ny &lt; 10000</code>.</li>
<li><code>:approximate</code>: Uses the asymptotic Kolmogorov distribution (suitable for larger samples). Default otherwise.</li>
</ul></li>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis.
<ul>
<li><code>:two-sided</code> (default): Tests if the distributions differ (ECDFs are different).</li>
<li><code>:right</code>: Tests if <code>xs</code> is stochastically greater than <code>ys</code> (ECDF(xs) is below ECDF(ys)).</li>
<li><code>:left</code>: Tests if <code>xs</code> is stochastically smaller than <code>ys</code> (ECDF(xs) is above ECDF(ys)).</li>
</ul></li>
<li><code>:distinct?</code> (keyword or boolean, default <code>:ties</code>): How to handle duplicate values (ties).
<ul>
<li><code>:ties</code> (default): Includes all points. Passes information about ties to the <code>:exact</code> calculation method. Accuracy depends on the exact method’s tie handling.</li>
<li><code>:jitter</code>: Adds a small amount of random noise to break ties before comparison. A practical approach if exact tie handling is complex or not required.</li>
<li><code>true</code>: Applies <code>distinct</code> to <code>xs</code> and <code>ys</code> separately before combining. May not resolve all ties between the combined samples.</li>
<li><code>false</code>: Uses the data as-is, without attempting to handle ties explicitly (may lead to less accurate p-values, especially with the exact method).</li>
</ul></li>
<li><code>:correct?</code> (boolean, default <code>true</code>): Apply continuity correction when using the <code>:exact</code> calculation method for a more accurate p-value especially for smaller sample sizes.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:nx</code>: Number of observations in <code>xs</code> (after <code>:distinct?</code> processing if applicable).</li>
<li><code>:ny</code>: Number of observations in <code>ys</code> (after <code>:distinct?</code> processing if applicable).</li>
<li><code>:n</code>: Effective sample size used for asymptotic calculation (<code>nx*ny / (nx+ny)</code>).</li>
<li><code>:dp</code>: Maximum positive difference (ECDF(xs) - ECDF(ys)).</li>
<li><code>:dn</code>: Maximum positive difference (ECDF(ys) - ECDF(xs)).</li>
<li><code>:d</code>: The KS test statistic (max absolute difference: <code>max(dp, dn)</code>).</li>
<li><code>:stat</code>: The specific statistic used for p-value calculation (<code>d</code>, <code>dp</code>, or <code>dn</code> for exact; scaled version for approximate).</li>
<li><code>:KS</code>: Alias for <code>:stat</code>.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic and <code>:sides</code>.</li>
<li><code>:sides</code>: The alternative hypothesis side used.</li>
<li><code>:method</code>: The calculation method used (<code>:exact</code> or <code>:approximate</code>).</li>
</ul>
<p>Note on Ties: The KS test is strictly defined for continuous distributions where ties have zero probability. The presence of ties in sample data affects the p-value calculation. The <code>:distinct?</code> option provides ways to manage this, with <code>:jitter</code> being a common pragmatic choice.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6170">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-kullback-leibler-divergence"></span>
</section>
<section id="kullback-leibler-divergence-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="kullback-leibler-divergence-deprecated">kullback-leibler-divergence <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use <a href="#LOS-dissimilarity">dissimilarity</a>.</em></p>
<ul>
<li><code>(kullback-leibler-divergence [vs1 vs2])</code></li>
<li><code>(kullback-leibler-divergence vs1 vs2)</code></li>
</ul>
<p>Kullback-Leibler divergence of two sequences.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1695">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-kurtosis"></span>
</section>
<section id="kurtosis-1" class="level4">
<h4 class="anchored" data-anchor-id="kurtosis-1">kurtosis</h4>
<ul>
<li><code>(kurtosis vs)</code></li>
<li><code>(kurtosis vs typ)</code></li>
</ul>
<p>Calculates the kurtosis of a sequence, a measure of the ‘tailedness’ or ‘peakedness’ of the distribution compared to a normal distribution.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code> (seq of numbers): The input sequence.</li>
<li><code>typ</code> (keyword or sequence, optional): Specifies the type of kurtosis measure to calculate. Different types use different algorithms and may have different expected values under normality (e.g., 0 or 3). Defaults to <code>:G2</code>.</li>
</ul>
<p>Available <code>typ</code> values:</p>
<ul>
<li><code>:G2</code> (Default): Sample kurtosis based on the fourth standardized moment, as implemented by Apache Commons Math <code>Kurtosis</code>. Its value approaches 3 for a large normal sample, but the exact expected value depends on sample size.</li>
<li><code>:g2</code> or <code>:excess</code>: Sample excess kurtosis. This is calculated from <code>:G2</code> and adjusted for sample bias, such that the expected value for a normal distribution is approximately 0.</li>
<li><code>:kurt</code>: Kurtosis definition where normal = 3. Calculated as <code>:g2</code> + 3.</li>
<li><code>:b2</code>: Kurtosis defined as fourth moment divided by standard deviation to the power of 4</li>
<li><code>:geary</code>: Geary’s ‘g’, a robust measure calculated as <code>mean_abs_deviation / population_stddev</code>. Expected value for normal is <code>sqrt(2/pi) ≈ 0.798</code>. Lower values indicate leptokurtosis.</li>
<li><code>:moors</code>: Moors’ robust kurtosis measure based on octiles. The implementation returns a centered version where the expected value for normal is 0.</li>
<li><code>:crow</code>: Crow-Siddiqui robust kurtosis measure based on quantiles. The implementation returns a centered version where the expected value for normal is 0. Can accept parameters <code>alpha</code> and <code>beta</code> via sequential type <code>[:crow alpha beta]</code>.</li>
<li><code>:hogg</code>: Hogg’s robust kurtosis measure based on trimmed means. The implementation returns a centered version where the expected value for normal is 0. Can accept parameters <code>alpha</code> and <code>beta</code> via sequential type <code>[:hogg alpha beta]</code>.</li>
<li><code>:l-kurtosis</code>: L-kurtosis (τ₄), the ratio of the 4th L-moment (λ₄) to the 2nd L-moment (λ₂, L-scale). Calculated directly using <a href="#LOS-l-moment">l-moment</a> with the <code>:ratio?</code> option set to true. It’s a robust measure. Expected value for normal distribution is ≈ 0.1226.</li>
</ul>
<p>Interpretation (for excess kurtosis <code>:g2</code>):</p>
<ul>
<li>Positive values indicate a leptokurtic distribution (heavier tails, more peaked than normal).</li>
<li>Negative values indicate a platykurtic distribution (lighter tails, flatter than normal).</li>
<li>Values near 0 suggest kurtosis similar to a normal distribution.</li>
</ul>
<p>Returns the calculated kurtosis value as a double.</p>
<p>See also <a href="#LOS-kurtosis-test">kurtosis-test</a>, <a href="#LOS-bonett-seier-test">bonett-seier-test</a>, <a href="#LOS-normality-test">normality-test</a>, <a href="#LOS-jarque-bera-test">jarque-bera-test</a>, <a href="#LOS-l-moment">l-moment</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1323">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-kurtosis-test"></span>
</section>
<section id="kurtosis-test" class="level4">
<h4 class="anchored" data-anchor-id="kurtosis-test">kurtosis-test</h4>
<ul>
<li><code>(kurtosis-test xs)</code></li>
<li><code>(kurtosis-test xs params)</code></li>
<li><code>(kurtosis-test xs kurt {:keys [sides type], :or {sides :two-sided, type :kurt}})</code></li>
</ul>
<p>Performs a test for normality based on sample kurtosis.</p>
<p>This test assesses the null hypothesis that the data comes from a normally distributed population by checking if the sample kurtosis significantly deviates from the kurtosis expected under normality (approximately 3).</p>
<p>The test works by:</p>
<ol type="1">
<li>Calculating the sample kurtosis (type configurable via <code>:type</code>, default <code>:kurt</code>).</li>
<li>Standardizing the difference between the sample kurtosis and the expected kurtosis under normality using the theoretical standard error.</li>
<li>Applying a further transformation (e.g., Anscombe-Glynn/D’Agostino) to this standardized score to yield a final test statistic <code>Z</code> that more closely follows a standard normal distribution under the null hypothesis, especially for smaller sample sizes.</li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data.</li>
<li><code>kurt</code> (double, optional): A pre-calculated kurtosis value. If omitted, it’s calculated from <code>xs</code>.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis.
<ul>
<li><code>:two-sided</code> (default): The population kurtosis is different from normal.</li>
<li><code>:one-sided-greater</code>: The population kurtosis is greater than normal (leptokurtic).</li>
<li><code>:one-sided-less</code>: The population kurtosis is less than normal (platykurtic).</li>
</ul></li>
<li><code>:type</code> (keyword, default <code>:kurt</code>): The type of kurtosis to calculate if <code>kurt</code> is not provided. See <a href="#LOS-kurtosis">kurtosis</a> for options (e.g., <code>:kurt</code>, <code>:G2</code>, <code>:g2</code>).</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:Z</code>: The final test statistic, approximately standard normal under H0.</li>
<li><code>:stat</code>: Alias for <code>:Z</code>.</li>
<li><code>:p-value</code>: The p-value associated with <code>Z</code> and the specified <code>:sides</code>.</li>
<li><code>:kurtosis</code>: The sample kurtosis value used in the test (either provided or calculated).</li>
</ul>
<p>See also <a href="#LOS-skewness-test">skewness-test</a>, <a href="#LOS-normality-test">normality-test</a>, <a href="#LOS-jarque-bera-test">jarque-bera-test</a>, <a href="#LOS-bonett-seier-test">bonett-seier-test</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4947">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-l-moment"></span>
</section>
<section id="l-moment-1" class="level4">
<h4 class="anchored" data-anchor-id="l-moment-1">l-moment</h4>
<ul>
<li><code>(l-moment vs order)</code></li>
<li><code>(l-moment vs order {:keys [s t sorted? ratio?], :or {s 0, t 0}, :as opts})</code></li>
</ul>
<p>Calculates L-moment, TL-moment (trimmed) or (T)L-moment ratios.</p>
<p>Options:</p>
<ul>
<li><code>:s</code> (default: 0) - number of left trimmed values</li>
<li><code>:t</code> (default: 0) - number of right tirmmed values</li>
<li><code>:sorted?</code> (default: false) - if input is already sorted</li>
<li><code>:ratio?</code> (default: false) - normalized l-moment, l-moment ratio</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1063">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-l-variation"></span>
</section>
<section id="l-variation" class="level4">
<h4 class="anchored" data-anchor-id="l-variation">l-variation</h4>
<ul>
<li><code>(l-variation vs)</code></li>
</ul>
<p>Coefficient of L-variation, L-CV</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1101">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-levene-test"></span>
</section>
<section id="levene-test" class="level4">
<h4 class="anchored" data-anchor-id="levene-test">levene-test</h4>
<ul>
<li><code>(levene-test xss)</code></li>
<li><code>(levene-test xss {:keys [sides statistic scorediff], :or {sides :one-sided-greater, statistic mean, scorediff abs}})</code></li>
</ul>
<p>Performs Levene’s test for homogeneity of variances across two or more groups.</p>
<p>Levene’s test assesses the null hypothesis that the variances of the groups are equal. It calculates an ANOVA on the absolute deviations of the data points from their group center (mean by default).</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences): A collection where each element is a sequence representing a group of observations.</li>
<li><code>params</code> (map, optional): Options map with the following keys:
<ul>
<li><code>:sides</code> (keyword, default <code>:one-sided-greater</code>): Alternative hypothesis side for the F-test. Possible values: <code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>.</li>
<li><code>:statistic</code> (fn, default <a href="#LOS-mean">mean</a>): Function to calculate the center of each group (e.g., <a href="#LOS-mean">mean</a>, <a href="#LOS-median">median</a>). Using <a href="#LOS-median">median</a> results in the Brown-Forsythe test.</li>
<li><code>:scorediff</code> (fn, default <a href="#LOS-abs">abs</a>): Function applied to the difference between each data point and its group center (e.g., <a href="#LOS-abs">abs</a>, <a href="#LOS-sq">sq</a>).</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:W</code>: The Levene test statistic (which is an F-statistic).</li>
<li><code>:stat</code>: Alias for <code>:W</code>.</li>
<li><code>:p-value</code>: The p-value for the test.</li>
<li><code>:df</code>: Degrees of freedom for the F-statistic ([DFt, DFe]).</li>
<li><code>:n</code>: Sequence of sample sizes for each group.</li>
<li><code>:SSt</code>: Sum of squares between groups (treatment).</li>
<li><code>:SSe</code>: Sum of squares within groups (error).</li>
<li><code>:DFt</code>: Degrees of freedom between groups.</li>
<li><code>:DFe</code>: Degrees of freedom within groups.</li>
<li><code>:MSt</code>: Mean square between groups.</li>
<li><code>:MSe</code>: Mean square within groups.</li>
<li><code>:sides</code>: Test side used.</li>
</ul>
<p>See also <a href="#LOS-brown-forsythe-test">brown-forsythe-test</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5835">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mad"></span>
</section>
<section id="mad-1" class="level4">
<h4 class="anchored" data-anchor-id="mad-1">mad</h4>
<p>Alias for <a href="#LOS-median-absolute-deviation">median-absolute-deviation</a></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L622">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mad-extent"></span>
</section>
<section id="mad-extent" class="level4">
<h4 class="anchored" data-anchor-id="mad-extent">mad-extent</h4>
<ul>
<li><code>(mad-extent vs)</code></li>
</ul>
<p>-/+ median-absolute-deviation and median</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L690">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mae"></span>
</section>
<section id="mae" class="level4">
<h4 class="anchored" data-anchor-id="mae">mae</h4>
<ul>
<li><code>(mae [vs1 vs2-or-val])</code></li>
<li><code>(mae vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the Mean Absolute Error (MAE) between two sequences or a sequence and constant value.</p>
<p>MAE is a measure of the difference between two sequences of values. It quantifies the average magnitude of the errors, without considering their direction.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence (often the observed or true values).</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence (often the predicted or reference values), or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated Mean Absolute Error as a double.</p>
<p>Note: MAE is less sensitive to large outliers than metrics like Mean Squared Error (MSE) because it uses the absolute value of differences rather than the squared difference.</p>
<p>See also <a href="#LOS-me">me</a> (Mean Error), <a href="#LOS-mse">mse</a> (Mean Squared Error), <a href="#LOS-rmse">rmse</a> (Root Mean Squared Error).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1838">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mape"></span>
</section>
<section id="mape" class="level4">
<h4 class="anchored" data-anchor-id="mape">mape</h4>
<ul>
<li><code>(mape [vs1 vs2-or-val])</code></li>
<li><code>(mape vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the Mean Absolute Percentage Error (MAPE) between two sequences or a sequence and a constant value.</p>
<p>MAPE is a measure of prediction accuracy of a forecasting method, for example in time series analysis. It is calculated as the average of the absolute percentage errors.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence (conventionally, the actual or true values).</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence (conventionally, the predicted or reference values), or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated Mean Absolute Percentage Error as a double.</p>
<p>Note: MAPE is scale-independent and useful for comparing performance across different datasets. However, it is undefined if any of the actual values (<code>x_i</code>) are zero, and can be skewed by small actual values.</p>
<p>See also <a href="#LOS-me">me</a> (Mean Error), <a href="#LOS-mae">mae</a> (Mean Absolute Error), <a href="#LOS-mse">mse</a> (Mean Squared Error), <a href="#LOS-rmse">rmse</a> (Root Mean Squared Error).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1866">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-maximum"></span>
</section>
<section id="maximum" class="level4">
<h4 class="anchored" data-anchor-id="maximum">maximum</h4>
<ul>
<li><code>(maximum vs)</code></li>
</ul>
<p>Finds the maximum value in a sequence of numbers.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L80">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mcc"></span>
</section>
<section id="mcc" class="level4">
<h4 class="anchored" data-anchor-id="mcc">mcc</h4>
<ul>
<li><code>(mcc group1 group2)</code></li>
<li><code>(mcc ct)</code></li>
</ul>
<p>Calculates the Matthews Correlation Coefficient (MCC), also known as the Phi coefficient, for a 2x2 contingency table or binary classification outcomes.</p>
<p>MCC is a measure of the quality of binary classifications. It is a balanced measure which can be used even if the classes are of very different sizes. Its value ranges from -1 to +1.</p>
<ul>
<li>A coefficient of +1 represents a perfect prediction.</li>
<li>0 represents a prediction no better than random.</li>
<li>-1 represents a perfect inverse prediction.</li>
</ul>
<p>The function can be called in two ways:</p>
<ol type="1">
<li><p>With two sequences <code>group1</code> and <code>group2</code>: The function will automatically construct a 2x2 contingency table from the unique values in the sequences (assuming they represent two binary variables). The mapping of values to table cells (e.g., what corresponds to TP, TN, FP, FN) depends on how <code>contingency-table</code> orders the unique values. For direct control over which cell is which, use the contingency table input.</p></li>
<li><p>With a contingency table: The contingency table can be provided as:</p>
<ul>
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] TP, [0 1] FP, [1 0] FN, [1 1] TN}</code>). This is the output format of <a href="#LOS-contingency-table">contingency-table</a> with two inputs.</li>
<li>A sequence of sequences representing the rows of the table (e.g., <code>[TP FP] [FN TN](#LOS-TP FP] [FN TN)</code>). This is equivalent to <code>rows-&gt;contingency-table</code>.</li>
</ul></li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (sequence): The first sequence of binary outcomes/categories.</li>
<li><code>group2</code> (sequence): The second sequence of binary outcomes/categories. Must have the same length as <code>group1</code>.</li>
<li><code>contingency-table</code> (map or sequence of sequences): A pre-computed 2x2 contingency table.</li>
</ul>
<p>Returns the calculated Matthews Correlation Coefficient as a double.</p>
<p>Note: The implementation uses marginal sums from the contingency table, which is mathematically equivalent to the standard formula but avoids potential division by zero in the denominator product if any marginal sum is zero.</p>
<p>See also <a href="#LOS-contingency-table">contingency-table</a>, <a href="#LOS-contingency-2x2-measures">contingency-2x2-measures</a>, <a href="#LOS-binary-measures-all">binary-measures-all</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3574">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-me"></span>
</section>
<section id="me" class="level4">
<h4 class="anchored" data-anchor-id="me">me</h4>
<ul>
<li><code>(me [vs1 vs2-or-val])</code></li>
<li><code>(me vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the Mean Error (ME) between two sequences or a sequence and constant value.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence.</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence of numbers, or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>Both sequences (<code>vs1</code> and <code>vs2</code>) must have the same length if both are sequences. If <code>vs2-or-val</code> is a single number, it is compared element-wise to <code>vs1</code>.</p>
<p>Returns the calculated Mean Error as a double.</p>
<p>Note: Positive ME indicates that <code>vs1</code> values tend to be greater than <code>vs2</code> values on average, while negative ME indicates <code>vs1</code> values tend to be smaller. ME can be influenced by the magnitude of errors and their signs. It does not directly measure the magnitude of the typical error due to potential cancellation of positive and negative differences.</p>
<p>See also <a href="#LOS-mae">mae</a> (Mean Absolute Error), <a href="#LOS-mse">mse</a> (Mean Squared Error), <a href="#LOS-rmse">rmse</a> (Root Mean Squared Error).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1812">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mean"></span>
</section>
<section id="mean-1" class="level4">
<h4 class="anchored" data-anchor-id="mean-1">mean</h4>
<ul>
<li><code>(mean vs)</code></li>
<li><code>(mean vs weights)</code></li>
</ul>
<p>Calculates the arithmetic mean (average) of a sequence <code>vs</code>.</p>
<p>If <code>weights</code> are provided, calculates the weighted arithmetic mean.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of numbers.</li>
<li><code>weights</code> (optional): Sequence of non-negative weights corresponding to <code>vs</code>. Must have the same count as <code>vs</code>.</li>
</ul>
<p>Returns the calculated mean as a double.</p>
<p>See also <a href="#LOS-geomean">geomean</a>, <a href="#LOS-harmean">harmean</a>, <a href="#LOS-powmean">powmean</a>, <a href="#LOS-median">median</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L380">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mean-absolute-deviation"></span>
</section>
<section id="mean-absolute-deviation" class="level4">
<h4 class="anchored" data-anchor-id="mean-absolute-deviation">mean-absolute-deviation</h4>
<ul>
<li><code>(mean-absolute-deviation vs)</code></li>
<li><code>(mean-absolute-deviation vs center)</code></li>
</ul>
<p>Calculates the Mean Absolute Deviation of a sequence <code>vs</code>.</p>
<p>MeanAD is a measure of the variability of a univariate sample of quantitative data. It is defined as the mean of the absolute deviations from a central point, typically the data’s mean.</p>
<p><code>MeanAD = mean(|X_i - center|)</code></p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of numbers.</li>
<li><code>center</code> (optional, double): The central point from which to calculate deviations. If <code>nil</code> or not provided, the arithmetic <a href="#LOS-mean">mean</a> of <code>vs</code> is used as the center.</li>
</ul>
<p>Returns the calculated Mean Absolute Deviation as a double.</p>
<p>Unlike <a href="#LOS-median-absolute-deviation">median-absolute-deviation</a>, which uses the median of absolute deviations from the median, the Mean Absolute Deviation uses the mean of absolute deviations from the mean (or specified center). This makes it more sensitive to outliers than <a href="#LOS-median-absolute-deviation">median-absolute-deviation</a> but less sensitive than the standard deviation.</p>
<p>See also <a href="#LOS-median-absolute-deviation">median-absolute-deviation</a>, <a href="#LOS-stddev">stddev</a>, <a href="#LOS-mean">mean</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L625">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-means-ratio"></span>
</section>
<section id="means-ratio" class="level4">
<h4 class="anchored" data-anchor-id="means-ratio">means-ratio</h4>
<ul>
<li><code>(means-ratio [group1 group2])</code></li>
<li><code>(means-ratio group1 group2)</code></li>
<li><code>(means-ratio group1 group2 adjusted?)</code></li>
</ul>
<p>Calculates the ratio of the mean of <code>group1</code> to the mean of <code>group2</code>.</p>
<p>This is a measure of effect size in the ‘Ratio Family’, comparing the central tendency of two groups multiplicatively.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first independent sample. The mean of this group is the numerator.</li>
<li><code>group2</code> (seq of numbers): The second independent sample. The mean of this group is the denominator.</li>
<li><code>adjusted?</code> (boolean, optional): If <code>true</code>, applies a small-sample bias correction to the ratio. Defaults to <code>false</code>.</li>
</ul>
<p>Returns the calculated ratio of means as a double.</p>
<p>A value greater than 1 indicates that <code>group1</code> has a larger mean than <code>group2</code>. A value less than 1 indicates <code>group1</code> has a smaller mean. A value close to 1 indicates similar means.</p>
<p>The <code>adjusted?</code> version attempts to provide a less biased estimate of the population mean ratio, particularly for small sample sizes, by incorporating variances into the calculation (based on Bickel and Doksum, see also <a href="#LOS-means-ratio-corrected">means-ratio-corrected</a>).</p>
<p>See also <a href="#LOS-means-ratio-corrected">means-ratio-corrected</a> (which is equivalent to calling this with <code>adjusted?</code> set to <code>true</code>).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2777">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-means-ratio-corrected"></span>
</section>
<section id="means-ratio-corrected" class="level4">
<h4 class="anchored" data-anchor-id="means-ratio-corrected">means-ratio-corrected</h4>
<ul>
<li><code>(means-ratio-corrected [group1 group2])</code></li>
<li><code>(means-ratio-corrected group1 group2)</code></li>
</ul>
<p>Calculates a bias-corrected ratio of the mean of <code>group1</code> to the mean of <code>group2</code>.</p>
<p>This function applies a correction (based on Bickel and Doksum) to the simple ratio <code>mean(group1) / mean(group2)</code> to reduce bias, particularly for small sample sizes.</p>
<p>It is equivalent to calling <code>(means-ratio group1 group2 true)</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first independent sample. The mean of this group is the numerator.</li>
<li><code>group2</code> (seq of numbers): The second independent sample. The mean of this group is the denominator.</li>
</ul>
<p>Returns the calculated bias-corrected ratio of means as a double.</p>
<p>See also <a href="#LOS-means-ratio">means-ratio</a> (for the simple, uncorrected ratio).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2818">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-median"></span>
</section>
<section id="median" class="level4">
<h4 class="anchored" data-anchor-id="median">median</h4>
<ul>
<li><code>(median vs estimation-strategy)</code></li>
<li><code>(median vs)</code></li>
</ul>
<p>Calculates median of a sequence <code>vs</code>.</p>
<p>An optional <code>estimation-strategy</code> keyword can be provided to specify the method used for estimating the quantile, particularly how interpolation is handled when the desired quantile falls between data points in the sorted sequence.</p>
<p>Available <code>estimation-strategy</code> values:</p>
<ul>
<li><code>:legacy</code> (Default): The original method used in Apache Commons Math.</li>
<li><code>:r1</code> through <code>:r9</code>: Correspond to the nine quantile estimation algorithms recommended by Hyndman and Fan (1996). Each strategy differs slightly in how it calculates the index (e.g., using <code>np</code> or <code>(n+1)p</code>) and how it interpolates between points.</li>
</ul>
<p>For detailed mathematical descriptions of each estimation strategy, refer to the <a href="http://commons.apache.org/proper/commons-math/javadocs/api-3.6.1/org/apache/commons/math3/stat/descriptive/rank/Percentile.EstimationType.html">Apache Commons Math Percentile documentation</a>.</p>
<p>See also <a href="#LOS-quantile">quantile</a>, <a href="#LOS-median-3">median-3</a></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L352">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-median-3"></span>
</section>
<section id="median-3" class="level4">
<h4 class="anchored" data-anchor-id="median-3">median-3</h4>
<ul>
<li><code>(median-3 a b c)</code></li>
</ul>
<p>Median of three values. See <a href="#LOS-median">median</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L375">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-median-absolute-deviation"></span>
</section>
<section id="median-absolute-deviation" class="level4">
<h4 class="anchored" data-anchor-id="median-absolute-deviation">median-absolute-deviation</h4>
<ul>
<li><code>(median-absolute-deviation vs)</code></li>
<li><code>(median-absolute-deviation vs center-or-estimation-strategy)</code></li>
<li><code>(median-absolute-deviation vs center estimation-strategy)</code></li>
</ul>
<p>Calculates the Median Absolute Deviation (MAD) of a sequence <code>vs</code>.</p>
<p>MAD is a robust measure of the variability of a univariate sample of quantitative data. It is defined as the median of the absolute deviations from the data’s median (or a specified center).</p>
<p><code>MAD = median(|X_i - median(X)|)</code></p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of numbers.</li>
<li><code>center-or-estimation-strategy</code> (optional): The central point from which to calculate deviations or estimation strategy. If <code>nil</code> or not provided, the <a href="#LOS-median">median</a> of <code>vs</code> is used as the center. If keyword, it’s treated as estimation strategy for median.</li>
<li><code>estimation-strategy</code> (optional, keyword): The estimation strategy to use for calculating the median(s). This applies to the calculation of the central value (if <code>center</code> is not provided) and to the final median of the absolute deviations. See <a href="#LOS-median">median</a> or <a href="#LOS-quantile">quantile</a> for available strategies (e.g., <code>:legacy</code>, <code>:r1</code> through <code>:r9</code>).</li>
</ul>
<p>Returns the calculated MAD as a double.</p>
<p>MAD is less sensitive to outliers than the standard deviation.</p>
<p>See also <a href="#LOS-mean-absolute-deviation">mean-absolute-deviation</a>, <a href="#LOS-stddev">stddev</a>, <a href="#LOS-median">median</a>, <a href="#LOS-quantile">quantile</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L586">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-minimum"></span>
</section>
<section id="minimum" class="level4">
<h4 class="anchored" data-anchor-id="minimum">minimum</h4>
<ul>
<li><code>(minimum vs)</code></li>
</ul>
<p>Finds the minimum value in a sequence of numbers.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L73">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-minimum-discrimination-information-test"></span>
</section>
<section id="minimum-discrimination-information-test" class="level4">
<h4 class="anchored" data-anchor-id="minimum-discrimination-information-test">minimum-discrimination-information-test</h4>
<ul>
<li><code>(minimum-discrimination-information-test contingency-table-or-xs)</code></li>
<li><code>(minimum-discrimination-information-test contingency-table-or-xs params)</code></li>
</ul>
<p>Minimum discrimination information test, a power divergence test for <code>lambda</code> -1.0</p>
<p>Performs a power divergence test, which encompasses several common statistical tests like Chi-squared, G-test (likelihood ratio), etc., based on the lambda parameter. This function can perform either a goodness-of-fit test or a test for independence in a contingency table.</p>
<p>Usage:</p>
<ol type="1">
<li><strong>Goodness-of-Fit (GOF):</strong>
<ul>
<li>Input: <code>observed-counts</code> (sequence of numbers) and <code>:p</code> (expected probabilities/weights).</li>
<li>Input: <code>data</code> (sequence of numbers) and <code>:p</code> (a distribution object). In this case, a histogram of <code>data</code> is created (controlled by <code>:bins</code>) and compared against the probability mass/density of the distribution in those bins.</li>
</ul></li>
<li><strong>Test for Independence:</strong>
<ul>
<li>Input: <code>contingency-table</code> (2D sequence or map format). The <code>:p</code> option is ignored.</li>
</ul></li>
</ol>
<p>Options map:</p>
<ul>
<li><code>:lambda</code> (double, default: <code>2/3</code>): Determines the specific test statistic. Common values:
<ul>
<li><code>1.0</code>: Pearson Chi-squared test (<a href="#LOS-chisq-test">chisq-test</a>).</li>
<li><code>0.0</code>: G-test / Multinomial Likelihood Ratio test (<a href="#LOS-multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</a>).</li>
<li><code>-0.5</code>: Freeman-Tukey test (<a href="#LOS-freeman-tukey-test">freeman-tukey-test</a>).</li>
<li><code>-1.0</code>: Minimum Discrimination Information test (<a href="#LOS-minimum-discrimination-information-test">minimum-discrimination-information-test</a>).</li>
<li><code>-2.0</code>: Neyman Modified Chi-squared test (<a href="#LOS-neyman-modified-chisq-test">neyman-modified-chisq-test</a>).</li>
<li><code>2/3</code>: Cressie-Read test (default, <a href="#LOS-cressie-read-test">cressie-read-test</a>).</li>
</ul></li>
<li><code>:p</code> (seq of numbers or distribution): Expected probabilities/weights (for GOF with counts) or a <code>fastmath.random</code> distribution object (for GOF with data). Ignored for independence tests.</li>
<li><code>:alpha</code> (double, default: <code>0.05</code>): Significance level for confidence intervals.</li>
<li><code>:ci-sides</code> (keyword, default: <code>:two-sided</code>): Sides for bootstrap confidence intervals (<code>:two-sided</code>, <code>:one-sided-greater</code>, <code>:one-sided-less</code>).</li>
<li><code>:sides</code> (keyword, default: <code>:one-sided-greater</code>): Alternative hypothesis side for the p-value calculation against the Chi-squared distribution (<code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>).</li>
<li><code>:bootstrap-samples</code> (long, default: <code>1000</code>): Number of bootstrap samples for confidence interval estimation.</li>
<li><code>:ddof</code> (long, default: <code>0</code>): Delta degrees of freedom. Adjustment subtracted from the calculated degrees of freedom.</li>
<li><code>:bins</code> (number, keyword, or seq): Used only for GOF test against a distribution. Specifies the number of bins, an estimation method (see <a href="#LOS-histogram">histogram</a>), or explicit bin edges for histogram creation.</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:stat</code>: The calculated power divergence test statistic.</li>
<li><code>:chi2</code>: Alias for <code>:stat</code>.</li>
<li><code>:df</code>: Degrees of freedom for the test.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic.</li>
<li><code>:n</code>: Total number of observations.</li>
<li><code>:estimate</code>: Observed proportions.</li>
<li><code>:expected</code>: Expected counts or proportions under the null hypothesis.</li>
<li><code>:confidence-interval</code>: Bootstrap confidence intervals for the observed proportions.</li>
<li><code>:lambda</code>, <code>:alpha</code>, <code>:sides</code>, <code>:ci-sides</code>: Input options used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5745">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mode"></span>
</section>
<section id="mode-1" class="level4">
<h4 class="anchored" data-anchor-id="mode-1">mode</h4>
<ul>
<li><code>(mode vs method)</code></li>
<li><code>(mode vs method opts)</code></li>
<li><code>(mode vs)</code></li>
</ul>
<p>Find the value that appears most often in a dataset <code>vs</code>.</p>
<p>If multiple values share the same highest frequency (or estimated density/histogram peak), this function returns only the <em>first</em> one encountered during processing. The specific mode returned in case of a tie is not guaranteed to be stable. Use <a href="#LOS-modes">modes</a> if you need all tied modes.</p>
<p>For samples potentially drawn from a continuous distribution, several estimation methods are provided via the <code>method</code> argument:</p>
<ul>
<li><code>:histogram</code>: Calculates the mode based on the peak of a histogram constructed from <code>vs</code>. Uses interpolation within the bin with the highest frequency. Accepts options via <code>opts</code>, primarily <code>:bins</code> to control histogram construction (see <a href="#LOS-histogram">histogram</a>).</li>
<li><code>:pearson</code>: Estimates the mode using Pearson’s second skewness coefficient formula: <code>mode ≈ 3 * median - 2 * mean</code>. Accepts <code>:estimation-strategy</code> in <code>opts</code> for median calculation (see <a href="#LOS-median">median</a>).</li>
<li><code>:kde</code>: Estimates the mode by finding the original data point in <code>vs</code> with the highest estimated probability density, based on Kernel Density Estimation (KDE). Accepts KDE options in <code>opts</code> like <code>:kernel</code>, <code>:bandwidth</code>, etc. (passed to <code>fastmath.kernel.density/kernel-density</code>).</li>
<li><code>:default</code> (or when <code>method</code> is omitted): Finds the exact value that occurs most frequently in <code>vs</code>. Suitable for discrete data.</li>
</ul>
<p>The optional <code>opts</code> map provides method-specific configuration.</p>
<p>See also <a href="#LOS-modes">modes</a> (returns all modes) and <a href="#LOS-wmode">wmode</a> (for weighted data).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L993">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-modes"></span>
</section>
<section id="modes" class="level4">
<h4 class="anchored" data-anchor-id="modes">modes</h4>
<ul>
<li><code>(modes vs method)</code></li>
<li><code>(modes vs method opts)</code></li>
<li><code>(modes vs)</code></li>
</ul>
<p>Find the values that appear most often in a dataset <code>vs</code>.</p>
<p>Returns sequence with all most appearing values. For the default method (discrete data), modes are sorted in increasing order.</p>
<p>For samples potentially drawn from a continuous distribution, simply finding the most frequent exact value might not be meaningful. Several estimation methods are provided via the <code>method</code> argument:</p>
<ul>
<li><code>:histogram</code>: Calculates the mode(s) based on the peak(s) of a histogram constructed from <code>vs</code>. Uses interpolation within the bin(s) with the highest frequency. Accepts options via <code>opts</code>, primarily <code>:bins</code> to control histogram construction (see <a href="#LOS-histogram">histogram</a>).</li>
<li><code>:pearson</code>: Estimates the mode using Pearson’s second skewness coefficient formula: <code>mode ≈ 3 * median - 2 * mean</code>. Accepts <code>:estimation-strategy</code> in <code>opts</code> for median calculation (see <a href="#LOS-median">median</a>). Returns a single estimated mode.</li>
<li><code>:kde</code>: Estimates the mode(s) by finding the original data points in <code>vs</code> with the highest estimated probability density, based on Kernel Density Estimation (KDE). Accepts KDE options in <code>opts</code> like <code>:kernel</code>, <code>:bandwidth</code>, etc. (passed to <code>fastmath.kernel.density/kernel-density</code>).</li>
<li><code>:default</code> (or when <code>method</code> is omitted): Finds the exact value(s) that occur most frequently in <code>vs</code>. Suitable for discrete data.</li>
</ul>
<p>The optional <code>opts</code> map provides method-specific configuration.</p>
<p>See also <a href="#LOS-mode">mode</a> (returns only the first mode) and <a href="#LOS-wmodes">wmodes</a> (for weighted data).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L941">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-modified-power-transformation"></span>
</section>
<section id="modified-power-transformation-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="modified-power-transformation-deprecated">modified-power-transformation <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use `(box-cox-transformation xs lambda {:negative? true})</em></p>
<ul>
<li><code>(modified-power-transformation xs)</code></li>
<li><code>(modified-power-transformation xs lambda)</code></li>
<li><code>(modified-power-transformation xs lambda alpha)</code></li>
</ul>
<p>Applies a modified power transformation (Bickel and Doksum) to a data.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6507">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-moment"></span>
</section>
<section id="moment" class="level4">
<h4 class="anchored" data-anchor-id="moment">moment</h4>
<ul>
<li><code>(moment vs)</code></li>
<li><code>(moment vs order)</code></li>
<li><code>(moment vs order {:keys [absolute? center mean? normalize?], :or {mean? true}})</code></li>
</ul>
<p>Calculate moment (central or/and absolute) of given order (default: 2).</p>
<p>Additional parameters as a map:</p>
<ul>
<li><code>:absolute?</code> - calculate sum as absolute values (default: <code>false</code>)</li>
<li><code>:mean?</code> - returns mean (proper moment) or just sum of differences (default: <code>true</code>)</li>
<li><code>:center</code> - value of center (default: <code>nil</code> = mean)</li>
<li><code>:normalize?</code> - apply normalization by standard deviation to the order power</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1028">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-mse"></span>
</section>
<section id="mse" class="level4">
<h4 class="anchored" data-anchor-id="mse">mse</h4>
<ul>
<li><code>(mse [vs1 vs2-or-val])</code></li>
<li><code>(mse vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the Mean Squared Error (MSE) between two sequences or a sequence and a constant value.</p>
<p>MSE is a measure of the quality of an estimator or predictor. It quantifies the average of the squared differences between corresponding elements of the input sequences.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence (often the observed or true values).</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence (often the predicted or reference values), or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated Mean Squared Error as a double.</p>
<p>Note: MSE penalizes larger errors more heavily than smaller errors because the errors are squared. This makes it sensitive to outliers. It is the average of the <a href="#LOS-rss">rss</a> (Residual Sum of Squares). Its square root is the <a href="#LOS-rmse">rmse</a>.</p>
<p>See also <a href="#LOS-rss">rss</a> (Residual Sum of Squares), <a href="#LOS-rmse">rmse</a> (Root Mean Squared Error), <a href="#LOS-me">me</a> (Mean Error), <a href="#LOS-mae">mae</a> (Mean Absolute Error), <a href="#LOS-r2">r2</a> (Coefficient of Determination).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1984">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-multinomial-likelihood-ratio-test"></span>
</section>
<section id="multinomial-likelihood-ratio-test" class="level4">
<h4 class="anchored" data-anchor-id="multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</h4>
<ul>
<li><code>(multinomial-likelihood-ratio-test contingency-table-or-xs)</code></li>
<li><code>(multinomial-likelihood-ratio-test contingency-table-or-xs params)</code></li>
</ul>
<p>Multinomial likelihood ratio test, a power divergence test for <code>lambda</code> 0.0</p>
<p>Performs a power divergence test, which encompasses several common statistical tests like Chi-squared, G-test (likelihood ratio), etc., based on the lambda parameter. This function can perform either a goodness-of-fit test or a test for independence in a contingency table.</p>
<p>Usage:</p>
<ol type="1">
<li><strong>Goodness-of-Fit (GOF):</strong>
<ul>
<li>Input: <code>observed-counts</code> (sequence of numbers) and <code>:p</code> (expected probabilities/weights).</li>
<li>Input: <code>data</code> (sequence of numbers) and <code>:p</code> (a distribution object). In this case, a histogram of <code>data</code> is created (controlled by <code>:bins</code>) and compared against the probability mass/density of the distribution in those bins.</li>
</ul></li>
<li><strong>Test for Independence:</strong>
<ul>
<li>Input: <code>contingency-table</code> (2D sequence or map format). The <code>:p</code> option is ignored.</li>
</ul></li>
</ol>
<p>Options map:</p>
<ul>
<li><code>:lambda</code> (double, default: <code>2/3</code>): Determines the specific test statistic. Common values:
<ul>
<li><code>1.0</code>: Pearson Chi-squared test (<a href="#LOS-chisq-test">chisq-test</a>).</li>
<li><code>0.0</code>: G-test / Multinomial Likelihood Ratio test (<a href="#LOS-multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</a>).</li>
<li><code>-0.5</code>: Freeman-Tukey test (<a href="#LOS-freeman-tukey-test">freeman-tukey-test</a>).</li>
<li><code>-1.0</code>: Minimum Discrimination Information test (<a href="#LOS-minimum-discrimination-information-test">minimum-discrimination-information-test</a>).</li>
<li><code>-2.0</code>: Neyman Modified Chi-squared test (<a href="#LOS-neyman-modified-chisq-test">neyman-modified-chisq-test</a>).</li>
<li><code>2/3</code>: Cressie-Read test (default, <a href="#LOS-cressie-read-test">cressie-read-test</a>).</li>
</ul></li>
<li><code>:p</code> (seq of numbers or distribution): Expected probabilities/weights (for GOF with counts) or a <code>fastmath.random</code> distribution object (for GOF with data). Ignored for independence tests.</li>
<li><code>:alpha</code> (double, default: <code>0.05</code>): Significance level for confidence intervals.</li>
<li><code>:ci-sides</code> (keyword, default: <code>:two-sided</code>): Sides for bootstrap confidence intervals (<code>:two-sided</code>, <code>:one-sided-greater</code>, <code>:one-sided-less</code>).</li>
<li><code>:sides</code> (keyword, default: <code>:one-sided-greater</code>): Alternative hypothesis side for the p-value calculation against the Chi-squared distribution (<code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>).</li>
<li><code>:bootstrap-samples</code> (long, default: <code>1000</code>): Number of bootstrap samples for confidence interval estimation.</li>
<li><code>:ddof</code> (long, default: <code>0</code>): Delta degrees of freedom. Adjustment subtracted from the calculated degrees of freedom.</li>
<li><code>:bins</code> (number, keyword, or seq): Used only for GOF test against a distribution. Specifies the number of bins, an estimation method (see <a href="#LOS-histogram">histogram</a>), or explicit bin edges for histogram creation.</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:stat</code>: The calculated power divergence test statistic.</li>
<li><code>:chi2</code>: Alias for <code>:stat</code>.</li>
<li><code>:df</code>: Degrees of freedom for the test.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic.</li>
<li><code>:n</code>: Total number of observations.</li>
<li><code>:estimate</code>: Observed proportions.</li>
<li><code>:expected</code>: Expected counts or proportions under the null hypothesis.</li>
<li><code>:confidence-interval</code>: Bootstrap confidence intervals for the observed proportions.</li>
<li><code>:lambda</code>, <code>:alpha</code>, <code>:sides</code>, <code>:ci-sides</code>: Input options used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5739">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-neyman-modified-chisq-test"></span>
</section>
<section id="neyman-modified-chisq-test" class="level4">
<h4 class="anchored" data-anchor-id="neyman-modified-chisq-test">neyman-modified-chisq-test</h4>
<ul>
<li><code>(neyman-modified-chisq-test contingency-table-or-xs)</code></li>
<li><code>(neyman-modified-chisq-test contingency-table-or-xs params)</code></li>
</ul>
<p>Neyman modifield chi square test, a power divergence test for <code>lambda</code> -2.0</p>
<p>Performs a power divergence test, which encompasses several common statistical tests like Chi-squared, G-test (likelihood ratio), etc., based on the lambda parameter. This function can perform either a goodness-of-fit test or a test for independence in a contingency table.</p>
<p>Usage:</p>
<ol type="1">
<li><strong>Goodness-of-Fit (GOF):</strong>
<ul>
<li>Input: <code>observed-counts</code> (sequence of numbers) and <code>:p</code> (expected probabilities/weights).</li>
<li>Input: <code>data</code> (sequence of numbers) and <code>:p</code> (a distribution object). In this case, a histogram of <code>data</code> is created (controlled by <code>:bins</code>) and compared against the probability mass/density of the distribution in those bins.</li>
</ul></li>
<li><strong>Test for Independence:</strong>
<ul>
<li>Input: <code>contingency-table</code> (2D sequence or map format). The <code>:p</code> option is ignored.</li>
</ul></li>
</ol>
<p>Options map:</p>
<ul>
<li><code>:lambda</code> (double, default: <code>2/3</code>): Determines the specific test statistic. Common values:
<ul>
<li><code>1.0</code>: Pearson Chi-squared test (<a href="#LOS-chisq-test">chisq-test</a>).</li>
<li><code>0.0</code>: G-test / Multinomial Likelihood Ratio test (<a href="#LOS-multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</a>).</li>
<li><code>-0.5</code>: Freeman-Tukey test (<a href="#LOS-freeman-tukey-test">freeman-tukey-test</a>).</li>
<li><code>-1.0</code>: Minimum Discrimination Information test (<a href="#LOS-minimum-discrimination-information-test">minimum-discrimination-information-test</a>).</li>
<li><code>-2.0</code>: Neyman Modified Chi-squared test (<a href="#LOS-neyman-modified-chisq-test">neyman-modified-chisq-test</a>).</li>
<li><code>2/3</code>: Cressie-Read test (default, <a href="#LOS-cressie-read-test">cressie-read-test</a>).</li>
</ul></li>
<li><code>:p</code> (seq of numbers or distribution): Expected probabilities/weights (for GOF with counts) or a <code>fastmath.random</code> distribution object (for GOF with data). Ignored for independence tests.</li>
<li><code>:alpha</code> (double, default: <code>0.05</code>): Significance level for confidence intervals.</li>
<li><code>:ci-sides</code> (keyword, default: <code>:two-sided</code>): Sides for bootstrap confidence intervals (<code>:two-sided</code>, <code>:one-sided-greater</code>, <code>:one-sided-less</code>).</li>
<li><code>:sides</code> (keyword, default: <code>:one-sided-greater</code>): Alternative hypothesis side for the p-value calculation against the Chi-squared distribution (<code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>).</li>
<li><code>:bootstrap-samples</code> (long, default: <code>1000</code>): Number of bootstrap samples for confidence interval estimation.</li>
<li><code>:ddof</code> (long, default: <code>0</code>): Delta degrees of freedom. Adjustment subtracted from the calculated degrees of freedom.</li>
<li><code>:bins</code> (number, keyword, or seq): Used only for GOF test against a distribution. Specifies the number of bins, an estimation method (see <a href="#LOS-histogram">histogram</a>), or explicit bin edges for histogram creation.</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:stat</code>: The calculated power divergence test statistic.</li>
<li><code>:chi2</code>: Alias for <code>:stat</code>.</li>
<li><code>:df</code>: Degrees of freedom for the test.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic.</li>
<li><code>:n</code>: Total number of observations.</li>
<li><code>:estimate</code>: Observed proportions.</li>
<li><code>:expected</code>: Expected counts or proportions under the null hypothesis.</li>
<li><code>:confidence-interval</code>: Bootstrap confidence intervals for the observed proportions.</li>
<li><code>:lambda</code>, <code>:alpha</code>, <code>:sides</code>, <code>:ci-sides</code>: Input options used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5751">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-normality-test"></span>
</section>
<section id="normality-test" class="level4">
<h4 class="anchored" data-anchor-id="normality-test">normality-test</h4>
<ul>
<li><code>(normality-test xs)</code></li>
<li><code>(normality-test xs params)</code></li>
<li><code>(normality-test xs skew kurt {:keys [sides], :or {sides :one-sided-greater}})</code></li>
</ul>
<p>Performs the D’Agostino-Pearson K² omnibus test for normality.</p>
<p>This test combines the results of the skewness and kurtosis tests to provide an overall assessment of whether the sample data deviates from a normal distribution in terms of either asymmetry or peakedness/tailedness.</p>
<p>The test works by: 1. Calculating a normalized test statistic (Z₁) for skewness using <a href="#LOS-skewness-test">skewness-test</a>. 2. Calculating a normalized test statistic (Z₂) for kurtosis using <a href="#LOS-kurtosis-test">kurtosis-test</a>. 3. Combining these into an omnibus statistic: K² = Z₁² + Z₂². 4. Under the null hypothesis that the data comes from a normal distribution, K² approximately follows a Chi-squared distribution with 2 degrees of freedom.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data.</li>
<li><code>skew</code> (double, optional): A pre-calculated skewness value (type <code>:g1</code> used by default in underlying test).</li>
<li><code>kurt</code> (double, optional): A pre-calculated kurtosis value (type <code>:kurt</code> used by default in underlying test).</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:sides</code> (keyword, default <code>:one-sided-greater</code>): Specifies the side(s) of the Chi-squared(2) distribution used for p-value calculation.
<ul>
<li><code>:one-sided-greater</code> (default and standard): Tests if K² is significantly large, indicating departure from normality in skewness, kurtosis, or both.</li>
<li><code>:one-sided-less</code>: Tests if the K² statistic is significantly small.</li>
<li><code>:two-sided</code>: Tests if the K² statistic is extreme in either tail.</li>
</ul></li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:Z</code>: The calculated K² omnibus test statistic (labeled <code>:Z</code> for consistency, though it follows Chi-squared(2)).</li>
<li><code>:stat</code>: Alias for <code>:Z</code>.</li>
<li><code>:p-value</code>: The p-value associated with the K² statistic and <code>:sides</code>.</li>
<li><code>:skewness</code>: The sample skewness value used (either provided or calculated).</li>
<li><code>:kurtosis</code>: The sample kurtosis value used (either provided or calculated).</li>
</ul>
<p>See also <a href="#LOS-skewness-test">skewness-test</a>, <a href="#LOS-kurtosis-test">kurtosis-test</a>, <a href="#LOS-jarque-bera-test">jarque-bera-test</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5009">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-omega-sq"></span>
</section>
<section id="omega-sq" class="level4">
<h4 class="anchored" data-anchor-id="omega-sq">omega-sq</h4>
<ul>
<li><code>(omega-sq [group1 group2])</code></li>
<li><code>(omega-sq group1 group2)</code></li>
<li><code>(omega-sq group1 group2 degrees-of-freedom)</code></li>
</ul>
<p>Calculates Omega squared (ω²), an effect size measure for the simple linear regression of <code>group1</code> on <code>group2</code>.</p>
<p>Omega squared estimates the proportion of variance in the dependent variable (<code>group1</code>) that is accounted for by the independent variable (<code>group2</code>) in the population. It is considered a less biased alternative to <a href="#LOS-r2-determination">r2-determination</a>.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The dependent variable.</li>
<li><code>group2</code> (seq of numbers): The independent variable. Must have the same length as <code>group1</code>.</li>
<li><code>degrees-of-freedom</code> (double, optional): The degrees of freedom for the regression model. Defaults to 1.0, which is standard for simple linear regression and used in the 2-arity version. Providing a different value allows calculating ω² for cases with multiple predictors if the sums of squares are computed for the overall model.</li>
</ul>
<p>Returns the calculated Omega squared value as a double. The value typically ranges from 0.0 to 1.0.</p>
<p>Interpretation:</p>
<ul>
<li>0.0 indicates that <code>group2</code> explains none of the variance in <code>group1</code> in the population.</li>
<li>1.0 indicates that <code>group2</code> perfectly explains the variance in <code>group1</code> in the population.</li>
</ul>
<p>Note: While often presented in the context of ANOVA, this implementation applies the formula to the sums of squares obtained from a simple linear regression between the two sequences. The 3-arity version allows specifying a custom degrees of freedom for regression, which might be relevant for calculating overall <span class="math inline">\(\omega^2\)</span> in multiple regression contexts (where <code>degrees-of-freedom</code> would be the number of predictors).</p>
<p>See also <a href="#LOS-eta-sq">eta-sq</a> (Eta-squared, often based on <span class="math inline">\(R^2\)</span>), <a href="#LOS-epsilon-sq">epsilon-sq</a> (another adjusted R²-like measure), <a href="#LOS-r2-determination">r2-determination</a> (R-squared).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3228">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-one-way-anova-test"></span>
</section>
<section id="one-way-anova-test" class="level4">
<h4 class="anchored" data-anchor-id="one-way-anova-test">one-way-anova-test</h4>
<ul>
<li><code>(one-way-anova-test xss)</code></li>
<li><code>(one-way-anova-test xss {:keys [sides], :or {sides :one-sided-greater}})</code></li>
</ul>
<p>Performs a one-way analysis of variance (ANOVA) test.</p>
<p>ANOVA tests the null hypothesis that the means of two or more independent groups are equal. It assumes that the data within each group are normally distributed and have equal variances.</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences): A collection where each element is a sequence representing a group of observations.</li>
<li><code>params</code> (map, optional): Options map with the following key:
<ul>
<li><code>:sides</code> (keyword, default <code>:one-sided-greater</code>): Alternative hypothesis side for the F-test. Possible values: <code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:F</code>: The F-statistic for the test.</li>
<li><code>:stat</code>: Alias for <code>:F</code>.</li>
<li><code>:p-value</code>: The p-value for the test.</li>
<li><code>:df</code>: Degrees of freedom for the F-statistic ([DFt, DFe]).</li>
<li><code>:n</code>: Sequence of sample sizes for each group.</li>
<li><code>:SSt</code>: Sum of squares between groups (treatment).</li>
<li><code>:SSe</code>: Sum of squares within groups (error).</li>
<li><code>:DFt</code>: Degrees of freedom between groups.</li>
<li><code>:DFe</code>: Degrees of freedom within groups.</li>
<li><code>:MSt</code>: Mean square between groups.</li>
<li><code>:MSe</code>: Mean square within groups.</li>
<li><code>:sides</code>: Test side used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5801">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-outer-fence-extent"></span>
</section>
<section id="outer-fence-extent" class="level4">
<h4 class="anchored" data-anchor-id="outer-fence-extent">outer-fence-extent</h4>
<ul>
<li><code>(outer-fence-extent vs)</code></li>
<li><code>(outer-fence-extent vs estimation-strategy)</code></li>
</ul>
<p>Returns LOF, UOF and median</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L807">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-outliers"></span>
</section>
<section id="outliers" class="level4">
<h4 class="anchored" data-anchor-id="outliers">outliers</h4>
<ul>
<li><code>(outliers vs)</code></li>
<li><code>(outliers vs estimation-strategy)</code></li>
<li><code>(outliers vs q1 q3)</code></li>
</ul>
<p>Find outliers defined as values outside inner fences.</p>
<p>Let Q1 is 25-percentile and Q3 is 75-percentile. IQR is <code>(- Q3 Q1)</code>.</p>
<ul>
<li>LIF (Lower Inner Fence) equals <code>(- Q1 (* 1.5 IQR))</code>.</li>
<li>UIF (Upper Inner Fence) equals <code>(+ Q3 (* 1.5 IQR))</code>.</li>
</ul>
<p>Returns a sequence of outliers.</p>
<p>Optional <code>estimation-strategy</code> argument can be set to change quantile calculations estimation type. See <a href="#LOS-estimation-strategies">estimation-strategies</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L830">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-p-overlap"></span>
</section>
<section id="p-overlap" class="level4">
<h4 class="anchored" data-anchor-id="p-overlap">p-overlap</h4>
<ul>
<li><code>(p-overlap [group1 group2])</code></li>
<li><code>(p-overlap group1 group2)</code></li>
<li><code>(p-overlap group1 group2 {:keys [kde bandwidth min-iterations steps], :or {kde :gaussian, min-iterations 3, steps 500}})</code></li>
</ul>
<p>Calculates the overlapping index between the estimated distributions of two samples using Kernel Density Estimation (KDE).</p>
<p>This function estimates the probability density function (PDF) for <code>group1</code> and <code>group2</code> using KDE and then calculates the area of overlap between the two estimated PDFs. The area of overlap is the integral of the minimum of the two density functions.</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sample.</li>
<li><code>group2</code> (seq of numbers): The second sample.</li>
<li><code>opts</code> (map, optional): Options map for KDE and integration:
<ul>
<li><code>:kde</code> (keyword, default <code>:gaussian</code>): The kernel function to use for KDE. See <code>fastmath.kernel.density/kernel-density+</code> for options.</li>
<li><code>:bandwidth</code> (double, optional): The bandwidth for KDE. If omitted, it is automatically estimated.</li>
<li><code>:min-iterations</code> (long, default 3): Minimum number of iterations for Romberg integration.</li>
<li><code>:steps</code> (long, default 500): Number of steps (subintervals) for numerical integration over the relevant range.</li>
</ul></li>
</ul>
<p>Returns the calculated overlapping index as a double, representing the area of overlap between the two estimated distributions. A value closer to 1 indicates greater overlap, while a value closer to 0 indicates less overlap.</p>
<p>This measure quantifies the degree to which two distributions share common values and can be seen as a measure of similarity.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2935">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-p-value"></span>
</section>
<section id="p-value" class="level4">
<h4 class="anchored" data-anchor-id="p-value">p-value</h4>
<ul>
<li><code>(p-value stat)</code></li>
<li><code>(p-value distribution stat)</code></li>
<li><code>(p-value distribution stat sides)</code></li>
</ul>
<p>Calculates the p-value for a given test statistic based on a reference probability distribution.</p>
<p>The p-value represents the probability of observing a test statistic as extreme as, or more extreme than, the provided <code>stat</code>, assuming the null hypothesis is true (where the null hypothesis implies <code>stat</code> follows the given <code>distribution</code>).</p>
<p>Parameters:</p>
<ul>
<li><code>distribution</code> (distribution object, optional): The probability distribution object (from <code>fastmath.random</code>) that the test statistic follows under the null hypothesis. Defaults to the standard normal distribution (<code>fastmath.random/default-normal</code>) if omitted.</li>
<li><code>stat</code> (double): The observed value of the test statistic.</li>
<li><code>sides</code> (keyword, optional): Specifies the type of alternative hypothesis and how ‘extremeness’ is defined. Defaults to <code>:two-sided</code>.
<ul>
<li><code>:two-sided</code> or <code>:both</code>: Alternative hypothesis is that the true parameter is different from the null value (tests for extremeness in either tail). Calculates <code>2 * min(CDF(stat), CCDF(stat))</code> (adjusted for discrete).</li>
<li><code>:one-sided-greater</code> or <code>:right</code>: Alternative hypothesis is that the true parameter is greater than the null value (tests for extremeness in the right tail). Calculates <code>CCDF(stat)</code> (adjusted for discrete).</li>
<li><code>:one-sided-less</code>, <code>:left</code>, or <code>:one-sided</code>: Alternative hypothesis is that the true parameter is less than the null value (tests for extremeness in the left tail). Calculates <code>CDF(stat)</code>.</li>
</ul></li>
</ul>
<p>Note: For discrete distributions, a continuity correction (<code>stat - 1</code> for CCDF calculations) is applied when calculating right-tail or two-tail probabilities involving the upper tail. This ensures the probability mass <em>at</em> the statistic value is correctly accounted for.</p>
<p>Returns the calculated p-value (a double between 0.0 and 1.0).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4851">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pacf"></span>
</section>
<section id="pacf" class="level4">
<h4 class="anchored" data-anchor-id="pacf">pacf</h4>
<ul>
<li><code>(pacf data)</code></li>
<li><code>(pacf data lags)</code></li>
</ul>
<p>Calculates the Partial Autocorrelation Function (PACF) for a given time series <code>data</code>.</p>
<p>The PACF measures the linear dependence between a time series and its lagged values <em>after removing</em> the effects of the intermediate lags. It helps identify the direct relationship at each lag and is used to determine the order of autoregressive (AR) components in time series models (e.g., ARIMA).</p>
<p>Parameters:</p>
<ul>
<li><code>data</code> (seq of numbers): The time series data.</li>
<li><code>lags</code> (long, optional): The maximum lag for which to calculate the PACF. If omitted, calculates PACF for lags from 0 up to <code>(dec (count data))</code>.</li>
</ul>
<p>Returns a sequence of doubles representing the partial autocorrelation coefficients for the specified lags. The value at lag 0 is always 0.0.</p>
<p>See also <a href="#LOS-acf">acf</a>, <a href="#LOS-acf-ci">acf-ci</a>, <a href="#LOS-pacf-ci">pacf-ci</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4522">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pacf-ci"></span>
</section>
<section id="pacf-ci" class="level4">
<h4 class="anchored" data-anchor-id="pacf-ci">pacf-ci</h4>
<ul>
<li><code>(pacf-ci data)</code></li>
<li><code>(pacf-ci data lags)</code></li>
<li><code>(pacf-ci data lags alpha)</code></li>
</ul>
<p>Calculates the Partial Autocorrelation Function (PACF) for a time series and provides approximate confidence intervals.</p>
<p>This function computes the PACF of the input time series <code>data</code> for specified lags (see <a href="#LOS-pacf">pacf</a>) and includes approximate confidence intervals around the PACF estimates. These intervals help determine whether the partial autocorrelation at a specific lag is statistically significant (i.e., likely non-zero in the population).</p>
<p>Parameters:</p>
<ul>
<li><code>data</code> (seq of numbers): The time series data.</li>
<li><code>lags</code> (long, optional): The maximum lag for which to calculate the PACF and CI. If omitted, calculates for lags up to <code>(dec (count data))</code>.</li>
<li><code>alpha</code> (double, optional): The significance level for the confidence intervals. Defaults to <code>0.05</code> (for a 95% CI).</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:ci</code> (double): The value of the approximate standard confidence interval bound for lags &gt; 0. If the absolute value of a PACF coefficient at lag <code>k &gt; 0</code> exceeds this value, it is considered statistically significant.</li>
<li><code>:pacf</code> (seq of doubles): The sequence of partial autocorrelation coefficients at lags from 0 up to <code>lags</code> (calculated using <a href="#LOS-pacf">pacf</a>).</li>
</ul>
<p>See also <a href="#LOS-pacf">pacf</a>, <a href="#LOS-acf">acf</a>, <a href="#LOS-acf-ci">acf-ci</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4556">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pearson-correlation"></span>
</section>
<section id="pearson-correlation" class="level4">
<h4 class="anchored" data-anchor-id="pearson-correlation">pearson-correlation</h4>
<ul>
<li><code>(pearson-correlation [vs1 vs2])</code></li>
<li><code>(pearson-correlation vs1 vs2)</code></li>
</ul>
<p>Calculates the Pearson product-moment correlation coefficient between two sequences.</p>
<p>This function measures the linear relationship between two datasets. The coefficient value ranges from -1.0 (perfect negative linear correlation) to 1.0 (perfect positive linear correlation), with 0.0 indicating no linear correlation.</p>
<p>Parameters:</p>
<ul>
<li><code>[vs1 vs2]</code> (sequence of two sequences): A sequence containing the two sequences of numbers.</li>
<li><code>vs1</code>, <code>vs2</code> (sequences): The two sequences of numbers directly as arguments.</li>
</ul>
<p>Both input sequences must contain only numbers and must have the same length.</p>
<p>Returns the calculated Pearson correlation coefficient as a double. Returns <code>NaN</code> if either sequence has zero variance (i.e., all elements are the same).</p>
<p>See also <a href="#LOS-correlation">correlation</a> (general correlation, defaults to Pearson), <a href="#LOS-spearman-correlation">spearman-correlation</a>, <a href="#LOS-kendall-correlation">kendall-correlation</a>, <a href="#LOS-correlation-matrix">correlation-matrix</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1647">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pearson-r"></span>
</section>
<section id="pearson-r" class="level4">
<h4 class="anchored" data-anchor-id="pearson-r">pearson-r</h4>
<ul>
<li><code>(pearson-r [group1 group2])</code></li>
<li><code>(pearson-r group1 group2)</code></li>
</ul>
<p>Calculates the Pearson <code>r</code> correlation coefficient between two sequences.</p>
<p>This function is an alias for <a href="#LOS-pearson-correlation">pearson-correlation</a>.</p>
<p>See <a href="#LOS-pearson-correlation">pearson-correlation</a> for detailed documentation, parameters, and usage examples.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3161">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-percentile"></span>
</section>
<section id="percentile" class="level4">
<h4 class="anchored" data-anchor-id="percentile">percentile</h4>
<ul>
<li><code>(percentile vs p)</code></li>
<li><code>(percentile vs p estimation-strategy)</code></li>
</ul>
<p>Calculates the p-th percentile of a sequence <code>vs</code>.</p>
<p>The percentile <code>p</code> is a value between 0 and 100, inclusive.</p>
<p>An optional <code>estimation-strategy</code> keyword can be provided to specify the method used for estimating the percentile, particularly how interpolation is handled when the desired percentile falls between data points in the sorted sequence.</p>
<p>Available <code>estimation-strategy</code> values:</p>
<ul>
<li><code>:legacy</code> (Default): The original method used in Apache Commons Math.</li>
<li><code>:r1</code> through <code>:r9</code>: Correspond to the nine quantile estimation algorithms recommended by Hyndman and Fan (1996). Each strategy differs slightly in how it calculates the index (e.g., using <code>np</code> or <code>(n+1)p</code>) and how it interpolates between points.</li>
</ul>
<p>For detailed mathematical descriptions of each estimation strategy, refer to the <a href="http://commons.apache.org/proper/commons-math/javadocs/api-3.6.1/org/apache/commons/math3/stat/descriptive/rank/Percentile.EstimationType.html">Apache Commons Math Percentile documentation</a>.</p>
<p>See also <a href="#LOS-quantile">quantile</a> (which uses a 0.0-1.0 range) and <a href="#LOS-percentiles">percentiles</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L141">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-percentile-bc-extent"></span>
</section>
<section id="percentile-bc-extent" class="level4">
<h4 class="anchored" data-anchor-id="percentile-bc-extent">percentile-bc-extent</h4>
<ul>
<li><code>(percentile-bc-extent vs)</code></li>
<li><code>(percentile-bc-extent vs p)</code></li>
<li><code>(percentile-bc-extent vs p1 p2)</code></li>
<li><code>(percentile-bc-extent vs p1 p2 estimation-strategy)</code></li>
</ul>
<p>Return bias corrected percentile range and mean for bootstrap samples. See https://projecteuclid.org/euclid.ss/1032280214</p>
<p><code>p</code> - calculates extent of bias corrected <code>p</code> and <code>100-p</code> (default: <code>p=2.5</code>)</p>
<p>Set <code>estimation-strategy</code> to <code>:r7</code> to get the same result as in R <code>coxed::bca</code>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4678">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-percentile-bca-extent"></span>
</section>
<section id="percentile-bca-extent" class="level4">
<h4 class="anchored" data-anchor-id="percentile-bca-extent">percentile-bca-extent</h4>
<ul>
<li><code>(percentile-bca-extent vs)</code></li>
<li><code>(percentile-bca-extent vs p)</code></li>
<li><code>(percentile-bca-extent vs p1 p2)</code></li>
<li><code>(percentile-bca-extent vs p1 p2 estimation-strategy)</code></li>
<li><code>(percentile-bca-extent vs p1 p2 accel estimation-strategy)</code></li>
</ul>
<p>Return bias corrected percentile range and mean for bootstrap samples. Also accounts for variance variations throught the accelaration parameter. See https://projecteuclid.org/euclid.ss/1032280214</p>
<p><code>p</code> - calculates extent of bias corrected <code>p</code> and <code>100-p</code> (default: <code>p=2.5</code>)</p>
<p>Set <code>estimation-strategy</code> to <code>:r7</code> to get the same result as in R <code>coxed::bca</code>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4659">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-percentile-extent"></span>
</section>
<section id="percentile-extent" class="level4">
<h4 class="anchored" data-anchor-id="percentile-extent">percentile-extent</h4>
<ul>
<li><code>(percentile-extent vs)</code></li>
<li><code>(percentile-extent vs p)</code></li>
<li><code>(percentile-extent vs p1 p2)</code></li>
<li><code>(percentile-extent vs p1 p2 estimation-strategy)</code></li>
</ul>
<p>Return percentile range and median.</p>
<p><code>p</code> - calculates extent of <code>p</code> and <code>100-p</code> (default: <code>p=25</code>)</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L693">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-percentiles"></span>
</section>
<section id="percentiles" class="level4">
<h4 class="anchored" data-anchor-id="percentiles">percentiles</h4>
<ul>
<li><code>(percentiles vs)</code></li>
<li><code>(percentiles vs ps)</code></li>
<li><code>(percentiles vs ps estimation-strategy)</code></li>
</ul>
<p>Calculates the sequence of p-th percentiles of a sequence <code>vs</code>.</p>
<p>Percentiles <code>ps</code> is sequence of values between 0 and 100, inclusive.</p>
<p>An optional <code>estimation-strategy</code> keyword can be provided to specify the method used for estimating the percentile, particularly how interpolation is handled when the desired percentile falls between data points in the sorted sequence.</p>
<p>Available <code>estimation-strategy</code> values:</p>
<ul>
<li><code>:legacy</code> (Default): The original method used in Apache Commons Math.</li>
<li><code>:r1</code> through <code>:r9</code>: Correspond to the nine quantile estimation algorithms recommended by Hyndman and Fan (1996). Each strategy differs slightly in how it calculates the index (e.g., using <code>np</code> or <code>(n+1)p</code>) and how it interpolates between points.</li>
</ul>
<p>For detailed mathematical descriptions of each estimation strategy, refer to the <a href="http://commons.apache.org/proper/commons-math/javadocs/api-3.6.1/org/apache/commons/math3/stat/descriptive/rank/Percentile.EstimationType.html">Apache Commons Math Percentile documentation</a>.</p>
<p>See also <a href="#LOS-quantiles">quantiles</a> (which uses a 0.0-1.0 range) and <a href="#LOS-percentile">percentile</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L172">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pi"></span>
</section>
<section id="pi" class="level4">
<h4 class="anchored" data-anchor-id="pi">pi</h4>
<ul>
<li><code>(pi vs)</code></li>
<li><code>(pi vs size)</code></li>
<li><code>(pi vs size estimation-strategy)</code></li>
</ul>
<p>Returns PI as a map, quantile intervals based on interval size.</p>
<p>Quantiles are <code>(1-size)/2</code> and <code>1-(1-size)/2</code></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L719">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pi-extent"></span>
</section>
<section id="pi-extent" class="level4">
<h4 class="anchored" data-anchor-id="pi-extent">pi-extent</h4>
<ul>
<li><code>(pi-extent vs)</code></li>
<li><code>(pi-extent vs size)</code></li>
<li><code>(pi-extent vs size estimation-strategy)</code></li>
</ul>
<p>Returns PI extent, quantile intervals based on interval size + median.</p>
<p>Quantiles are <code>(1-size)/2</code> and <code>1-(1-size)/2</code></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L733">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pooled-mad"></span>
</section>
<section id="pooled-mad" class="level4">
<h4 class="anchored" data-anchor-id="pooled-mad">pooled-mad</h4>
<ul>
<li><code>(pooled-mad groups)</code></li>
<li><code>(pooled-mad groups const)</code></li>
</ul>
<p>Calculate pooled median absolute deviation for samples.</p>
<p>k is a scaling constant which equals around 1.4826 by default.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2557">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pooled-stddev"></span>
</section>
<section id="pooled-stddev" class="level4">
<h4 class="anchored" data-anchor-id="pooled-stddev">pooled-stddev</h4>
<ul>
<li><code>(pooled-stddev groups)</code></li>
<li><code>(pooled-stddev groups method)</code></li>
</ul>
<p>Calculate pooled standard deviation for samples and method</p>
<p>Methods:</p>
<ul>
<li><code>:unbiased</code> - sqrt of weighted average of variances (default)</li>
<li><code>:biased</code> - biased version of <code>:unbiased</code>, no count correction.</li>
<li><code>:avg</code> - sqrt of average of variances</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2546">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-pooled-variance"></span>
</section>
<section id="pooled-variance" class="level4">
<h4 class="anchored" data-anchor-id="pooled-variance">pooled-variance</h4>
<ul>
<li><code>(pooled-variance groups)</code></li>
<li><code>(pooled-variance groups method)</code></li>
</ul>
<p>Calculate pooled variance for samples and method.</p>
<p>Methods: * <code>:unbiased</code> - weighted average of variances (default) * <code>:biased</code> - biased version of <code>:unbiased</code>, no count correction. * <code>:avg</code> - average of variances</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2528">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-population-stddev"></span>
</section>
<section id="population-stddev" class="level4">
<h4 class="anchored" data-anchor-id="population-stddev">population-stddev</h4>
<ul>
<li><code>(population-stddev vs)</code></li>
<li><code>(population-stddev vs mu)</code></li>
</ul>
<p>Calculate population standard deviation of <code>vs</code>.</p>
<p>See <a href="#LOS-stddev">stddev</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L530">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-population-variance"></span>
</section>
<section id="population-variance" class="level4">
<h4 class="anchored" data-anchor-id="population-variance">population-variance</h4>
<ul>
<li><code>(population-variance vs)</code></li>
<li><code>(population-variance vs mu)</code></li>
</ul>
<p>Calculate population variance of <code>vs</code>.</p>
<p>See <a href="#LOS-variance">variance</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L494">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-population-wstddev"></span>
</section>
<section id="population-wstddev" class="level4">
<h4 class="anchored" data-anchor-id="population-wstddev">population-wstddev</h4>
<ul>
<li><code>(population-wstddev vs weights)</code></li>
</ul>
<p>Calculate population weighted standard deviation of <code>vs</code></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L539">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-population-wvariance"></span>
</section>
<section id="population-wvariance" class="level4">
<h4 class="anchored" data-anchor-id="population-wvariance">population-wvariance</h4>
<ul>
<li><code>(population-wvariance vs freqs)</code></li>
</ul>
<p>Calculate weighted population variance of <code>vs</code>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L503">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-power-divergence-test"></span>
</section>
<section id="power-divergence-test" class="level4">
<h4 class="anchored" data-anchor-id="power-divergence-test">power-divergence-test</h4>
<ul>
<li><code>(power-divergence-test contingency-table-or-xs)</code></li>
<li><code>(power-divergence-test contingency-table-or-xs {:keys [lambda ci-sides sides p alpha bootstrap-samples ddof bins], :or {lambda m/TWO_THIRD, sides :one-sided-greater, ci-sides :two-sided, alpha 0.05, bootstrap-samples 1000, ddof 0}})</code></li>
</ul>
<p>Performs a power divergence test, which encompasses several common statistical tests like Chi-squared, G-test (likelihood ratio), etc., based on the lambda parameter. This function can perform either a goodness-of-fit test or a test for independence in a contingency table.</p>
<p>Usage:</p>
<ol type="1">
<li><strong>Goodness-of-Fit (GOF):</strong>
<ul>
<li>Input: <code>observed-counts</code> (sequence of numbers) and <code>:p</code> (expected probabilities/weights).</li>
<li>Input: <code>data</code> (sequence of numbers) and <code>:p</code> (a distribution object). In this case, a histogram of <code>data</code> is created (controlled by <code>:bins</code>) and compared against the probability mass/density of the distribution in those bins.</li>
</ul></li>
<li><strong>Test for Independence:</strong>
<ul>
<li>Input: <code>contingency-table</code> (2D sequence or map format). The <code>:p</code> option is ignored.</li>
</ul></li>
</ol>
<p>Options map:</p>
<ul>
<li><code>:lambda</code> (double, default: <code>2/3</code>): Determines the specific test statistic. Common values:
<ul>
<li><code>1.0</code>: Pearson Chi-squared test (<a href="#LOS-chisq-test">chisq-test</a>).</li>
<li><code>0.0</code>: G-test / Multinomial Likelihood Ratio test (<a href="#LOS-multinomial-likelihood-ratio-test">multinomial-likelihood-ratio-test</a>).</li>
<li><code>-0.5</code>: Freeman-Tukey test (<a href="#LOS-freeman-tukey-test">freeman-tukey-test</a>).</li>
<li><code>-1.0</code>: Minimum Discrimination Information test (<a href="#LOS-minimum-discrimination-information-test">minimum-discrimination-information-test</a>).</li>
<li><code>-2.0</code>: Neyman Modified Chi-squared test (<a href="#LOS-neyman-modified-chisq-test">neyman-modified-chisq-test</a>).</li>
<li><code>2/3</code>: Cressie-Read test (default, <a href="#LOS-cressie-read-test">cressie-read-test</a>).</li>
</ul></li>
<li><code>:p</code> (seq of numbers or distribution): Expected probabilities/weights (for GOF with counts) or a <code>fastmath.random</code> distribution object (for GOF with data). Ignored for independence tests.</li>
<li><code>:alpha</code> (double, default: <code>0.05</code>): Significance level for confidence intervals.</li>
<li><code>:ci-sides</code> (keyword, default: <code>:two-sided</code>): Sides for bootstrap confidence intervals (<code>:two-sided</code>, <code>:one-sided-greater</code>, <code>:one-sided-less</code>).</li>
<li><code>:sides</code> (keyword, default: <code>:one-sided-greater</code>): Alternative hypothesis side for the p-value calculation against the Chi-squared distribution (<code>:one-sided-greater</code>, <code>:one-sided-less</code>, <code>:two-sided</code>).</li>
<li><code>:bootstrap-samples</code> (long, default: <code>1000</code>): Number of bootstrap samples for confidence interval estimation.</li>
<li><code>:ddof</code> (long, default: <code>0</code>): Delta degrees of freedom. Adjustment subtracted from the calculated degrees of freedom.</li>
<li><code>:bins</code> (number, keyword, or seq): Used only for GOF test against a distribution. Specifies the number of bins, an estimation method (see <a href="#LOS-histogram">histogram</a>), or explicit bin edges for histogram creation.</li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:stat</code>: The calculated power divergence test statistic.</li>
<li><code>:chi2</code>: Alias for <code>:stat</code>.</li>
<li><code>:df</code>: Degrees of freedom for the test.</li>
<li><code>:p-value</code>: The p-value associated with the test statistic.</li>
<li><code>:n</code>: Total number of observations.</li>
<li><code>:estimate</code>: Observed proportions.</li>
<li><code>:expected</code>: Expected counts or proportions under the null hypothesis.</li>
<li><code>:confidence-interval</code>: Bootstrap confidence intervals for the observed proportions.</li>
<li><code>:lambda</code>, <code>:alpha</code>, <code>:sides</code>, <code>:ci-sides</code>: Input options used.</li>
</ul>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5664">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-power-transformation"></span>
</section>
<section id="power-transformation-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="power-transformation-deprecated">power-transformation <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use `(box-cox-transformation xs lambda {:scaled true})</em></p>
<ul>
<li><code>(power-transformation xs)</code></li>
<li><code>(power-transformation xs lambda)</code></li>
<li><code>(power-transformation xs lambda alpha)</code></li>
</ul>
<p>Applies a power transformation to a data.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6498">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-powmean"></span>
</section>
<section id="powmean" class="level4">
<h4 class="anchored" data-anchor-id="powmean">powmean</h4>
<ul>
<li><code>(powmean vs power)</code></li>
<li><code>(powmean vs weights power)</code></li>
</ul>
<p>Calculates the generalized power mean (also known as the Hölder mean) of a sequence <code>vs</code>.</p>
<p>The power mean is a generalization of the Pythagorean means (arithmetic, geometric, harmonic) and other means like the quadratic mean (RMS). It is defined for a non-zero real number <code>power</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of numbers. Constraints depend on the <code>power</code>:
<ul>
<li>For <code>power &gt; 0</code>, values should be non-negative.</li>
<li>For <code>power = 0</code>, values must be positive (reduces to geometric mean).</li>
<li>For <code>power &lt; 0</code>, values must be positive and non-zero.</li>
</ul></li>
<li><code>weights</code> (optional): Sequence of non-negative weights corresponding to <code>vs</code>. Must have the same count as <code>vs</code>.</li>
<li><code>power</code> (double): The exponent defining the mean.</li>
</ul>
<p>Special Cases:</p>
<ul>
<li><code>power = 0</code>: Returns the <a href="#LOS-geomean">geomean</a>.</li>
<li><code>power = 1</code>: Returns the arithmetic <a href="#LOS-mean">mean</a>.</li>
<li><code>power = -1</code>: Equivalent to the <a href="#LOS-harmean">harmean</a>. (Handled by the general formula)</li>
<li><code>power = 2</code>: Returns the Root Mean Square (RMS) or quadratic mean.</li>
<li><code>power = inf</code>: Returns maximum.</li>
<li><code>power = -inf</code>: Returms minimum.</li>
<li>The implementation includes optimized paths for <code>power</code> values 1/3, 0.5, 2, and 3.</li>
</ul>
<p>Returns the calculated power mean as a double.</p>
<p>See also <a href="#LOS-mean">mean</a>, <a href="#LOS-geomean">geomean</a>, <a href="#LOS-harmean">harmean</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L435">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-psnr"></span>
</section>
<section id="psnr" class="level4">
<h4 class="anchored" data-anchor-id="psnr">psnr</h4>
<ul>
<li><code>(psnr [vs1 vs2-or-val])</code></li>
<li><code>(psnr vs1 vs2-or-val)</code></li>
<li><code>(psnr vs1 vs2-or-val max-value)</code></li>
</ul>
<p>Peak Signal-to-Noise Ratio (PSNR).</p>
<p>PSNR is a measure used to quantify the quality of reconstruction of lossy compression codecs (e.g., for images or video). It is calculated using the Mean Squared Error (MSE) between the original and compressed images/signals. A higher PSNR generally indicates a higher quality signal reconstruction (i.e., less distortion).</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence (conventionally, the original or reference signal/data).</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence (conventionally, the reconstructed or noisy signal/data), or a single number to compare against each element of <code>vs1</code>.</li>
<li><code>max-value</code> (optional, double): The maximum possible value of a sample in the data. If not provided, the function automatically determines the maximum value present across both input sequences (<code>vs1</code> and <code>vs2</code> if a sequence, or <code>vs1</code> and the scalar value if <code>vs2-or-val</code> is a number). Providing an explicit <code>max-value</code> is often more appropriate based on the data type’s theoretical maximum range (e.g., 255 for 8-bit).</li>
</ul>
<p>If <code>vs2-or-val</code> is a sequence, both <code>vs1</code> and <code>vs2</code> must have the same length.</p>
<p>Returns the calculated Peak Signal-to-Noise Ratio as a double. Returns <code>-Double/Infinity</code> if the MSE is zero (perfect match). Returns <code>NaN</code> if MSE is non-positive.</p>
<p>See also <a href="#LOS-mse">mse</a>, <a href="#LOS-rmse">rmse</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2157">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-quantile"></span>
</section>
<section id="quantile" class="level4">
<h4 class="anchored" data-anchor-id="quantile">quantile</h4>
<ul>
<li><code>(quantile vs q)</code></li>
<li><code>(quantile vs q estimation-strategy)</code></li>
</ul>
<p>Calculates the q-th quantile of a sequence <code>vs</code>.</p>
<p>The quantile <code>q</code> is a value between 0.0 and 1.0, inclusive.</p>
<p>An optional <code>estimation-strategy</code> keyword can be provided to specify the method used for estimating the quantile, particularly how interpolation is handled when the desired quantile falls between data points in the sorted sequence.</p>
<p>Available <code>estimation-strategy</code> values:</p>
<ul>
<li><code>:legacy</code> (Default): The original method used in Apache Commons Math.</li>
<li><code>:r1</code> through <code>:r9</code>: Correspond to the nine quantile estimation algorithms recommended by Hyndman and Fan (1996). Each strategy differs slightly in how it calculates the index (e.g., using <code>np</code> or <code>(n+1)p</code>) and how it interpolates between points.</li>
</ul>
<p>For detailed mathematical descriptions of each estimation strategy, refer to the <a href="http://commons.apache.org/proper/commons-math/javadocs/api-3.6.1/org/apache/commons/math3/stat/descriptive/rank/Percentile.EstimationType.html">Apache Commons Math Percentile documentation</a>.</p>
<p>See also <a href="#LOS-percentile">percentile</a> (which uses a 0-100 range) and <a href="#LOS-quantiles">quantiles</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L200">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-quantile-extent"></span>
</section>
<section id="quantile-extent" class="level4">
<h4 class="anchored" data-anchor-id="quantile-extent">quantile-extent</h4>
<ul>
<li><code>(quantile-extent vs)</code></li>
<li><code>(quantile-extent vs q)</code></li>
<li><code>(quantile-extent vs q1 q2)</code></li>
<li><code>(quantile-extent vs q1 q2 estimation-strategy)</code></li>
</ul>
<p>Return quantile range and median.</p>
<p><code>q</code> - calculates extent of <code>q</code> and <code>1.0-q</code> (default: <code>q=0.25</code>)</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L706">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-quantiles"></span>
</section>
<section id="quantiles" class="level4">
<h4 class="anchored" data-anchor-id="quantiles">quantiles</h4>
<ul>
<li><code>(quantiles vs)</code></li>
<li><code>(quantiles vs qs)</code></li>
<li><code>(quantiles vs qs estimation-strategy)</code></li>
</ul>
<p>Calculates the sequence of q-th quantiles of a sequence <code>vs</code>.</p>
<p>Quantiles <code>q</code> is a sequence of values between 0.0 and 1.0, inclusive.</p>
<p>An optional <code>estimation-strategy</code> keyword can be provided to specify the method used for estimating the quantile, particularly how interpolation is handled when the desired quantile falls between data points in the sorted sequence.</p>
<p>Available <code>estimation-strategy</code> values:</p>
<ul>
<li><code>:legacy</code> (Default): The original method used in Apache Commons Math.</li>
<li><code>:r1</code> through <code>:r9</code>: Correspond to the nine quantile estimation algorithms recommended by Hyndman and Fan (1996). Each strategy differs slightly in how it calculates the index (e.g., using <code>np</code> or <code>(n+1)p</code>) and how it interpolates between points.</li>
</ul>
<p>For detailed mathematical descriptions of each estimation strategy, refer to the <a href="http://commons.apache.org/proper/commons-math/javadocs/api-3.6.1/org/apache/commons/math3/stat/descriptive/rank/Percentile.EstimationType.html">Apache Commons Math Percentile documentation</a>.</p>
<p>See also <a href="#LOS-percentiles">percentiles</a> (which uses a 0-100 range) and <a href="#LOS-quantile">quantile</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L225">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-r2"></span>
</section>
<section id="r2" class="level4">
<h4 class="anchored" data-anchor-id="r2">r2</h4>
<ul>
<li><code>(r2 [vs1 vs2-or-val])</code></li>
<li><code>(r2 vs1 vs2-or-val)</code></li>
<li><code>(r2 vs1 vs2-or-val no-of-variables)</code></li>
</ul>
<p>Calculates the Coefficient of Determination (<span class="math inline">\(R^2\)</span>) or adjusted version between two sequences or a sequence and a constant value.</p>
<p><span class="math inline">\(R^2\)</span> is a statistical measure that represents the proportion of the variance in the dependent variable that is predictable from the independent variable(s) in a statistical model. It indicates how well the model fits the observed data.</p>
<p>The standard <span class="math inline">\(R^2\)</span> is calculated as <span class="math inline">\(1 - (RSS / TSS)\)</span>, where: - <span class="math inline">\(RSS\)</span> (Residual Sum of Squares) is the sum of the squared differences between the observed values (<code>vs1</code>) and the predicted/reference values (<code>vs2</code> or <code>vs2-or-val</code>). See <a href="#LOS-rss">rss</a>. - <span class="math inline">\(TSS\)</span> (Total Sum of Squares) is the sum of the squared differences between the observed values (<code>vs1</code>) and their mean. This is calculated using <a href="#LOS-moment">moment</a> of order 2 with <code>:mean?</code> set to <code>false</code>.</p>
<p>This function has two arities:</p>
<ol type="1">
<li><p><code>(r2 vs1 vs2-or-val)</code>: Calculates the standard <span class="math inline">\(R^2\)</span>.</p>
<ul>
<li><code>vs1</code> (seq of numbers): The sequence of observed or actual values.</li>
<li><code>vs2-or-val</code> (seq of numbers or single number): The sequence of predicted or reference values, or a single constant value to compare against.</li>
</ul>
<p>Returns the calculated standard <span class="math inline">\(R^2\)</span> as a double. For simple linear regression, this is equal to the square of the Pearson correlation coefficient (<a href="#LOS-r2-determination">r2-determination</a>). <span class="math inline">\(R^2\)</span> typically ranges from 0 to 1 in this context, but can be negative if the chosen model fits the data worse than a horizontal line through the mean of the observed data.</p></li>
<li><p><code>(r2 vs1 vs2-or-val no-of-variables)</code>: Calculates the <strong>Adjusted <span class="math inline">\(R^2\)</span></strong>. The adjusted <span class="math inline">\(R^2\)</span> is a modified version of <span class="math inline">\(R^2\)</span> that has been adjusted for the number of predictors in the model. It increases only if the new term improves the model more than would be expected by chance. The formula for adjusted <span class="math inline">\(R^2\)</span> is: <span class="math display">\[ R^2_{adj} = 1 - (1 - R^2) \frac{n-1}{n-p-1} \]</span> where <span class="math inline">\(n\)</span> is the number of observations (length of <code>vs1</code>) and <span class="math inline">\(p\)</span> is the number of independent variables (<code>no-of-variables</code>).</p>
<ul>
<li><code>vs1</code> (seq of numbers): The sequence of observed or actual values.</li>
<li><code>vs2-or-val</code> (seq of numbers or single number): The sequence of predicted or reference values, or a single constant value to compare against.</li>
<li><code>no-of-variables</code> (double): The number of independent variables (<span class="math inline">\(p\)</span>) used in the model that produced the <code>vs2-or-val</code> predictions.</li>
</ul>
<p>Returns the calculated adjusted <span class="math inline">\(R^2\)</span> as a double.</p></li>
</ol>
<p>Both <code>vs1</code> and <code>vs2</code> (if <code>vs2-or-val</code> is a sequence) must have the same length.</p>
<p>See also <a href="#LOS-rss">rss</a>, <a href="#LOS-mse">mse</a>, <a href="#LOS-rmse">rmse</a>, <a href="#LOS-pearson-correlation">pearson-correlation</a>, <a href="#LOS-r2-determination">r2-determination</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1924">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-r2-determination"></span>
</section>
<section id="r2-determination" class="level4">
<h4 class="anchored" data-anchor-id="r2-determination">r2-determination</h4>
<ul>
<li><code>(r2-determination [group1 group2])</code></li>
<li><code>(r2-determination group1 group2)</code></li>
</ul>
<p>Calculates the Coefficient of Determination (<span class="math inline">\(R^2\)</span>) between two sequences.</p>
<p>This function computes the square of the Pearson product-moment correlation coefficient (<a href="#LOS-pearson-correlation">pearson-correlation</a>) between <code>group1</code> and <code>group2</code>.</p>
<p><span class="math inline">\(R^2\)</span> measures the proportion of the variance in one variable that is predictable from the other variable in a linear relationship. For a simple linear regression with one independent variable, this value is equivalent to the <span class="math inline">\(R^2\)</span> calculated from the Residual Sum of Squares (RSS) and Total Sum of Squares (TSS).</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first sequence.</li>
<li><code>group2</code> (seq of numbers): The second sequence.</li>
</ul>
<p>Both sequences must have the same length.</p>
<p>Returns the calculated <span class="math inline">\(R^2\)</span> value (a double between 0.0 and 1.0) as a double. Returns <code>NaN</code> if the Pearson correlation cannot be calculated (e.g., one sequence is constant).</p>
<p>See also <a href="#LOS-r2">r2</a> (for general <span class="math inline">\(R^2\)</span> and adjusted <span class="math inline">\(R^2\)</span>), <a href="#LOS-pearson-correlation">pearson-correlation</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3171">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-rank-epsilon-sq"></span>
</section>
<section id="rank-epsilon-sq" class="level4">
<h4 class="anchored" data-anchor-id="rank-epsilon-sq">rank-epsilon-sq</h4>
<ul>
<li><code>(rank-epsilon-sq xss)</code></li>
</ul>
<p>Calculates Rank Epsilon-squared (ε²), a measure of effect size for the Kruskal-Wallis H-test.</p>
<p>Rank Epsilon-squared is a non-parametric measure quantifying the proportion of the total variability (based on ranks) in the dependent variable that is associated with group membership (the independent variable). It is analogous to Eta-squared or Epsilon-squared in one-way ANOVA but used for the rank-based Kruskal-Wallis test.</p>
<p>This function calculates Epsilon-squared based on the Kruskal-Wallis H statistic (<code>H</code>) and the total number of observations (<code>n</code>) across all groups.</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences): A collection where each element is a sequence representing a group of observations, as used in <a href="#LOS-kruskal-test">kruskal-test</a>.</li>
</ul>
<p>Returns the calculated Rank Epsilon-squared value as a double, ranging from 0 to 1.</p>
<p>Interpretation:</p>
<ul>
<li>A value of 0 indicates no difference in the distributions across groups.</li>
<li>A value closer to 1 indicates that a large proportion of the variability is due to differences between group ranks.</li>
</ul>
<p>Rank Epsilon-squared is a useful supplement to the Kruskal-Wallis test, providing a measure of the magnitude of the group effect that is not sensitive to assumptions about the data distribution shape (beyond having similar shapes for valid interpretation of the Kruskal-Wallis test itself).</p>
<p>See also <a href="#LOS-kruskal-test">kruskal-test</a>, <a href="#LOS-rank-eta-sq">rank-eta-sq</a> (another rank-based effect size).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3438">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-rank-eta-sq"></span>
</section>
<section id="rank-eta-sq" class="level4">
<h4 class="anchored" data-anchor-id="rank-eta-sq">rank-eta-sq</h4>
<ul>
<li><code>(rank-eta-sq xss)</code></li>
</ul>
<p>Calculates the Rank Eta-squared (η²), an effect size measure for the Kruskal-Wallis H-test.</p>
<p>Rank Eta-squared is a non-parametric measure quantifying the proportion of the total variability (based on ranks) in the dependent variable that is associated with group membership (the independent variable). It is analogous to Eta-squared in one-way ANOVA but used for the rank-based Kruskal-Wallis test.</p>
<p>The statistic is calculated based on the Kruskal-Wallis H statistic, the number of groups (<code>k</code>), and the total number of observations (<code>n</code>).</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences): A collection where each element is a sequence representing a group of observations, as used in <a href="#LOS-kruskal-test">kruskal-test</a>.</li>
</ul>
<p>Returns the calculated Rank Eta-squared value as a double, ranging from 0 to 1.</p>
<p>Interpretation: - A value of 0 indicates no difference in the distributions across groups (all variability is within groups). - A value closer to 1 indicates that a large proportion of the variability is due to differences between group ranks.</p>
<p>Rank Eta-squared is a useful supplement to the Kruskal-Wallis test, providing a measure of the magnitude of the group effect that is not sensitive to assumptions about the data distribution shape (beyond having similar shapes for valid interpretation of the Kruskal-Wallis test itself).</p>
<p>See also <a href="#LOS-kruskal-test">kruskal-test</a>, <a href="#LOS-rank-epsilon-sq">rank-epsilon-sq</a> (another rank-based effect size).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3404">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-remove-outliers"></span>
</section>
<section id="remove-outliers" class="level4">
<h4 class="anchored" data-anchor-id="remove-outliers">remove-outliers</h4>
<ul>
<li><code>(remove-outliers vs)</code></li>
<li><code>(remove-outliers vs estimation-strategy)</code></li>
<li><code>(remove-outliers vs q1 q3)</code></li>
</ul>
<p>Remove outliers defined as values outside inner fences.</p>
<p>Let Q1 is 25-percentile and Q3 is 75-percentile. IQR is <code>(- Q3 Q1)</code>.</p>
<ul>
<li>LIF (Lower Inner Fence) equals <code>(- Q1 (* 1.5 IQR))</code>.</li>
<li>UIF (Upper Inner Fence) equals <code>(+ Q3 (* 1.5 IQR))</code>.</li>
</ul>
<p>Returns a sequence without outliers.</p>
<p>Optional <code>estimation-strategy</code> argument can be set to change quantile calculations estimation type. See <a href="#LOS-estimation-strategies">estimation-strategies</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L856">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-rescale"></span>
</section>
<section id="rescale" class="level4">
<h4 class="anchored" data-anchor-id="rescale">rescale</h4>
<ul>
<li><code>(rescale vs)</code></li>
<li><code>(rescale vs low high)</code></li>
</ul>
<p>Lineary rascale data to desired range, [0,1] by default</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1557">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-rmse"></span>
</section>
<section id="rmse" class="level4">
<h4 class="anchored" data-anchor-id="rmse">rmse</h4>
<ul>
<li><code>(rmse [vs1 vs2-or-val])</code></li>
<li><code>(rmse vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the Root Mean Squared Error (RMSE) between two sequences or a sequence and a constant value.</p>
<p>RMSE is the square root of the <a href="#LOS-mse">mse</a> (Mean Squared Error). It represents the standard deviation of the residuals (prediction errors) and has the same units as the original data, making it more interpretable than MSE. It measures the average magnitude of the errors, penalizing larger errors more than smaller ones due to the squaring involved.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence (often the observed or true values).</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence (often the predicted or reference values), or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both inputs are sequences, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated Root Mean Squared Error as a double.</p>
<p>See also <a href="#LOS-mse">mse</a> (Mean Squared Error), <a href="#LOS-rss">rss</a> (Residual Sum of Squares), <a href="#LOS-me">me</a> (Mean Error), <a href="#LOS-mae">mae</a> (Mean Absolute Error), <a href="#LOS-r2">r2</a> (Coefficient of Determination).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2015">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-robust-standardize"></span>
</section>
<section id="robust-standardize" class="level4">
<h4 class="anchored" data-anchor-id="robust-standardize">robust-standardize</h4>
<ul>
<li><code>(robust-standardize vs)</code></li>
<li><code>(robust-standardize vs q)</code></li>
</ul>
<p>Normalize samples to have median = 0 and MAD = 1.</p>
<p>If <code>q</code> argument is used, scaling is done by quantile difference (Q_q, Q_(1-q)). Set 0.25 for IQR.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1536">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-rows->contingency-table"></span>
</section>
<section id="rows-contingency-table" class="level4">
<h4 class="anchored" data-anchor-id="rows-contingency-table">rows-&gt;contingency-table</h4>
<ul>
<li><code>(rows-&gt;contingency-table xss)</code></li>
</ul>
<p>Converts a sequence of sequences (representing rows of counts) into a map-based contingency table.</p>
<p>This function takes a collection where each inner sequence is treated as a row of counts in a grid or matrix. It transforms this matrix representation into a map where keys are <code>[row-index, column-index]</code> tuples and values are the non-zero counts at that intersection.</p>
<p>This is particularly useful for converting structured count data, like the output of some grouping or tabulation processes, into a format suitable for functions expecting a contingency table map (like <code>contingency-table-&gt;marginals</code> or chi-squared tests).</p>
<p>Parameters:</p>
<ul>
<li><code>xss</code> (sequence of sequences of numbers): A collection where each inner sequence <code>xs_i</code> contains counts for row <code>i</code>. Values within <code>xs_i</code> are interpreted as counts for columns <code>0, 1, ...</code>.</li>
</ul>
<p>Returns a map where keys are <code>[row-index, column-index]</code> vectors and values are the corresponding non-zero counts from the input matrix. Zero counts are omitted from the output map.</p>
<p>See also <a href="#LOS-contingency-table">contingency-table</a> (for building tables from raw data), <a href="#LOS-contingency-table-%3Emarginals">contingency-table-&gt;marginals</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3499">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-rss"></span>
</section>
<section id="rss" class="level4">
<h4 class="anchored" data-anchor-id="rss">rss</h4>
<ul>
<li><code>(rss [vs1 vs2-or-val])</code></li>
<li><code>(rss vs1 vs2-or-val)</code></li>
</ul>
<p>Calculates the Residual Sum of Squares (RSS) between two sequences or a sequence and a constant value.</p>
<p>RSS is a measure of the discrepancy between data and a model, often used in regression analysis to quantify the total squared difference between observed values and predicted (or reference) values.</p>
<p>Parameters:</p>
<ul>
<li><code>vs1</code> (sequence of numbers): The first sequence (often observed values).</li>
<li><code>vs2-or-val</code> (sequence of numbers or single number): The second sequence (often predicted or reference values), or a single number to compare against each element of <code>vs1</code>.</li>
</ul>
<p>If both sequences (<code>vs1</code> and <code>vs2</code>) are provided, they must have the same length. If <code>vs2-or-val</code> is a single number, it is effectively treated as a sequence of that number repeated <code>count(vs1)</code> times.</p>
<p>Returns the calculated Residual Sum of Squares as a double.</p>
<p>See also <a href="#LOS-mse">mse</a> (Mean Squared Error), <a href="#LOS-rmse">rmse</a> (Root Mean Squared Error), <a href="#LOS-r2">r2</a> (Coefficient of Determination).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1898">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-second-moment"></span>
</section>
<section id="second-moment-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="second-moment-deprecated">second-moment <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use <a href="#LOS-moment">moment</a> function</em></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1059">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-sem"></span>
</section>
<section id="sem" class="level4">
<h4 class="anchored" data-anchor-id="sem">sem</h4>
<ul>
<li><code>(sem vs)</code></li>
</ul>
<p>Calculates the Standard Error of the Mean (SEM) for a sequence <code>vs</code>.</p>
<p>The SEM estimates the standard deviation of the sample mean, providing an indication of how accurately the sample mean represents the population mean. It is calculated as:</p>
<p><code>SEM = stddev(vs) / sqrt(count(vs))</code></p>
<p>where <code>stddev(vs)</code> is the sample standard deviation and <code>count(vs)</code> is the sample size.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of numbers.</li>
</ul>
<p>Returns the calculated SEM as a double.</p>
<p>A smaller SEM indicates that the sample mean is likely to be a more precise estimate of the population mean.</p>
<p>See also <a href="#LOS-stddev">stddev</a>, <a href="#LOS-mean">mean</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L653">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-sem-extent"></span>
</section>
<section id="sem-extent" class="level4">
<h4 class="anchored" data-anchor-id="sem-extent">sem-extent</h4>
<ul>
<li><code>(sem-extent vs)</code></li>
</ul>
<p>-/+ sem and mean</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L691">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-similarity"></span>
</section>
<section id="similarity" class="level4">
<h4 class="anchored" data-anchor-id="similarity">similarity</h4>
<ul>
<li><code>(similarity method P-observed Q-expected)</code></li>
<li><code>(similarity method P-observed Q-expected {:keys [bins probabilities? epsilon], :or {probabilities? true, epsilon 1.0E-6}})</code></li>
</ul>
<p>Various PDF similarities between two histograms (frequencies) or probabilities.</p>
<p>Q can be a distribution object. Then, histogram will be created out of P.</p>
<p>Arguments:</p>
<ul>
<li><code>method</code> - distance method</li>
<li><code>P-observed</code> - frequencies, probabilities or actual data (when Q is a distribution)</li>
<li><code>Q-expected</code> - frequencies, probabilities or distribution object (when P is a data)</li>
</ul>
<p>Options:</p>
<ul>
<li><code>:probabilities?</code> - should P/Q be converted to a probabilities, default: <code>true</code>.</li>
<li><code>:epsilon</code> - small number which replaces <code>0.0</code> when division or logarithm is used`</li>
<li><code>:bins</code> - number of bins or bins estimation method, see <a href="#LOS-histogram">histogram</a>.</li>
</ul>
<p>The list of methods: <code>:intersection</code>, <code>:czekanowski</code>, <code>:motyka</code>, <code>:kulczynski</code>, <code>:ruzicka</code>, <code>:inner-product</code>, <code>:harmonic-mean</code>, <code>:cosine</code>, <code>:jaccard</code>, <code>:dice</code>, <code>:fidelity</code>, <code>:squared-chord</code></p>
<p>See more: Comprehensive Survey on Distance/Similarity Measures between Probability Density Functions by Sung-Hyuk Cha</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2479">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-skewness"></span>
</section>
<section id="skewness-1" class="level4">
<h4 class="anchored" data-anchor-id="skewness-1">skewness</h4>
<ul>
<li><code>(skewness vs)</code></li>
<li><code>(skewness vs typ)</code></li>
</ul>
<p>Calculate skewness from sequence, a measure of the asymmetry of the probability distribution about its mean.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code> (seq of numbers): The input sequence.</li>
<li><code>typ</code> (keyword or sequence, optional): Specifies the type of skewness measure to calculate. Defaults to <code>:G1</code>.</li>
</ul>
<p>Available <code>typ</code> values:</p>
<ul>
<li><code>:G1</code> (Default): Sample skewness based on the third standardized moment, as implemented by Apache Commons Math <code>Skewness</code>. Adjusted for sample size bias.</li>
<li><code>:g1</code> or <code>:pearson</code>: Pearson’s moment coefficient of skewness (g1), a bias-adjusted version of the third standardized moment. Expected value 0 for symmetric distributions.</li>
<li><code>:b1</code>: Sample skewness coefficient (b1), related to :g1.</li>
<li><code>:B1</code> or <code>:yule</code>: Yule’s coefficient (robust), based on quantiles. Takes an optional quantile <code>u</code> (default 0.25) via sequence <code>[:B1 u]</code> or <code>[:yule u]</code>.</li>
<li><code>:B3</code>: Robust measure comparing the mean and median relative to the mean absolute deviation around the median.</li>
<li><code>:skew</code>: An adjusted skewness definition sometimes used in bootstrap (BCa) calculations.</li>
<li><code>:mode</code>: Pearson’s second skewness coefficient: <code>(mean - mode) / stddev</code>. Requires calculating the mode. Mode calculation method can be specified via sequence <code>[:mode method opts]</code>, see <a href="#LOS-mode">mode</a>.</li>
<li><code>:median</code>: Robust measure: <code>3 * (mean - median) / stddev</code>.</li>
<li><code>:bowley</code>: Bowley’s coefficient (robust), based on quartiles (Q1, Q2, Q3). Also known as Yule-Bowley coefficient. Calculated as <code>(Q3 + Q1 - 2*Q2) / (Q3 - Q1)</code>.</li>
<li><code>:hogg</code>: Hogg’s robust measure based on the ratio of differences between trimmed means.</li>
<li><code>:l-skewness</code>: L-skewness (τ₃), the ratio of the 3rd L-moment (λ₃) to the 2nd L-moment (λ₂, L-scale). Calculated directly using <a href="#LOS-l-moment">l-moment</a> with the <code>:ratio?</code> option set to true. It’s a robust measure of asymmetry. Expected value 0 for symmetric distributions.</li>
</ul>
<p>Interpretation:</p>
<ul>
<li>Positive values generally indicate a distribution skewed to the right (tail is longer on the right).</li>
<li>Negative values generally indicate a distribution skewed to the left (tail is longer on the left).</li>
<li>Values near 0 suggest relative symmetry.</li>
</ul>
<p>Returns the calculated skewness value as a double.</p>
<p>See also <a href="#LOS-skewness-test">skewness-test</a>, <a href="#LOS-normality-test">normality-test</a>, <a href="#LOS-jarque-bera-test">jarque-bera-test</a>, <a href="#LOS-l-moment">l-moment</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1223">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-skewness-test"></span>
</section>
<section id="skewness-test" class="level4">
<h4 class="anchored" data-anchor-id="skewness-test">skewness-test</h4>
<ul>
<li><code>(skewness-test xs)</code></li>
<li><code>(skewness-test xs params)</code></li>
<li><code>(skewness-test xs skew {:keys [sides type], :or {sides :two-sided, type :g1}})</code></li>
</ul>
<p>Performs the D’Agostino test for normality based on sample skewness.</p>
<p>This test assesses the null hypothesis that the data comes from a normally distributed population by checking if the sample skewness significantly deviates from the zero skewness expected under normality.</p>
<p>The test works by:</p>
<ol type="1">
<li>Calculating the sample skewness (type configurable via <code>:type</code>, default <code>:g1</code>).</li>
<li>Standardizing the sample skewness relative to its expected value (0) and standard error under the null hypothesis.</li>
<li>Applying a further transformation (inverse hyperbolic sine based) to this standardized score to yield a final test statistic <code>Z</code> that more closely follows a standard normal distribution under the null hypothesis.</li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data.</li>
<li><code>skew</code> (double, optional): A pre-calculated skewness value. If omitted, it’s calculated from <code>xs</code>.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis.
<ul>
<li><code>:two-sided</code> (default): The population skewness is different from 0.</li>
<li><code>:one-sided-greater</code>: The population skewness is greater than 0 (right-skewed).</li>
<li><code>:one-sided-less</code>: The population skewness is less than 0 (left-skewed).</li>
</ul></li>
<li><code>:type</code> (keyword, default <code>:g1</code>): The type of skewness to calculate if <code>skew</code> is not provided. Note that the internal normalization constants are derived based on <code>:g1</code>. See <a href="#LOS-skewness">skewness</a> for options.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:Z</code>: The final test statistic, approximately standard normal under H0.</li>
<li><code>:stat</code>: Alias for <code>:Z</code>.</li>
<li><code>:p-value</code>: The p-value associated with <code>Z</code> and the specified <code>:sides</code>.</li>
<li><code>:skewness</code>: The sample skewness value used in the test (either provided or calculated).</li>
</ul>
<p>See also <a href="#LOS-kurtosis-test">kurtosis-test</a>, <a href="#LOS-normality-test">normality-test</a>, <a href="#LOS-jarque-bera-test">jarque-bera-test</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L4893">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-span"></span>
</section>
<section id="span" class="level4">
<h4 class="anchored" data-anchor-id="span">span</h4>
<ul>
<li><code>(span vs)</code></li>
</ul>
<p>Width of the sample, maximum value minus minimum value</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L815">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-spearman-correlation"></span>
</section>
<section id="spearman-correlation" class="level4">
<h4 class="anchored" data-anchor-id="spearman-correlation">spearman-correlation</h4>
<ul>
<li><code>(spearman-correlation [vs1 vs2])</code></li>
<li><code>(spearman-correlation vs1 vs2)</code></li>
</ul>
<p>Calculates Spearman’s rank correlation coefficient between two sequences.</p>
<p>Spearman’s rank correlation is a non-parametric measure of the monotonic relationship between two datasets. It assesses how well the relationship between two variables can be described using a monotonic function. It does not require the data to be linearly related or follow a specific distribution. The coefficient is calculated on the ranks of the data rather than the raw values.</p>
<p>Parameters:</p>
<ul>
<li><code>[vs1 vs2]</code> (sequence of two sequences): A sequence containing the two sequences of numbers.</li>
<li><code>vs1</code>, <code>vs2</code> (sequences): The two sequences of numbers directly as arguments.</li>
</ul>
<p>Both sequences must have the same length.</p>
<p>Returns the calculated Spearman rank correlation coefficient (a value between -1.0 and 1.0) as a double. A value of 1 indicates a perfect monotonic increasing relationship, -1 a perfect monotonic decreasing relationship, and 0 no monotonic relationship.</p>
<p>See also <a href="#LOS-pearson-correlation">pearson-correlation</a>, <a href="#LOS-kendall-correlation">kendall-correlation</a>, <a href="#LOS-correlation">correlation</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1622">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-standardize"></span>
</section>
<section id="standardize" class="level4">
<h4 class="anchored" data-anchor-id="standardize">standardize</h4>
<ul>
<li><code>(standardize vs)</code></li>
</ul>
<p>Normalize samples to have mean = 0 and stddev = 1.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1531">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-stats-map"></span>
</section>
<section id="stats-map" class="level4">
<h4 class="anchored" data-anchor-id="stats-map">stats-map</h4>
<ul>
<li><code>(stats-map vs)</code></li>
<li><code>(stats-map vs estimation-strategy)</code></li>
</ul>
<p>Calculates a comprehensive set of descriptive statistics for a numerical dataset.</p>
<p>This function computes various summary measures and returns them as a map, providing a quick overview of the data’s central tendency, dispersion, shape, and potential outliers.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code> (seq of numbers): The input sequence of numerical data.</li>
<li><code>estimation-strategy</code> (keyword, optional): Specifies the method for calculating quantiles (including median, quartiles, and values used for fences). Defaults to <code>:legacy</code>. See <a href="#LOS-percentile">percentile</a> or <a href="#LOS-quantile">quantile</a> for available strategies (e.g., <code>:r1</code> through <code>:r9</code>).</li>
</ul>
<p>Returns a map where keys are statistic names (as keywords) and values are their calculated measures:</p>
<ul>
<li><code>:Size</code>: The number of data points in the sequence (count).</li>
<li><code>:Min</code>: The minimum value (see <a href="#LOS-minimum">minimum</a>).</li>
<li><code>:Max</code>: The maximum value (see <a href="#LOS-maximum">maximum</a>).</li>
<li><code>:Range</code>: The difference between the maximum and minimum values (Max - Min).</li>
<li><code>:Mean</code>: The arithmetic average (see <a href="#LOS-mean">mean</a>).</li>
<li><code>:Median</code>: The middle value (see <a href="#LOS-median">median</a> with <code>estimation-strategy</code>).</li>
<li><code>:Mode</code>: The most frequent value (see <a href="#LOS-mode">mode</a> with default method).</li>
<li><code>:Q1</code>: The first quartile (25th percentile) (see <a href="#LOS-percentile">percentile</a> with <code>estimation-strategy</code>).</li>
<li><code>:Q3</code>: The third quartile (75th percentile) (see <a href="#LOS-percentile">percentile</a> with <code>estimation-strategy</code>).</li>
<li><code>:Total</code>: The sum of all values (see <a href="#LOS-sum">sum</a>).</li>
<li><code>:SD</code>: The sample standard deviation (see <a href="#LOS-stddev">stddev</a>).</li>
<li><code>:Variance</code>: The sample variance (SD^2, see <a href="#LOS-variance">variance</a>).</li>
<li><code>:MAD</code>: The Median Absolute Deviation (see <a href="#LOS-median-absolute-deviation">median-absolute-deviation</a>).</li>
<li><code>:SEM</code>: The Standard Error of the Mean (see <a href="#LOS-sem">sem</a>).</li>
<li><code>:LAV</code>: The Lower Adjacent Value (smallest value within the inner fence, see <a href="#LOS-adjacent-values">adjacent-values</a>).</li>
<li><code>:UAV</code>: The Upper Adjacent Value (largest value within the inner fence, see <a href="#LOS-adjacent-values">adjacent-values</a>).</li>
<li><code>:IQR</code>: The Interquartile Range (Q3 - Q1).</li>
<li><code>:LOF</code>: The Lower Outer Fence (Q1 - 3*IQR, see <a href="#LOS-outer-fence-extent">outer-fence-extent</a>).</li>
<li><code>:UOF</code>: The Upper Outer Fence (Q3 + 3*IQR, see <a href="#LOS-outer-fence-extent">outer-fence-extent</a>).</li>
<li><code>:LIF</code>: The Lower Inner Fence (Q1 - 1.5*IQR, see <a href="#LOS-inner-fence-extent">inner-fence-extent</a>).</li>
<li><code>:UIF</code>: The Upper Inner Fence (Q3 + 1.5*IQR, see <a href="#LOS-inner-fence-extent">inner-fence-extent</a>).</li>
<li><code>:Outliers</code>: A sequence of data points falling outside the inner fences (see <a href="#LOS-outliers">outliers</a>).</li>
<li><code>:Kurtosis</code>: A measure of tailedness/peakedness (see <a href="#LOS-kurtosis">kurtosis</a> with default <code>:G2</code> type).</li>
<li><code>:Skewness</code>: A measure of asymmetry (see <a href="#LOS-skewness">skewness</a> with default <code>:G1</code> type).</li>
</ul>
<p>This function is a convenient way to get a standard set of summary statistics for a dataset in a single call.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1446">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-stddev"></span>
</section>
<section id="stddev" class="level4">
<h4 class="anchored" data-anchor-id="stddev">stddev</h4>
<ul>
<li><code>(stddev vs)</code></li>
<li><code>(stddev vs mu)</code></li>
</ul>
<p>Calculate standard deviation of <code>vs</code>.</p>
<p>See <a href="#LOS-population-stddev">population-stddev</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L544">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-stddev-extent"></span>
</section>
<section id="stddev-extent" class="level4">
<h4 class="anchored" data-anchor-id="stddev-extent">stddev-extent</h4>
<ul>
<li><code>(stddev-extent vs)</code></li>
</ul>
<p>-/+ stddev and mean</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L689">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-sum"></span>
</section>
<section id="sum" class="level4">
<h4 class="anchored" data-anchor-id="sum">sum</h4>
<ul>
<li><code>(sum vs)</code></li>
<li><code>(sum vs compensation-method)</code></li>
</ul>
<p>Sum of all <code>vs</code> values.</p>
<p>Possible compensated summation methods are: <code>:kahan</code>, <code>:neumayer</code> and <code>:klein</code></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L124">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-t-test-one-sample"></span>
</section>
<section id="t-test-one-sample" class="level4">
<h4 class="anchored" data-anchor-id="t-test-one-sample">t-test-one-sample</h4>
<ul>
<li><code>(t-test-one-sample xs)</code></li>
<li><code>(t-test-one-sample xs m)</code></li>
</ul>
<p>Performs a one-sample Student’s t-test to compare the sample mean against a hypothesized population mean.</p>
<p>This test assesses the null hypothesis that the true population mean is equal to <code>mu</code>. It is suitable when the population standard deviation is unknown and is estimated from the sample.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:alpha</code> (double, default <code>0.05</code>): Significance level for the confidence interval.</li>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis.
<ul>
<li><code>:two-sided</code> (default): The true mean is not equal to <code>mu</code>.</li>
<li><code>:one-sided-greater</code>: The true mean is greater than <code>mu</code>.</li>
<li><code>:one-sided-less</code>: The true mean is less than <code>mu</code>.</li>
</ul></li>
<li><code>:mu</code> (double, default <code>0.0</code>): The hypothesized population mean under the null hypothesis.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:t</code>: The calculated t-statistic.</li>
<li><code>:stat</code>: Alias for <code>:t</code>.</li>
<li><code>:df</code>: Degrees of freedom (<code>n-1</code>).</li>
<li><code>:p-value</code>: The p-value associated with the t-statistic and <code>:sides</code>.</li>
<li><code>:confidence-interval</code>: Confidence interval for the true population mean.</li>
<li><code>:estimate</code>: The calculated sample mean.</li>
<li><code>:n</code>: The sample size.</li>
<li><code>:mu</code>: The hypothesized population mean used in the test.</li>
<li><code>:stderr</code>: The standard error of the mean (calculated from the sample).</li>
<li><code>:alpha</code>: Significance level used.</li>
<li><code>:sides</code>: Alternative hypothesis side used.</li>
<li><code>:test-type</code>: Alias for <code>:sides</code>.</li>
</ul>
<p>Assumptions:</p>
<ul>
<li>The data are independent observations.</li>
<li>The data are drawn from a population that is approximately normally distributed. (The t-test is relatively robust to moderate violations, especially with larger sample sizes).</li>
</ul>
<p>See also <a href="#LOS-z-test-one-sample">z-test-one-sample</a> for large samples or known population standard deviation.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5266">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-t-test-two-samples"></span>
</section>
<section id="t-test-two-samples" class="level4">
<h4 class="anchored" data-anchor-id="t-test-two-samples">t-test-two-samples</h4>
<ul>
<li><code>(t-test-two-samples xs ys)</code></li>
<li><code>(t-test-two-samples xs ys {:keys [paired? equal-variances?], :or {paired? false, equal-variances? false}, :as params})</code></li>
</ul>
<p>Performs a two-sample Student’s t-test to compare the means of two samples.</p>
<p>This function can perform:</p>
<ul>
<li>An <strong>unpaired t-test</strong> (assuming independent samples) using either:
<ul>
<li><strong>Welch’s t-test</strong> (default: <code>:equal-variances? false</code>): Does not assume equal population variances. Uses the Satterthwaite approximation for degrees of freedom. Recommended unless variances are known to be equal.</li>
<li><strong>Student’s t-test</strong> (<code>:equal-variances? true</code>): Assumes equal population variances and uses a pooled variance estimate.</li>
</ul></li>
<li>A <strong>paired t-test</strong> (<code>:paired? true</code>): Assumes observations in <code>xs</code> and <code>ys</code> are paired (e.g., before/after measurements on the same subjects). This performs a one-sample t-test on the differences between paired observations.</li>
</ul>
<p>The test assesses the null hypothesis that the true difference between the population means (or the mean of the differences for paired test) is equal to <code>mu</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The first sample.</li>
<li><code>ys</code> (seq of numbers): The second sample.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:alpha</code> (double, default <code>0.05</code>): Significance level for the confidence interval.</li>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis.
<ul>
<li><code>:two-sided</code> (default): The true difference in means is not equal to <code>mu</code>.</li>
<li><code>:one-sided-greater</code>: The true difference (<code>mean(xs) - mean(ys)</code> or <code>mean(diff)</code>) is greater than <code>mu</code>.</li>
<li><code>:one-sided-less</code>: The true difference (<code>mean(xs) - mean(ys)</code> or <code>mean(diff)</code>) is less than <code>mu</code>.</li>
</ul></li>
<li><code>:mu</code> (double, default <code>0.0</code>): The hypothesized difference in means under the null hypothesis.</li>
<li><code>:paired?</code> (boolean, default <code>false</code>): If <code>true</code>, performs a paired t-test (requires <code>xs</code> and <code>ys</code> to have the same length). If <code>false</code>, performs an unpaired test.</li>
<li><code>:equal-variances?</code> (boolean, default <code>false</code>): Used only when <code>paired?</code> is <code>false</code>. If <code>true</code>, assumes equal population variances (Student’s). If <code>false</code>, does not assume equal variances (Welch’s).</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:t</code>: The calculated t-statistic.</li>
<li><code>:stat</code>: Alias for <code>:t</code>.</li>
<li><code>:df</code>: Degrees of freedom used for the t-distribution.</li>
<li><code>:p-value</code>: The p-value associated with the t-statistic and <code>:sides</code>.</li>
<li><code>:confidence-interval</code>: Confidence interval for the true difference in means.</li>
<li><code>:estimate</code>: The observed difference between sample means (<code>mean(xs) - mean(ys)</code> or <code>mean(differences)</code>).</li>
<li><code>:n</code>: Sample sizes as <code>[count xs, count ys]</code> (or <code>count diffs</code> if paired).</li>
<li><code>:nx</code>: Sample size of <code>xs</code> (if unpaired).</li>
<li><code>:ny</code>: Sample size of <code>ys</code> (if unpaired).</li>
<li><code>:estimated-mu</code>: Observed sample means as <code>[mean xs, mean ys]</code> (if unpaired).</li>
<li><code>:mu</code>: The hypothesized difference under the null hypothesis.</li>
<li><code>:stderr</code>: The standard error of the difference between the means (or of the mean difference if paired).</li>
<li><code>:alpha</code>: Significance level used.</li>
<li><code>:sides</code>: Alternative hypothesis side used.</li>
<li><code>:test-type</code>: Alias for <code>:sides</code>.</li>
<li><code>:paired?</code>: Boolean indicating if a paired test was performed.</li>
<li><code>:equal-variances?</code>: Boolean indicating the variance assumption used (if unpaired).</li>
</ul>
<p>Assumptions: - Independence of observations (within and between groups for unpaired). - Normality of the underlying populations (or of the differences for paired). The t-test is relatively robust to violations of normality, especially with larger sample sizes. - Equal variances (only if <code>:equal-variances? true</code>).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5406">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-trim"></span>
</section>
<section id="trim" class="level4">
<h4 class="anchored" data-anchor-id="trim">trim</h4>
<ul>
<li><code>(trim vs)</code></li>
<li><code>(trim vs quantile)</code></li>
<li><code>(trim vs quantile estimation-strategy)</code></li>
<li><code>(trim vs low high nan)</code></li>
</ul>
<p>Return trimmed data. Trim is done by using quantiles, by default is set to 0.2.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1172">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-trim-lower"></span>
</section>
<section id="trim-lower" class="level4">
<h4 class="anchored" data-anchor-id="trim-lower">trim-lower</h4>
<ul>
<li><code>(trim-lower vs)</code></li>
<li><code>(trim-lower vs quantile)</code></li>
<li><code>(trim-lower vs quantile estimation-strategy)</code></li>
</ul>
<p>Trim data below given quanitle, default: 0.2.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1188">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-trim-upper"></span>
</section>
<section id="trim-upper" class="level4">
<h4 class="anchored" data-anchor-id="trim-upper">trim-upper</h4>
<ul>
<li><code>(trim-upper vs)</code></li>
<li><code>(trim-upper vs quantile)</code></li>
<li><code>(trim-upper vs quantile estimation-strategy)</code></li>
</ul>
<p>Trim data above given quanitle, default: 0.2.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1196">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-tschuprows-t"></span>
</section>
<section id="tschuprows-t" class="level4">
<h4 class="anchored" data-anchor-id="tschuprows-t">tschuprows-t</h4>
<ul>
<li><code>(tschuprows-t group1 group2)</code></li>
<li><code>(tschuprows-t contingency-table)</code></li>
</ul>
<p>Calculates Tschuprow’s T, a measure of association between two nominal variables represented in a contingency table.</p>
<p>Tschuprow’s T is derived from the Pearson’s Chi-squared statistic and measures the strength of the association. Its value ranges from 0 to 1.</p>
<ul>
<li>A value of 0 indicates no association between the variables.</li>
<li>A value of 1 indicates perfect association, but only when the number of rows (<code>r</code>) equals the number of columns (<code>k</code>) in the contingency table. If <code>r != k</code>, Tschuprow’s T cannot reach 1, making Cramer’s V (<a href="#LOS-cramers-v">cramers-v</a>) often preferred as it can reach 1 for any table size.</li>
</ul>
<p>The function can be called in two ways:</p>
<ol type="1">
<li>With two sequences <code>group1</code> and <code>group2</code>: The function will automatically construct a contingency table from the unique values in the sequences.</li>
<li>With a contingency table: The contingency table can be provided as:
<ul>
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] 10, [0 1] 5, [1 0] 3, [1 1] 12}</code>). This is the output format of <a href="#LOS-contingency-table">contingency-table</a> with two inputs.</li>
<li>A sequence of sequences representing the rows of the table (e.g., <code>[10 5] [3 12](#LOS-10 5] [3 12)</code>). This is equivalent to <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>.</li>
</ul></li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (sequence): The first sequence of categorical data.</li>
<li><code>group2</code> (sequence): The second sequence of categorical data. Must have the same length as <code>group1</code>.</li>
<li><code>contingency-table</code> (map or sequence of sequences): A pre-computed contingency table.</li>
</ul>
<p>Returns the calculated Tschuprow’s T coefficient as a double.</p>
<p>See also <a href="#LOS-chisq-test">chisq-test</a>, <a href="#LOS-cramers-c">cramers-c</a>, <a href="#LOS-cramers-v">cramers-v</a>, <a href="#LOS-cohens-w">cohens-w</a>, <a href="#LOS-contingency-table">contingency-table</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3786">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ttest-one-sample"></span>
</section>
<section id="ttest-one-sample-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="ttest-one-sample-deprecated">ttest-one-sample <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use <a href="#LOS-t-test-one-sample">t-test-one-sample</a></em></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5315">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ttest-two-samples"></span>
</section>
<section id="ttest-two-samples-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="ttest-two-samples-deprecated">ttest-two-samples <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use <a href="#LOS-t-test-two-samples">t-test-two-samples</a></em></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5476">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-variance"></span>
</section>
<section id="variance" class="level4">
<h4 class="anchored" data-anchor-id="variance">variance</h4>
<ul>
<li><code>(variance vs)</code></li>
<li><code>(variance vs mu)</code></li>
</ul>
<p>Calculate variance of <code>vs</code>.</p>
<p>See <a href="#LOS-population-variance">population-variance</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L512">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-variation"></span>
</section>
<section id="variation" class="level4">
<h4 class="anchored" data-anchor-id="variation">variation</h4>
<ul>
<li><code>(variation vs)</code></li>
</ul>
<p>Calculates the coefficient of variation (CV) for a sequence <code>vs</code>.</p>
<p>The CV is a standardized measure of dispersion of a probability distribution or frequency distribution. It is defined as the ratio of the standard deviation to the mean:</p>
<p><code>CV = stddev(vs) / mean(vs)</code></p>
<p>This measure is unitless and allows for comparison of variability between datasets with different means or different units.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of numbers.</li>
</ul>
<p>Returns the calculated coefficient of variation as a double.</p>
<p>Note: The CV is undefined if the mean is zero, and may be misleading if the mean is close to zero or if the data can take both positive and negative values. All values in <code>vs</code> should ideally be positive.</p>
<p>See also <a href="#LOS-stddev">stddev</a>, <a href="#LOS-mean">mean</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L558">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-weighted-kappa"></span>
</section>
<section id="weighted-kappa" class="level4">
<h4 class="anchored" data-anchor-id="weighted-kappa">weighted-kappa</h4>
<ul>
<li><code>(weighted-kappa contingency-table)</code></li>
<li><code>(weighted-kappa contingency-table weights)</code></li>
</ul>
<p>Calculates Cohen’s weighted Kappa coefficient (κ) for a contingency table, allowing for partial agreement between categories, typically used for ordinal data.</p>
<p>Weighted Kappa measures inter-rater agreement, similar to <a href="#LOS-cohens-kappa">cohens-kappa</a>, but assigns different penalties to disagreements based on their magnitude. Disagreements between closely related categories are penalized less than disagreements between distantly related categories.</p>
<p>The function can be called in two ways:</p>
<ol type="1">
<li><p>With two sequences <code>group1</code> and <code>group2</code>: The function will automatically construct a contingency table from the unique values in the sequences. These values are assumed to be ordinal and their position in the sorted unique value list determines their index. The mapping of values to table indices might need verification.</p></li>
<li><p>With a contingency table: The contingency table can be provided as:</p>
<ul>
<li>A map where keys are <code>[row-index, column-index]</code> tuples and values are counts (e.g., <code>{[0 0] 10, [0 1] 5, [1 0] 3, [1 1] 12}</code>). This is the output format of <a href="#LOS-contingency-table">contingency-table</a> with two inputs. Indices are assumed to represent the ordered categories.</li>
<li>A sequence of sequences representing the rows of the table (e.g., <code>[10 5] [3 12](#LOS-10 5] [3 12)</code>). This is equivalent to <a href="#LOS-rows-%3Econtingency-table">rows-&gt;contingency-table</a>. The row and column indices are assumed to correspond to the ordered categories.</li>
</ul></li>
</ol>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (sequence): The first sequence of ordinal outcomes/categories.</li>
<li><code>group2</code> (sequence): The second sequence of ordinal outcomes/categories. Must have the same length as <code>group1</code>.</li>
<li><code>contingency-table</code> (map or sequence of sequences): A pre-computed contingency table where row and column indices correspond to ordered categories.</li>
<li><code>weights</code> (keyword, function, or map, optional): Specifies the weighting scheme to quantify the difference between categories. Defaults to <code>:equal-spacing</code>.
<ul>
<li><code>:equal-spacing</code> (default, linear weights): Penalizes disagreements linearly with the distance between categories. Weight is <code>1 - |i-j|/R</code>, where <code>i</code> is row index, <code>j</code> is column index, and <code>R</code> is the maximum dimension of the table (max(max_row_index, max_col_index)).</li>
<li><code>:fleiss-cohen</code> (quadratic weights): Penalizes disagreements quadratically with the distance. Weight is <code>1 - (|i-j|/R)^2</code>.</li>
<li>(function <code>(fn [R id1 id2])</code>): A custom function that takes the maximum dimension <code>R</code>, row index <code>id1</code>, and column index <code>id2</code> and returns the weight (typically between 0 and 1, where 1 is perfect agreement).</li>
<li>(map <code>{[id1 id2] weight}</code>): A custom map providing weights for specific <code>[row-index, column-index]</code> pairs. Missing pairs default to a weight of 0.0.</li>
</ul></li>
</ul>
<p>Returns the calculated weighted Cohen’s Kappa coefficient as a double.</p>
<p>Interpretation:</p>
<ul>
<li><code>κ_w = 1</code>: Perfect agreement.</li>
<li><code>κ_w = 0</code>: Agreement is no better than chance.</li>
<li><code>κ_w &lt; 0</code>: Agreement is worse than chance.</li>
</ul>
<p>See also <a href="#LOS-cohens-kappa">cohens-kappa</a> (unweighted Kappa).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L3887">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-winsor"></span>
</section>
<section id="winsor" class="level4">
<h4 class="anchored" data-anchor-id="winsor">winsor</h4>
<ul>
<li><code>(winsor vs)</code></li>
<li><code>(winsor vs quantile)</code></li>
<li><code>(winsor vs quantile estimation-strategy)</code></li>
<li><code>(winsor vs low high nan)</code></li>
</ul>
<p>Return winsorized data. Trim is done by using quantiles, by default is set to 0.2.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L1157">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wmean"></span>
</section>
<section id="wmean-deprecated" class="level4">
<h4 class="anchored" data-anchor-id="wmean-deprecated">wmean <sup><sub>DEPRECATED</sub></sup></h4>
<p><em>Deprecated: Use <code>mean</code></em></p>
<ul>
<li><code>(wmean vs)</code></li>
<li><code>(wmean vs weights)</code></li>
</ul>
<p>Weighted mean</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L487">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wmedian"></span>
</section>
<section id="wmedian" class="level4">
<h4 class="anchored" data-anchor-id="wmedian">wmedian</h4>
<ul>
<li><code>(wmedian vs ws)</code></li>
<li><code>(wmedian vs ws method)</code></li>
</ul>
<p>Calculates median of a sequence <code>vs</code> with corresponding weights <code>ws</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of data values.</li>
<li><code>ws</code>: Sequence of corresponding non-negative weights. Must have the same count as <code>vs</code>.</li>
<li><code>method</code> (optional keyword): Specifies the interpolation method used when <code>qs</code> falls between points in the weighted ECDF. Defaults to <code>:linear</code>.
<ul>
<li><code>:linear</code>: Performs linear interpolation between the data values corresponding to the cumulative weights surrounding <code>q=0.5</code>.</li>
<li><code>:step</code>: Uses a step function (specifically, step-before) based on the weighted ECDF. The result is the data value whose cumulative weight range includes <code>q=0.5</code>.</li>
<li><code>:average</code>: Computes the average of the step-before and step-after interpolation methods.</li>
</ul></li>
</ul>
<p>See also: <a href="#LOS-wquantile">wquantile</a>, <a href="#LOS-quantile">quantile</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L331">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wmode"></span>
</section>
<section id="wmode" class="level4">
<h4 class="anchored" data-anchor-id="wmode">wmode</h4>
<ul>
<li><code>(wmode vs)</code></li>
<li><code>(wmode vs weights)</code></li>
</ul>
<p>Returns the primary weighted mode of a sequence <code>vs</code>.</p>
<p>The mode is the value that appears most often in a dataset. This function generalizes the mode concept by considering weights associated with each value. A value’s contribution to the mode calculation is proportional to its weight.</p>
<p>If multiple values share the same highest total weight (i.e., there are ties for the mode), this function returns only the first one encountered during processing. The specific mode returned in case of a tie is not guaranteed to be stable across different runs or environments. Use <a href="#LOS-wmodes">wmodes</a> if you need all tied modes.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of data values. Can contain any data type (numbers, keywords, etc.).</li>
<li><code>weights</code> (optional): Sequence of non-negative weights corresponding to <code>vs</code>. Must have the same count as <code>vs</code>. Defaults to a sequence of 1.0s if omitted, effectively calculating the unweighted mode.</li>
</ul>
<p>Returns a single value representing the mode (or one of the modes if ties exist).</p>
<p>See also <a href="#LOS-wmodes">wmodes</a> (returns all modes) and <a href="#LOS-mode">mode</a> (for unweighted numeric data).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L912">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wmodes"></span>
</section>
<section id="wmodes" class="level4">
<h4 class="anchored" data-anchor-id="wmodes">wmodes</h4>
<ul>
<li><code>(wmodes vs)</code></li>
<li><code>(wmodes vs weights)</code></li>
</ul>
<p>Returns the weighted mode(s) of a sequence <code>vs</code>.</p>
<p>The mode is the value that appears most often in a dataset. This function generalizes the mode concept by considering weights associated with each value. A value’s contribution to the mode calculation is proportional to its weight.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of data values. Can contain any data type (numbers, keywords, etc.).</li>
<li><code>weights</code> (optional): Sequence of non-negative weights corresponding to <code>vs</code>. Must have the same count as <code>vs</code>. Defaults to a sequence of 1.0s if omitted, effectively calculating the unweighted modes.</li>
</ul>
<p>Returns a sequence containing all values that have the highest total weight. If there are ties (multiple values share the same maximum total weight), all tied values are included in the returned sequence. The order of modes in the returned sequence is not guaranteed.</p>
<p>See also <a href="#LOS-wmode">wmode</a> (returns only one mode in case of ties) and <a href="#LOS-modes">modes</a> (for unweighted numeric data).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L881">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wmw-odds"></span>
</section>
<section id="wmw-odds" class="level4">
<h4 class="anchored" data-anchor-id="wmw-odds">wmw-odds</h4>
<ul>
<li><code>(wmw-odds [group1 group2])</code></li>
<li><code>(wmw-odds group1 group2)</code></li>
</ul>
<p>Calculates the Wilcoxon-Mann-Whitney odds (often denoted as ψ) for two independent samples.</p>
<p>This non-parametric effect size measure quantifies the odds that a randomly chosen observation from the first group (<code>group1</code>) is greater than a randomly chosen observation from the second group (<code>group2</code>).</p>
<p>The statistic is directly related to <a href="#LOS-cliffs-delta">cliffs-delta</a> (δ): ψ = (1 + δ) / (1 - δ).</p>
<p>Parameters:</p>
<ul>
<li><code>group1</code> (seq of numbers): The first independent sample.</li>
<li><code>group2</code> (seq of numbers): The second independent sample.</li>
</ul>
<p>Returns the calculated WMW odds as a double.</p>
<p>Interpretation:</p>
<ul>
<li>A value greater than 1 indicates that values from <code>group1</code> tend to be larger than values from <code>group2</code>.</li>
<li>A value less than 1 indicates that values from <code>group1</code> tend to be smaller than values from <code>group2</code>.</li>
<li>A value of 1 indicates stochastic equality between the distributions (50/50 odds).</li>
</ul>
<p>This measure is robust to violations of normality and is suitable for ordinal data. It is closely related to Cliff’s Delta (δ) and the Mann-Whitney U test statistic.</p>
<p>See also <a href="#LOS-cliffs-delta">cliffs-delta</a>, <a href="#LOS-ameasure">ameasure</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L2896">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wquantile"></span>
</section>
<section id="wquantile" class="level4">
<h4 class="anchored" data-anchor-id="wquantile">wquantile</h4>
<ul>
<li><code>(wquantile vs ws q)</code></li>
<li><code>(wquantile vs ws q method)</code></li>
</ul>
<p>Calculates the q-th weighted quantile of a sequence <code>vs</code> with corresponding weights <code>ws</code>.</p>
<p>The quantile <code>q</code> is a value between 0.0 and 1.0, inclusive.</p>
<p>The calculation involves constructing a weighted empirical cumulative distribution function (ECDF) and interpolating to find the value at quantile <code>q</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of data values.</li>
<li><code>ws</code>: Sequence of corresponding non-negative weights. Must have the same count as <code>vs</code>.</li>
<li><code>q</code>: The quantile level (0.0 &lt; q &lt;= 1.0).</li>
<li><code>method</code> (optional keyword): Specifies the interpolation method used when <code>q</code> falls between points in the weighted ECDF. Defaults to <code>:linear</code>.
<ul>
<li><code>:linear</code>: Performs linear interpolation between the data values corresponding to the cumulative weights surrounding <code>q</code>.</li>
<li><code>:step</code>: Uses a step function (specifically, step-before) based on the weighted ECDF. The result is the data value whose cumulative weight range includes <code>q</code>.</li>
<li><code>:average</code>: Computes the average of the step-before and step-after interpolation methods. Useful when <code>q</code> corresponds exactly to a cumulative weight boundary.</li>
</ul></li>
</ul>
<p>See also: <a href="#LOS-wmedian">wmedian</a>, <a href="#LOS-wquantiles">wquantiles</a>, <a href="#LOS-quantile">quantile</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L270">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wquantiles"></span>
</section>
<section id="wquantiles" class="level4">
<h4 class="anchored" data-anchor-id="wquantiles">wquantiles</h4>
<ul>
<li><code>(wquantiles vs ws)</code></li>
<li><code>(wquantiles vs ws qs)</code></li>
<li><code>(wquantiles vs ws qs method)</code></li>
</ul>
<p>Calculates the sequence of q-th weighted quantiles of a sequence <code>vs</code> with corresponding weights <code>ws</code>.</p>
<p>Quantiles <code>qs</code> is a sequence of values between 0.0 and 1.0, inclusive.</p>
<p>The calculation involves constructing a weighted empirical cumulative distribution function (ECDF) and interpolating to find the value at quantiles <code>qs</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code>: Sequence of data values.</li>
<li><code>ws</code>: Sequence of corresponding non-negative weights. Must have the same count as <code>vs</code>.</li>
<li><code>qs</code>: Sequence of quantiles level (0.0 &lt; q &lt;= 1.0).</li>
<li><code>method</code> (optional keyword): Specifies the interpolation method used when <code>qs</code> falls between points in the weighted ECDF. Defaults to <code>:linear</code>.
<ul>
<li><code>:linear</code>: Performs linear interpolation between the data values corresponding to the cumulative weights surrounding <code>q</code>.</li>
<li><code>:step</code>: Uses a step function (specifically, step-before) based on the weighted ECDF. The result is the data value whose cumulative weight range includes <code>q</code>.</li>
<li><code>:average</code>: Computes the average of the step-before and step-after interpolation methods. Useful when <code>q</code> corresponds exactly to a cumulative weight boundary.</li>
</ul></li>
</ul>
<p>See also: <a href="#LOS-wquantile">wquantile</a>, <a href="#LOS-quantiles">quantiles</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L300">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wstddev"></span>
</section>
<section id="wstddev" class="level4">
<h4 class="anchored" data-anchor-id="wstddev">wstddev</h4>
<ul>
<li><code>(wstddev vs freqs)</code></li>
</ul>
<p>Calculate weighted (unbiased) standard deviation of <code>vs</code></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L553">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-wvariance"></span>
</section>
<section id="wvariance" class="level4">
<h4 class="anchored" data-anchor-id="wvariance">wvariance</h4>
<ul>
<li><code>(wvariance vs freqs)</code></li>
</ul>
<p>Calculate weighted (unbiased) variance of <code>vs</code>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L521">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-yeo-johnson-infer-lambda"></span>
</section>
<section id="yeo-johnson-infer-lambda" class="level4">
<h4 class="anchored" data-anchor-id="yeo-johnson-infer-lambda">yeo-johnson-infer-lambda</h4>
<ul>
<li><code>(yeo-johnson-infer-lambda xs)</code></li>
<li><code>(yeo-johnson-infer-lambda xs lambda-range)</code></li>
<li><code>(yeo-johnson-infer-lambda xs lambda-range {:keys [alpha], :or {alpha 0.0}})</code></li>
</ul>
<p>Find optimal <code>lambda</code> parameter for Yeo-Johnson tranformation using maximum log likelihood method.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6460">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-yeo-johnson-transformation"></span>
</section>
<section id="yeo-johnson-transformation" class="level4">
<h4 class="anchored" data-anchor-id="yeo-johnson-transformation">yeo-johnson-transformation</h4>
<ul>
<li><code>(yeo-johnson-transformation xs)</code></li>
<li><code>(yeo-johnson-transformation xs lambda)</code></li>
<li><code>(yeo-johnson-transformation xs lambda {:keys [alpha inverse?], :or {alpha 0.0}})</code></li>
</ul>
<p>Applies the Yeo-Johnson transformation to a dataset.</p>
<p>This transformation is used to stabilize variance and make data more normally distributed. It extends the Box-Cox transformation to allow for zero and negative values.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code>: The input dataset.</li>
<li><code>lambda</code> (default: 0.0): The power parameter controlling the transformation. If <code>lambda</code> is <code>nil</code> or a range <code>[lambda-min, lambda-max]</code> it will be inferred using maximum log-likelihood method.</li>
<li>Options map:
<ul>
<li><code>:alpha</code> (optional): A shift parameter applied before transformation.</li>
<li><code>:inverse?</code> (optional): Perform inverse operation, <code>lambda</code> should be provided (can’t be inferred).</li>
</ul></li>
</ul>
<p>Returns:</p>
<ul>
<li>A transformed sequence of numbers.</li>
</ul>
<p>Related: <code>box-cox-tranformation</code></p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L6468">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-z-test-one-sample"></span>
</section>
<section id="z-test-one-sample" class="level4">
<h4 class="anchored" data-anchor-id="z-test-one-sample">z-test-one-sample</h4>
<ul>
<li><code>(z-test-one-sample xs)</code></li>
<li><code>(z-test-one-sample xs m)</code></li>
</ul>
<p>Performs a one-sample Z-test to compare the sample mean against a hypothesized population mean.</p>
<p>This test assesses the null hypothesis that the true population mean is equal to <code>mu</code>. It typically assumes either a known population standard deviation or relies on a large sample size (e.g., n &gt; 30) where the sample standard deviation provides a reliable estimate. This implementation uses the sample standard deviation to calculate the standard error.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The sample data.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:alpha</code> (double, default <code>0.05</code>): Significance level for the confidence interval.</li>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis.
<ul>
<li><code>:two-sided</code> (default): The true mean is not equal to <code>mu</code>.</li>
<li><code>:one-sided-greater</code>: The true mean is greater than <code>mu</code>.</li>
<li><code>:one-sided-less</code>: The true mean is less than <code>mu</code>.</li>
</ul></li>
<li><code>:mu</code> (double, default <code>0.0</code>): The hypothesized population mean under the null hypothesis.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:z</code>: The calculated Z-statistic.</li>
<li><code>:stat</code>: Alias for <code>:z</code>.</li>
<li><code>:p-value</code>: The p-value associated with the Z-statistic and the specified <code>:sides</code>.</li>
<li><code>:confidence-interval</code>: Confidence interval for the true population mean.</li>
<li><code>:estimate</code>: The calculated sample mean.</li>
<li><code>:n</code>: The sample size.</li>
<li><code>:mu</code>: The hypothesized population mean used in the test.</li>
<li><code>:stderr</code>: The standard error of the mean (calculated using sample standard deviation).</li>
<li><code>:alpha</code>: Significance level used.</li>
<li><code>:sides</code>: Alternative hypothesis side used.</li>
<li><code>:test-type</code>: Alias for <code>:sides</code>.</li>
</ul>
<p>See also <a href="#LOS-t-test-one-sample">t-test-one-sample</a> for smaller samples or when the population standard deviation is unknown.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5317">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-z-test-two-samples"></span>
</section>
<section id="z-test-two-samples" class="level4">
<h4 class="anchored" data-anchor-id="z-test-two-samples">z-test-two-samples</h4>
<ul>
<li><code>(z-test-two-samples xs ys)</code></li>
<li><code>(z-test-two-samples xs ys {:keys [paired? equal-variances?], :or {paired? false, equal-variances? false}, :as params})</code></li>
</ul>
<p>Performs a two-sample Z-test to compare the means of two independent or paired samples.</p>
<p>This test assesses the null hypothesis that the difference between the population means is equal to <code>mu</code> (default 0). It typically assumes known population variances or relies on large sample sizes where sample variances provide good estimates. This implementation calculates the standard error using the provided sample variances.</p>
<p>Parameters:</p>
<ul>
<li><code>xs</code> (seq of numbers): The first sample.</li>
<li><code>ys</code> (seq of numbers): The second sample.</li>
<li><code>params</code> (map, optional): Options map:
<ul>
<li><code>:alpha</code> (double, default <code>0.05</code>): Significance level for the confidence interval.</li>
<li><code>:sides</code> (keyword, default <code>:two-sided</code>): Specifies the alternative hypothesis.
<ul>
<li><code>:two-sided</code> (default): The true difference in means is not equal to <code>mu</code>.</li>
<li><code>:one-sided-greater</code>: The true difference in means (<code>mean(xs) - mean(ys)</code>) is greater than <code>mu</code>.</li>
<li><code>:one-sided-less</code>: The true difference in means (<code>mean(xs) - mean(ys)</code>) is less than <code>mu</code>.</li>
</ul></li>
<li><code>:mu</code> (double, default <code>0.0</code>): The hypothesized difference in means under the null hypothesis.</li>
<li><code>:paired?</code> (boolean, default <code>false</code>): If <code>true</code>, performs a paired Z-test by applying <a href="#LOS-z-test-one-sample">z-test-one-sample</a> to the differences between paired observations in <code>xs</code> and <code>ys</code> (requires <code>xs</code> and <code>ys</code> to have the same length). If <code>false</code>, performs a two-sample test assuming independence.</li>
<li><code>:equal-variances?</code> (boolean, default <code>false</code>): Used only when <code>paired?</code> is <code>false</code>. If <code>true</code>, assumes population variances are equal and calculates a pooled standard error. If <code>false</code>, calculates the standard error without assuming equal variances (Welch’s approach adapted for Z-test). This affects the standard error calculation but the standard normal distribution is still used for inference.</li>
</ul></li>
</ul>
<p>Returns a map containing:</p>
<ul>
<li><code>:z</code>: The calculated Z-statistic.</li>
<li><code>:stat</code>: Alias for <code>:z</code>.</li>
<li><code>:p-value</code>: The p-value associated with the Z-statistic and the specified <code>:sides</code>.</li>
<li><code>:confidence-interval</code>: Confidence interval for the true difference in means.</li>
<li><code>:estimate</code>: The observed difference between sample means (<code>mean(xs) - mean(ys)</code>).</li>
<li><code>:n</code>: Sample sizes as <code>[count xs, count ys]</code>.</li>
<li><code>:nx</code>: Sample size of <code>xs</code>.</li>
<li><code>:ny</code>: Sample size of <code>ys</code>.</li>
<li><code>:estimated-mu</code>: The observed sample means as <code>[mean xs, mean ys]</code>.</li>
<li><code>:mu</code>: The hypothesized difference under the null hypothesis.</li>
<li><code>:stderr</code>: The standard error of the difference between the means.</li>
<li><code>:alpha</code>: Significance level used.</li>
<li><code>:sides</code>: Alternative hypothesis side used.</li>
<li><code>:test-type</code>: Alias for <code>:sides</code>.</li>
<li><code>:paired?</code>: Boolean indicating if a paired test was performed.</li>
<li><code>:equal-variances?</code>: Boolean indicating the assumption used for standard error calculation (if unpaired).</li>
</ul>
<p>See also <a href="#LOS-t-test-two-samples">t-test-two-samples</a> for smaller samples or when population variances are unknown.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats.clj#L5478">source</a></small><hr style="margin: 0"></div>
</section>
</section>
<section id="fastmath.stats.bootstrap" class="level3">
<h3 class="anchored" data-anchor-id="fastmath.stats.bootstrap">fastmath.stats.bootstrap</h3>
<p>Bootstrap methods and confidence intervals</p>
<span id="#LOS-bootstrap"></span>
<section id="bootstrap-1" class="level4">
<h4 class="anchored" data-anchor-id="bootstrap-1">bootstrap</h4>
<ul>
<li><code>(bootstrap input)</code></li>
<li><code>(bootstrap input params-or-statistic)</code></li>
<li><code>(bootstrap input statistic {:keys [rng samples size method antithetic? dimensions include? multi?], :or {samples 500}, :as params})</code></li>
</ul>
<p>Generates bootstrap samples from a given dataset or probabilistic model for resampling purposes.</p>
<p>This function supports both <strong>nonparametric bootstrap</strong> (resampling directly from the data) and <strong>parametric bootstrap</strong> (resampling from a statistical model estimated from or provided for the data). It can optionally apply a statistic function to the original data and each sample, returning summary statistics for the bootstrap distribution.</p>
<p>The primary input can be:</p>
<ul>
<li>A sequence of data values (for nonparametric bootstrap).</li>
<li>A map containing:
<ul>
<li><code>:data</code>: The sequence of data values.</li>
<li><code>:model</code>: An optional model for parametric bootstrap. If not provided, a default discrete distribution is built from the data (see <code>:distribution</code> and <code>:smoothing</code>).</li>
</ul></li>
</ul>
<p>The function offers various parameters to control the sampling process and model generation.</p>
<p>Parameters:</p>
<ul>
<li><code>input</code> (sequence or map): The data source. Can be a sequence of numbers or a map containing <code>:data</code> and optionally <code>:model</code>. Can be sequence of sequences for multidimensional data (when <code>:dimensions</code> is <code>:multi</code>).</li>
<li><code>statistic</code> (function, optional): A function that takes a sequence of data and returns a single numerical value (e.g., <code>fastmath.stats/mean</code>, <code>fastmath.stats/median</code>). If provided, <code>bootstrap-stats</code> is called on the results.</li>
<li><code>params</code> (map, optional): An options map to configure the bootstrap process. Keys include:
<ul>
<li><code>:samples</code> (long, default: 500): The number of bootstrap samples to generate.</li>
<li><code>:size</code> (long, optional): The size of each individual bootstrap sample. Defaults to the size of the original data.</li>
<li><code>:method</code> (keyword, optional): Specifies the sampling method.
<ul>
<li><code>nil</code> (default): Standard random sampling with replacement.</li>
<li><code>:jackknife</code>: Performs leave-one-out jackknife resampling (ignores <code>:samples</code> and <code>:size</code>).</li>
<li><code>:jackknife+</code>: Performs positive jackknife resampling (duplicates each observation once; ignores <code>:samples</code>).</li>
<li>Other keywords are passed to <code>fastmath.random/-&gt;seq</code> for sampling from a distribution (only relevant if a <code>:model</code> is used or built).</li>
</ul></li>
<li><code>:rng</code> (random number generator, optional): An instance of a random number generator (see <code>fastmath.random/rng</code>). A default JVM RNG is used if not provided.</li>
<li><code>:smoothing</code> (keyword, optional): Applies smoothing to the bootstrap process.
<ul>
<li><code>:kde</code>: Uses Kernel Density Estimation to smooth the empirical distribution before sampling. Requires specifying <code>:kernel</code> (default <code>:gaussian</code>) and optionally <code>:bandwidth</code> (auto-estimated by default).</li>
<li><code>:gaussian</code>: Adds random noise drawn from N(0, standard error) to each resampled value.</li>
</ul></li>
<li><code>:distribution</code> (keyword, default: <code>:real-discrete-distribution</code>): The type of discrete distribution to build automatically from the data if no explicit <code>:model</code> is provided. Other options include <code>:integer-discrete-distribution</code> (for integer data) and <code>:categorical-distribution</code> (for any data type).</li>
<li><code>:dimensions</code> (keyword, optional): If set to <code>:multi</code>, treats the input <code>:data</code> as a sequence of sequences (multidimensional data). Models are built or used separately for each dimension, and samples are generated as sequences of vectors.</li>
<li><code>:antithetic?</code> (boolean, default: <code>false</code>): If <code>true</code>, uses antithetic sampling for variance reduction (paired samples are generated as <code>x</code> and <code>1-x</code> from a uniform distribution, then transformed by the inverse CDF of the model). Requires sampling from a distribution model.</li>
<li><code>:include?</code> (boolean, default: <code>false</code>): If <code>true</code>, the original dataset is included as one of the samples in the output collection.</li>
</ul></li>
</ul>
<p>Model for parametric bootstrap:</p>
<p>The <code>:model</code> parameter in the input map can be:</p>
<ul>
<li>Any <code>fastmath.random</code> distribution object (e.g., <code>(r/distribution :normal {:mu 0 :sd 1})</code>).</li>
<li>Any 0-arity function that returns a random sample when called.</li>
</ul>
<p>If <code>:model</code> is omitted from the input map, a default discrete distribution (<code>:real-discrete-distribution</code> by default, see <code>:distribution</code> param) is built from the <code>:data</code>. Smoothing options (<code>:smoothing</code>) apply to this automatically built model.</p>
<p>When <code>:dimensions</code> is <code>:multi</code>, <code>:model</code> should be a sequence of models, one for each dimension.</p>
<p>Returns:</p>
<ul>
<li>If <code>statistic</code> is provided: A map containing the original input map augmented with analysis results from <code>bootstrap-stats</code> (e.g., <code>:t0</code>, <code>:ts</code>, <code>:bias</code>, <code>:mean</code>, <code>:stddev</code>).</li>
<li>If <code>statistic</code> is <code>nil</code>: A map containing the original input map augmented with the generated bootstrap samples in the <code>:samples</code> key. The <code>:samples</code> value is a collection of sequences, where each inner sequence is one bootstrap sample. If <code>:dimensions</code> is <code>:multi</code>, samples are sequences of vectors.</li>
</ul>
<p>See also <a href="#LOS-jackknife">jackknife</a>, <a href="#LOS-jackknife+">jackknife+</a>, <a href="#LOS-bootstrap-stats">bootstrap-stats</a>, <a href="#LOS-ci-normal">ci-normal</a>, <a href="#LOS-ci-basic">ci-basic</a>, <a href="#LOS-ci-percentile">ci-percentile</a>, <a href="#LOS-ci-bc">ci-bc</a>, <a href="#LOS-ci-bca">ci-bca</a>, <a href="#LOS-ci-studentized">ci-studentized</a>, <a href="#LOS-ci-t">ci-t</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L123">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-bootstrap-stats"></span>
</section>
<section id="bootstrap-stats" class="level4">
<h4 class="anchored" data-anchor-id="bootstrap-stats">bootstrap-stats</h4>
<ul>
<li><code>(bootstrap-stats {:keys [data samples], :as input} statistic)</code></li>
</ul>
<p>Calculates summary statistics for bootstrap results.</p>
<p>Takes bootstrap output (typically from <a href="#LOS-bootstrap">bootstrap</a>) and a statistic function, computes the statistic on the original data (<code>t0</code>) and on each bootstrap sample (<code>ts</code>), and derives various descriptive statistics from the distribution of <code>ts</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>boot-data</code> (map): A map containing:
<ul>
<li><code>:data</code>: The original dataset.</li>
<li><code>:samples</code>: A collection of bootstrap samples (e.g., from <a href="#LOS-bootstrap">bootstrap</a>).</li>
<li>(optional) other keys like <code>:model</code> from bootstrap generation.</li>
</ul></li>
<li><code>statistic</code> (function): A function that accepts a sequence of data and returns a single numerical statistic (e.g., <code>fastmath.stats/mean</code>, <code>fastmath.stats/median</code>).</li>
</ul>
<p>Returns a map which is the input <code>boot-data</code> augmented with bootstrap analysis results:</p>
<ul>
<li><code>:statistic</code>: The statistic function applied.</li>
<li><code>:t0</code>: The statistic calculated on the original <code>:data</code>.</li>
<li><code>:ts</code>: A sequence of the statistic calculated on each bootstrap sample in <code>:samples</code>.</li>
<li><code>:bias</code>: The estimated bias of the statistic: <code>mean(:ts) - :t0</code>.</li>
<li><code>:mean</code>, <code>:median</code>, <code>:variance</code>, <code>:stddev</code>, <code>:sem</code>: Descriptive statistics (mean, median, variance, standard deviation, standard error of the mean) calculated from the distribution of <code>:ts</code>.</li>
</ul>
<p>This function prepares the results for calculating various bootstrap confidence intervals (e.g., <a href="#LOS-ci-normal">ci-normal</a>, <a href="#LOS-ci-percentile">ci-percentile</a>, etc.).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L43">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ci-basic"></span>
</section>
<section id="ci-basic" class="level4">
<h4 class="anchored" data-anchor-id="ci-basic">ci-basic</h4>
<ul>
<li><code>(ci-basic boot-data)</code></li>
<li><code>(ci-basic boot-data alpha)</code></li>
<li><code>(ci-basic {:keys [t0 ts]} alpha estimation-strategy)</code></li>
</ul>
<p>Calculates the Basic (or Percentile-t) bootstrap confidence interval.</p>
<p>This method is based on the assumption that the distribution of the bootstrap replicates (<code>:ts</code>) centered around the true statistic (<code>t</code>) is approximately the same as the distribution of the original statistic (<code>:t0</code>) centered around the mean of the bootstrap replicates (<code>mean(:ts)</code>).</p>
<p>The interval is constructed using the quantiles of the bootstrap replicates (<code>:ts</code>) relative to the original statistic (<code>:t0</code>). Specifically, the lower bound is <code>2 * :t0 - q_upper</code> and the upper bound is <code>2 * :t0 - q_lower</code>, where <code>q_lower</code> and <code>q_upper</code> are the <code>alpha/2</code> and <code>1 - alpha/2</code> quantiles of <code>:ts</code>, respectively.</p>
<p>Parameters:</p>
<ul>
<li><code>boot-data</code> (map): A map containing bootstrap results, typically from <a href="#LOS-bootstrap-stats">bootstrap-stats</a>. Requires keys:
<ul>
<li><code>:t0</code> (double): The statistic calculated on the original data.</li>
<li><code>:ts</code> (sequence of numbers): The statistic calculated on each bootstrap sample.</li>
</ul></li>
<li><code>alpha</code> (double, optional): The significance level for the interval. Defaults to <code>0.05</code> (for a 95% CI). The interval is based on the <code>alpha/2</code> and <code>1 - alpha/2</code> quantiles of the <code>:ts</code> distribution.</li>
<li><code>estimation-strategy</code> (keyword, optional): Specifies the quantile estimation strategy used to calculate the quantiles of <code>:ts</code>. Defaults to <code>:legacy</code>. See <a href="#LOS-quantiles">quantiles</a> for available options (e.g., <code>:r1</code> through <code>:r9</code>).</li>
</ul>
<p>Returns a vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<ul>
<li><code>lower-bound</code> (double): The lower limit of the confidence interval.</li>
<li><code>upper-bound</code> (double): The upper limit of the confidence interval.</li>
<li><code>t0</code> (double): The statistic calculated on the original data (from <code>boot-data</code>).</li>
</ul>
<p>See also <a href="#LOS-bootstrap-stats">bootstrap-stats</a> for input preparation and other confidence interval methods: <a href="#LOS-ci-normal">ci-normal</a>, <a href="#LOS-ci-percentile">ci-percentile</a>, <a href="#LOS-ci-bc">ci-bc</a>, <a href="#LOS-ci-bca">ci-bca</a>, <a href="#LOS-ci-studentized">ci-studentized</a>, <a href="#LOS-ci-t">ci-t</a>, <a href="#LOS-quantiles">quantiles</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L294">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ci-bc"></span>
</section>
<section id="ci-bc" class="level4">
<h4 class="anchored" data-anchor-id="ci-bc">ci-bc</h4>
<ul>
<li><code>(ci-bc boot-data)</code></li>
<li><code>(ci-bc boot-data alpha)</code></li>
<li><code>(ci-bc {:keys [t0 ts]} alpha estimation-strategy)</code></li>
</ul>
<p>Calculates the Bias-Corrected (BC) bootstrap confidence interval.</p>
<p>This method adjusts the standard Percentile bootstrap interval (<a href="#LOS-ci-percentile">ci-percentile</a>) to account for potential bias in the statistic’s distribution. The correction is based on the proportion of bootstrap replicates of the statistic (<code>:ts</code>) that are less than the statistic calculated on the original data (<code>:t0</code>).</p>
<p>The procedure involves: 1. Calculating a bias correction factor (<span class="math inline">\(z_0\)</span>) based on the empirical cumulative distribution function (CDF) of the bootstrap replicates at the point of the original statistic (<span class="math inline">\(z_0 = \Phi^{-1}(\text{Proportion of } t^* &lt; t_0)\)</span>, where <span class="math inline">\(\Phi^{-1}\)</span> is the inverse standard normal CDF). 2. Shifting the standard normal quantiles corresponding to the desired confidence level (<span class="math inline">\(\alpha/2\)</span> and <span class="math inline">\(1-\alpha/2\)</span>) by <span class="math inline">\(z_0\)</span>. 3. Finding the corresponding quantiles in the distribution of bootstrap replicates (<code>:ts</code>) based on these shifted probabilities.</p>
<p>Parameters:</p>
<ul>
<li><code>boot-data</code> (map): A map containing bootstrap results, typically from <a href="#LOS-bootstrap-stats">bootstrap-stats</a>. Requires keys:
<ul>
<li><code>:t0</code> (double): The statistic calculated on the original data.</li>
<li><code>:ts</code> (sequence of numbers): The statistic calculated on each bootstrap sample.</li>
</ul></li>
<li><code>alpha</code> (double, optional): The significance level for the interval. Defaults to <code>0.05</code> (for a 95% CI). The interval is based on quantiles of the <code>:ts</code> distribution, adjusted by the bias correction factor.</li>
<li><code>estimation-strategy</code> (keyword, optional): Specifies the quantile estimation strategy used to calculate the final interval bounds from <code>:ts</code> after applying corrections. Defaults to <code>:legacy</code>. See <a href="#LOS-quantiles">quantiles</a> for available options (e.g., <code>:r1</code> through <code>:r9</code>).</li>
</ul>
<p>Returns a vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<ul>
<li><code>lower-bound</code> (double): The lower limit of the confidence interval.</li>
<li><code>upper-bound</code> (double): The upper limit of the confidence interval.</li>
<li><code>t0</code> (double): The statistic calculated on the original data (from <code>boot-data</code>).</li>
</ul>
<p>See also <a href="#LOS-bootstrap-stats">bootstrap-stats</a> for input preparation and other confidence interval methods: <a href="#LOS-ci-normal">ci-normal</a>, <a href="#LOS-ci-basic">ci-basic</a>, <a href="#LOS-ci-percentile">ci-percentile</a>, <a href="#LOS-ci-bca">ci-bca</a>, <a href="#LOS-ci-studentized">ci-studentized</a>, <a href="#LOS-ci-t">ci-t</a>, <a href="#LOS-quantiles">quantiles</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L397">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ci-bca"></span>
</section>
<section id="ci-bca" class="level4">
<h4 class="anchored" data-anchor-id="ci-bca">ci-bca</h4>
<ul>
<li><code>(ci-bca boot-data)</code></li>
<li><code>(ci-bca boot-data alpha)</code></li>
<li><code>(ci-bca {:keys [t0 ts data statistic]} alpha estimation-strategy)</code></li>
</ul>
<p>Calculates the Bias-Corrected and Accelerated (BCa) bootstrap confidence interval.</p>
<p>The BCa interval is a sophisticated method that corrects for both bias and skewness in the distribution of the bootstrap statistic replicates. It is considered a more accurate interval, particularly when the bootstrap distribution is skewed.</p>
<p>The calculation requires two components: 1. A <strong>bias correction factor</strong> (<span class="math inline">\(z_0\)</span>) based on the proportion of bootstrap replicates less than the original statistic (<span class="math inline">\(t_0\)</span>). 2. An <strong>acceleration factor</strong> (<span class="math inline">\(a\)</span>) which quantifies the rate of change of the standard error of the statistic with respect to the true parameter value.</p>
<p>The function uses one of two methods to calculate the acceleration factor:</p>
<ul>
<li><strong>Jackknife method</strong>: If the input <code>boot-data</code> map contains the original <code>:data</code> and the <code>:statistic</code> function used to compute <code>:t0</code> and <code>:ts</code>, the acceleration factor is estimated using the jackknife method (by computing the statistic on leave-one-out jackknife samples).</li>
<li><strong>Empirical method</strong>: If <code>:data</code> or <code>:statistic</code> are missing from <code>boot-data</code>, the acceleration factor is estimated empirically from the distribution of the bootstrap replicates (<code>:ts</code>) using its skewness.</li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>boot-data</code> (map): A map containing bootstrap results, typically from <a href="#LOS-bootstrap-stats">bootstrap-stats</a>. Requires keys:
<ul>
<li><code>:t0</code> (double): The statistic calculated on the original data.</li>
<li><code>:ts</code> (sequence of numbers): The statistic calculated on each bootstrap sample. May optionally include:</li>
<li><code>:data</code> (sequence): The original dataset (required for jackknife acceleration).</li>
<li><code>:statistic</code> (function): The function used to calculate the statistic (required for jackknife acceleration).</li>
</ul></li>
<li><code>alpha</code> (double, optional): The significance level for the interval. Defaults to <code>0.05</code> (for a 95% CI). The BCa method uses quantiles of the normal distribution and the bootstrap replicates, adjusted by the bias and acceleration factors.</li>
<li><code>estimation-strategy</code> (keyword, optional): Specifies the quantile estimation strategy used to calculate the quantiles of the bootstrap replicates (<code>:ts</code>) for the final interval bounds after applying corrections. Defaults to <code>:legacy</code>. See <a href="#LOS-quantiles">quantiles</a> for available options (e.g., <code>:r1</code> through <code>:r9</code>).</li>
</ul>
<p>Returns a vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<ul>
<li><code>lower-bound</code> (double): The lower limit of the confidence interval.</li>
<li><code>upper-bound</code> (double): The upper limit of the confidence interval.</li>
<li><code>t0</code> (double): The statistic calculated on the original data (from <code>boot-data</code>).</li>
</ul>
<p>See also <a href="#LOS-bootstrap-stats">bootstrap-stats</a> for input preparation and other confidence interval methods: <a href="#LOS-ci-normal">ci-normal</a>, <a href="#LOS-ci-basic">ci-basic</a>, <a href="#LOS-ci-percentile">ci-percentile</a>, <a href="#LOS-ci-bc">ci-bc</a>, <a href="#LOS-ci-studentized">ci-studentized</a>, <a href="#LOS-ci-t">ci-t</a>, <a href="#LOS-jackknife">jackknife</a>, <a href="#LOS-quantiles">quantiles</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L445">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ci-normal"></span>
</section>
<section id="ci-normal" class="level4">
<h4 class="anchored" data-anchor-id="ci-normal">ci-normal</h4>
<ul>
<li><code>(ci-normal boot-data)</code></li>
<li><code>(ci-normal {:keys [t0 ts stddev bias]} alpha)</code></li>
</ul>
<p>Calculates a Normal (Gaussian) approximation bias-corrected confidence interval.</p>
<p>This method assumes the distribution of the bootstrap replicates of the statistic (<code>:ts</code>) is approximately normal. It computes a confidence interval centered around the mean of the bootstrap statistics, adjusted by the estimated bias (<code>mean(:ts) - :t0</code>), and uses the standard error of the bootstrap statistics for scaling.</p>
<p>Parameters:</p>
<ul>
<li><code>boot-data</code> (map): A map containing bootstrap results. Typically produced by <a href="#LOS-bootstrap-stats">bootstrap-stats</a>. Requires keys:
<ul>
<li><code>:t0</code> (double): The statistic calculated on the original data.</li>
<li><code>:ts</code> (sequence of numbers): The statistic calculated on each bootstrap sample. May optionally include pre-calculated <code>:stddev</code> (standard deviation of <code>:ts</code>) and <code>:bias</code> for efficiency.</li>
</ul></li>
<li><code>alpha</code> (double, optional): The significance level for the interval. Defaults to <code>0.05</code> (for a 95% CI). The interval is based on the <code>alpha/2</code> and <code>1 - alpha/2</code> quantiles of the standard normal distribution.</li>
</ul>
<p>Returns a vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<ul>
<li><code>lower-bound</code> (double): The lower limit of the confidence interval.</li>
<li><code>upper-bound</code> (double): The upper limit of the confidence interval.</li>
<li><code>t0</code> (double): The statistic calculated on the original data (from <code>boot-data</code>).</li>
</ul>
<p>See also <a href="#LOS-bootstrap-stats">bootstrap-stats</a> for input preparation and other confidence interval methods: <a href="#LOS-ci-basic">ci-basic</a>, <a href="#LOS-ci-percentile">ci-percentile</a>, <a href="#LOS-ci-bc">ci-bc</a>, <a href="#LOS-ci-bca">ci-bca</a>, <a href="#LOS-ci-studentized">ci-studentized</a>, <a href="#LOS-ci-t">ci-t</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L256">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ci-percentile"></span>
</section>
<section id="ci-percentile" class="level4">
<h4 class="anchored" data-anchor-id="ci-percentile">ci-percentile</h4>
<ul>
<li><code>(ci-percentile boot-data)</code></li>
<li><code>(ci-percentile boot-data alpha)</code></li>
<li><code>(ci-percentile {:keys [t0 ts]} alpha estimation-strategy)</code></li>
</ul>
<p>Calculates the Percentile bootstrap confidence interval.</p>
<p>This is the simplest bootstrap confidence interval method. It directly uses the quantiles of the bootstrap replicates of the statistic (<code>:ts</code>) as the confidence interval bounds.</p>
<p>For a confidence level of <code>1 - alpha</code>, the interval is formed by taking the <code>alpha/2</code> and <code>1 - alpha/2</code> quantiles of the distribution of bootstrap replicates (<code>:ts</code>).</p>
<p>Parameters:</p>
<ul>
<li><code>boot-data</code> (map): A map containing bootstrap results, typically from <a href="#LOS-bootstrap-stats">bootstrap-stats</a>. Requires keys:
<ul>
<li><code>:t0</code> (double): The statistic calculated on the original data.</li>
<li><code>:ts</code> (sequence of numbers): The statistic calculated on each bootstrap sample.</li>
</ul></li>
<li><code>alpha</code> (double, optional): The significance level for the interval. Defaults to <code>0.05</code> (for a 95% CI). The interval is based on the <code>alpha/2</code> and <code>1 - alpha/2</code> quantiles of the <code>:ts</code> distribution.</li>
<li><code>estimation-strategy</code> (keyword, optional): Specifies the quantile estimation strategy used to calculate the quantiles of <code>:ts</code>. Defaults to <code>:legacy</code>. See <a href="#LOS-quantiles">quantiles</a> for available options (e.g., <code>:r1</code> through <code>:r9</code>).</li>
</ul>
<p>Returns a vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<ul>
<li><code>lower-bound</code> (double): The <code>alpha/2</code> quantile of <code>:ts</code>.</li>
<li><code>upper-bound</code> (double): The <code>1 - alpha/2</code> quantile of <code>:ts</code>.</li>
<li><code>t0</code> (double): The statistic calculated on the original data (from <code>boot-data</code>).</li>
</ul>
<p>See also <a href="#LOS-bootstrap-stats">bootstrap-stats</a> for input preparation and other confidence interval methods: <a href="#LOS-ci-normal">ci-normal</a>, <a href="#LOS-ci-basic">ci-basic</a>, <a href="#LOS-ci-bc">ci-bc</a>, <a href="#LOS-ci-bca">ci-bca</a>, <a href="#LOS-ci-studentized">ci-studentized</a>, <a href="#LOS-ci-t">ci-t</a>, <a href="#LOS-quantiles">quantiles</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L336">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ci-studentized"></span>
</section>
<section id="ci-studentized" class="level4">
<h4 class="anchored" data-anchor-id="ci-studentized">ci-studentized</h4>
<ul>
<li><code>(ci-studentized boot-data)</code></li>
<li><code>(ci-studentized boot-data alpha)</code></li>
<li><code>(ci-studentized {:keys [t0 ts data samples]} alpha estimation-strategy)</code></li>
</ul>
<p>Calculates the Studentized (or Bootstrap-t) confidence interval.</p>
<p>This method is based on the distribution of the studentized pivotal quantity <code>(statistic(sample) - statistic(data)) / standard_error(statistic(sample))</code>. It estimates the quantiles of this distribution using bootstrap replicates and then uses them to construct a confidence interval around the statistic calculated on the original data (<code>:t0</code>), scaled by the standard error of the statistic calculated on the original data (<code>stddev(:data)</code>).</p>
<p>Parameters:</p>
<ul>
<li><code>boot-data</code> (map): A map containing bootstrap results and necessary inputs. This map typically comes from <a href="#LOS-bootstrap-stats">bootstrap-stats</a> and augmented with <code>:data</code> and <code>:samples</code> from the original <a href="#LOS-bootstrap">bootstrap</a> call if not already present. Requires the following keys:
<ul>
<li><code>:t0</code> (double): The statistic calculated on the original data.</li>
<li><code>:ts</code> (sequence of numbers): The statistic calculated on each bootstrap sample.</li>
<li><code>:data</code> (sequence): The original dataset used for bootstrapping. Needed to estimate the standard error of the statistic for scaling the interval.</li>
<li><code>:samples</code> (collection of sequences): The collection of bootstrap samples. Needed to calculate the standard error of the statistic for each bootstrap sample.</li>
</ul></li>
<li><code>alpha</code> (double, optional): The significance level for the interval. Defaults to <code>0.05</code> (for a 95% CI). The interval is based on the <code>alpha/2</code> and <code>1 - alpha/2</code> quantiles of the studentized bootstrap replicates.</li>
<li><code>estimation-strategy</code> (keyword, optional): Specifies the quantile estimation strategy used to calculate the quantiles of the studentized replicates. Defaults to <code>:legacy</code>. See <a href="#LOS-quantiles">quantiles</a> for available options (e.g., <code>:r1</code> through <code>:r9</code>).</li>
</ul>
<p>Returns a vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<ul>
<li><code>lower-bound</code> (double): The lower limit of the confidence interval.</li>
<li><code>upper-bound</code> (double): The upper limit of the confidence interval.</li>
<li><code>t0</code> (double): The statistic calculated on the original data (from <code>boot-data</code>).</li>
</ul>
<p>See also <a href="#LOS-bootstrap-stats">bootstrap-stats</a> for input preparation and other confidence interval methods: <a href="#LOS-ci-normal">ci-normal</a>, <a href="#LOS-ci-basic">ci-basic</a>, <a href="#LOS-ci-percentile">ci-percentile</a>, <a href="#LOS-ci-bc">ci-bc</a>, <a href="#LOS-ci-bca">ci-bca</a>, <a href="#LOS-ci-t">ci-t</a>, <a href="#LOS-stats/stddev">stats/stddev</a>, <a href="#LOS-stats/quantiles">stats/quantiles</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L507">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-ci-t"></span>
</section>
<section id="ci-t" class="level4">
<h4 class="anchored" data-anchor-id="ci-t">ci-t</h4>
<ul>
<li><code>(ci-t boot-data)</code></li>
<li><code>(ci-t {:keys [t0 ts stddev]} alpha)</code></li>
</ul>
<p>Calculates a confidence interval based on Student’s t-distribution, centered at the original statistic value.</p>
<p>This method constructs a confidence interval centered at the statistic calculated on the original data (<code>:t0</code>). The width of the interval is determined by the standard deviation of the bootstrap replicates (<code>:ts</code>), scaled by a critical value from a Student’s t-distribution. The degrees of freedom for the t-distribution are based on the number of bootstrap replicates (<code>count(:ts) - 1</code>).</p>
<p>This interval does not explicitly use the Studentized bootstrap pivotal quantity. Instead, it applies a standard t-interval structure using components derived from the bootstrap results and the original data.</p>
<p>Parameters:</p>
<ul>
<li><code>boot-data</code> (map): A map containing bootstrap results, typically from <a href="#LOS-bootstrap-stats">bootstrap-stats</a>. Requires keys:
<ul>
<li><code>:t0</code> (double): The statistic calculated on the original data.</li>
<li><code>:ts</code> (sequence of numbers): The statistic calculated on each bootstrap sample. May optionally include pre-calculated <code>:stddev</code> (standard deviation of <code>:ts</code>) for efficiency.</li>
</ul></li>
<li><code>alpha</code> (double, optional): The significance level for the interval. Defaults to <code>0.05</code> (for a 95% CI). The interval is based on the <code>alpha/2</code> and <code>1 - alpha/2</code> quantiles of the Student’s t-distribution with <code>count(:ts) - 1</code> degrees of freedom.</li>
</ul>
<p>Returns a vector <code>[lower-bound, upper-bound, t0]</code>.</p>
<ul>
<li><code>lower-bound</code> (double): The lower limit of the confidence interval.</li>
<li><code>upper-bound</code> (double): The upper limit of the confidence interval.</li>
<li><code>t0</code> (double): The statistic calculated on the original data (from <code>boot-data</code>).</li>
</ul>
<p>See also <a href="#LOS-bootstrap-stats">bootstrap-stats</a> for input preparation and other confidence interval methods: <a href="#LOS-ci-normal">ci-normal</a>, <a href="#LOS-ci-basic">ci-basic</a>, <a href="#LOS-ci-percentile">ci-percentile</a>, <a href="#LOS-ci-bc">ci-bc</a>, <a href="#LOS-ci-bca">ci-bca</a>, <a href="#LOS-ci-studentized">ci-studentized</a>.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L555">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-jackknife"></span>
</section>
<section id="jackknife" class="level4">
<h4 class="anchored" data-anchor-id="jackknife">jackknife</h4>
<ul>
<li><code>(jackknife vs)</code></li>
</ul>
<p>Generates a set of samples from a given sequence using the jackknife leave-one-out method.</p>
<p>For an input sequence <code>vs</code> of size <code>n</code>, this method creates <code>n</code> samples. Each sample is formed by removing a single observation from the original sequence.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code> (sequence): The input data sequence.</li>
</ul>
<p>Returns a sequence of sequences. The i-th inner sequence is <code>vs</code> with the i-th element removed.</p>
<p>These samples are commonly used for estimating the bias and standard error of a statistic (e.g., via <a href="#LOS-bootstrap-stats">bootstrap-stats</a>).</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L90">source</a></small><hr style="margin: 0"></div>
<span id="#LOS-jackknife+"></span>
</section>
<section id="jackknife-1" class="level4">
<h4 class="anchored" data-anchor-id="jackknife-1">jackknife+</h4>
<ul>
<li><code>(jackknife+ vs)</code></li>
</ul>
<p>Generates a set of samples from a sequence using the ‘jackknife positive’ method.</p>
<p>For an input sequence <code>vs</code> of size <code>n</code>, this method creates <code>n</code> samples. Each sample is formed by duplicating a single observation from the original sequence and adding it back to the original sequence. Thus, each sample has size <code>n+1</code>.</p>
<p>Parameters:</p>
<ul>
<li><code>vs</code> (sequence): The input data sequence.</li>
</ul>
<p>Returns a sequence of sequences. The i-th inner sequence is <code>vs</code> with an additional copy of the i-th element of <code>vs</code>.</p>
<p>This method is used in specific resampling techniques for estimating bias and variance of a statistic.</p>
<div style="text-align: right"><small><a href="https://github.com/generateme/fastmath/tree/3.x/src/fastmath/stats/bootstrap.clj#L107">source</a></small><hr style="margin: 0"></div>
<div style="background-color:grey;height:2px;width:100%;"></div>
<div><pre><small><small>source: <a href="https://github.com/generateme/fastmath//blob/master/clay/stats.clj">clay/stats.clj</a></small></small></pre></div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./random.html" class="pagination-link" aria-label="Random">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Random</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./polynomials.html" class="pagination-link" aria-label="Polynomials">
        <span class="nav-page-text">Polynomials</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>