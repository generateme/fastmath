<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>fastmath.classification documentation</title><script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Fastmath</span> <span class="project-version">1.5.0-alpha5</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1"><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fastmath</span></div></div></li><li class="depth-2 branch current"><a href="fastmath.classification.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>classification</span></div></a></li><li class="depth-2 branch"><a href="fastmath.clustering.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clustering</span></div></a></li><li class="depth-2 branch"><a href="fastmath.complex.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>complex</span></div></a></li><li class="depth-2 branch"><a href="fastmath.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="fastmath.distance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>distance</span></div></a></li><li class="depth-2 branch"><a href="fastmath.easings.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>easings</span></div></a></li><li class="depth-2 branch"><a href="fastmath.fields.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fields</span></div></a></li><li class="depth-2 branch"><a href="fastmath.grid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>grid</span></div></a></li><li class="depth-2 branch"><a href="fastmath.interpolation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interpolation</span></div></a></li><li class="depth-2 branch"><a href="fastmath.kernel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kernel</span></div></a></li><li class="depth-2 branch"><a href="fastmath.optimization.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>optimization</span></div></a></li><li class="depth-2 branch"><a href="fastmath.protocols.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-2 branch"><a href="fastmath.random.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>random</span></div></a></li><li class="depth-2 branch"><a href="fastmath.regression.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>regression</span></div></a></li><li class="depth-2 branch"><a href="fastmath.signal.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>signal</span></div></a></li><li class="depth-2 branch"><a href="fastmath.stats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stats</span></div></a></li><li class="depth-2 branch"><a href="fastmath.transform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transform</span></div></a></li><li class="depth-2"><a href="fastmath.vector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fastmath.classification.html#var-accuracy"><div class="inner"><span>accuracy</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-activation-functions-list"><div class="inner"><span>activation-functions-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-ada-boost"><div class="inner"><span>ada-boost</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-backend"><div class="inner"><span>backend</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-bayes-models-list"><div class="inner"><span>bayes-models-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-confusion-map"><div class="inner"><span>confusion-map</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-cv"><div class="inner"><span>cv</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-data-native"><div class="inner"><span>data-native</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-decision-tree"><div class="inner"><span>decision-tree</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-error-functions-list"><div class="inner"><span>error-functions-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-fld"><div class="inner"><span>fld</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-gradient-tree-boost"><div class="inner"><span>gradient-tree-boost</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-knn"><div class="inner"><span>knn</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-labels"><div class="inner"><span>labels</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-lda"><div class="inner"><span>lda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-liblinear"><div class="inner"><span>liblinear</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-liblinear-solver-list"><div class="inner"><span>liblinear-solver-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-logistic-regression"><div class="inner"><span>logistic-regression</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-model-native"><div class="inner"><span>model-native</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-multiclass-strategies-list"><div class="inner"><span>multiclass-strategies-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-naive-bayes"><div class="inner"><span>naive-bayes</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-neural-net"><div class="inner"><span>neural-net</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-predict"><div class="inner"><span>predict</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-predict-all"><div class="inner"><span>predict-all</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-qda"><div class="inner"><span>qda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-random-forest"><div class="inner"><span>random-forest</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-rbf-network"><div class="inner"><span>rbf-network</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-rda"><div class="inner"><span>rda</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-split-rules-list"><div class="inner"><span>split-rules-list</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-svm"><div class="inner"><span>svm</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-train"><div class="inner"><span>train</span></div></a></li><li class="depth-1"><a href="fastmath.classification.html#var-validate"><div class="inner"><span>validate</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">fastmath.classification</h1><div class="doc"><div class="markdown"><p>Classification algorithms.</p>
<h3><a href="#input-data" name="input-data"></a>Input data</h3>
<ul>
  <li>features - sequence of sequences of numbers</li>
  <li>categories - sequence of any values</li>
</ul>
<h3><a href="#workflow" name="workflow"></a>Workflow</h3>
<ul>
  <li>create classifier with parameters</li>
  <li>cross validate <a href="fastmath.classification.html#var-cv">cv</a></li>
  <li>repeat or <a href="fastmath.classification.html#var-predict">predict</a></li>
  <li>to validate model against test data, call <a href="fastmath.classification.html#var-validate">validate</a></li>
</ul>
<p>Classifier parameters are map of values specific for given algorithm. Check documentation in backend library to find documentation. Classifier can be retrained using <a href="fastmath.classification.html#var-train">train</a>. New instance will be created.</p>
<p>Classifier training is delayed to the actual use. To force training, call <a href="fastmath.classification.html#var-train">train</a> or <a href="fastmath.classification.html#var-predict">predict</a>.</p>
<h3><a href="#implementation-notes" name="implementation-notes"></a>Implementation notes</h3>
<ul>
  <li>only doubles as input data</li>
  <li>categories can be any type</li>
</ul>
<h3><a href="#cross-validation" name="cross-validation"></a>Cross validation</h3>
<p>Every classifier exposes itâ€™s own cross validation method with configuration <a href="fastmath.classification.html#var-cv">cv</a>.</p>
<p><del>Additionally three Clojure level methods are defined: <a href="fastmath.classification.html#var-cv">cv</a>, <a href="null">loocv</a> and <a href="fastmath.stats.html#var-bootstrap">bootstrap</a>.</del></p>
<h3><a href="#smile" name="smile"></a>SMILE</h3>
<p><a href="https://haifengl.github.io/smile/classification.html">documentation</a></p>
<p>What is missed:</p>
<ul>
  <li>other types than doubles (attributes)</li>
  <li>maxent</li>
  <li>Online classifiers</li>
  <li>General Naive Bayes</li>
</ul>
<p>Native cross validation config is a map with keys:</p>
<ul>
  <li><code>:k</code> - number of folds (default: 10)</li>
  <li><code>:type</code> - type of cross validation, one of <code>:cv</code> (default), <code>:loocv</code> and <code>:bootstrap</code></li>
</ul>
<h3><a href="#liblinear" name="liblinear"></a>Liblinear</h3>
<p><a href="https://github.com/bwaldvogel/liblinear-java">https://github.com/bwaldvogel/liblinear-java</a></p>
<p>Native cross validation expects a number as number of folds (default: 10)</p>
<h3><a href="#examples" name="examples"></a>Examples</h3>
<p>Iris database is used.</p></div><div class="markdown"><h4>Categories</h4><ul><li>Classification: <a href="fastmath.classification.html#var-ada-boost">ada-boost</a> <a href="fastmath.classification.html#var-decision-tree">decision-tree</a> <a href="fastmath.classification.html#var-fld">fld</a> <a href="fastmath.classification.html#var-gradient-tree-boost">gradient-tree-boost</a> <a href="fastmath.classification.html#var-knn">knn</a> <a href="fastmath.classification.html#var-lda">lda</a> <a href="fastmath.classification.html#var-liblinear">liblinear</a> <a href="fastmath.classification.html#var-logistic-regression">logistic-regression</a> <a href="fastmath.classification.html#var-naive-bayes">naive-bayes</a> <a href="fastmath.classification.html#var-neural-net">neural-net</a> <a href="fastmath.classification.html#var-qda">qda</a> <a href="fastmath.classification.html#var-random-forest">random-forest</a> <a href="fastmath.classification.html#var-rbf-network">rbf-network</a> <a href="fastmath.classification.html#var-rda">rda</a> <a href="fastmath.classification.html#var-svm">svm</a></li><li>Validation: <a href="fastmath.classification.html#var-accuracy">accuracy</a> <a href="fastmath.classification.html#var-confusion-map">confusion-map</a> <a href="fastmath.classification.html#var-validate">validate</a></li></ul><p>Other vars: <a href="fastmath.classification.html#var-activation-functions-list">activation-functions-list</a> <a href="fastmath.classification.html#var-backend">backend</a> <a href="fastmath.classification.html#var-bayes-models-list">bayes-models-list</a> <a href="fastmath.classification.html#var-cv">cv</a> <a href="fastmath.classification.html#var-data-native">data-native</a> <a href="fastmath.classification.html#var-error-functions-list">error-functions-list</a> <a href="fastmath.classification.html#var-labels">labels</a> <a href="fastmath.classification.html#var-liblinear-solver-list">liblinear-solver-list</a> <a href="fastmath.classification.html#var-model-native">model-native</a> <a href="fastmath.classification.html#var-multiclass-strategies-list">multiclass-strategies-list</a> <a href="fastmath.classification.html#var-predict">predict</a> <a href="fastmath.classification.html#var-predict-all">predict-all</a> <a href="fastmath.classification.html#var-split-rules-list">split-rules-list</a> <a href="fastmath.classification.html#var-train">train</a></p></div></div><div class="public anchor" id="var-accuracy"><h3>accuracy</h3><div class="usage"><code>(accuracy t p)</code></div><div class="doc"><div class="markdown"><p>Calculate accuracy for real and predicted sequences.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(accuracy [1 2 3 4 1 2 3 4] [1 2 4 4 2 4 4 4])
;;=&gt; 0.5</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L112">view source</a></div></div><div class="public anchor" id="var-activation-functions-list"><h3>activation-functions-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of activation functions for <a href="fastmath.classification.html#var-neural-net">neural-net</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">activation-functions-list
;;=&gt; (:linear :logistic-sigmoid :soft-max)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L274">view source</a></div></div><div class="public anchor" id="var-ada-boost"><h3>ada-boost</h3><div class="usage"><code>(ada-boost x y)</code><code>(ada-boost {:keys [number-of-trees max-nodes], :or {number-of-trees 500, max-nodes 2}} x y)</code></div><div class="doc"><div class="markdown"><p>ada-boost classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (ada-boost train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid
;;=&gt;  {:count 4,
;;=&gt;   :data
;;=&gt;   ([6.3 2.8 5.1 1.5] [6.7 3 5 1.7] [6.1 2.6 5.6 1.4] [6.2 2.2 4.5 1.5]),
;;=&gt;   :prediction (:versicolor :virginica :versicolor :virginica),
;;=&gt;   :truth (:virginica :versicolor :virginica :versicolor)},
;;=&gt;  :stats {:accuracy 0.9111111111111111}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L200">view source</a></div></div><div class="public anchor" id="var-backend"><h3>backend</h3><div class="usage"><code>(backend model)</code></div><div class="doc"><div class="markdown"><p>Return name of backend library</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(backend (knn test-data test-labels))
;;=&gt; :smile
(backend (liblinear test-data test-labels))
;;=&gt; :liblinear</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L358">view source</a></div></div><div class="public anchor" id="var-bayes-models-list"><h3>bayes-models-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of <a href="fastmath.classification.html#var-naive-bayes">naive-bayes</a> models.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">bayes-models-list
;;=&gt; (:multinomial :bernoulli :polyaurn)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L254">view source</a></div></div><div class="public anchor" id="var-confusion-map"><h3>confusion-map</h3><div class="usage"><code>(confusion-map t p)</code></div><div class="doc"><div class="markdown"><p>Create confusion map where keys are pairs of <code>[truth-label prediction-label]</code></p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (liblinear {:solver :l1r-lr, :C 10} train-data train-labels)
      pred (predict-all cl test-data)]
  (confusion-map test-labels pred))
;;=&gt; {[:setosa :setosa] 13,
;;=&gt;  [:versicolor :versicolor] 12,
;;=&gt;  [:versicolor :virginica] 1,
;;=&gt;  [:virginica :versicolor] 1,
;;=&gt;  [:virginica :virginica] 18}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L488">view source</a></div></div><div class="public anchor" id="var-cv"><h3>cv</h3><div class="usage"><code>(cv model)</code><code>(cv model params)</code></div><div class="doc"><div class="markdown"><p>Cross validation</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(cv (knn train-data train-labels))
;;=&gt; {:accuracy 0.9619047619047619}
(cv (knn test-data test-labels) {:type :loocv})
;;=&gt; {:accuracy 0.9555555555555556}
(cv (knn test-data test-labels) {:type :bootstrap})
;;=&gt; {:accuracy {:mean 0.9647316821465428, :stddev 0.05340301764227176}}
(cv (liblinear test-data test-labels))
;;=&gt; {:accuracy 0.9111111111111111}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L385">view source</a></div></div><div class="public anchor" id="var-data-native"><h3>data-native</h3><div class="usage"><code>(data-native model)</code></div><div class="doc"><div class="markdown"><p>Return data transformed for backend library.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(data-native (knn [[1 2] [3 2]] [0 1]))
;;=&gt; [[[1.0 2.0] [3.0 2.0]] [0 1]]</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L366">view source</a></div></div><div class="public anchor" id="var-decision-tree"><h3>decision-tree</h3><div class="usage"><code>(decision-tree x y)</code><code>(decision-tree {:keys [max-nodes node-size split-rule], :or {max-nodes 100, node-size 1, split-rule :gini}} x y)</code></div><div class="doc"><div class="markdown"><p>decision-tree classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (decision-tree train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6.3 2.8 5.1 1.5] [6.7 3 5 1.7] [6.1 2.6 5.6 1.4]),
;;=&gt;            :prediction (:versicolor :virginica :versicolor),
;;=&gt;            :truth (:virginica :versicolor :virginica)},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L230">view source</a></div></div><div class="public anchor" id="var-error-functions-list"><h3>error-functions-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of error functions for <a href="fastmath.classification.html#var-neural-net">neural-net</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">error-functions-list
;;=&gt; (:least-mean-squares :cross-entropy)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L268">view source</a></div></div><div class="public anchor" id="var-fld"><h3>fld</h3><div class="usage"><code>(fld x y)</code><code>(fld {:keys [dimensionality tolerance], :or {dimensionality -1, tolerance 1.0E-4}} x y)</code></div><div class="doc"><div class="markdown"><p>fld classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (fld train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.7 3 5 1.7]),
;;=&gt;            :prediction (:versicolor :virginica),
;;=&gt;            :truth (:virginica :versicolor)},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L206">view source</a></div></div><div class="public anchor" id="var-gradient-tree-boost"><h3>gradient-tree-boost</h3><div class="usage"><code>(gradient-tree-boost x y)</code><code>(gradient-tree-boost {:keys [number-of-trees shrinkage max-nodes subsample], :or {number-of-trees 500, shrinkage 0.005, max-nodes 6, subsample 0.7}} x y)</code></div><div class="doc"><div class="markdown"><p>gradient-tree-boost classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (gradient-tree-boost train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6 3 4.8 1.8] [6.3 2.8 5.1 1.5] [6.7 3 5 1.7]),
;;=&gt;            :prediction (:versicolor :versicolor :virginica),
;;=&gt;            :truth (:virginica :virginica :versicolor)},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L236">view source</a></div></div><div class="public anchor" id="var-knn"><h3>knn</h3><div class="usage"><code>(knn x y)</code><code>(knn {:keys [distance k], :or {distance (EuclideanDistance.), k 1}} x y)</code></div><div class="doc"><div class="markdown"><p>knn classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (knn train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.3 2.8 5.1 1.5]),
;;=&gt;            :prediction (:versicolor :versicolor),
;;=&gt;            :truth (:virginica :virginica)},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div><div><blockquote><p>Different distance</p></blockquote><pre><code class="hljs clojure">(let [cl (knn {:distance dist/cosine} train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6 3 4.8 1.8] [6.5 3.2 5.1 2]),
;;=&gt;            :prediction (:versicolor :versicolor),
;;=&gt;            :truth (:virginica :virginica)},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L196">view source</a></div></div><div class="public anchor" id="var-labels"><h3>labels</h3><div class="usage"><code>(labels ys)</code></div><div class="doc"><div class="markdown"><p>Return labels</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(labels train-labels)
;;=&gt; [:setosa :versicolor :virginica]</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L390">view source</a></div></div><div class="public anchor" id="var-lda"><h3>lda</h3><div class="usage"><code>(lda x y)</code><code>(lda {:keys [priori tolerance], :or {priori nil, tolerance 1.0E-4}} x y)</code></div><div class="doc"><div class="markdown"><p>lda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (lda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 9,
;;=&gt;            :data ([5.9 3 5.1 1.8]
;;=&gt;                   [6.7 3.1 4.7 1.5]
;;=&gt;                   [6.3 2.8 5.1 1.5]
;;=&gt;                   [6.3 3.3 4.7 1.6]
;;=&gt;                   [5.8 2.7 5.1 1.9]
;;=&gt;                   [6.9 3.1 4.9 1.5]
;;=&gt;                   [7 3.2 4.7 1.4]
;;=&gt;                   [6.7 3 5 1.7]
;;=&gt;                   [6.1 2.6 5.6 1.4]),
;;=&gt;            :prediction (:versicolor :virginica :versicolor
;;=&gt;                                     :virginica :versicolor
;;=&gt;                                     :virginica :virginica
;;=&gt;                                     :virginica :versicolor),
;;=&gt;            :truth (:virginica :versicolor :virginica
;;=&gt;                               :versicolor :virginica
;;=&gt;                               :versicolor :versicolor
;;=&gt;                               :versicolor :virginica)},
;;=&gt;  :stats {:accuracy 0.8}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L218">view source</a></div></div><div class="public anchor" id="var-liblinear"><h3>liblinear</h3><div class="usage"><code>(liblinear x y)</code><code>(liblinear {:keys [solver bias C eps max-iters p weights], :or {solver :l2r-l2loss-svc-dual, bias -1, C 1.0, eps 0.01, max-iters 1000, p 0.1}} x y)</code></div><div class="doc"><div class="markdown"><p>liblinear classifier. Backend library: liblinear</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (liblinear train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6.3 2.8 5.1 1.5]),
;;=&gt;            :prediction (:versicolor),
;;=&gt;            :truth (:virginica)},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div><div><blockquote><p>Different solver</p></blockquote><pre><code class="hljs clojure">(let [cl (liblinear {:solver :l1r-lr, :C 10} train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6.3 2.8 5.1 1.5] [6.2 2.2 4.5 1.5]),
;;=&gt;            :prediction (:versicolor :virginica),
;;=&gt;            :truth (:virginica :versicolor)},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L351">view source</a></div></div><div class="public anchor" id="var-liblinear-solver-list"><h3>liblinear-solver-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of <a href="fastmath.classification.html#var-liblinear">liblinear</a> solvers.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">liblinear-solver-list
;;=&gt; (:l2r-lr :l2r-l2loss-svc-dual
;;=&gt;          :l2r-l2loss-svc :l2r-l1loss-svc-dual
;;=&gt;          :mcsvm-cs :l1r-l2loss-svc
;;=&gt;          :l1r-lr :l2r-lr-dual)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L349">view source</a></div></div><div class="public anchor" id="var-logistic-regression"><h3>logistic-regression</h3><div class="usage"><code>(logistic-regression x y)</code><code>(logistic-regression {:keys [lambda tolerance max-iterations], :or {lambda 0.0, tolerance 1.0E-5, max-iterations 500}} x y)</code></div><div class="doc"><div class="markdown"><p>logistic-regression classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (logistic-regression train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 5,
;;=&gt;            :data ([6 3 4.8 1.8]
;;=&gt;                   [6.3 2.8 5.1 1.5]
;;=&gt;                   [6.1 3 4.9 1.8]
;;=&gt;                   [6.1 2.6 5.6 1.4]
;;=&gt;                   [6.2 2.2 4.5 1.5]),
;;=&gt;            :prediction (:versicolor :versicolor :versicolor
;;=&gt;                                     :versicolor :virginica),
;;=&gt;            :truth (:virginica :virginica :virginica
;;=&gt;                               :virginica :versicolor)},
;;=&gt;  :stats {:accuracy 0.8888888888888888}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L243">view source</a></div></div><div class="public anchor" id="var-model-native"><h3>model-native</h3><div class="usage"><code>(model-native model)</code></div><div class="doc"><div class="markdown"><p>Return trained model as a backend class.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(model-native (knn train-data train-labels))
;;=&gt; smile.classification.KNN@5fb26827
(model-native (liblinear train-data train-labels))
;;=&gt; Model bias=-1.0 nr_class=3 nr_feature=4 solverType=L2R_L2LOSS_SVC_DUAL</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L362">view source</a></div></div><div class="public anchor" id="var-multiclass-strategies-list"><h3>multiclass-strategies-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of multiclass strategies for <a href="fastmath.classification.html#var-svm">svm</a></p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">multiclass-strategies-list
;;=&gt; (:one-vs-one :one-vs-all)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L324">view source</a></div></div><div class="public anchor" id="var-naive-bayes"><h3>naive-bayes</h3><div class="usage"><code>(naive-bayes x y)</code><code>(naive-bayes {:keys [model priori sigma], :or {model :bernoulli, sigma 1.0}} x y)</code></div><div class="doc"><div class="markdown"><p>naive-bayes classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (naive-bayes train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 32,
;;=&gt;            :data ([7.1 3 5.9 2.1]
;;=&gt;                   [5.8 2.7 4.1 1]
;;=&gt;                   [6.1 2.8 4 1.3]
;;=&gt;                   [5.9 3 5.1 1.8]
;;=&gt;                   [6.3 3.3 6 2.5]
;;=&gt;                   [6.5 3 5.2 2]
;;=&gt;                   [6 3 4.8 1.8]
;;=&gt;                   [6.3 2.7 4.9 1.8]
;;=&gt;                   [6.7 3.1 4.7 1.5]
;;=&gt;                   [6.3 2.8 5.1 1.5]
;;=&gt;                   [6.3 3.3 4.7 1.6]
;;=&gt;                   [6.4 2.8 5.6 2.2]
;;=&gt;                   [7.2 3.6 6.1 2.5]
;;=&gt;                   [5.7 2.8 4.5 1.3]
;;=&gt;                   [6.5 3 5.8 2.2]
;;=&gt;                   [5.8 2.7 5.1 1.9]
;;=&gt;                   [6.1 3 4.9 1.8]
;;=&gt;                   [6.9 3.1 4.9 1.5]
;;=&gt;                   [6.4 2.7 5.3 1.9]
;;=&gt;                   [7 3.2 4.7 1.4]
;;=&gt;                   [6.7 3.3 5.7 2.5]
;;=&gt;                   [6.7 3 5 1.7]
;;=&gt;                   [6.7 3 5.2 2.3]
;;=&gt;                   [5.2 2.7 3.9 1.4]
;;=&gt;                   [5 2.3 3.3 1]
;;=&gt;                   [6.1 2.6 5.6 1.4]
;;=&gt;                   [5.6 2.8 4.9 2]
;;=&gt;                   [5.5 2.3 4 1.3]
;;=&gt;                   [6.2 2.2 4.5 1.5]
;;=&gt;                   [6.8 2.8 4.8 1.4]
;;=&gt;                   [6.4 3.2 5.3 2.3]
;;=&gt;                   [6.5 3.2 5.1 2]),
;;=&gt;            :prediction (:setosa
;;=&gt;                         :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa),
;;=&gt;            :truth (:virginica
;;=&gt;                    :versicolor
;;=&gt;                    :versicolor :virginica
;;=&gt;                    :virginica :virginica
;;=&gt;                    :virginica :virginica
;;=&gt;                    :versicolor :virginica
;;=&gt;                    :versicolor :virginica
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :virginica :virginica
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :versicolor :virginica
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :versicolor :versicolor
;;=&gt;                    :virginica :virginica)},
;;=&gt;  :stats {:accuracy 0.28888888888888886}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L256">view source</a></div></div><div class="public anchor" id="var-neural-net"><h3>neural-net</h3><div class="usage"><code>(neural-net x y)</code><code>(neural-net {:keys [error-function activation-function layers learning-rate momentum weight-decay number-of-epochs], :or {error-function :cross-entropy, learning-rate 0.1, momentum 0.0, weight-decay 0.0, number-of-epochs 25}} x y)</code></div><div class="doc"><div class="markdown"><p>neural-net classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (neural-net {:layers [100 100]} train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6.7 3 5 1.7] [6.2 2.2 4.5 1.5]),
;;=&gt;            :prediction (:virginica :virginica),
;;=&gt;            :truth (:versicolor :versicolor)},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div><div><blockquote><p>Bad model</p></blockquote><pre><code class="hljs clojure">(let [cl (neural-net {:layers [3 3 3], :number-of-epochs 3}
                     train-data
                     train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 32,
;;=&gt;            :data ([7.1 3 5.9 2.1]
;;=&gt;                   [5.8 2.7 4.1 1]
;;=&gt;                   [6.1 2.8 4 1.3]
;;=&gt;                   [5.9 3 5.1 1.8]
;;=&gt;                   [6.3 3.3 6 2.5]
;;=&gt;                   [6.5 3 5.2 2]
;;=&gt;                   [6 3 4.8 1.8]
;;=&gt;                   [6.3 2.7 4.9 1.8]
;;=&gt;                   [6.7 3.1 4.7 1.5]
;;=&gt;                   [6.3 2.8 5.1 1.5]
;;=&gt;                   [6.3 3.3 4.7 1.6]
;;=&gt;                   [6.4 2.8 5.6 2.2]
;;=&gt;                   [7.2 3.6 6.1 2.5]
;;=&gt;                   [5.7 2.8 4.5 1.3]
;;=&gt;                   [6.5 3 5.8 2.2]
;;=&gt;                   [5.8 2.7 5.1 1.9]
;;=&gt;                   [6.1 3 4.9 1.8]
;;=&gt;                   [6.9 3.1 4.9 1.5]
;;=&gt;                   [6.4 2.7 5.3 1.9]
;;=&gt;                   [7 3.2 4.7 1.4]
;;=&gt;                   [6.7 3.3 5.7 2.5]
;;=&gt;                   [6.7 3 5 1.7]
;;=&gt;                   [6.7 3 5.2 2.3]
;;=&gt;                   [5.2 2.7 3.9 1.4]
;;=&gt;                   [5 2.3 3.3 1]
;;=&gt;                   [6.1 2.6 5.6 1.4]
;;=&gt;                   [5.6 2.8 4.9 2]
;;=&gt;                   [5.5 2.3 4 1.3]
;;=&gt;                   [6.2 2.2 4.5 1.5]
;;=&gt;                   [6.8 2.8 4.8 1.4]
;;=&gt;                   [6.4 3.2 5.3 2.3]
;;=&gt;                   [6.5 3.2 5.1 2]),
;;=&gt;            :prediction (:setosa
;;=&gt;                         :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa
;;=&gt;                         :setosa :setosa),
;;=&gt;            :truth (:virginica
;;=&gt;                    :versicolor
;;=&gt;                    :versicolor :virginica
;;=&gt;                    :virginica :virginica
;;=&gt;                    :virginica :virginica
;;=&gt;                    :versicolor :virginica
;;=&gt;                    :versicolor :virginica
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :virginica :virginica
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :versicolor :virginica
;;=&gt;                    :virginica :versicolor
;;=&gt;                    :versicolor :versicolor
;;=&gt;                    :virginica :virginica)},
;;=&gt;  :stats {:accuracy 0.28888888888888886}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L276">view source</a></div></div><div class="public anchor" id="var-predict"><h3>predict</h3><div class="usage"><code>(predict model v)</code><code>(predict model v posteriori?)</code></div><div class="doc"><div class="markdown"><p>Predict categories for given vector. If <code>posteriori?</code> is true returns also posteriori probability (default <code>false</code>).</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(predict (knn train-data train-labels) [1 2 3 4])
;;=&gt; :virginica
(predict (ada-boost train-data train-labels) [1 2 3 4] true)
;;=&gt; [:virginica
;;=&gt;  {:setosa 0.0581440168937598,
;;=&gt;   :versicolor 0.42281344462630893,
;;=&gt;   :virginica 0.5190425384799313}]</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L370">view source</a></div></div><div class="public anchor" id="var-predict-all"><h3>predict-all</h3><div class="usage"><code>(predict-all model v)</code><code>(predict-all model v posteriori?)</code></div><div class="doc"><div class="markdown"><p>Predict categories for given sequence of vectors. If <code>posteriori?</code> is true returns also posteriori probability (default <code>false</code>).</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(predict-all (knn train-data train-labels) (take 3 test-data))
;;=&gt; (:virginica :versicolor :versicolor)
(predict-all (ada-boost train-data train-labels)
             (take 3 test-data)
             true)
;;=&gt; ([:virginica
;;=&gt;   {:setosa 0.0,
;;=&gt;    :versicolor 0.3747678245437091,
;;=&gt;    :virginica 0.625232175456291}]
;;=&gt;  [:versicolor
;;=&gt;   {:setosa 0.020748059490083032,
;;=&gt;    :versicolor 0.5920790247006971,
;;=&gt;    :virginica 0.38717291580922}]
;;=&gt;  [:versicolor
;;=&gt;   {:setosa 0.01979617807103763,
;;=&gt;    :versicolor 0.6052032243574003,
;;=&gt;    :virginica 0.375000597571562}])</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L375">view source</a></div></div><div class="public anchor" id="var-qda"><h3>qda</h3><div class="usage"><code>(qda x y)</code><code>(qda {:keys [priori tolerance], :or {priori nil, tolerance 1.0E-4}} x y)</code></div><div class="doc"><div class="markdown"><p>qda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (qda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6.3 2.8 5.1 1.5] [6.2 2.2 4.5 1.5]),
;;=&gt;            :prediction (:versicolor :virginica),
;;=&gt;            :truth (:virginica :versicolor)},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L212">view source</a></div></div><div class="public anchor" id="var-random-forest"><h3>random-forest</h3><div class="usage"><code>(random-forest x y)</code><code>(random-forest {:keys [number-of-trees split-rule mtry node-size max-nodes subsample], :or {number-of-trees 500, split-rule :gini, node-size 1, max-nodes 100, subsample 1.0}} x y)</code></div><div class="doc"><div class="markdown"><p>random-forest classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (random-forest train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid
;;=&gt;  {:count 4,
;;=&gt;   :data
;;=&gt;   ([6 3 4.8 1.8] [6.3 2.8 5.1 1.5] [6.7 3 5 1.7] [6.1 2.6 5.6 1.4]),
;;=&gt;   :prediction (:versicolor :versicolor :virginica :versicolor),
;;=&gt;   :truth (:virginica :virginica :versicolor :virginica)},
;;=&gt;  :stats {:accuracy 0.9111111111111111}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L310">view source</a></div></div><div class="public anchor" id="var-rbf-network"><h3>rbf-network</h3><div class="usage"><code>(rbf-network x y)</code><code>(rbf-network {:keys [distance rbf number-of-basis normalize?], :or {distance dist/euclidean, number-of-basis 10, normalize? false}} x y)</code></div><div class="doc"><div class="markdown"><p>rbf-network classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (rbf-network train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 3,
;;=&gt;            :data ([6 3 4.8 1.8] [6.3 2.8 5.1 1.5] [6.1 3 4.9 1.8]),
;;=&gt;            :prediction (:versicolor :versicolor :versicolor),
;;=&gt;            :truth (:virginica :virginica :virginica)},
;;=&gt;  :stats {:accuracy 0.9333333333333333}}</code></pre></div><div><blockquote><p>Custom rbfs</p></blockquote><pre><code class="hljs clojure">(let [cl (rbf-network
          {:rbf (take 5 (cycle [(k/rbf :linear) (k/rbf :wendland-20)]))}
          train-data
          train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 10,
;;=&gt;            :data ([5.9 3 5.1 1.8]
;;=&gt;                   [6 3 4.8 1.8]
;;=&gt;                   [6.3 2.7 4.9 1.8]
;;=&gt;                   [6.3 2.8 5.1 1.5]
;;=&gt;                   [5.8 2.7 5.1 1.9]
;;=&gt;                   [6.1 3 4.9 1.8]
;;=&gt;                   [6.9 3.1 4.9 1.5]
;;=&gt;                   [6.7 3 5 1.7]
;;=&gt;                   [6.1 2.6 5.6 1.4]
;;=&gt;                   [5.6 2.8 4.9 2]),
;;=&gt;            :prediction (:versicolor :versicolor
;;=&gt;                                     :versicolor :versicolor
;;=&gt;                                     :versicolor :versicolor
;;=&gt;                                     :virginica :virginica
;;=&gt;                                     :versicolor :versicolor),
;;=&gt;            :truth (:virginica :virginica
;;=&gt;                               :virginica :virginica
;;=&gt;                               :virginica :virginica
;;=&gt;                               :versicolor :versicolor
;;=&gt;                               :virginica :virginica)},
;;=&gt;  :stats {:accuracy 0.7777777777777778}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L295">view source</a></div></div><div class="public anchor" id="var-rda"><h3>rda</h3><div class="usage"><code>(rda x y)</code><code>(rda {:keys [alpha priori tolerance], :or {alpha 0.9, tolerance 1.0E-4}} x y)</code></div><div class="doc"><div class="markdown"><p>rda classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (rda train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([5.9 3 5.1 1.8] [6.3 2.8 5.1 1.5]),
;;=&gt;            :prediction (:versicolor :versicolor),
;;=&gt;            :truth (:virginica :virginica)},
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L304">view source</a></div></div><div class="public anchor" id="var-split-rules-list"><h3>split-rules-list</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>List of split rules for <a href="null">decision tree</a> and <a href="fastmath.classification.html#var-random-forest">random-forest</a></p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Names</p></blockquote><pre><code class="hljs clojure">split-rules-list
;;=&gt; (:gini :entropy :classification-error)</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L228">view source</a></div></div><div class="public anchor" id="var-svm"><h3>svm</h3><div class="usage"><code>(svm x y)</code><code>(svm {:keys [kernel c-or-cp cn strategy-for-multiclass class-weights tolerance epochs], :or {kernel (k/kernel :linear), c-or-cp 1.0, cn 1.0, strategy-for-multiclass :one-vs-one, tolerance 0.001, epochs 2}} x y)</code></div><div class="doc"><div class="markdown"><p>svm classifier. Backend library: smile</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Usage</p></blockquote><pre><code class="hljs clojure">(let [cl (svm train-data train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 3 4.8 1.8]),
;;=&gt;            :prediction (:versicolor),
;;=&gt;            :truth (:virginica)},
;;=&gt;  :stats {:accuracy 0.9777777777777777}}</code></pre></div><div><blockquote><p>Different kernel</p></blockquote><pre><code class="hljs clojure">(let [cl (svm {:kernel (k/kernel :gaussian 0.15), :epochs 10}
              train-data
              train-labels)]
  (select-keys (validate cl test-data test-labels) [:invalid :stats]))
;;=&gt; {:invalid {:count 10,
;;=&gt;            :data ([5.9 3 5.1 1.8]
;;=&gt;                   [6 3 4.8 1.8]
;;=&gt;                   [6.3 2.8 5.1 1.5]
;;=&gt;                   [4.3 3 1.1 0.1]
;;=&gt;                   [4.6 3.6 1 0.2]
;;=&gt;                   [6.9 3.1 4.9 1.5]
;;=&gt;                   [7 3.2 4.7 1.4]
;;=&gt;                   [6.7 3 5 1.7]
;;=&gt;                   [5.8 4 1.2 0.2]
;;=&gt;                   [5.5 4.2 1.4 0.2]),
;;=&gt;            :prediction (:versicolor :versicolor
;;=&gt;                                     :versicolor :virginica
;;=&gt;                                     :virginica :virginica
;;=&gt;                                     :virginica :virginica
;;=&gt;                                     :virginica :virginica),
;;=&gt;            :truth (:virginica :virginica
;;=&gt;                               :virginica :setosa
;;=&gt;                               :setosa :versicolor
;;=&gt;                               :versicolor :versicolor
;;=&gt;                               :setosa :setosa)},
;;=&gt;  :stats {:accuracy 0.7777777777777778}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L326">view source</a></div></div><div class="public anchor" id="var-train"><h3>train</h3><div class="usage"><code>(train model)</code><code>(train model xs ys)</code></div><div class="doc"><div class="markdown"><p>Train another set of data for given classifier or force training already given data.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Train new data</p></blockquote><pre><code class="hljs clojure">(train (knn train-data train-labels))
;;=&gt; fastmath.classification$eval13178$fn$reify__13193@35dfd7f4</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L380">view source</a></div></div><div class="public anchor" id="var-validate"><h3>validate</h3><div class="usage"><code>(validate model tx ty)</code></div><div class="doc"><div class="markdown"><p>Validate data against trained classifier. Same as <a href="null">test</a>.</p></div></div><div class="markdown"><h4>Examples</h4><div><blockquote><p>Use data provided during training</p></blockquote><pre><code class="hljs clojure">(validate (qda train-data train-labels) test-data test-labels)
;;=&gt; {:invalid {:count 2,
;;=&gt;            :data ([6.3 2.8 5.1 1.5] [6.2 2.2 4.5 1.5]),
;;=&gt;            :prediction (:versicolor :virginica),
;;=&gt;            :truth (:virginica :versicolor)},
;;=&gt;  :prediction (:virginica
;;=&gt;               :versicolor :versicolor
;;=&gt;               :virginica :virginica
;;=&gt;               :setosa :virginica
;;=&gt;               :virginica :setosa
;;=&gt;               :virginica :versicolor
;;=&gt;               :setosa :versicolor
;;=&gt;               :versicolor :virginica
;;=&gt;               :virginica :setosa
;;=&gt;               :setosa :versicolor
;;=&gt;               :setosa :setosa
;;=&gt;               :virginica :virginica
;;=&gt;               :virginica :versicolor
;;=&gt;               :virginica :versicolor
;;=&gt;               :virginica :setosa
;;=&gt;               :versicolor :virginica
;;=&gt;               :versicolor :versicolor
;;=&gt;               :virginica :setosa
;;=&gt;               :setosa :virginica
;;=&gt;               :versicolor :virginica
;;=&gt;               :setosa :versicolor
;;=&gt;               :setosa :setosa
;;=&gt;               :virginica :virginica),
;;=&gt;  :stats {:accuracy 0.9555555555555556}}</code></pre></div><div><blockquote><p>Test other data</p></blockquote><pre><code class="hljs clojure">(validate (qda train-data train-labels)
          [[1 2 3 4] [6 4 3 2]]
          [:virginica :setosa])
;;=&gt; {:invalid {:count 1,
;;=&gt;            :data ([6 4 3 2]),
;;=&gt;            :prediction (:virginica),
;;=&gt;            :truth (:setosa)},
;;=&gt;  :prediction (:virginica :virginica),
;;=&gt;  :stats {:accuracy 0.5}}</code></pre></div></div><div class="src-link"><a href="https://github.com/generateme/fastmath/blob/master/src/fastmath/classification.clj#L397">view source</a></div></div></div></body></html>